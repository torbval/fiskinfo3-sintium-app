var Sintium=function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n(n.s=127)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(6);e.METADATA_KEY=i;var r=n(94);e.Container=r.Container;var o=n(9);e.BindingScopeEnum=o.BindingScopeEnum,e.BindingTypeEnum=o.BindingTypeEnum,e.TargetTypeEnum=o.TargetTypeEnum;var s=n(78);e.AsyncContainerModule=s.AsyncContainerModule,e.ContainerModule=s.ContainerModule;var a=n(77);e.injectable=a.injectable;var c=n(76);e.tagged=c.tagged;var l=n(75);e.named=l.named;var u=n(43);e.inject=u.inject,e.LazyServiceIdentifer=u.LazyServiceIdentifer;var h=n(74);e.optional=h.optional;var d=n(73);e.unmanaged=d.unmanaged;var f=n(72);e.multiInject=f.multiInject;var p=n(71);e.targetName=p.targetName;var g=n(70);e.postConstruct=g.postConstruct;var _=n(45);e.MetadataReader=_.MetadataReader;var m=n(11);e.id=m.id;var y=n(10);e.decorate=y.decorate;var v=n(40);e.traverseAncerstors=v.traverseAncerstors,e.taggedConstraint=v.taggedConstraint,e.namedConstraint=v.namedConstraint,e.typeConstraint=v.typeConstraint;var b=n(14);e.getServiceIdentifierAsString=b.getServiceIdentifierAsString;var C=n(69);e.multiBindToService=C.multiBindToService},function(t,e){t.exports=ol},function(t,e){t.exports=d3},function(t,e,n){
/**
 * chroma.js - JavaScript library for color conversions
 *
 * Copyright (c) 2011-2018, Gregor Aisch
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * 1. Redistributions of source code must retain the above copyright notice, this
 * list of conditions and the following disclaimer.
 *
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 * this list of conditions and the following disclaimer in the documentation
 * and/or other materials provided with the distribution.
 *
 * 3. The name Gregor Aisch may not be used to endorse or promote products
 * derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL GREGOR AISCH OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * -------------------------------------------------------
 *
 * chroma.js includes colors from colorbrewer2.org, which are released under
 * the following license:
 *
 * Copyright (c) 2002 Cynthia Brewer, Mark Harrower,
 * and The Pennsylvania State University.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
 * either express or implied. See the License for the specific
 * language governing permissions and limitations under the License.
 *
 * ------------------------------------------------------
 *
 * Named colors are taken from X11 Color Names.
 * http://www.w3.org/TR/css3-color/#svg-color
 *
 * @preserve
 */
t.exports=function(){"use strict";for(var t=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=1),t<e?e:t>n?n:t},e={},n=0,i=["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"];n<i.length;n+=1){var r=i[n];e["[object "+r+"]"]=r.toLowerCase()}var o=function(t){return e[Object.prototype.toString.call(t)]||"object"},s=Math.PI,a={clip_rgb:function(e){e._clipped=!1,e._unclipped=e.slice(0);for(var n=0;n<=3;n++)n<3?((e[n]<0||e[n]>255)&&(e._clipped=!0),e[n]=t(e[n],0,255)):3===n&&(e[n]=t(e[n],0,1));return e},limit:t,type:o,unpack:function(t,e){return void 0===e&&(e=null),t.length>=3?Array.prototype.slice.call(t):"object"==o(t[0])&&e?e.split("").filter(function(e){return void 0!==t[0][e]}).map(function(e){return t[0][e]}):t[0]},last:function(t){if(t.length<2)return null;var e=t.length-1;return"string"==o(t[e])?t[e].toLowerCase():null},PI:s,TWOPI:2*s,PITHIRD:s/3,DEG2RAD:s/180,RAD2DEG:180/s},c={format:{},autodetect:[]},l=a.last,u=a.clip_rgb,h=a.type,d=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=this;if("object"===h(t[0])&&t[0].constructor&&t[0].constructor===this.constructor)return t[0];var i=l(t),r=!1;if(!i){r=!0,c.sorted||(c.autodetect=c.autodetect.sort(function(t,e){return e.p-t.p}),c.sorted=!0);for(var o=0,s=c.autodetect;o<s.length;o+=1){var a=s[o];if(i=a.test.apply(a,t))break}}if(!c.format[i])throw new Error("unknown format: "+t);var d=c.format[i].apply(null,r?t:t.slice(0,-1));n._rgb=u(d),3===n._rgb.length&&n._rgb.push(1)};d.prototype.toString=function(){return"function"==h(this.hex)?this.hex():"["+this._rgb.join(",")+"]"};var f=d,p=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(p.Color,[null].concat(t)))};p.Color=f,p.version="2.0.2";var g=p,_=a.unpack,m=Math.max,y=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=_(t,"rgb"),i=n[0],r=n[1],o=n[2],s=1-m(i/=255,m(r/=255,o/=255)),a=s<1?1/(1-s):0,c=(1-i-s)*a,l=(1-r-s)*a,u=(1-o-s)*a;return[c,l,u,s]},v=a.unpack,b=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=(t=v(t,"cmyk"))[0],i=t[1],r=t[2],o=t[3],s=t.length>4?t[4]:1;return 1===o?[0,0,0,s]:[n>=1?0:255*(1-n)*(1-o),i>=1?0:255*(1-i)*(1-o),r>=1?0:255*(1-r)*(1-o),s]},C=a.unpack,w=a.type;f.prototype.cmyk=function(){return y(this._rgb)},g.cmyk=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(f,[null].concat(t,["cmyk"])))},c.format.cmyk=b,c.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=C(t,"cmyk"),"array"===w(t)&&4===t.length)return"cmyk"}});var E=a.unpack,T=a.last,S=function(t){return Math.round(100*t)/100},x=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=E(t,"hsla"),i=T(t)||"lsa";return n[0]=S(n[0]||0),n[1]=S(100*n[1])+"%",n[2]=S(100*n[2])+"%","hsla"===i||n.length>3&&n[3]<1?(n[3]=n.length>3?n[3]:1,i="hsla"):n.length=3,i+"("+n.join(",")+")"},R=a.unpack,A=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=(t=R(t,"rgba"))[0],i=t[1],r=t[2];n/=255,i/=255,r/=255;var o,s,a=Math.min(n,i,r),c=Math.max(n,i,r),l=(c+a)/2;return c===a?(o=0,s=Number.NaN):o=l<.5?(c-a)/(c+a):(c-a)/(2-c-a),n==c?s=(i-r)/(c-a):i==c?s=2+(r-n)/(c-a):r==c&&(s=4+(n-i)/(c-a)),(s*=60)<0&&(s+=360),t.length>3&&void 0!==t[3]?[s,o,l,t[3]]:[s,o,l]},O=a.unpack,I=a.last,M=Math.round,P=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=O(t,"rgba"),i=I(t)||"rgb";return"hsl"==i.substr(0,3)?x(A(n),i):(n[0]=M(n[0]),n[1]=M(n[1]),n[2]=M(n[2]),("rgba"===i||n.length>3&&n[3]<1)&&(n[3]=n.length>3?n[3]:1,i="rgba"),i+"("+n.slice(0,"rgb"===i?3:4).join(",")+")")},L=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,D=/^#?([A-Fa-f0-9]{8})$/,k=function(t){if(t.match(L)){4!==t.length&&7!==t.length||(t=t.substr(1)),3===t.length&&(t=(t=t.split(""))[0]+t[0]+t[1]+t[1]+t[2]+t[2]);var e=parseInt(t,16);return[e>>16,e>>8&255,255&e,1]}if(t.match(D)){9===t.length&&(t=t.substr(1));var n=parseInt(t,16);return[n>>24&255,n>>16&255,n>>8&255,Math.round((255&n)/255*100)/100]}throw new Error("unknown hex color: "+t)},F=a.unpack,N=Math.round,j=function(){for(var t,e=[],n=arguments.length;n--;)e[n]=arguments[n];var i,r,o,s=(e=F(e,"hsl"))[0],a=e[1],c=e[2];if(0===a)i=r=o=255*c;else{var l=[0,0,0],u=[0,0,0],h=c<.5?c*(1+a):c+a-c*a,d=2*c-h,f=s/360;l[0]=f+1/3,l[1]=f,l[2]=f-1/3;for(var p=0;p<3;p++)l[p]<0&&(l[p]+=1),l[p]>1&&(l[p]-=1),6*l[p]<1?u[p]=d+6*(h-d)*l[p]:2*l[p]<1?u[p]=h:3*l[p]<2?u[p]=d+(h-d)*(2/3-l[p])*6:u[p]=d;i=(t=[N(255*u[0]),N(255*u[1]),N(255*u[2])])[0],r=t[1],o=t[2]}return e.length>3?[i,r,o,e[3]]:[i,r,o]},B={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflower:"#6495ed",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},z=/^rgb\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*\)$/,U=/^rgba\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*,\s*([01]|[01]?\.\d+)\)$/,H=/^rgb\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,W=/^rgba\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,G=/^hsl\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,V=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,Y=Math.round,q=function(t){if(t=t.toLowerCase().trim(),B[t])return k(B[t]);var e;if(e=t.match(z)){for(var n=e.slice(1,4),i=0;i<3;i++)n[i]=+n[i];return n[3]=1,n}if(e=t.match(U)){for(var r=e.slice(1,5),o=0;o<4;o++)r[o]=+r[o];return r}if(e=t.match(H)){for(var s=e.slice(1,4),a=0;a<3;a++)s[a]=Y(2.55*s[a]);return s[3]=1,s}if(e=t.match(W)){for(var c=e.slice(1,5),l=0;l<3;l++)c[l]=Y(2.55*c[l]);return c[3]=+c[3],c}if(e=t.match(G)){var u=e.slice(1,4);u[1]*=.01,u[2]*=.01;var h=j(u);return h[3]=1,h}if(e=t.match(V)){var d=e.slice(1,4);d[1]*=.01,d[2]*=.01;var f=j(d);return f[3]=+e[4],f}};q.test=function(t){return z.test(t)||U.test(t)||H.test(t)||W.test(t)||G.test(t)||V.test(t)};var X=q,K=a.type;f.prototype.css=function(t){return P(this._rgb,t)},g.css=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(f,[null].concat(t,["css"])))},c.format.css=X,c.autodetect.push({p:5,test:function(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];if(!e.length&&"string"===K(t)&&X.test(t))return"css"}});var $=a.unpack;c.format.gl=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=$(t,"rgba");return n[0]*=255,n[1]*=255,n[2]*=255,n},g.gl=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(f,[null].concat(t,["gl"])))},f.prototype.gl=function(){var t=this._rgb;return[t[0]/255,t[1]/255,t[2]/255,t[3]]};var Z=a.unpack,J=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n,i=Z(t,"rgb"),r=i[0],o=i[1],s=i[2],a=Math.min(r,o,s),c=Math.max(r,o,s),l=c-a,u=100*l/255,h=a/(255-l)*100;return 0===l?n=Number.NaN:(r===c&&(n=(o-s)/l),o===c&&(n=2+(s-r)/l),s===c&&(n=4+(r-o)/l),(n*=60)<0&&(n+=360)),[n,u,h]},Q=a.unpack,tt=Math.floor,et=function(){for(var t,e,n,i,r,o,s=[],a=arguments.length;a--;)s[a]=arguments[a];var c,l,u,h=(s=Q(s,"hcg"))[0],d=s[1],f=s[2];f*=255;var p=255*d;if(0===d)c=l=u=f;else{360===h&&(h=0),h>360&&(h-=360),h<0&&(h+=360);var g=tt(h/=60),_=h-g,m=f*(1-d),y=m+p*(1-_),v=m+p*_,b=m+p;switch(g){case 0:c=(t=[b,v,m])[0],l=t[1],u=t[2];break;case 1:c=(e=[y,b,m])[0],l=e[1],u=e[2];break;case 2:c=(n=[m,b,v])[0],l=n[1],u=n[2];break;case 3:c=(i=[m,y,b])[0],l=i[1],u=i[2];break;case 4:c=(r=[v,m,b])[0],l=r[1],u=r[2];break;case 5:c=(o=[b,m,y])[0],l=o[1],u=o[2]}}return[c,l,u,s.length>3?s[3]:1]},nt=a.unpack,it=a.type;f.prototype.hcg=function(){return J(this._rgb)},g.hcg=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(f,[null].concat(t,["hcg"])))},c.format.hcg=et,c.autodetect.push({p:1,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=nt(t,"hcg"),"array"===it(t)&&3===t.length)return"hcg"}});var rt=a.unpack,ot=a.last,st=Math.round,at=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=rt(t,"rgba"),i=n[0],r=n[1],o=n[2],s=n[3],a=ot(t)||"auto";void 0===s&&(s=1),"auto"===a&&(a=s<1?"rgba":"rgb");var c=(i=st(i))<<16|(r=st(r))<<8|(o=st(o)),l="000000"+c.toString(16);l=l.substr(l.length-6);var u="0"+st(255*s).toString(16);switch(u=u.substr(u.length-2),a.toLowerCase()){case"rgba":return"#"+l+u;case"argb":return"#"+u+l;default:return"#"+l}},ct=a.type;f.prototype.hex=function(t){return at(this._rgb,t)},g.hex=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(f,[null].concat(t,["hex"])))},c.format.hex=k,c.autodetect.push({p:4,test:function(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];if(!e.length&&"string"===ct(t)&&[3,4,6,7,8,9].includes(t.length))return"hex"}});var lt=a.unpack,ut=a.TWOPI,ht=Math.min,dt=Math.sqrt,ft=Math.acos,pt=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n,i=lt(t,"rgb"),r=i[0],o=i[1],s=i[2],a=ht(r/=255,o/=255,s/=255),c=(r+o+s)/3,l=c>0?1-a/c:0;return 0===l?n=NaN:(n=(r-o+(r-s))/2,n/=dt((r-o)*(r-o)+(r-s)*(o-s)),n=ft(n),s>o&&(n=ut-n),n/=ut),[360*n,l,c]},gt=a.unpack,_t=a.limit,mt=a.TWOPI,yt=a.PITHIRD,vt=Math.cos,bt=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n,i,r,o=(t=gt(t,"hsi"))[0],s=t[1],a=t[2];return isNaN(o)&&(o=0),isNaN(s)&&(s=0),o>360&&(o-=360),o<0&&(o+=360),(o/=360)<1/3?i=1-((r=(1-s)/3)+(n=(1+s*vt(mt*o)/vt(yt-mt*o))/3)):o<2/3?r=1-((n=(1-s)/3)+(i=(1+s*vt(mt*(o-=1/3))/vt(yt-mt*o))/3)):n=1-((i=(1-s)/3)+(r=(1+s*vt(mt*(o-=2/3))/vt(yt-mt*o))/3)),[255*(n=_t(a*n*3)),255*(i=_t(a*i*3)),255*(r=_t(a*r*3)),t.length>3?t[3]:1]},Ct=a.unpack,wt=a.type;f.prototype.hsi=function(){return pt(this._rgb)},g.hsi=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(f,[null].concat(t,["hsi"])))},c.format.hsi=bt,c.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=Ct(t,"hsi"),"array"===wt(t)&&3===t.length)return"hsi"}});var Et=a.unpack,Tt=a.type;f.prototype.hsl=function(){return A(this._rgb)},g.hsl=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(f,[null].concat(t,["hsl"])))},c.format.hsl=j,c.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=Et(t,"hsl"),"array"===Tt(t)&&3===t.length)return"hsl"}});var St=a.unpack,xt=Math.min,Rt=Math.max,At=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n,i,r,o=(t=St(t,"rgb"))[0],s=t[1],a=t[2],c=xt(o,s,a),l=Rt(o,s,a),u=l-c;return r=l/255,0===l?(n=Number.NaN,i=0):(i=u/l,o===l&&(n=(s-a)/u),s===l&&(n=2+(a-o)/u),a===l&&(n=4+(o-s)/u),(n*=60)<0&&(n+=360)),[n,i,r]},Ot=a.unpack,It=Math.floor,Mt=function(){for(var t,e,n,i,r,o,s=[],a=arguments.length;a--;)s[a]=arguments[a];var c,l,u,h=(s=Ot(s,"hsv"))[0],d=s[1],f=s[2];if(f*=255,0===d)c=l=u=f;else{360===h&&(h=0),h>360&&(h-=360),h<0&&(h+=360);var p=It(h/=60),g=h-p,_=f*(1-d),m=f*(1-d*g),y=f*(1-d*(1-g));switch(p){case 0:c=(t=[f,y,_])[0],l=t[1],u=t[2];break;case 1:c=(e=[m,f,_])[0],l=e[1],u=e[2];break;case 2:c=(n=[_,f,y])[0],l=n[1],u=n[2];break;case 3:c=(i=[_,m,f])[0],l=i[1],u=i[2];break;case 4:c=(r=[y,_,f])[0],l=r[1],u=r[2];break;case 5:c=(o=[f,_,m])[0],l=o[1],u=o[2]}}return[c,l,u,s.length>3?s[3]:1]},Pt=a.unpack,Lt=a.type;f.prototype.hsv=function(){return At(this._rgb)},g.hsv=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(f,[null].concat(t,["hsv"])))},c.format.hsv=Mt,c.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=Pt(t,"hsv"),"array"===Lt(t)&&3===t.length)return"hsv"}});var Dt=18,kt=.95047,Ft=1,Nt=1.08883,jt=.137931034,Bt=.206896552,zt=.12841855,Ut=.008856452,Ht=a.unpack,Wt=Math.pow,Gt=function(t){return(t/=255)<=.04045?t/12.92:Wt((t+.055)/1.055,2.4)},Vt=function(t){return t>Ut?Wt(t,1/3):t/zt+jt},Yt=function(t,e,n){return t=Gt(t),e=Gt(e),n=Gt(n),[Vt((.4124564*t+.3575761*e+.1804375*n)/kt),Vt((.2126729*t+.7151522*e+.072175*n)/Ft),Vt((.0193339*t+.119192*e+.9503041*n)/Nt)]},qt=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=Ht(t,"rgb"),i=n[0],r=n[1],o=n[2],s=Yt(i,r,o),a=s[0],c=s[1],l=s[2],u=116*c-16;return[u<0?0:u,500*(a-c),200*(c-l)]},Xt=a.unpack,Kt=Math.pow,$t=function(t){return 255*(t<=.00304?12.92*t:1.055*Kt(t,1/2.4)-.055)},Zt=function(t){return t>Bt?t*t*t:zt*(t-jt)},Jt=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n,i,r,o=(t=Xt(t,"lab"))[0],s=t[1],a=t[2];return i=(o+16)/116,n=isNaN(s)?i:i+s/500,r=isNaN(a)?i:i-a/200,i=Ft*Zt(i),n=kt*Zt(n),r=Nt*Zt(r),[$t(3.2404542*n-1.5371385*i-.4985314*r),$t(-.969266*n+1.8760108*i+.041556*r),$t(.0556434*n-.2040259*i+1.0572252*r),t.length>3?t[3]:1]},Qt=a.unpack,te=a.type;f.prototype.lab=function(){return qt(this._rgb)},g.lab=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(f,[null].concat(t,["lab"])))},c.format.lab=Jt,c.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=Qt(t,"lab"),"array"===te(t)&&3===t.length)return"lab"}});var ee=a.unpack,ne=a.RAD2DEG,ie=Math.sqrt,re=Math.atan2,oe=Math.round,se=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=ee(t,"lab"),i=n[0],r=n[1],o=n[2],s=ie(r*r+o*o),a=(re(o,r)*ne+360)%360;return 0===oe(1e4*s)&&(a=Number.NaN),[i,s,a]},ae=a.unpack,ce=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=ae(t,"rgb"),i=n[0],r=n[1],o=n[2],s=qt(i,r,o),a=s[0],c=s[1],l=s[2];return se(a,c,l)},le=a.unpack,ue=a.DEG2RAD,he=Math.sin,de=Math.cos,fe=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=le(t,"lch"),i=n[0],r=n[1],o=n[2];return isNaN(o)&&(o=0),[i,de(o*=ue)*r,he(o)*r]},pe=a.unpack,ge=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=(t=pe(t,"lch"))[0],i=t[1],r=t[2],o=fe(n,i,r),s=o[0],a=o[1],c=o[2],l=Jt(s,a,c),u=l[0],h=l[1],d=l[2];return[u,h,d,t.length>3?t[3]:1]},_e=a.unpack,me=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=_e(t,"hcl").reverse();return ge.apply(void 0,n)},ye=a.unpack,ve=a.type;f.prototype.lch=function(){return ce(this._rgb)},f.prototype.hcl=function(){return ce(this._rgb).reverse()},g.lch=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(f,[null].concat(t,["lch"])))},g.hcl=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(f,[null].concat(t,["hcl"])))},c.format.lch=ge,c.format.hcl=me,["lch","hcl"].forEach(function(t){return c.autodetect.push({p:2,test:function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];if(e=ye(e,t),"array"===ve(e)&&3===e.length)return t}})});var be=a.type;f.prototype.name=function(){for(var t=at(this._rgb,"rgb"),e=0,n=Object.keys(B);e<n.length;e+=1){var i=n[e];if(B[i]===t)return i.toLowerCase()}return t},c.format.named=function(t){if(t=t.toLowerCase(),B[t])return k(B[t]);throw new Error("unknown color name: "+t)},c.autodetect.push({p:5,test:function(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];if(!e.length&&"string"===be(t)&&B[t.toLowerCase()])return"named"}});var Ce=a.unpack,we=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=Ce(t,"rgb"),i=n[0],r=n[1],o=n[2];return(i<<16)+(r<<8)+o},Ee=a.type,Te=function(t){if("number"==Ee(t)&&t>=0&&t<=16777215)return[t>>16,t>>8&255,255&t,1];throw new Error("unknown num color: "+t)},Se=a.type;f.prototype.num=function(){return we(this._rgb)},g.num=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(f,[null].concat(t,["num"])))},c.format.num=Te,c.autodetect.push({p:5,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(1===t.length&&"number"===Se(t[0])&&t[0]>=0&&t[0]<=16777215)return"num"}});var xe=a.unpack,Re=a.type,Ae=Math.round;f.prototype.rgb=function(t){return void 0===t&&(t=!0),!1===t?this._rgb.slice(0,3):this._rgb.slice(0,3).map(Ae)},f.prototype.rgba=function(t){return void 0===t&&(t=!0),this._rgb.slice(0,4).map(function(e,n){return n<3?!1===t?e:Ae(e):e})},g.rgb=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(f,[null].concat(t,["rgb"])))},c.format.rgb=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=xe(t,"rgba");return void 0===n[3]&&(n[3]=1),n},c.autodetect.push({p:3,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=xe(t,"rgba"),"array"===Re(t)&&(3===t.length||4===t.length&&"number"==Re(t[3])&&t[3]>=0&&t[3]<=1))return"rgb"}});var Oe=Math.log,Ie=function(t){var e,n,i,r=t/100;return r<66?(e=255,n=-155.25485562709179-.44596950469579133*(n=r-2)+104.49216199393888*Oe(n),i=r<20?0:.8274096064007395*(i=r-10)-254.76935184120902+115.67994401066147*Oe(i)):(e=351.97690566805693+.114206453784165*(e=r-55)-40.25366309332127*Oe(e),n=325.4494125711974+.07943456536662342*(n=r-50)-28.0852963507957*Oe(n),i=255),[e,n,i,1]},Me=a.unpack,Pe=Math.round,Le=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];for(var n,i=Me(t,"rgb"),r=i[0],o=i[2],s=1e3,a=4e4,c=.4;a-s>c;){var l=Ie(n=.5*(a+s));l[2]/l[0]>=o/r?a=n:s=n}return Pe(n)};f.prototype.temp=f.prototype.kelvin=f.prototype.temperature=function(){return Le(this._rgb)},g.temp=g.kelvin=g.temperature=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(f,[null].concat(t,["temp"])))},c.format.temp=c.format.kelvin=c.format.temperature=Ie;var De=a.type;f.prototype.alpha=function(t,e){return void 0===e&&(e=!1),void 0!==t&&"number"===De(t)?e?(this._rgb[3]=t,this):new f([this._rgb[0],this._rgb[1],this._rgb[2],t],"rgb"):this._rgb[3]},f.prototype.clipped=function(){return this._rgb._clipped||!1},f.prototype.darken=function(t){void 0===t&&(t=1);var e=this.lab();return e[0]-=Dt*t,new f(e,"lab").alpha(this.alpha(),!0)},f.prototype.brighten=function(t){return void 0===t&&(t=1),this.darken(-t)},f.prototype.darker=f.prototype.darken,f.prototype.brighter=f.prototype.brighten,f.prototype.get=function(t){var e=t.split("."),n=e[0],i=e[1],r=this[n]();if(i){var o=n.indexOf(i);if(o>-1)return r[o];throw new Error("unknown channel "+i+" in mode "+n)}return r};var ke=a.type,Fe=Math.pow;f.prototype.luminance=function(t){if(void 0!==t&&"number"===ke(t)){if(0===t)return new f([0,0,0,this._rgb[3]],"rgb");if(1===t)return new f([255,255,255,this._rgb[3]],"rgb");var e=this.luminance(),n=20,i=function(e,r){var o=e.interpolate(r,.5,"rgb"),s=o.luminance();return Math.abs(t-s)<1e-7||!n--?o:s>t?i(e,o):i(o,r)},r=(e>t?i(new f([0,0,0]),this):i(this,new f([255,255,255]))).rgb();return new f(r.concat([this._rgb[3]]))}return Ne.apply(void 0,this._rgb.slice(0,3))};var Ne=function(t,e,n){return.2126*(t=je(t))+.7152*(e=je(e))+.0722*(n=je(n))},je=function(t){return(t/=255)<=.03928?t/12.92:Fe((t+.055)/1.055,2.4)},Be={},ze=a.type,Ue=function(t,e,n){void 0===n&&(n=.5);for(var i=[],r=arguments.length-3;r-- >0;)i[r]=arguments[r+3];var o=i[0]||"lrgb";if(Be[o]||i.length||(o=Object.keys(Be)[0]),!Be[o])throw new Error("interpolation mode "+o+" is not defined");return"object"!==ze(t)&&(t=new f(t)),"object"!==ze(e)&&(e=new f(e)),Be[o](t,e,n).alpha(t.alpha()+n*(e.alpha()-t.alpha()))};f.prototype.mix=f.prototype.interpolate=function(t,e){void 0===e&&(e=.5);for(var n=[],i=arguments.length-2;i-- >0;)n[i]=arguments[i+2];return Ue.apply(void 0,[this,t,e].concat(n))},f.prototype.premultiply=function(t){void 0===t&&(t=!1);var e=this._rgb,n=e[3];return t?(this._rgb=[e[0]*n,e[1]*n,e[2]*n,n],this):new f([e[0]*n,e[1]*n,e[2]*n,n],"rgb")},f.prototype.saturate=function(t){void 0===t&&(t=1);var e=this.lch();return e[1]+=Dt*t,e[1]<0&&(e[1]=0),new f(e,"lch").alpha(this.alpha(),!0)},f.prototype.desaturate=function(t){return void 0===t&&(t=1),this.saturate(-t)};var He=a.type;f.prototype.set=function(t,e,n){void 0===n&&(n=!1);var i=t.split("."),r=i[0],o=i[1],s=this[r]();if(o){var a=r.indexOf(o);if(a>-1){if("string"==He(e))switch(e.charAt(0)){case"+":case"-":s[a]+=+e;break;case"*":s[a]*=+e.substr(1);break;case"/":s[a]/=+e.substr(1);break;default:s[a]=+e}else{if("number"!==He(e))throw new Error("unsupported value for Color.set");s[a]=e}var c=new f(s,r);return n?(this._rgb=c._rgb,this):c}throw new Error("unknown channel "+o+" in mode "+r)}return s},Be.rgb=function(t,e,n){var i=t._rgb,r=e._rgb;return new f(i[0]+n*(r[0]-i[0]),i[1]+n*(r[1]-i[1]),i[2]+n*(r[2]-i[2]),"rgb")};var We=Math.sqrt,Ge=Math.pow;Be.lrgb=function(t,e,n){var i=t._rgb,r=i[0],o=i[1],s=i[2],a=e._rgb,c=a[0],l=a[1],u=a[2];return new f(We(Ge(r,2)*(1-n)+Ge(c,2)*n),We(Ge(o,2)*(1-n)+Ge(l,2)*n),We(Ge(s,2)*(1-n)+Ge(u,2)*n),"rgb")},Be.lab=function(t,e,n){var i=t.lab(),r=e.lab();return new f(i[0]+n*(r[0]-i[0]),i[1]+n*(r[1]-i[1]),i[2]+n*(r[2]-i[2]),"lab")};var Ve=function(t,e,n,i){var r,o,s,a,c,l,u,h,d,p,g,_;return"hsl"===i?(s=t.hsl(),a=e.hsl()):"hsv"===i?(s=t.hsv(),a=e.hsv()):"hcg"===i?(s=t.hcg(),a=e.hcg()):"hsi"===i?(s=t.hsi(),a=e.hsi()):"lch"!==i&&"hcl"!==i||(i="hcl",s=t.hcl(),a=e.hcl()),"h"===i.substr(0,1)&&(c=(r=s)[0],u=r[1],d=r[2],l=(o=a)[0],h=o[1],p=o[2]),isNaN(c)||isNaN(l)?isNaN(c)?isNaN(l)?_=Number.NaN:(_=l,1!=d&&0!=d||"hsv"==i||(g=h)):(_=c,1!=p&&0!=p||"hsv"==i||(g=u)):_=c+n*(l>c&&l-c>180?l-(c+360):l<c&&c-l>180?l+360-c:l-c),void 0===g&&(g=u+n*(h-u)),new f([_,g,d+n*(p-d)],i)},Ye=function(t,e,n){return Ve(t,e,n,"lch")};Be.lch=Ye,Be.hcl=Ye,Be.num=function(t,e,n){var i=t.num(),r=e.num();return new f(i+n*(r-i),"num")},Be.hcg=function(t,e,n){return Ve(t,e,n,"hcg")},Be.hsi=function(t,e,n){return Ve(t,e,n,"hsi")},Be.hsl=function(t,e,n){return Ve(t,e,n,"hsl")},Be.hsv=function(t,e,n){return Ve(t,e,n,"hsv")};var qe=a.clip_rgb,Xe=Math.pow,Ke=Math.sqrt,$e=Math.PI,Ze=Math.cos,Je=Math.sin,Qe=Math.atan2,tn=function(t){for(var e=1/t.length,n=[0,0,0,0],i=0,r=t;i<r.length;i+=1){var o=r[i]._rgb;n[0]+=Xe(o[0],2)*e,n[1]+=Xe(o[1],2)*e,n[2]+=Xe(o[2],2)*e,n[3]+=o[3]*e}return n[0]=Ke(n[0]),n[1]=Ke(n[1]),n[2]=Ke(n[2]),n[3]>.9999999&&(n[3]=1),new f(qe(n))},en=a.type,nn=Math.pow,rn=function(t){var e="rgb",n=g("#ccc"),i=0,r=[0,1],o=[],s=[0,0],a=!1,c=[],l=!1,u=0,h=1,d=!1,f={},p=!0,_=1,m=function(t){if((t=t||["#fff","#000"])&&"string"===en(t)&&g.brewer&&g.brewer[t.toLowerCase()]&&(t=g.brewer[t.toLowerCase()]),"array"===en(t)){1===t.length&&(t=[t[0],t[0]]),t=t.slice(0);for(var e=0;e<t.length;e++)t[e]=g(t[e]);o.length=0;for(var n=0;n<t.length;n++)o.push(n/(t.length-1))}return b(),c=t},y=function(t){return t},v=function(t,i){var r,l;if(null==i&&(i=!1),isNaN(t)||null===t)return n;l=i?t:a&&a.length>2?function(t){if(null!=a){for(var e=a.length-1,n=0;n<e&&t>=a[n];)n++;return n-1}return 0}(t)/(a.length-2):h!==u?(t-u)/(h-u):1,i||(l=y(l)),1!==_&&(l=nn(l,_)),l=s[0]+l*(1-s[0]-s[1]),l=Math.min(1,Math.max(0,l));var d=Math.floor(1e4*l);if(p&&f[d])r=f[d];else{if("array"===en(c))for(var m=0;m<o.length;m++){var v=o[m];if(l<=v){r=c[m];break}if(l>=v&&m===o.length-1){r=c[m];break}if(l>v&&l<o[m+1]){l=(l-v)/(o[m+1]-v),r=g.interpolate(c[m],c[m+1],l,e);break}}else"function"===en(c)&&(r=c(l));p&&(f[d]=r)}return r},b=function(){return f={}};m(t);var C=function(t){var e=g(v(t));return l&&e[l]?e[l]():e};return C.classes=function(t){if(null!=t){if("array"===en(t))a=t,r=[t[0],t[t.length-1]];else{var e=g.analyze(r);a=0===t?[e.min,e.max]:g.limits(e,"e",t)}return C}return a},C.domain=function(t){if(!arguments.length)return r;u=t[0],h=t[t.length-1],o=[];var e=c.length;if(t.length===e&&u!==h)for(var n=0,i=Array.from(t);n<i.length;n+=1){var s=i[n];o.push((s-u)/(h-u))}else for(var a=0;a<e;a++)o.push(a/(e-1));return r=[u,h],C},C.mode=function(t){return arguments.length?(e=t,b(),C):e},C.range=function(t,e){return m(t),C},C.out=function(t){return l=t,C},C.spread=function(t){return arguments.length?(i=t,C):i},C.correctLightness=function(t){return null==t&&(t=!0),d=t,b(),y=d?function(t){for(var e=v(0,!0).lab()[0],n=v(1,!0).lab()[0],i=e>n,r=v(t,!0).lab()[0],o=e+(n-e)*t,s=r-o,a=0,c=1,l=20;Math.abs(s)>.01&&l-- >0;)i&&(s*=-1),s<0?(a=t,t+=.5*(c-t)):(c=t,t+=.5*(a-t)),r=v(t,!0).lab()[0],s=r-o;return t}:function(t){return t},C},C.padding=function(t){return null!=t?("number"===en(t)&&(t=[t,t]),s=t,C):s},C.colors=function(e,n){arguments.length<2&&(n="hex");var i=[];if(0===arguments.length)i=c.slice(0);else if(1===e)i=[C(.5)];else if(e>1){var o=r[0],s=r[1]-o;i=on(0,e,!1).map(function(t){return C(o+t/(e-1)*s)})}else{t=[];var l=[];if(a&&a.length>2)for(var u=1,h=a.length,d=1<=h;d?u<h:u>h;d?u++:u--)l.push(.5*(a[u-1]+a[u]));else l=r;i=l.map(function(t){return C(t)})}return g[n]&&(i=i.map(function(t){return t[n]()})),i},C.cache=function(t){return null!=t?(p=t,C):p},C.gamma=function(t){return null!=t?(_=t,C):_},C.nodata=function(t){return null!=t?(n=g(t),C):n},C};function on(t,e,n){for(var i=[],r=t<e,o=n?r?e+1:e-1:e,s=t;r?s<o:s>o;r?s++:s--)i.push(s);return i}var sn=function(t){var e,n,i,r,o,s,a;if(2===(t=t.map(function(t){return new f(t)})).length)e=t.map(function(t){return t.lab()}),o=e[0],s=e[1],r=function(t){var e=[0,1,2].map(function(e){return o[e]+t*(s[e]-o[e])});return new f(e,"lab")};else if(3===t.length)n=t.map(function(t){return t.lab()}),o=n[0],s=n[1],a=n[2],r=function(t){var e=[0,1,2].map(function(e){return(1-t)*(1-t)*o[e]+2*(1-t)*t*s[e]+t*t*a[e]});return new f(e,"lab")};else if(4===t.length){var c;i=t.map(function(t){return t.lab()}),o=i[0],s=i[1],a=i[2],c=i[3],r=function(t){var e=[0,1,2].map(function(e){return(1-t)*(1-t)*(1-t)*o[e]+3*(1-t)*(1-t)*t*s[e]+3*(1-t)*t*t*a[e]+t*t*t*c[e]});return new f(e,"lab")}}else if(5===t.length){var l=sn(t.slice(0,3)),u=sn(t.slice(2,5));r=function(t){return t<.5?l(2*t):u(2*(t-.5))}}return r},an=function(t,e,n){if(!an[n])throw new Error("unknown blend mode "+n);return an[n](t,e)},cn=function(t){return function(e,n){var i=g(n).rgb(),r=g(e).rgb();return g.rgb(t(i,r))}},ln=function(t){return function(e,n){var i=[];return i[0]=t(e[0],n[0]),i[1]=t(e[1],n[1]),i[2]=t(e[2],n[2]),i}};an.normal=cn(ln(function(t){return t})),an.multiply=cn(ln(function(t,e){return t*e/255})),an.screen=cn(ln(function(t,e){return 255*(1-(1-t/255)*(1-e/255))})),an.overlay=cn(ln(function(t,e){return e<128?2*t*e/255:255*(1-2*(1-t/255)*(1-e/255))})),an.darken=cn(ln(function(t,e){return t>e?e:t})),an.lighten=cn(ln(function(t,e){return t>e?t:e})),an.dodge=cn(ln(function(t,e){return 255===t?255:(t=e/255*255/(1-t/255))>255?255:t})),an.burn=cn(ln(function(t,e){return 255*(1-(1-e/255)/(t/255))}));for(var un=an,hn=a.type,dn=a.clip_rgb,fn=a.TWOPI,pn=Math.pow,gn=Math.sin,_n=Math.cos,mn=Math.floor,yn=Math.random,vn=Math.log,bn=Math.pow,Cn=Math.floor,wn=Math.abs,En=function(t,e){void 0===e&&(e=null);var n={min:Number.MAX_VALUE,max:-1*Number.MAX_VALUE,sum:0,values:[],count:0};return"object"===o(t)&&(t=Object.values(t)),t.forEach(function(t){e&&"object"===o(t)&&(t=t[e]),null==t||isNaN(t)||(n.values.push(t),n.sum+=t,t<n.min&&(n.min=t),t>n.max&&(n.max=t),n.count+=1)}),n.domain=[n.min,n.max],n.limits=function(t,e){return Tn(n,t,e)},n},Tn=function(t,e,n){void 0===e&&(e="equal"),void 0===n&&(n=7),"array"==o(t)&&(t=En(t));var i=t.min,r=t.max,s=t.values.sort(function(t,e){return t-e});if(1===n)return[i,r];var a=[];if("c"===e.substr(0,1)&&(a.push(i),a.push(r)),"e"===e.substr(0,1)){a.push(i);for(var c=1;c<n;c++)a.push(i+c/n*(r-i));a.push(r)}else if("l"===e.substr(0,1)){if(i<=0)throw new Error("Logarithmic scales are only possible for values > 0");var l=Math.LOG10E*vn(i),u=Math.LOG10E*vn(r);a.push(i);for(var h=1;h<n;h++)a.push(bn(10,l+h/n*(u-l)));a.push(r)}else if("q"===e.substr(0,1)){a.push(i);for(var d=1;d<n;d++){var f=(s.length-1)*d/n,p=Cn(f);if(p===f)a.push(s[p]);else{var g=f-p;a.push(s[p]*(1-g)+s[p+1]*g)}}a.push(r)}else if("k"===e.substr(0,1)){var _,m=s.length,y=new Array(m),v=new Array(n),b=!0,C=0,w=null;(w=[]).push(i);for(var E=1;E<n;E++)w.push(i+E/n*(r-i));for(w.push(r);b;){for(var T=0;T<n;T++)v[T]=0;for(var S=0;S<m;S++)for(var x=s[S],R=Number.MAX_VALUE,A=void 0,O=0;O<n;O++){var I=wn(w[O]-x);I<R&&(R=I,A=O),v[A]++,y[S]=A}for(var M=new Array(n),P=0;P<n;P++)M[P]=null;for(var L=0;L<m;L++)null===M[_=y[L]]?M[_]=s[L]:M[_]+=s[L];for(var D=0;D<n;D++)M[D]*=1/v[D];b=!1;for(var k=0;k<n;k++)if(M[k]!==w[k]){b=!0;break}w=M,++C>200&&(b=!1)}for(var F={},N=0;N<n;N++)F[N]=[];for(var j=0;j<m;j++)F[_=y[j]].push(s[j]);for(var B=[],z=0;z<n;z++)B.push(F[z][0]),B.push(F[z][F[z].length-1]);B=B.sort(function(t,e){return t-e}),a.push(B[0]);for(var U=1;U<B.length;U+=2){var H=B[U];isNaN(H)||-1!==a.indexOf(H)||a.push(H)}}return a},Sn={analyze:En,limits:Tn},xn=Math.sqrt,Rn=Math.atan2,An=Math.abs,On=Math.cos,In=Math.PI,Mn={cool:function(){return rn([g.hsl(180,1,.9),g.hsl(250,.7,.4)])},hot:function(){return rn(["#000","#f00","#ff0","#fff"]).mode("rgb")}},Pn={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},Ln=0,Dn=Object.keys(Pn);Ln<Dn.length;Ln+=1){var kn=Dn[Ln];Pn[kn.toLowerCase()]=Pn[kn]}var Fn=Pn;return g.average=function(t,e){void 0===e&&(e="lrgb");var n=t.length;if(t=t.map(function(t){return new f(t)}),"lrgb"===e)return tn(t);for(var i=t.shift(),r=i.get(e),o=[],s=0,a=0,c=0;c<r.length;c++)if(r[c]=r[c]||0,o.push(isNaN(r[c])?0:1),"h"===e.charAt(c)&&!isNaN(r[c])){var l=r[c]/180*$e;s+=Ze(l),a+=Je(l)}var u=i.alpha();t.forEach(function(t){var n=t.get(e);u+=t.alpha();for(var i=0;i<r.length;i++)if(!isNaN(n[i]))if(o[i]++,"h"===e.charAt(i)){var c=n[i]/180*$e;s+=Ze(c),a+=Je(c)}else r[i]+=n[i]});for(var h=0;h<r.length;h++)if("h"===e.charAt(h)){for(var d=Qe(a/o[h],s/o[h])/$e*180;d<0;)d+=360;for(;d>=360;)d-=360;r[h]=d}else r[h]=r[h]/o[h];return u/=n,new f(r,e).alpha(u>.99999?1:u,!0)},g.bezier=function(t){var e=sn(t);return e.scale=function(){return rn(e)},e},g.blend=un,g.cubehelix=function(t,e,n,i,r){void 0===t&&(t=300),void 0===e&&(e=-1.5),void 0===n&&(n=1),void 0===i&&(i=1),void 0===r&&(r=[0,1]);var o,s=0;"array"===hn(r)?o=r[1]-r[0]:(o=0,r=[r,r]);var a=function(a){var c=fn*((t+120)/360+e*a),l=pn(r[0]+o*a,i),u=(0!==s?n[0]+a*s:n)*l*(1-l)/2,h=_n(c),d=gn(c);return g(dn([255*(l+u*(-.14861*h+1.78277*d)),255*(l+u*(-.29227*h-.90649*d)),255*(l+u*(1.97294*h)),1]))};return a.start=function(e){return null==e?t:(t=e,a)},a.rotations=function(t){return null==t?e:(e=t,a)},a.gamma=function(t){return null==t?i:(i=t,a)},a.hue=function(t){return null==t?n:("array"===hn(n=t)?0==(s=n[1]-n[0])&&(n=n[1]):s=0,a)},a.lightness=function(t){return null==t?r:("array"===hn(t)?(r=t,o=t[1]-t[0]):(r=[t,t],o=0),a)},a.scale=function(){return g.scale(a)},a.hue(n),a},g.mix=g.interpolate=Ue,g.random=function(){for(var t="#",e=0;e<6;e++)t+="0123456789abcdef".charAt(mn(16*yn()));return new f(t,"hex")},g.scale=rn,g.analyze=Sn.analyze,g.contrast=function(t,e){t=new f(t),e=new f(e);var n=t.luminance(),i=e.luminance();return n>i?(n+.05)/(i+.05):(i+.05)/(n+.05)},g.deltaE=function(t,e,n,i){void 0===n&&(n=1),void 0===i&&(i=1),t=new f(t),e=new f(e);for(var r=Array.from(t.lab()),o=r[0],s=r[1],a=r[2],c=Array.from(e.lab()),l=c[0],u=c[1],h=c[2],d=xn(s*s+a*a),p=xn(u*u+h*h),g=o<16?.511:.040975*o/(1+.01765*o),_=.0638*d/(1+.0131*d)+.638,m=d<1e-6?0:180*Rn(a,s)/In;m<0;)m+=360;for(;m>=360;)m-=360;var y=m>=164&&m<=345?.56+An(.2*On(In*(m+168)/180)):.36+An(.4*On(In*(m+35)/180)),v=d*d*d*d,b=xn(v/(v+1900)),C=_*(b*y+1-b),w=d-p,E=s-u,T=a-h,S=(o-l)/(n*g),x=w/(i*_);return xn(S*S+x*x+(E*E+T*T-w*w)/(C*C))},g.distance=function(t,e,n){void 0===n&&(n="lab"),t=new f(t),e=new f(e);var i=t.get(n),r=e.get(n),o=0;for(var s in i){var a=(i[s]||0)-(r[s]||0);o+=a*a}return Math.sqrt(o)},g.limits=Sn.limits,g.valid=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];try{return new(Function.prototype.bind.apply(f,[null].concat(t))),!0}catch(t){return!1}},g.scales=Mn,g.colors=B,g.brewer=Fn,g}()},function(t,e){t.exports=jQuery},function(t,e,n){var i,r,o;r=[n(4)],void 0===(o="function"==typeof(i=function(t){return t.ui=t.ui||{},t.ui.version="1.12.1"})?i.apply(e,r):i)||(t.exports=o)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NAMED_TAG="named",e.NAME_TAG="name",e.UNMANAGED_TAG="unmanaged",e.OPTIONAL_TAG="optional",e.INJECT_TAG="inject",e.MULTI_INJECT_TAG="multi_inject",e.TAGGED="inversify:tagged",e.TAGGED_PROP="inversify:tagged_props",e.PARAM_TYPES="inversify:paramtypes",e.DESIGN_PARAM_TYPES="design:paramtypes",e.POST_CONSTRUCT="post_construct"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",e.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",e.NULL_ARGUMENT="NULL argument",e.KEY_NOT_FOUND="Key Not Found",e.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",e.CANNOT_UNBIND="Could not unbind serviceIdentifier:",e.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",e.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",e.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:",e.UNDEFINED_INJECT_ANNOTATION=function(t){return"@inject called with undefined this could mean that the class "+t+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},e.CIRCULAR_DEPENDENCY="Circular dependency found:",e.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",e.INVALID_BINDING_TYPE="Invalid binding type:",e.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",e.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",e.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",e.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",e.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",e.ARGUMENTS_LENGTH_MISMATCH=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return"The number of constructor arguments in the derived class "+t[0]+" must be >= than the number of constructor arguments of its base class."},e.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",e.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",e.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",e.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",e.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class",e.POST_CONSTRUCT_ERROR=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return"@postConstruct error in class "+t[0]+": "+t[1]},e.CIRCULAR_DEPENDENCY_IN_FACTORY=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return"It looks like there is a circular dependency in one of the '"+t[0]+"' bindings. Please investigate bindings withservice identifier '"+t[1]+"'."},e.STACK_OVERFLOW="Maximum call stack size exceeded"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(6),r=function(){function t(t,e){this.key=t,this.value=e}return t.prototype.toString=function(){return this.key===i.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},t}();e.Metadata=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.BindingScopeEnum={Request:"Request",Singleton:"Singleton",Transient:"Transient"};e.BindingTypeEnum={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};e.TargetTypeEnum={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(7),r=n(6);function o(t,e,n,r,o){var s={},a="number"==typeof o,c=void 0!==o&&a?o.toString():n;if(a&&void 0!==n)throw new Error(i.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(t,e)&&(s=Reflect.getMetadata(t,e));var l=s[c];if(Array.isArray(l))for(var u=0,h=l;u<h.length;u++){var d=h[u];if(d.key===r.key)throw new Error(i.DUPLICATED_METADATA+" "+d.key.toString())}else l=[];l.push(r),s[c]=l,Reflect.defineMetadata(t,s,e)}function s(t,e){Reflect.decorate(t,e)}function a(t,e){return function(n,i){e(n,i,t)}}e.tagParameter=function(t,e,n,i){o(r.TAGGED,t,e,i,n)},e.tagProperty=function(t,e,n){o(r.TAGGED_PROP,t.constructor,e,n)},e.decorate=function(t,e,n){"number"==typeof n?s([a(n,t)],e):"string"==typeof n?Reflect.decorate([t],e,n):s([t],e)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=0;e.id=function(){return i++}},function(t,e){t.exports=dc},function(t,e,n){var i,r,o;
/*!
 * jQuery UI Widget 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */r=[n(4),n(5)],void 0===(o="function"==typeof(i=function(t){var e,n=0,i=Array.prototype.slice;return t.cleanData=(e=t.cleanData,function(n){var i,r,o;for(o=0;null!=(r=n[o]);o++)try{(i=t._data(r,"events"))&&i.remove&&t(r).triggerHandler("remove")}catch(t){}e(n)}),t.widget=function(e,n,i){var r,o,s,a={},c=e.split(".")[0],l=c+"-"+(e=e.split(".")[1]);return i||(i=n,n=t.Widget),t.isArray(i)&&(i=t.extend.apply(null,[{}].concat(i))),t.expr[":"][l.toLowerCase()]=function(e){return!!t.data(e,l)},t[c]=t[c]||{},r=t[c][e],o=t[c][e]=function(t,e){if(!this._createWidget)return new o(t,e);arguments.length&&this._createWidget(t,e)},t.extend(o,r,{version:i.version,_proto:t.extend({},i),_childConstructors:[]}),(s=new n).options=t.widget.extend({},s.options),t.each(i,function(e,i){t.isFunction(i)?a[e]=function(){function t(){return n.prototype[e].apply(this,arguments)}function r(t){return n.prototype[e].apply(this,t)}return function(){var e,n=this._super,o=this._superApply;return this._super=t,this._superApply=r,e=i.apply(this,arguments),this._super=n,this._superApply=o,e}}():a[e]=i}),o.prototype=t.widget.extend(s,{widgetEventPrefix:r&&s.widgetEventPrefix||e},a,{constructor:o,namespace:c,widgetName:e,widgetFullName:l}),r?(t.each(r._childConstructors,function(e,n){var i=n.prototype;t.widget(i.namespace+"."+i.widgetName,o,n._proto)}),delete r._childConstructors):n._childConstructors.push(o),t.widget.bridge(e,o),o},t.widget.extend=function(e){for(var n,r,o=i.call(arguments,1),s=0,a=o.length;s<a;s++)for(n in o[s])r=o[s][n],o[s].hasOwnProperty(n)&&void 0!==r&&(t.isPlainObject(r)?e[n]=t.isPlainObject(e[n])?t.widget.extend({},e[n],r):t.widget.extend({},r):e[n]=r);return e},t.widget.bridge=function(e,n){var r=n.prototype.widgetFullName||e;t.fn[e]=function(o){var s="string"==typeof o,a=i.call(arguments,1),c=this;return s?this.length||"instance"!==o?this.each(function(){var n,i=t.data(this,r);return"instance"===o?(c=i,!1):i?t.isFunction(i[o])&&"_"!==o.charAt(0)?(n=i[o].apply(i,a))!==i&&void 0!==n?(c=n&&n.jquery?c.pushStack(n.get()):n,!1):void 0:t.error("no such method '"+o+"' for "+e+" widget instance"):t.error("cannot call methods on "+e+" prior to initialization; attempted to call method '"+o+"'")}):c=void 0:(a.length&&(o=t.widget.extend.apply(null,[o].concat(a))),this.each(function(){var e=t.data(this,r);e?(e.option(o||{}),e._init&&e._init()):t.data(this,r,new n(o,this))})),c}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(e,i){i=t(i||this.defaultElement||this)[0],this.element=t(i),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=t(),this.hoverable=t(),this.focusable=t(),this.classesElementLookup={},i!==this&&(t.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===i&&this.destroy()}}),this.document=t(i.style?i.ownerDocument:i.document||i),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this.options=t.widget.extend({},this.options,this._getCreateOptions(),e),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){var e=this;this._destroy(),t.each(this.classesElementLookup,function(t,n){e._removeClass(n,t)}),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:t.noop,widget:function(){return this.element},option:function(e,n){var i,r,o,s=e;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof e)if(s={},i=e.split("."),e=i.shift(),i.length){for(r=s[e]=t.widget.extend({},this.options[e]),o=0;o<i.length-1;o++)r[i[o]]=r[i[o]]||{},r=r[i[o]];if(e=i.pop(),1===arguments.length)return void 0===r[e]?null:r[e];r[e]=n}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];s[e]=n}return this._setOptions(s),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return"classes"===t&&this._setOptionClasses(e),this.options[t]=e,"disabled"===t&&this._setOptionDisabled(e),this},_setOptionClasses:function(e){var n,i,r;for(n in e)r=this.classesElementLookup[n],e[n]!==this.options.classes[n]&&r&&r.length&&(i=t(r.get()),this._removeClass(r,n),i.addClass(this._classes({element:i,keys:n,classes:e,add:!0})))},_setOptionDisabled:function(t){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!t),t&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(e){var n=[],i=this;function r(r,o){var s,a;for(a=0;a<r.length;a++)s=i.classesElementLookup[r[a]]||t(),s=e.add?t(t.unique(s.get().concat(e.element.get()))):t(s.not(e.element).get()),i.classesElementLookup[r[a]]=s,n.push(r[a]),o&&e.classes[r[a]]&&n.push(e.classes[r[a]])}return e=t.extend({element:this.element,classes:this.options.classes||{}},e),this._on(e.element,{remove:"_untrackClassesElement"}),e.keys&&r(e.keys.match(/\S+/g)||[],!0),e.extra&&r(e.extra.match(/\S+/g)||[]),n.join(" ")},_untrackClassesElement:function(e){var n=this;t.each(n.classesElementLookup,function(i,r){-1!==t.inArray(e.target,r)&&(n.classesElementLookup[i]=t(r.not(e.target).get()))})},_removeClass:function(t,e,n){return this._toggleClass(t,e,n,!1)},_addClass:function(t,e,n){return this._toggleClass(t,e,n,!0)},_toggleClass:function(t,e,n,i){i="boolean"==typeof i?i:n;var r="string"==typeof t||null===t,o={extra:r?e:n,keys:r?t:e,element:r?this.element:t,add:i};return o.element.toggleClass(this._classes(o),i),this},_on:function(e,n,i){var r,o=this;"boolean"!=typeof e&&(i=n,n=e,e=!1),i?(n=r=t(n),this.bindings=this.bindings.add(n)):(i=n,n=this.element,r=this.widget()),t.each(i,function(i,s){function a(){if(e||!0!==o.options.disabled&&!t(this).hasClass("ui-state-disabled"))return("string"==typeof s?o[s]:s).apply(o,arguments)}"string"!=typeof s&&(a.guid=s.guid=s.guid||a.guid||t.guid++);var c=i.match(/^([\w:-]*)\s*(.*)$/),l=c[1]+o.eventNamespace,u=c[2];u?r.on(l,u,a):n.on(l,a)})},_off:function(e,n){n=(n||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.off(n).off(n),this.bindings=t(this.bindings.not(e).get()),this.focusable=t(this.focusable.not(e).get()),this.hoverable=t(this.hoverable.not(e).get())},_delay:function(t,e){var n=this;return setTimeout(function(){return("string"==typeof t?n[t]:t).apply(n,arguments)},e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){this._addClass(t(e.currentTarget),null,"ui-state-hover")},mouseleave:function(e){this._removeClass(t(e.currentTarget),null,"ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){this._addClass(t(e.currentTarget),null,"ui-state-focus")},focusout:function(e){this._removeClass(t(e.currentTarget),null,"ui-state-focus")}})},_trigger:function(e,n,i){var r,o,s=this.options[e];if(i=i||{},(n=t.Event(n)).type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),n.target=this.element[0],o=n.originalEvent)for(r in o)r in n||(n[r]=o[r]);return this.element.trigger(n,i),!(t.isFunction(s)&&!1===s.apply(this.element[0],[n].concat(i))||n.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},function(e,n){t.Widget.prototype["_"+e]=function(i,r,o){var s;"string"==typeof r&&(r={effect:r});var a=r?!0===r||"number"==typeof r?n:r.effect||n:e;"number"==typeof(r=r||{})&&(r={duration:r}),s=!t.isEmptyObject(r),r.complete=o,r.delay&&i.delay(r.delay),s&&t.effects&&t.effects.effect[a]?i[e](r):a!==e&&i[a]?i[a](r.duration,r.easing,o):i.queue(function(n){t(this)[e](),o&&o.call(i[0]),n()})}}),t.widget})?i.apply(e,r):i)||(t.exports=o)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(7);function r(t){return"function"==typeof t?t.name:"symbol"==typeof t?t.toString():t}function o(t){if(t.name)return t.name;var e=t.toString(),n=e.match(/^function\s*([^\s(]+)/);return n?n[1]:"Anonymous function: "+e}e.getServiceIdentifierAsString=r,e.listRegisteredBindingsForServiceIdentifier=function(t,e,n){var i="",r=n(t,e);return 0!==r.length&&(i="\nRegistered bindings:",r.forEach(function(t){var e="Object";null!==t.implementationType&&(e=o(t.implementationType)),i=i+"\n "+e,t.constraint.metaData&&(i=i+" - "+t.constraint.metaData)})),i},e.circularDependencyToException=function t(e){e.childRequests.forEach(function(e){if(function t(e,n){return null!==e.parentRequest&&(e.parentRequest.serviceIdentifier===n||t(e.parentRequest,n))}(e,e.serviceIdentifier)){var n=function(t){return function t(e,n){void 0===n&&(n=[]);var i=r(e.serviceIdentifier);return n.push(i),null!==e.parentRequest?t(e.parentRequest,n):n}(t).reverse().join(" --\x3e ")}(e);throw new Error(i.CIRCULAR_DEPENDENCY+" "+n)}t(e)})},e.listMetadataForTarget=function(t,e){if(e.isTagged()||e.isNamed()){var n="",i=e.getNamedTag(),r=e.getCustomTags();return null!==i&&(n+=i.toString()+"\n"),null!==r&&r.forEach(function(t){n+=t.toString()+"\n"})," "+t+"\n "+t+" - "+n}return" "+t},e.getFunctionName=o},function(t,e,n){(function(t,e){
/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var n;!function(n){!function(i){var r="object"==typeof e?e:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),o=s(n);function s(t,e){return function(n,i){"function"!=typeof t[n]&&Object.defineProperty(t,n,{configurable:!0,writable:!0,value:i}),e&&e(n,i)}}void 0===r.Reflect?r.Reflect=n:o=s(r.Reflect,o),function(e){var n=Object.prototype.hasOwnProperty,i="function"==typeof Symbol,r=i&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",o=i&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",s="function"==typeof Object.create,a={__proto__:[]}instanceof Array,c=!s&&!a,l={create:s?function(){return L(Object.create(null))}:a?function(){return L({__proto__:null})}:function(){return L({})},has:c?function(t,e){return n.call(t,e)}:function(t,e){return e in t},get:c?function(t,e){return n.call(t,e)?t[e]:void 0}:function(t,e){return t[e]}},u=Object.getPrototypeOf(Function),h="object"==typeof t&&t.env&&"true"===t.env.REFLECT_METADATA_USE_MAP_POLYFILL,d=h||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function(){var t={},e=[],n=function(){function t(t,e,n){this._index=0,this._keys=t,this._values=e,this._selector=n}return t.prototype["@@iterator"]=function(){return this},t.prototype[o]=function(){return this},t.prototype.next=function(){var t=this._index;if(t>=0&&t<this._keys.length){var n=this._selector(this._keys[t],this._values[t]);return t+1>=this._keys.length?(this._index=-1,this._keys=e,this._values=e):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},t.prototype.throw=function(t){throw this._index>=0&&(this._index=-1,this._keys=e,this._values=e),t},t.prototype.return=function(t){return this._index>=0&&(this._index=-1,this._keys=e,this._values=e),{value:t,done:!0}},t}();return function(){function e(){this._keys=[],this._values=[],this._cacheKey=t,this._cacheIndex=-2}return Object.defineProperty(e.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),e.prototype.has=function(t){return this._find(t,!1)>=0},e.prototype.get=function(t){var e=this._find(t,!1);return e>=0?this._values[e]:void 0},e.prototype.set=function(t,e){var n=this._find(t,!0);return this._values[n]=e,this},e.prototype.delete=function(e){var n=this._find(e,!1);if(n>=0){for(var i=this._keys.length,r=n+1;r<i;r++)this._keys[r-1]=this._keys[r],this._values[r-1]=this._values[r];return this._keys.length--,this._values.length--,e===this._cacheKey&&(this._cacheKey=t,this._cacheIndex=-2),!0}return!1},e.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=t,this._cacheIndex=-2},e.prototype.keys=function(){return new n(this._keys,this._values,i)},e.prototype.values=function(){return new n(this._keys,this._values,r)},e.prototype.entries=function(){return new n(this._keys,this._values,s)},e.prototype["@@iterator"]=function(){return this.entries()},e.prototype[o]=function(){return this.entries()},e.prototype._find=function(t,e){return this._cacheKey!==t&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=t)),this._cacheIndex<0&&e&&(this._cacheIndex=this._keys.length,this._keys.push(t),this._values.push(void 0)),this._cacheIndex},e}();function i(t,e){return t}function r(t,e){return e}function s(t,e){return[t,e]}}():Map,f=h||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function(){function t(){this._map=new d}return Object.defineProperty(t.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),t.prototype.has=function(t){return this._map.has(t)},t.prototype.add=function(t){return this._map.set(t,t),this},t.prototype.delete=function(t){return this._map.delete(t)},t.prototype.clear=function(){this._map.clear()},t.prototype.keys=function(){return this._map.keys()},t.prototype.values=function(){return this._map.values()},t.prototype.entries=function(){return this._map.entries()},t.prototype["@@iterator"]=function(){return this.keys()},t.prototype[o]=function(){return this.keys()},t}():Set,p=new(h||"function"!=typeof WeakMap?function(){var t=16,e=l.create(),i=r();return function(){function t(){this._key=r()}return t.prototype.has=function(t){var e=o(t,!1);return void 0!==e&&l.has(e,this._key)},t.prototype.get=function(t){var e=o(t,!1);return void 0!==e?l.get(e,this._key):void 0},t.prototype.set=function(t,e){return o(t,!0)[this._key]=e,this},t.prototype.delete=function(t){var e=o(t,!1);return void 0!==e&&delete e[this._key]},t.prototype.clear=function(){this._key=r()},t}();function r(){var t;do{t="@@WeakMap@@"+a()}while(l.has(e,t));return e[t]=!0,t}function o(t,e){if(!n.call(t,i)){if(!e)return;Object.defineProperty(t,i,{value:l.create()})}return t[i]}function s(t,e){for(var n=0;n<e;++n)t[n]=255*Math.random()|0;return t}function a(){var e,n=(e=t,"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):s(new Uint8Array(e),e):s(new Array(e),e));n[6]=79&n[6]|64,n[8]=191&n[8]|128;for(var i="",r=0;r<t;++r){var o=n[r];4!==r&&6!==r&&8!==r||(i+="-"),o<16&&(i+="0"),i+=o.toString(16).toLowerCase()}return i}}():WeakMap);function g(t,e,n){var i=p.get(t);if(C(i)){if(!n)return;i=new d,p.set(t,i)}var r=i.get(e);if(C(r)){if(!n)return;r=new d,i.set(e,r)}return r}function _(t,e,n){var i=g(e,n,!1);return!C(i)&&!!i.has(t)}function m(t,e,n){var i=g(e,n,!1);if(!C(i))return i.get(t)}function y(t,e,n,i){g(n,i,!0).set(t,e)}function v(t,e){var n=[],i=g(t,e,!1);if(C(i))return n;for(var r=function(t){var e=O(t,o);if(!R(e))throw new TypeError;var n=e.call(t);if(!E(n))throw new TypeError;return n}(i.keys()),s=0;;){var a=I(r);if(!a)return n.length=s,n;var c=a.value;try{n[s]=c}catch(t){try{M(r)}finally{throw t}}s++}}function b(t){if(null===t)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}function C(t){return void 0===t}function w(t){return null===t}function E(t){return"object"==typeof t?null!==t:"function"==typeof t}function T(t,e){switch(b(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}var n=3===e?"string":5===e?"number":"default",i=O(t,r);if(void 0!==i){var o=i.call(t,n);if(E(o))throw new TypeError;return o}return function(t,e){if("string"===e){var n=t.toString;if(R(n))if(!E(r=n.call(t)))return r;if(R(i=t.valueOf))if(!E(r=i.call(t)))return r}else{var i;if(R(i=t.valueOf))if(!E(r=i.call(t)))return r;var r,o=t.toString;if(R(o))if(!E(r=o.call(t)))return r}throw new TypeError}(t,"default"===n?"number":n)}function S(t){var e=T(t,3);return"symbol"==typeof e?e:function(t){return""+t}(e)}function x(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:"[object Array]"===Object.prototype.toString.call(t)}function R(t){return"function"==typeof t}function A(t){return"function"==typeof t}function O(t,e){var n=t[e];if(null!=n){if(!R(n))throw new TypeError;return n}}function I(t){var e=t.next();return!e.done&&e}function M(t){var e=t.return;e&&e.call(t)}function P(t){var e=Object.getPrototypeOf(t);if("function"!=typeof t||t===u)return e;if(e!==u)return e;var n=t.prototype,i=n&&Object.getPrototypeOf(n);if(null==i||i===Object.prototype)return e;var r=i.constructor;return"function"!=typeof r?e:r===t?e:r}function L(t){return t.__=void 0,delete t.__,t}e("decorate",function(t,e,n,i){if(C(n)){if(!x(t))throw new TypeError;if(!A(e))throw new TypeError;return function(t,e){for(var n=t.length-1;n>=0;--n){var i=(0,t[n])(e);if(!C(i)&&!w(i)){if(!A(i))throw new TypeError;e=i}}return e}(t,e)}if(!x(t))throw new TypeError;if(!E(e))throw new TypeError;if(!E(i)&&!C(i)&&!w(i))throw new TypeError;return w(i)&&(i=void 0),function(t,e,n,i){for(var r=t.length-1;r>=0;--r){var o=(0,t[r])(e,n,i);if(!C(o)&&!w(o)){if(!E(o))throw new TypeError;i=o}}return i}(t,e,n=S(n),i)}),e("metadata",function(t,e){return function(n,i){if(!E(n))throw new TypeError;if(!C(i)&&!function(t){switch(b(t)){case 3:case 4:return!0;default:return!1}}(i))throw new TypeError;y(t,e,n,i)}}),e("defineMetadata",function(t,e,n,i){if(!E(n))throw new TypeError;return C(i)||(i=S(i)),y(t,e,n,i)}),e("hasMetadata",function(t,e,n){if(!E(e))throw new TypeError;return C(n)||(n=S(n)),function t(e,n,i){var r=_(e,n,i);if(r)return!0;var o=P(n);if(!w(o))return t(e,o,i);return!1}(t,e,n)}),e("hasOwnMetadata",function(t,e,n){if(!E(e))throw new TypeError;return C(n)||(n=S(n)),_(t,e,n)}),e("getMetadata",function(t,e,n){if(!E(e))throw new TypeError;return C(n)||(n=S(n)),function t(e,n,i){var r=_(e,n,i);if(r)return m(e,n,i);var o=P(n);if(!w(o))return t(e,o,i);return}(t,e,n)}),e("getOwnMetadata",function(t,e,n){if(!E(e))throw new TypeError;return C(n)||(n=S(n)),m(t,e,n)}),e("getMetadataKeys",function(t,e){if(!E(t))throw new TypeError;return C(e)||(e=S(e)),function t(e,n){var i=v(e,n);var r=P(e);if(null===r)return i;var o=t(r,n);if(o.length<=0)return i;if(i.length<=0)return o;var s=new f;var a=[];for(var c=0,l=i;c<l.length;c++){var u=l[c];s.has(u)||(s.add(u),a.push(u))}for(var h=0,d=o;h<d.length;h++){u=d[h];s.has(u)||(s.add(u),a.push(u))}return a}(t,e)}),e("getOwnMetadataKeys",function(t,e){if(!E(t))throw new TypeError;return C(e)||(e=S(e)),v(t,e)}),e("deleteMetadata",function(t,e,n){if(!E(e))throw new TypeError;C(n)||(n=S(n));var i=g(e,n,!1);if(C(i))return!1;if(!i.delete(t))return!1;if(i.size>0)return!0;var r=p.get(e);return r.delete(n),r.size>0||(p.delete(e),!0)})}(o)}()}(n||(n={}))}).call(this,n(126),n(26))},,function(t,e,n){var i,r,o;
/*!
 * jQuery UI Mouse 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */r=[n(4),n(33),n(5),n(13)],void 0===(o="function"==typeof(i=function(t){var e=!1;return t(document).on("mouseup",function(){e=!1}),t.widget("ui.mouse",{version:"1.12.1",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.on("mousedown."+this.widgetName,function(t){return e._mouseDown(t)}).on("click."+this.widgetName,function(n){if(!0===t.data(n.target,e.widgetName+".preventClickEvent"))return t.removeData(n.target,e.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.off("."+this.widgetName),this._mouseMoveDelegate&&this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(n){if(!e){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(n),this._mouseDownEvent=n;var i=this,r=1===n.which,o=!("string"!=typeof this.options.cancel||!n.target.nodeName)&&t(n.target).closest(this.options.cancel).length;return!(r&&!o&&this._mouseCapture(n)&&(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(n)&&this._mouseDelayMet(n)&&(this._mouseStarted=!1!==this._mouseStart(n),!this._mouseStarted)?(n.preventDefault(),0):(!0===t.data(n.target,this.widgetName+".preventClickEvent")&&t.removeData(n.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return i._mouseMove(t)},this._mouseUpDelegate=function(t){return i._mouseUp(t)},this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate),n.preventDefault(),e=!0,0)))}},_mouseMove:function(e){if(this._mouseMoved){if(t.ui.ie&&(!document.documentMode||document.documentMode<9)&&!e.button)return this._mouseUp(e);if(!e.which)if(e.originalEvent.altKey||e.originalEvent.ctrlKey||e.originalEvent.metaKey||e.originalEvent.shiftKey)this.ignoreMissingWhich=!0;else if(!this.ignoreMissingWhich)return this._mouseUp(e)}return(e.which||e.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,e),this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},_mouseUp:function(n){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,n.target===this._mouseDownEvent.target&&t.data(n.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(n)),this._mouseDelayTimer&&(clearTimeout(this._mouseDelayTimer),delete this._mouseDelayTimer),this.ignoreMissingWhich=!1,e=!1,n.preventDefault()},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})})?i.apply(e,r):i)||(t.exports=o)},,function(t,e,n){t.exports=function(){return n(37)('!function(t){var n={};function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)e.d(r,i,function(n){return t[n]}.bind(null,i));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="/",e(e.s=16)}([function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.NAMED_TAG="named",n.NAME_TAG="name",n.UNMANAGED_TAG="unmanaged",n.OPTIONAL_TAG="optional",n.INJECT_TAG="inject",n.MULTI_INJECT_TAG="multi_inject",n.TAGGED="inversify:tagged",n.TAGGED_PROP="inversify:tagged_props",n.PARAM_TYPES="inversify:paramtypes",n.DESIGN_PARAM_TYPES="design:paramtypes",n.POST_CONSTRUCT="post_construct"},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",n.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",n.NULL_ARGUMENT="NULL argument",n.KEY_NOT_FOUND="Key Not Found",n.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",n.CANNOT_UNBIND="Could not unbind serviceIdentifier:",n.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",n.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",n.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:",n.UNDEFINED_INJECT_ANNOTATION=function(t){return"@inject called with undefined this could mean that the class "+t+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},n.CIRCULAR_DEPENDENCY="Circular dependency found:",n.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",n.INVALID_BINDING_TYPE="Invalid binding type:",n.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",n.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",n.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",n.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",n.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",n.ARGUMENTS_LENGTH_MISMATCH=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return"The number of constructor arguments in the derived class "+t[0]+" must be >= than the number of constructor arguments of its base class."},n.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",n.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string (\'singleton\' or \'transient\').",n.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",n.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",n.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class",n.POST_CONSTRUCT_ERROR=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return"@postConstruct error in class "+t[0]+": "+t[1]},n.CIRCULAR_DEPENDENCY_IN_FACTORY=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return"It looks like there is a circular dependency in one of the \'"+t[0]+"\' bindings. Please investigate bindings withservice identifier \'"+t[1]+"\'."},n.STACK_OVERFLOW="Maximum call stack size exceeded"},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(0),i=function(){function t(t,n){this.key=t,this.value=n}return t.prototype.toString=function(){return this.key===r.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},t}();n.Metadata=i},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.BindingScopeEnum={Request:"Request",Singleton:"Singleton",Transient:"Transient"};n.BindingTypeEnum={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};n.TargetTypeEnum={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(1),i=e(0);function o(t,n,e,i,o){var a={},u="number"==typeof o,s=void 0!==o&&u?o.toString():e;if(u&&void 0!==e)throw new Error(r.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(t,n)&&(a=Reflect.getMetadata(t,n));var c=a[s];if(Array.isArray(c))for(var f=0,d=c;f<d.length;f++){var l=d[f];if(l.key===i.key)throw new Error(r.DUPLICATED_METADATA+" "+l.key.toString())}else c=[];c.push(i),a[s]=c,Reflect.defineMetadata(t,a,n)}function a(t,n){Reflect.decorate(t,n)}function u(t,n){return function(e,r){n(e,r,t)}}n.tagParameter=function(t,n,e,r){o(i.TAGGED,t,n,r,e)},n.tagProperty=function(t,n,e){o(i.TAGGED_PROP,t.constructor,n,e)},n.decorate=function(t,n,e){"number"==typeof e?a([u(e,t)],n):"string"==typeof e?Reflect.decorate([t],n,e):a([t],n)}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=0;n.id=function(){return r++}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(1);function i(t){return"function"==typeof t?t.name:"symbol"==typeof t?t.toString():t}function o(t){if(t.name)return t.name;var n=t.toString(),e=n.match(/^function\\s*([^\\s(]+)/);return e?e[1]:"Anonymous function: "+n}n.getServiceIdentifierAsString=i,n.listRegisteredBindingsForServiceIdentifier=function(t,n,e){var r="",i=e(t,n);return 0!==i.length&&(r="\\nRegistered bindings:",i.forEach(function(t){var n="Object";null!==t.implementationType&&(n=o(t.implementationType)),r=r+"\\n "+n,t.constraint.metaData&&(r=r+" - "+t.constraint.metaData)})),r},n.circularDependencyToException=function t(n){n.childRequests.forEach(function(n){if(function t(n,e){return null!==n.parentRequest&&(n.parentRequest.serviceIdentifier===e||t(n.parentRequest,e))}(n,n.serviceIdentifier)){var e=function(t){return function t(n,e){void 0===e&&(e=[]);var r=i(n.serviceIdentifier);return e.push(r),null!==n.parentRequest?t(n.parentRequest,e):e}(t).reverse().join(" --\\x3e ")}(n);throw new Error(r.CIRCULAR_DEPENDENCY+" "+e)}t(n)})},n.listMetadataForTarget=function(t,n){if(n.isTagged()||n.isNamed()){var e="",r=n.getNamedTag(),i=n.getCustomTags();return null!==r&&(e+=r.toString()+"\\n"),null!==i&&i.forEach(function(t){e+=t.toString()+"\\n"})," "+t+"\\n "+t+" - "+e}return" "+t},n.getFunctionName=o},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(8),i=e(9),o=function(){function t(t){this._binding=t}return t.prototype.when=function(t){return this._binding.constraint=t,new r.BindingOnSyntax(this._binding)},t.prototype.whenTargetNamed=function(t){return this._binding.constraint=i.namedConstraint(t),new r.BindingOnSyntax(this._binding)},t.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(t){return null!==t.target&&!t.target.isNamed()&&!t.target.isTagged()},new r.BindingOnSyntax(this._binding)},t.prototype.whenTargetTagged=function(t,n){return this._binding.constraint=i.taggedConstraint(t)(n),new r.BindingOnSyntax(this._binding)},t.prototype.whenInjectedInto=function(t){return this._binding.constraint=function(n){return i.typeConstraint(t)(n.parentRequest)},new r.BindingOnSyntax(this._binding)},t.prototype.whenParentNamed=function(t){return this._binding.constraint=function(n){return i.namedConstraint(t)(n.parentRequest)},new r.BindingOnSyntax(this._binding)},t.prototype.whenParentTagged=function(t,n){return this._binding.constraint=function(e){return i.taggedConstraint(t)(n)(e.parentRequest)},new r.BindingOnSyntax(this._binding)},t.prototype.whenAnyAncestorIs=function(t){return this._binding.constraint=function(n){return i.traverseAncerstors(n,i.typeConstraint(t))},new r.BindingOnSyntax(this._binding)},t.prototype.whenNoAncestorIs=function(t){return this._binding.constraint=function(n){return!i.traverseAncerstors(n,i.typeConstraint(t))},new r.BindingOnSyntax(this._binding)},t.prototype.whenAnyAncestorNamed=function(t){return this._binding.constraint=function(n){return i.traverseAncerstors(n,i.namedConstraint(t))},new r.BindingOnSyntax(this._binding)},t.prototype.whenNoAncestorNamed=function(t){return this._binding.constraint=function(n){return!i.traverseAncerstors(n,i.namedConstraint(t))},new r.BindingOnSyntax(this._binding)},t.prototype.whenAnyAncestorTagged=function(t,n){return this._binding.constraint=function(e){return i.traverseAncerstors(e,i.taggedConstraint(t)(n))},new r.BindingOnSyntax(this._binding)},t.prototype.whenNoAncestorTagged=function(t,n){return this._binding.constraint=function(e){return!i.traverseAncerstors(e,i.taggedConstraint(t)(n))},new r.BindingOnSyntax(this._binding)},t.prototype.whenAnyAncestorMatches=function(t){return this._binding.constraint=function(n){return i.traverseAncerstors(n,t)},new r.BindingOnSyntax(this._binding)},t.prototype.whenNoAncestorMatches=function(t){return this._binding.constraint=function(n){return!i.traverseAncerstors(n,t)},new r.BindingOnSyntax(this._binding)},t}();n.BindingWhenSyntax=o},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(7),i=function(){function t(t){this._binding=t}return t.prototype.onActivation=function(t){return this._binding.onActivation=t,new r.BindingWhenSyntax(this._binding)},t}();n.BindingOnSyntax=i},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(0),i=e(2),o=function(t,n){var e=t.parentRequest;return null!==e&&(!!n(e)||o(e,n))};n.traverseAncerstors=o;var a=function(t){return function(n){var e=function(e){return null!==e&&null!==e.target&&e.target.matchesTag(t)(n)};return e.metaData=new i.Metadata(t,n),e}};n.taggedConstraint=a;var u=a(r.NAMED_TAG);n.namedConstraint=u;n.typeConstraint=function(t){return function(n){var e=null;if(null!==n){if(e=n.bindings[0],"string"==typeof t)return e.serviceIdentifier===t;var r=n.bindings[0].implementationType;return t===r}return!1}}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(8),i=e(7),o=function(){function t(t){this._binding=t,this._bindingWhenSyntax=new i.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new r.BindingOnSyntax(this._binding)}return t.prototype.when=function(t){return this._bindingWhenSyntax.when(t)},t.prototype.whenTargetNamed=function(t){return this._bindingWhenSyntax.whenTargetNamed(t)},t.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},t.prototype.whenTargetTagged=function(t,n){return this._bindingWhenSyntax.whenTargetTagged(t,n)},t.prototype.whenInjectedInto=function(t){return this._bindingWhenSyntax.whenInjectedInto(t)},t.prototype.whenParentNamed=function(t){return this._bindingWhenSyntax.whenParentNamed(t)},t.prototype.whenParentTagged=function(t,n){return this._bindingWhenSyntax.whenParentTagged(t,n)},t.prototype.whenAnyAncestorIs=function(t){return this._bindingWhenSyntax.whenAnyAncestorIs(t)},t.prototype.whenNoAncestorIs=function(t){return this._bindingWhenSyntax.whenNoAncestorIs(t)},t.prototype.whenAnyAncestorNamed=function(t){return this._bindingWhenSyntax.whenAnyAncestorNamed(t)},t.prototype.whenAnyAncestorTagged=function(t,n){return this._bindingWhenSyntax.whenAnyAncestorTagged(t,n)},t.prototype.whenNoAncestorNamed=function(t){return this._bindingWhenSyntax.whenNoAncestorNamed(t)},t.prototype.whenNoAncestorTagged=function(t,n){return this._bindingWhenSyntax.whenNoAncestorTagged(t,n)},t.prototype.whenAnyAncestorMatches=function(t){return this._bindingWhenSyntax.whenAnyAncestorMatches(t)},t.prototype.whenNoAncestorMatches=function(t){return this._bindingWhenSyntax.whenNoAncestorMatches(t)},t.prototype.onActivation=function(t){return this._bindingOnSyntax.onActivation(t)},t}();n.BindingWhenOnSyntax=o},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(0),i=e(5),o=e(2),a=e(35),u=function(){function t(t,n,e,u){this.id=i.id(),this.type=t,this.serviceIdentifier=e,this.name=new a.QueryableString(n||""),this.metadata=new Array;var s=null;"string"==typeof u?s=new o.Metadata(r.NAMED_TAG,u):u instanceof o.Metadata&&(s=u),null!==s&&this.metadata.push(s)}return t.prototype.hasTag=function(t){for(var n=0,e=this.metadata;n<e.length;n++){if(e[n].key===t)return!0}return!1},t.prototype.isArray=function(){return this.hasTag(r.MULTI_INJECT_TAG)},t.prototype.matchesArray=function(t){return this.matchesTag(r.MULTI_INJECT_TAG)(t)},t.prototype.isNamed=function(){return this.hasTag(r.NAMED_TAG)},t.prototype.isTagged=function(){return this.metadata.some(function(t){return t.key!==r.INJECT_TAG&&t.key!==r.MULTI_INJECT_TAG&&t.key!==r.NAME_TAG&&t.key!==r.UNMANAGED_TAG&&t.key!==r.NAMED_TAG})},t.prototype.isOptional=function(){return this.matchesTag(r.OPTIONAL_TAG)(!0)},t.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(t){return t.key===r.NAMED_TAG})[0]:null},t.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(t){return t.key!==r.INJECT_TAG&&t.key!==r.MULTI_INJECT_TAG&&t.key!==r.NAME_TAG&&t.key!==r.UNMANAGED_TAG&&t.key!==r.NAMED_TAG}):null},t.prototype.matchesNamedTag=function(t){return this.matchesTag(r.NAMED_TAG)(t)},t.prototype.matchesTag=function(t){var n=this;return function(e){for(var r=0,i=n.metadata;r<i.length;r++){var o=i[r];if(o.key===t&&o.value===e)return!0}return!1}},t}();n.Target=u},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(1),i=e(0),o=e(2),a=e(4),u=function(){function t(t){this._cb=t}return t.prototype.unwrap=function(){return this._cb()},t}();n.LazyServiceIdentifer=u,n.inject=function(t){return function(n,e,u){if(void 0===t)throw new Error(r.UNDEFINED_INJECT_ANNOTATION(n.name));var s=new o.Metadata(i.INJECT_TAG,t);"number"==typeof u?a.tagParameter(n,e,u,s):a.tagProperty(n,e,s)}}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(1);n.isStackOverflowExeption=function(t){return t instanceof RangeError||t.message===r.STACK_OVERFLOW}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(0),i=function(){function t(){}return t.prototype.getConstructorMetadata=function(t){return{compilerGeneratedMetadata:Reflect.getMetadata(r.PARAM_TYPES,t),userGeneratedMetadata:Reflect.getMetadata(r.TAGGED,t)||{}}},t.prototype.getPropertiesMetadata=function(t){return Reflect.getMetadata(r.TAGGED_PROP,t)||[]},t}();n.MetadataReader=i},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(0);n.METADATA_KEY=r;var i=e(42);n.Container=i.Container;var o=e(3);n.BindingScopeEnum=o.BindingScopeEnum,n.BindingTypeEnum=o.BindingTypeEnum,n.TargetTypeEnum=o.TargetTypeEnum;var a=e(26);n.AsyncContainerModule=a.AsyncContainerModule,n.ContainerModule=a.ContainerModule;var u=e(25);n.injectable=u.injectable;var s=e(24);n.tagged=s.tagged;var c=e(23);n.named=c.named;var f=e(12);n.inject=f.inject,n.LazyServiceIdentifer=f.LazyServiceIdentifer;var d=e(22);n.optional=d.optional;var l=e(21);n.unmanaged=l.unmanaged;var h=e(20);n.multiInject=h.multiInject;var p=e(19);n.targetName=p.targetName;var y=e(18);n.postConstruct=y.postConstruct;var g=e(14);n.MetadataReader=g.MetadataReader;var _=e(5);n.id=_.id;var v=e(4);n.decorate=v.decorate;var T=e(9);n.traverseAncerstors=T.traverseAncerstors,n.taggedConstraint=T.taggedConstraint,n.namedConstraint=T.namedConstraint,n.typeConstraint=T.typeConstraint;var m=e(6);n.getServiceIdentifierAsString=m.getServiceIdentifierAsString;var b=e(17);n.multiBindToService=b.multiBindToService},function(t,n,e){"use strict";function r(t,n,e,o,a,u){if(a-o<=e)return;const s=o+a>>1;!function t(n,e,r,o,a,u){for(;a>o;){if(a-o>600){const i=a-o+1,s=r-o+1,c=Math.log(i),f=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*f*(i-f)/i)*(s-i/2<0?-1:1),l=Math.max(o,Math.floor(r-s*f/i+d)),h=Math.min(a,Math.floor(r+(i-s)*f/i+d));t(n,e,r,l,h,u)}const s=e[2*r+u];let c=o,f=a;for(i(n,e,o,r),e[2*a+u]>s&&i(n,e,o,a);c<f;){for(i(n,e,c,f),c++,f--;e[2*c+u]<s;)c++;for(;e[2*f+u]>s;)f--}e[2*o+u]===s?i(n,e,o,f):i(n,e,++f,a),f<=r&&(o=f+1),r<=f&&(a=f-1)}}(t,n,s,o,a,u%2),r(t,n,e,o,s-1,u+1),r(t,n,e,s+1,a,u+1)}function i(t,n,e,r){o(t,e,r),o(n,2*e,2*r),o(n,2*e+1,2*r+1)}function o(t,n,e){const r=t[n];t[n]=t[e],t[e]=r}function a(t,n,e,r){const i=t-e,o=n-r;return i*i+o*o}e.r(n);const u=t=>t[0],s=t=>t[1];class c{constructor(t,n=u,e=s,i=64,o=Float64Array){this.nodeSize=i,this.points=t;const a=t.length<65536?Uint16Array:Uint32Array,c=this.ids=new a(t.length),f=this.coords=new o(2*t.length);for(let r=0;r<t.length;r++)c[r]=r,f[2*r]=n(t[r]),f[2*r+1]=e(t[r]);r(c,f,i,0,c.length-1,0)}range(t,n,e,r){return function(t,n,e,r,i,o,a){const u=[0,t.length-1,0],s=[];let c,f;for(;u.length;){const d=u.pop(),l=u.pop(),h=u.pop();if(l-h<=a){for(let a=h;a<=l;a++)c=n[2*a],f=n[2*a+1],c>=e&&c<=i&&f>=r&&f<=o&&s.push(t[a]);continue}const p=Math.floor((h+l)/2);c=n[2*p],f=n[2*p+1],c>=e&&c<=i&&f>=r&&f<=o&&s.push(t[p]);const y=(d+1)%2;(0===d?e<=c:r<=f)&&(u.push(h),u.push(p-1),u.push(y)),(0===d?i>=c:o>=f)&&(u.push(p+1),u.push(l),u.push(y))}return s}(this.ids,this.coords,t,n,e,r,this.nodeSize)}within(t,n,e){return function(t,n,e,r,i,o){const u=[0,t.length-1,0],s=[],c=i*i;for(;u.length;){const f=u.pop(),d=u.pop(),l=u.pop();if(d-l<=o){for(let i=l;i<=d;i++)a(n[2*i],n[2*i+1],e,r)<=c&&s.push(t[i]);continue}const h=Math.floor((l+d)/2),p=n[2*h],y=n[2*h+1];a(p,y,e,r)<=c&&s.push(t[h]);const g=(f+1)%2;(0===f?e-i<=p:r-i<=y)&&(u.push(l),u.push(h-1),u.push(g)),(0===f?e+i>=p:r+i>=y)&&(u.push(h+1),u.push(d),u.push(g))}return s}(this.ids,this.coords,t,n,e,this.nodeSize)}}e(45);var f={BigVectorLayer:!1,DataSource:!1,GridHeatMap:!1},d=e(15);let l=class{constructor(){this._allData=[],this._filterLookup={},this._filtered=!1,this._processed={},this._hasSetAllUnclusteredPoints=!1}initialize(t){f.BigVectorLayer&&console.log(`Cluster Radius is ${t}`),this._radius=t}addData(t){this._allData=this._allData.concat(t)}dataDone(){const t=performance.now();this._kdTree=new c(this._allData,this._getX,this._getY,8,Float32Array),f.BigVectorLayer&&console.log("KD tree done in",performance.now()-t,"ms")}_getX(t){return t[0]}_getY(t){return t[1]}addShowOnlyKeysFilter(t){this._filterLookup={},this._filtered=t.length!==this._allData.length,this._filtered&&t.forEach(t=>this._filterLookup[t]=!0),this._extent&&this._callback&&this.cluster(this._extent,this._zoom,this._shouldCluster,this._callback)}cluster(t,n,e,r){if(this._extent=t,this._zoom=n,this._shouldCluster=e,this._callback=r,!this._kdTree)return;const i=this._getPointsInViewPort(t,n);if(e){this._hasSetAllUnclusteredPoints=!1,r(this._getClusteredPoints(i,n))}else if(!this._hasSetAllUnclusteredPoints){r(this._getUnclusteredPoints(this._allData))}}_getPointsInViewPort(t,n){t||(t=[-1/0,-1/0,1/0,1/0]);const[e,r,i,o]=t,a=this._kdTree.range(e,r,i,o).map(t=>this._allData[t]);return this._filtered?a.filter(t=>this._filterLookup[t[2]]):a}_getClusteredPoints(t,n){this._processed={};const e=[],r=this._radius/(512*Math.pow(2,n)),i=performance.now();for(let n=0;n<t.length;n++){const i=t[n];if(this._isProccessed(i))continue;this._processed[i[2]]=!0;let o=this._kdTree.within(i[0],i[1],r),a=i[0],u=i[1];const s=[i[2]];for(let t=0;t<o.length;t++){const n=this._kdTree.points[o[t]];this._isProccessed(n)||this._isFiltered(n)||i[3]!=n[3]||(this._processed[n[2]]=!0,a+=n[0],u+=n[1],s.push(n[2]))}let c;if(s.length>1){const t=a/s.length,n=u/s.length;c=this._createCluster(t,n,-1,s,i[3])}else c=this._createCluster(i[0],i[1],i[2],[],i[3]);e.push(c)}return f.BigVectorLayer&&console.log("Clustering done in",performance.now()-i,"ms"),e}_getUnclusteredPoints(t){return this._hasSetAllUnclusteredPoints=!0,t.map(t=>this._createCluster(t[0],t[1],t[2],[],t[3]))}_createCluster(t,n,e,r,i){return[t,n,e,i,r]}_isProccessed(t){return this._processed[t[2]]}_isFiltered(t){return this._filtered&&!this._filterLookup[t[2]]}hasData(){return this._allData.length>0}};let h=new(l=function(t,n,e,r){var i,o=arguments.length,a=o<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,n,e,r);else for(var u=t.length-1;u>=0;u--)(i=t[u])&&(a=(o<3?i(a):o>3?i(n,e,a):i(n,e))||a);return o>3&&a&&Object.defineProperty(n,e,a),a}([Object(d.injectable)()],l));const p=self;let y;function g(t){const{zoom:n,extent:e,shouldCluster:r}=t;h.hasData()?h.cluster(e,n,r,t=>{const n={type:"response",clusters:t};p.postMessage(n)}):y=t}p.addEventListener("message",t=>{const{type:n,subData:e,clusterRadius:r,keys:i}=t.data;switch(n){case"data":!function(t){h.addData(t)}(e);break;case"done":!function(t){h.initialize(t),h.dataDone(),y&&g(y)}(r);break;case"request":g(t.data);break;case"filter":h.addShowOnlyKeysFilter(i)}});n.default=null},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.multiBindToService=function(t){return function(n){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return e.forEach(function(e){return t.bind(e).toService(n)})}}}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(1),i=e(0),o=e(2);n.postConstruct=function(){return function(t,n,e){var a=new o.Metadata(i.POST_CONSTRUCT,n);if(Reflect.hasOwnMetadata(i.POST_CONSTRUCT,t.constructor))throw new Error(r.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(i.POST_CONSTRUCT,a,t.constructor)}}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(0),i=e(2),o=e(4);n.targetName=function(t){return function(n,e,a){var u=new i.Metadata(r.NAME_TAG,t);o.tagParameter(n,e,a,u)}}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(0),i=e(2),o=e(4);n.multiInject=function(t){return function(n,e,a){var u=new i.Metadata(r.MULTI_INJECT_TAG,t);"number"==typeof a?o.tagParameter(n,e,a,u):o.tagProperty(n,e,u)}}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(0),i=e(2),o=e(4);n.unmanaged=function(){return function(t,n,e){var a=new i.Metadata(r.UNMANAGED_TAG,!0);o.tagParameter(t,n,e,a)}}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(0),i=e(2),o=e(4);n.optional=function(){return function(t,n,e){var a=new i.Metadata(r.OPTIONAL_TAG,!0);"number"==typeof e?o.tagParameter(t,n,e,a):o.tagProperty(t,n,a)}}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(0),i=e(2),o=e(4);n.named=function(t){return function(n,e,a){var u=new i.Metadata(r.NAMED_TAG,t);"number"==typeof a?o.tagParameter(n,e,a,u):o.tagProperty(n,e,u)}}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(2),i=e(4);n.tagged=function(t,n){return function(e,o,a){var u=new r.Metadata(t,n);"number"==typeof a?i.tagParameter(e,o,a,u):i.tagProperty(e,o,u)}}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(1),i=e(0);n.injectable=function(){return function(t){if(Reflect.hasOwnMetadata(i.PARAM_TYPES,t))throw new Error(r.DUPLICATED_INJECTABLE_DECORATOR);var n=Reflect.getMetadata(i.DESIGN_PARAM_TYPES,t)||[];return Reflect.defineMetadata(i.PARAM_TYPES,n,t),t}}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(5),i=function(t){this.id=r.id(),this.registry=t};n.ContainerModule=i;var o=function(t){this.id=r.id(),this.registry=t};n.AsyncContainerModule=o},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(1),i=function(){function t(){this._map=new Map}return t.prototype.getMap=function(){return this._map},t.prototype.add=function(t,n){if(null==t)throw new Error(r.NULL_ARGUMENT);if(null==n)throw new Error(r.NULL_ARGUMENT);var e=this._map.get(t);void 0!==e?(e.push(n),this._map.set(t,e)):this._map.set(t,[n])},t.prototype.get=function(t){if(null==t)throw new Error(r.NULL_ARGUMENT);var n=this._map.get(t);if(void 0!==n)return n;throw new Error(r.KEY_NOT_FOUND)},t.prototype.remove=function(t){if(null==t)throw new Error(r.NULL_ARGUMENT);if(!this._map.delete(t))throw new Error(r.KEY_NOT_FOUND)},t.prototype.removeByCondition=function(t){var n=this;this._map.forEach(function(e,r){var i=e.filter(function(n){return!t(n)});i.length>0?n._map.set(r,i):n._map.delete(r)})},t.prototype.hasKey=function(t){if(null==t)throw new Error(r.NULL_ARGUMENT);return this._map.has(t)},t.prototype.clone=function(){var n=new t;return this._map.forEach(function(t,e){t.forEach(function(t){return n.add(e,t.clone())})}),n},t.prototype.traverse=function(t){this._map.forEach(function(n,e){t(e,n)})},t}();n.Lookup=i},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(){}return t.of=function(n,e){var r=new t;return r.bindings=n,r.middleware=e,r},t}();n.ContainerSnapshot=r},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(3),i=e(10),o=function(){function t(t){this._binding=t}return t.prototype.inRequestScope=function(){return this._binding.scope=r.BindingScopeEnum.Request,new i.BindingWhenOnSyntax(this._binding)},t.prototype.inSingletonScope=function(){return this._binding.scope=r.BindingScopeEnum.Singleton,new i.BindingWhenOnSyntax(this._binding)},t.prototype.inTransientScope=function(){return this._binding.scope=r.BindingScopeEnum.Transient,new i.BindingWhenOnSyntax(this._binding)},t}();n.BindingInSyntax=o},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(29),i=e(8),o=e(7),a=function(){function t(t){this._binding=t,this._bindingWhenSyntax=new o.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new i.BindingOnSyntax(this._binding),this._bindingInSyntax=new r.BindingInSyntax(t)}return t.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},t.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},t.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},t.prototype.when=function(t){return this._bindingWhenSyntax.when(t)},t.prototype.whenTargetNamed=function(t){return this._bindingWhenSyntax.whenTargetNamed(t)},t.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},t.prototype.whenTargetTagged=function(t,n){return this._bindingWhenSyntax.whenTargetTagged(t,n)},t.prototype.whenInjectedInto=function(t){return this._bindingWhenSyntax.whenInjectedInto(t)},t.prototype.whenParentNamed=function(t){return this._bindingWhenSyntax.whenParentNamed(t)},t.prototype.whenParentTagged=function(t,n){return this._bindingWhenSyntax.whenParentTagged(t,n)},t.prototype.whenAnyAncestorIs=function(t){return this._bindingWhenSyntax.whenAnyAncestorIs(t)},t.prototype.whenNoAncestorIs=function(t){return this._bindingWhenSyntax.whenNoAncestorIs(t)},t.prototype.whenAnyAncestorNamed=function(t){return this._bindingWhenSyntax.whenAnyAncestorNamed(t)},t.prototype.whenAnyAncestorTagged=function(t,n){return this._bindingWhenSyntax.whenAnyAncestorTagged(t,n)},t.prototype.whenNoAncestorNamed=function(t){return this._bindingWhenSyntax.whenNoAncestorNamed(t)},t.prototype.whenNoAncestorTagged=function(t,n){return this._bindingWhenSyntax.whenNoAncestorTagged(t,n)},t.prototype.whenAnyAncestorMatches=function(t){return this._bindingWhenSyntax.whenAnyAncestorMatches(t)},t.prototype.whenNoAncestorMatches=function(t){return this._bindingWhenSyntax.whenNoAncestorMatches(t)},t.prototype.onActivation=function(t){return this._bindingOnSyntax.onActivation(t)},t}();n.BindingInWhenOnSyntax=a},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(1),i=e(3),o=e(30),a=e(10),u=function(){function t(t){this._binding=t}return t.prototype.to=function(t){return this._binding.type=i.BindingTypeEnum.Instance,this._binding.implementationType=t,new o.BindingInWhenOnSyntax(this._binding)},t.prototype.toSelf=function(){if("function"!=typeof this._binding.serviceIdentifier)throw new Error(""+r.INVALID_TO_SELF_VALUE);var t=this._binding.serviceIdentifier;return this.to(t)},t.prototype.toConstantValue=function(t){return this._binding.type=i.BindingTypeEnum.ConstantValue,this._binding.cache=t,this._binding.dynamicValue=null,this._binding.implementationType=null,new a.BindingWhenOnSyntax(this._binding)},t.prototype.toDynamicValue=function(t){return this._binding.type=i.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=t,this._binding.implementationType=null,new o.BindingInWhenOnSyntax(this._binding)},t.prototype.toConstructor=function(t){return this._binding.type=i.BindingTypeEnum.Constructor,this._binding.implementationType=t,new a.BindingWhenOnSyntax(this._binding)},t.prototype.toFactory=function(t){return this._binding.type=i.BindingTypeEnum.Factory,this._binding.factory=t,new a.BindingWhenOnSyntax(this._binding)},t.prototype.toFunction=function(t){if("function"!=typeof t)throw new Error(r.INVALID_FUNCTION_BINDING);var n=this.toConstantValue(t);return this._binding.type=i.BindingTypeEnum.Function,n},t.prototype.toAutoFactory=function(t){return this._binding.type=i.BindingTypeEnum.Factory,this._binding.factory=function(n){return function(){return n.container.get(t)}},new a.BindingWhenOnSyntax(this._binding)},t.prototype.toProvider=function(t){return this._binding.type=i.BindingTypeEnum.Provider,this._binding.provider=t,new a.BindingWhenOnSyntax(this._binding)},t.prototype.toService=function(t){this.toDynamicValue(function(n){return n.container.get(t)})},t}();n.BindingToSyntax=u},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(1),i=e(3),o=e(0);n.resolveInstance=function(t,n,e){var a,u,s=null;if(n.length>0){var c=n.filter(function(t){return null!==t.target&&t.target.type===i.TargetTypeEnum.ConstructorArgument}).map(e);u=c,s=function(t,n,e){var r=n.filter(function(t){return null!==t.target&&t.target.type===i.TargetTypeEnum.ClassProperty}),o=r.map(e);return r.forEach(function(n,e){var r;r=n.target.name.value();var i=o[e];t[r]=i}),t}(s=new((a=t).bind.apply(a,[void 0].concat(u))),n,e)}else s=new t;return function(t,n){if(Reflect.hasMetadata(o.POST_CONSTRUCT,t)){var e=Reflect.getMetadata(o.POST_CONSTRUCT,t);try{n[e.value]()}catch(n){throw new Error(r.POST_CONSTRUCT_ERROR(t.name,n.message))}}}(t,s),s}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(1),i=e(3),o=e(13),a=e(6),u=e(32),s=function(t,n,e){try{return e()}catch(e){throw o.isStackOverflowExeption(e)?new Error(r.CIRCULAR_DEPENDENCY_IN_FACTORY(t,n.toString())):e}},c=function(t){return function(n){n.parentContext.setCurrentRequest(n);var e=n.bindings,o=n.childRequests,f=n.target&&n.target.isArray(),d=!(n.parentRequest&&n.parentRequest.target&&n.target&&n.parentRequest.target.matchesArray(n.target.serviceIdentifier));if(f&&d)return o.map(function(n){return c(t)(n)});var l=null;if(!n.target.isOptional()||0!==e.length){var h=e[0],p=h.scope===i.BindingScopeEnum.Singleton,y=h.scope===i.BindingScopeEnum.Request;if(p&&h.activated)return h.cache;if(y&&null!==t&&t.has(h.id))return t.get(h.id);if(h.type===i.BindingTypeEnum.ConstantValue)l=h.cache;else if(h.type===i.BindingTypeEnum.Function)l=h.cache;else if(h.type===i.BindingTypeEnum.Constructor)l=h.implementationType;else if(h.type===i.BindingTypeEnum.DynamicValue&&null!==h.dynamicValue)l=s("toDynamicValue",h.serviceIdentifier,function(){return h.dynamicValue(n.parentContext)});else if(h.type===i.BindingTypeEnum.Factory&&null!==h.factory)l=s("toFactory",h.serviceIdentifier,function(){return h.factory(n.parentContext)});else if(h.type===i.BindingTypeEnum.Provider&&null!==h.provider)l=s("toProvider",h.serviceIdentifier,function(){return h.provider(n.parentContext)});else{if(h.type!==i.BindingTypeEnum.Instance||null===h.implementationType){var g=a.getServiceIdentifierAsString(n.serviceIdentifier);throw new Error(r.INVALID_BINDING_TYPE+" "+g)}l=u.resolveInstance(h.implementationType,o,c(t))}return"function"==typeof h.onActivation&&(l=h.onActivation(n.parentContext,l)),p&&(h.cache=l,h.activated=!0),y&&null!==t&&!t.has(h.id)&&t.set(h.id,l),l}}};n.resolve=function(t){return c(t.plan.rootRequest.requestScope)(t.plan.rootRequest)}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(5),i=function(){function t(t,n,e,i,o){this.id=r.id(),this.serviceIdentifier=t,this.parentContext=n,this.parentRequest=e,this.target=o,this.childRequests=[],this.bindings=Array.isArray(i)?i:[i],this.requestScope=null===e?new Map:null}return t.prototype.addChildRequest=function(n,e,r){var i=new t(n,this.parentContext,this,e,r);return this.childRequests.push(i),i},t}();n.Request=i},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(t){this.str=t}return t.prototype.startsWith=function(t){return 0===this.str.indexOf(t)},t.prototype.endsWith=function(t){var n,e=t.split("").reverse().join("");return n=this.str.split("").reverse().join(""),this.startsWith.call({str:n},e)},t.prototype.contains=function(t){return-1!==this.str.indexOf(t)},t.prototype.equals=function(t){return this.str===t},t.prototype.value=function(){return this.str},t}();n.QueryableString=r},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(12),i=e(1),o=e(3),a=e(0),u=e(6);n.getFunctionName=u.getFunctionName;var s=e(11);function c(t,n,e,r){var a=t.getConstructorMetadata(e),u=a.compilerGeneratedMetadata;if(void 0===u){var c=i.MISSING_INJECTABLE_ANNOTATION+" "+n+".";throw new Error(c)}var l=a.userGeneratedMetadata,h=Object.keys(l),p=function(t,n,e,r,i){for(var o=[],a=0;a<i;a++){var u=f(a,t,n,e,r);null!==u&&o.push(u)}return o}(r,n,u,l,0===e.length&&h.length>0?h.length:e.length),y=function t(n,e){var r=n.getPropertiesMetadata(e);var i=[];var a=Object.keys(r);for(var u=0,c=a;u<c.length;u++){var f=c[u],l=r[f],h=d(r[f]),p=h.targetName||f,y=h.inject||h.multiInject,g=new s.Target(o.TargetTypeEnum.ClassProperty,p,y);g.metadata=l,i.push(g)}var _=Object.getPrototypeOf(e.prototype).constructor;if(_!==Object){var v=t(n,_);i=i.concat(v)}return i}(t,e);return p.concat(y)}function f(t,n,e,a,u){var c=u[t.toString()]||[],f=d(c),l=!0!==f.unmanaged,h=a[t],p=f.inject||f.multiInject;if((h=p||h)instanceof r.LazyServiceIdentifer&&(h=h.unwrap()),l){var y=h===Object,g=h===Function;if(!n&&(y||g||void 0===h)){var _=i.MISSING_INJECT_ANNOTATION+" argument "+t+" in class "+e+".";throw new Error(_)}var v=new s.Target(o.TargetTypeEnum.ConstructorArgument,f.targetName,h);return v.metadata=c,v}return null}function d(t){var n={};return t.forEach(function(t){n[t.key.toString()]=t.value}),{inject:n[a.INJECT_TAG],multiInject:n[a.MULTI_INJECT_TAG],targetName:n[a.NAME_TAG],unmanaged:n[a.UNMANAGED_TAG]}}n.getDependencies=function(t,n){return c(t,u.getFunctionName(n),n,!1)},n.getBaseClassDependencyCount=function t(n,e){var r=Object.getPrototypeOf(e.prototype).constructor;if(r!==Object){var i=c(n,u.getFunctionName(r),r,!0),o=i.map(function(t){return t.metadata.filter(function(t){return t.key===a.UNMANAGED_TAG})}),s=[].concat.apply([],o).length,f=i.length-s;return f>0?f:t(n,r)}return 0}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(t,n){this.parentContext=t,this.rootRequest=n};n.Plan=r},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(5),i=function(){function t(t){this.id=r.id(),this.container=t}return t.prototype.addPlan=function(t){this.plan=t},t.prototype.setCurrentRequest=function(t){this.currentRequest=t},t}();n.Context=i},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.BindingCount={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(39),i=e(1),o=e(3),a=e(0),u=e(13),s=e(6),c=e(38),f=e(2),d=e(37),l=e(36),h=e(34),p=e(11);function y(t){return t._bindingDictionary}function g(t,n,e,o,a){var u=_(e.container,a.serviceIdentifier),c=[];return u.length===r.BindingCount.NoBindingsAvailable&&e.container.options.autoBindInjectable&&"function"==typeof a.serviceIdentifier&&t.getConstructorMetadata(a.serviceIdentifier).compilerGeneratedMetadata&&(e.container.bind(a.serviceIdentifier).toSelf(),u=_(e.container,a.serviceIdentifier)),c=n?u:u.filter(function(t){var n=new h.Request(t.serviceIdentifier,e,o,t,a);return t.constraint(n)}),function(t,n,e,o){switch(n.length){case r.BindingCount.NoBindingsAvailable:if(e.isOptional())return n;var a=s.getServiceIdentifierAsString(t),u=i.NOT_REGISTERED;throw u+=s.listMetadataForTarget(a,e),u+=s.listRegisteredBindingsForServiceIdentifier(o,a,_),new Error(u);case r.BindingCount.OnlyOneBindingAvailable:if(!e.isArray())return n;case r.BindingCount.MultipleBindingsAvailable:default:if(e.isArray())return n;a=s.getServiceIdentifierAsString(t),u=i.AMBIGUOUS_MATCH+" "+a;throw u+=s.listRegisteredBindingsForServiceIdentifier(o,a,_),new Error(u)}}(a.serviceIdentifier,c,a,e.container),c}function _(t,n){var e=[],r=y(t);return r.hasKey(n)?e=r.get(n):null!==t.parent&&(e=_(t.parent,n)),e}n.getBindingDictionary=y,n.plan=function(t,n,e,r,y,_,v,T){void 0===T&&(T=!1);var m=new c.Context(n),b=function(t,n,e,r,i,o){var u=t?a.MULTI_INJECT_TAG:a.INJECT_TAG,s=new f.Metadata(u,e),c=new p.Target(n,r,e,s);if(void 0!==i){var d=new f.Metadata(i,o);c.metadata.push(d)}return c}(e,r,y,"",_,v);try{return function t(n,e,r,a,u,s){var c,f;if(null===u){c=g(n,e,a,null,s),f=new h.Request(r,a,null,c,s);var p=new d.Plan(a,f);a.addPlan(p)}else c=g(n,e,a,u,s),f=u.addChildRequest(s.serviceIdentifier,c,s);c.forEach(function(e){var r=null;if(s.isArray())r=f.addChildRequest(e.serviceIdentifier,e,s);else{if(e.cache)return;r=f}if(e.type===o.BindingTypeEnum.Instance&&null!==e.implementationType){var u=l.getDependencies(n,e.implementationType);if(!a.container.options.skipBaseClassChecks){var c=l.getBaseClassDependencyCount(n,e.implementationType);if(u.length<c){var d=i.ARGUMENTS_LENGTH_MISMATCH(l.getFunctionName(e.implementationType));throw new Error(d)}}u.forEach(function(e){t(n,!1,e.serviceIdentifier,a,r,e)})}})}(t,T,y,m,null,b),m}catch(t){throw u.isStackOverflowExeption(t)&&m.plan&&s.circularDependencyToException(m.plan.rootRequest),t}},n.createMockRequest=function(t,n,e,r){var i=new p.Target(o.TargetTypeEnum.Variable,"",n,new f.Metadata(e,r)),a=new c.Context(t);return new h.Request(n,a,null,[],i)}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(3),i=e(5),o=function(){function t(t,n){this.id=i.id(),this.activated=!1,this.serviceIdentifier=t,this.scope=n,this.type=r.BindingTypeEnum.Invalid,this.constraint=function(t){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return t.prototype.clone=function(){var n=new t(this.serviceIdentifier,this.scope);return n.activated=!1,n.implementationType=this.implementationType,n.dynamicValue=this.dynamicValue,n.scope=this.scope,n.type=this.type,n.factory=this.factory,n.provider=this.provider,n.constraint=this.constraint,n.onActivation=this.onActivation,n.cache=this.cache,n},t}();n.Binding=o},function(t,n,e){"use strict";var r=this&&this.__awaiter||function(t,n,e,r){return new(e||(e=Promise))(function(i,o){function a(t){try{s(r.next(t))}catch(t){o(t)}}function u(t){try{s(r.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new e(function(n){n(t.value)}).then(a,u)}s((r=r.apply(t,n||[])).next())})},i=this&&this.__generator||function(t,n){var e,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=n.call(t,a)}catch(t){o=[6,t],r=0}finally{e=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}};Object.defineProperty(n,"__esModule",{value:!0});var o=e(41),a=e(1),u=e(3),s=e(0),c=e(14),f=e(40),d=e(33),l=e(31),h=e(5),p=e(6),y=e(28),g=e(27),_=function(){function t(t){var n=t||{};if("object"!=typeof n)throw new Error(""+a.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(void 0===n.defaultScope)n.defaultScope=u.BindingScopeEnum.Transient;else if(n.defaultScope!==u.BindingScopeEnum.Singleton&&n.defaultScope!==u.BindingScopeEnum.Transient&&n.defaultScope!==u.BindingScopeEnum.Request)throw new Error(""+a.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(void 0===n.autoBindInjectable)n.autoBindInjectable=!1;else if("boolean"!=typeof n.autoBindInjectable)throw new Error(""+a.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(void 0===n.skipBaseClassChecks)n.skipBaseClassChecks=!1;else if("boolean"!=typeof n.skipBaseClassChecks)throw new Error(""+a.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:n.autoBindInjectable,defaultScope:n.defaultScope,skipBaseClassChecks:n.skipBaseClassChecks},this.id=h.id(),this._bindingDictionary=new g.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new c.MetadataReader}return t.merge=function(n,e){var r=new t,i=f.getBindingDictionary(r),o=f.getBindingDictionary(n),a=f.getBindingDictionary(e);function u(t,n){t.traverse(function(t,e){e.forEach(function(t){n.add(t.serviceIdentifier,t.clone())})})}return u(o,i),u(a,i),r},t.prototype.load=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var e=this._getContainerModuleHelpersFactory(),r=0,i=t;r<i.length;r++){var o=i[r],a=e(o.id);o.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction)}},t.prototype.loadAsync=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return r(this,void 0,void 0,function(){var n,e,r,o,a;return i(this,function(i){switch(i.label){case 0:n=this._getContainerModuleHelpersFactory(),e=0,r=t,i.label=1;case 1:return e<r.length?(o=r[e],a=n(o.id),[4,o.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction)]):[3,4];case 2:i.sent(),i.label=3;case 3:return e++,[3,1];case 4:return[2]}})})},t.prototype.unload=function(){for(var t=this,n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var r=function(t){return function(n){return n.moduleId===t}};n.forEach(function(n){var e=r(n.id);t._bindingDictionary.removeByCondition(e)})},t.prototype.bind=function(t){var n=this.options.defaultScope||u.BindingScopeEnum.Transient,e=new o.Binding(t,n);return this._bindingDictionary.add(t,e),new l.BindingToSyntax(e)},t.prototype.rebind=function(t){return this.unbind(t),this.bind(t)},t.prototype.unbind=function(t){try{this._bindingDictionary.remove(t)}catch(n){throw new Error(a.CANNOT_UNBIND+" "+p.getServiceIdentifierAsString(t))}},t.prototype.unbindAll=function(){this._bindingDictionary=new g.Lookup},t.prototype.isBound=function(t){var n=this._bindingDictionary.hasKey(t);return!n&&this.parent&&(n=this.parent.isBound(t)),n},t.prototype.isBoundNamed=function(t,n){return this.isBoundTagged(t,s.NAMED_TAG,n)},t.prototype.isBoundTagged=function(t,n,e){var r=!1;if(this._bindingDictionary.hasKey(t)){var i=this._bindingDictionary.get(t),o=f.createMockRequest(this,t,n,e);r=i.some(function(t){return t.constraint(o)})}return!r&&this.parent&&(r=this.parent.isBoundTagged(t,n,e)),r},t.prototype.snapshot=function(){this._snapshots.push(y.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},t.prototype.restore=function(){var t=this._snapshots.pop();if(void 0===t)throw new Error(a.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=t.bindings,this._middleware=t.middleware},t.prototype.createChild=function(n){var e=new t(n||this.options);return e.parent=this,e},t.prototype.applyMiddleware=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var e=this._middleware?this._middleware:this._planAndResolve();this._middleware=t.reduce(function(t,n){return n(t)},e)},t.prototype.applyCustomMetadataReader=function(t){this._metadataReader=t},t.prototype.get=function(t){return this._get(!1,!1,u.TargetTypeEnum.Variable,t)},t.prototype.getTagged=function(t,n,e){return this._get(!1,!1,u.TargetTypeEnum.Variable,t,n,e)},t.prototype.getNamed=function(t,n){return this.getTagged(t,s.NAMED_TAG,n)},t.prototype.getAll=function(t){return this._get(!0,!0,u.TargetTypeEnum.Variable,t)},t.prototype.getAllTagged=function(t,n,e){return this._get(!1,!0,u.TargetTypeEnum.Variable,t,n,e)},t.prototype.getAllNamed=function(t,n){return this.getAllTagged(t,s.NAMED_TAG,n)},t.prototype.resolve=function(t){var n=this.createChild();return n.bind(t).toSelf(),n.get(t)},t.prototype._getContainerModuleHelpersFactory=function(){var t=this,n=function(t,n){t._binding.moduleId=n},e=function(e){return function(r){var i=t.rebind.bind(t)(r);return n(i,e),i}};return function(r){return{bindFunction:(i=r,function(e){var r=t.bind.bind(t)(e);return n(r,i),r}),isboundFunction:function(n){return t.isBound.bind(t)(n)},rebindFunction:e(r),unbindFunction:function(n){t.unbind.bind(t)(n)}};var i}},t.prototype._get=function(t,n,e,r,i,o){var u=null,s={avoidConstraints:t,contextInterceptor:function(t){return t},isMultiInject:n,key:i,serviceIdentifier:r,targetType:e,value:o};if(this._middleware){if(null==(u=this._middleware(s)))throw new Error(a.INVALID_MIDDLEWARE_RETURN)}else u=this._planAndResolve()(s);return u},t.prototype._planAndResolve=function(){var t=this;return function(n){var e=f.plan(t._metadataReader,t,n.isMultiInject,n.targetType,n.serviceIdentifier,n.key,n.value,n.avoidConstraints);return e=n.contextInterceptor(e),d.resolve(e)}},t}();n.Container=_},function(t,n){var e;e=function(){return this}();try{e=e||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(e=window)}t.exports=e},function(t,n){var e,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function u(t){if(e===setTimeout)return setTimeout(t,0);if((e===o||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(n){try{return e.call(null,t,0)}catch(n){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:o}catch(t){e=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var s,c=[],f=!1,d=-1;function l(){f&&s&&(f=!1,s.length?c=s.concat(c):d=-1,c.length&&h())}function h(){if(!f){var t=u(l);f=!0;for(var n=c.length;n;){for(s=c,c=[];++d<n;)s&&s[d].run();d=-1,n=c.length}s=null,f=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(n){try{return r.call(null,t)}catch(n){return r.call(this,t)}}}(t)}}function p(t,n){this.fun=t,this.array=n}function y(){}i.nextTick=function(t){var n=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)n[e-1]=arguments[e];c.push(new p(t,n)),1!==c.length||f||u(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=y,i.addListener=y,i.once=y,i.off=y,i.removeListener=y,i.removeAllListeners=y,i.emit=y,i.prependListener=y,i.prependOnceListener=y,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,n,e){(function(t,n){\n/*! *****************************************************************************\nCopyright (C) Microsoft. All rights reserved.\nLicensed under the Apache License, Version 2.0 (the "License"); you may not use\nthis file except in compliance with the License. You may obtain a copy of the\nLicense at http://www.apache.org/licenses/LICENSE-2.0\n\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\nMERCHANTABLITY OR NON-INFRINGEMENT.\n\nSee the Apache Version 2.0 License for specific language governing permissions\nand limitations under the License.\n***************************************************************************** */\nvar e;!function(e){!function(r){var i="object"==typeof n?n:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),o=a(e);function a(t,n){return function(e,r){"function"!=typeof t[e]&&Object.defineProperty(t,e,{configurable:!0,writable:!0,value:r}),n&&n(e,r)}}void 0===i.Reflect?i.Reflect=e:o=a(i.Reflect,o),function(n){var e=Object.prototype.hasOwnProperty,r="function"==typeof Symbol,i=r&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",o=r&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",a="function"==typeof Object.create,u={__proto__:[]}instanceof Array,s=!a&&!u,c={create:a?function(){return D(Object.create(null))}:u?function(){return D({__proto__:null})}:function(){return D({})},has:s?function(t,n){return e.call(t,n)}:function(t,n){return n in t},get:s?function(t,n){return e.call(t,n)?t[n]:void 0}:function(t,n){return t[n]}},f=Object.getPrototypeOf(Function),d="object"==typeof t&&t.env&&"true"===t.env.REFLECT_METADATA_USE_MAP_POLYFILL,l=d||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function(){var t={},n=[],e=function(){function t(t,n,e){this._index=0,this._keys=t,this._values=n,this._selector=e}return t.prototype["@@iterator"]=function(){return this},t.prototype[o]=function(){return this},t.prototype.next=function(){var t=this._index;if(t>=0&&t<this._keys.length){var e=this._selector(this._keys[t],this._values[t]);return t+1>=this._keys.length?(this._index=-1,this._keys=n,this._values=n):this._index++,{value:e,done:!1}}return{value:void 0,done:!0}},t.prototype.throw=function(t){throw this._index>=0&&(this._index=-1,this._keys=n,this._values=n),t},t.prototype.return=function(t){return this._index>=0&&(this._index=-1,this._keys=n,this._values=n),{value:t,done:!0}},t}();return function(){function n(){this._keys=[],this._values=[],this._cacheKey=t,this._cacheIndex=-2}return Object.defineProperty(n.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),n.prototype.has=function(t){return this._find(t,!1)>=0},n.prototype.get=function(t){var n=this._find(t,!1);return n>=0?this._values[n]:void 0},n.prototype.set=function(t,n){var e=this._find(t,!0);return this._values[e]=n,this},n.prototype.delete=function(n){var e=this._find(n,!1);if(e>=0){for(var r=this._keys.length,i=e+1;i<r;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,n===this._cacheKey&&(this._cacheKey=t,this._cacheIndex=-2),!0}return!1},n.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=t,this._cacheIndex=-2},n.prototype.keys=function(){return new e(this._keys,this._values,r)},n.prototype.values=function(){return new e(this._keys,this._values,i)},n.prototype.entries=function(){return new e(this._keys,this._values,a)},n.prototype["@@iterator"]=function(){return this.entries()},n.prototype[o]=function(){return this.entries()},n.prototype._find=function(t,n){return this._cacheKey!==t&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=t)),this._cacheIndex<0&&n&&(this._cacheIndex=this._keys.length,this._keys.push(t),this._values.push(void 0)),this._cacheIndex},n}();function r(t,n){return t}function i(t,n){return n}function a(t,n){return[t,n]}}():Map,h=d||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function(){function t(){this._map=new l}return Object.defineProperty(t.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),t.prototype.has=function(t){return this._map.has(t)},t.prototype.add=function(t){return this._map.set(t,t),this},t.prototype.delete=function(t){return this._map.delete(t)},t.prototype.clear=function(){this._map.clear()},t.prototype.keys=function(){return this._map.keys()},t.prototype.values=function(){return this._map.values()},t.prototype.entries=function(){return this._map.entries()},t.prototype["@@iterator"]=function(){return this.keys()},t.prototype[o]=function(){return this.keys()},t}():Set,p=new(d||"function"!=typeof WeakMap?function(){var t=16,n=c.create(),r=i();return function(){function t(){this._key=i()}return t.prototype.has=function(t){var n=o(t,!1);return void 0!==n&&c.has(n,this._key)},t.prototype.get=function(t){var n=o(t,!1);return void 0!==n?c.get(n,this._key):void 0},t.prototype.set=function(t,n){return o(t,!0)[this._key]=n,this},t.prototype.delete=function(t){var n=o(t,!1);return void 0!==n&&delete n[this._key]},t.prototype.clear=function(){this._key=i()},t}();function i(){var t;do{t="@@WeakMap@@"+u()}while(c.has(n,t));return n[t]=!0,t}function o(t,n){if(!e.call(t,r)){if(!n)return;Object.defineProperty(t,r,{value:c.create()})}return t[r]}function a(t,n){for(var e=0;e<n;++e)t[e]=255*Math.random()|0;return t}function u(){var n,e=(n=t,"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(n)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(n)):a(new Uint8Array(n),n):a(new Array(n),n));e[6]=79&e[6]|64,e[8]=191&e[8]|128;for(var r="",i=0;i<t;++i){var o=e[i];4!==i&&6!==i&&8!==i||(r+="-"),o<16&&(r+="0"),r+=o.toString(16).toLowerCase()}return r}}():WeakMap);function y(t,n,e){var r=p.get(t);if(b(r)){if(!e)return;r=new l,p.set(t,r)}var i=r.get(n);if(b(i)){if(!e)return;i=new l,r.set(n,i)}return i}function g(t,n,e){var r=y(n,e,!1);return!b(r)&&!!r.has(t)}function _(t,n,e){var r=y(n,e,!1);if(!b(r))return r.get(t)}function v(t,n,e,r){y(e,r,!0).set(t,n)}function T(t,n){var e=[],r=y(t,n,!1);if(b(r))return e;for(var i=function(t){var n=M(t,o);if(!I(n))throw new TypeError;var e=n.call(t);if(!w(e))throw new TypeError;return e}(r.keys()),a=0;;){var u=C(i);if(!u)return e.length=a,e;var s=u.value;try{e[a]=s}catch(t){try{P(i)}finally{throw t}}a++}}function m(t){if(null===t)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}function b(t){return void 0===t}function A(t){return null===t}function w(t){return"object"==typeof t?null!==t:"function"==typeof t}function E(t,n){switch(m(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}var e=3===n?"string":5===n?"number":"default",r=M(t,i);if(void 0!==r){var o=r.call(t,e);if(w(o))throw new TypeError;return o}return function(t,n){if("string"===n){var e=t.toString;if(I(e))if(!w(i=e.call(t)))return i;if(I(r=t.valueOf))if(!w(i=r.call(t)))return i}else{var r;if(I(r=t.valueOf))if(!w(i=r.call(t)))return i;var i,o=t.toString;if(I(o))if(!w(i=o.call(t)))return i}throw new TypeError}(t,"default"===e?"number":e)}function N(t){var n=E(t,3);return"symbol"==typeof n?n:function(t){return""+t}(n)}function S(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:"[object Array]"===Object.prototype.toString.call(t)}function I(t){return"function"==typeof t}function O(t){return"function"==typeof t}function M(t,n){var e=t[n];if(null!=e){if(!I(e))throw new TypeError;return e}}function C(t){var n=t.next();return!n.done&&n}function P(t){var n=t.return;n&&n.call(t)}function R(t){var n=Object.getPrototypeOf(t);if("function"!=typeof t||t===f)return n;if(n!==f)return n;var e=t.prototype,r=e&&Object.getPrototypeOf(e);if(null==r||r===Object.prototype)return n;var i=r.constructor;return"function"!=typeof i?n:i===t?n:i}function D(t){return t.__=void 0,delete t.__,t}n("decorate",function(t,n,e,r){if(b(e)){if(!S(t))throw new TypeError;if(!O(n))throw new TypeError;return function(t,n){for(var e=t.length-1;e>=0;--e){var r=(0,t[e])(n);if(!b(r)&&!A(r)){if(!O(r))throw new TypeError;n=r}}return n}(t,n)}if(!S(t))throw new TypeError;if(!w(n))throw new TypeError;if(!w(r)&&!b(r)&&!A(r))throw new TypeError;return A(r)&&(r=void 0),function(t,n,e,r){for(var i=t.length-1;i>=0;--i){var o=(0,t[i])(n,e,r);if(!b(o)&&!A(o)){if(!w(o))throw new TypeError;r=o}}return r}(t,n,e=N(e),r)}),n("metadata",function(t,n){return function(e,r){if(!w(e))throw new TypeError;if(!b(r)&&!function(t){switch(m(t)){case 3:case 4:return!0;default:return!1}}(r))throw new TypeError;v(t,n,e,r)}}),n("defineMetadata",function(t,n,e,r){if(!w(e))throw new TypeError;return b(r)||(r=N(r)),v(t,n,e,r)}),n("hasMetadata",function(t,n,e){if(!w(n))throw new TypeError;return b(e)||(e=N(e)),function t(n,e,r){var i=g(n,e,r);if(i)return!0;var o=R(e);if(!A(o))return t(n,o,r);return!1}(t,n,e)}),n("hasOwnMetadata",function(t,n,e){if(!w(n))throw new TypeError;return b(e)||(e=N(e)),g(t,n,e)}),n("getMetadata",function(t,n,e){if(!w(n))throw new TypeError;return b(e)||(e=N(e)),function t(n,e,r){var i=g(n,e,r);if(i)return _(n,e,r);var o=R(e);if(!A(o))return t(n,o,r);return}(t,n,e)}),n("getOwnMetadata",function(t,n,e){if(!w(n))throw new TypeError;return b(e)||(e=N(e)),_(t,n,e)}),n("getMetadataKeys",function(t,n){if(!w(t))throw new TypeError;return b(n)||(n=N(n)),function t(n,e){var r=T(n,e);var i=R(n);if(null===i)return r;var o=t(i,e);if(o.length<=0)return r;if(r.length<=0)return o;var a=new h;var u=[];for(var s=0,c=r;s<c.length;s++){var f=c[s];a.has(f)||(a.add(f),u.push(f))}for(var d=0,l=o;d<l.length;d++){f=l[d];a.has(f)||(a.add(f),u.push(f))}return u}(t,n)}),n("getOwnMetadataKeys",function(t,n){if(!w(t))throw new TypeError;return b(n)||(n=N(n)),T(t,n)}),n("deleteMetadata",function(t,n,e){if(!w(n))throw new TypeError;b(e)||(e=N(e));var r=y(n,e,!1);if(b(r))return!1;if(!r.delete(t))return!1;if(r.size>0)return!0;var i=p.get(n);return i.delete(e),i.size>0||(p.delete(n),!0)})}(o)}()}(e||(e={}))}).call(this,e(44),e(43))}]);',null)}},function(t,e,n){var i,r,o;
/* @license
Papa Parse
v4.6.2
https://github.com/mholt/PapaParse
License: MIT
*/Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),r=[],void 0===(o="function"==typeof(i=function(){"use strict";var t,e,n="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n?n:{},i=!n.document&&!!n.postMessage,r=i&&/(\?|&)papaworker(=|&|$)/.test(n.location.search),o=!1,s={},a=0,c={parse:function(e,i){var r=(i=i||{}).dynamicTyping||!1;if(E(r)&&(i.dynamicTypingFunction=r,r={}),i.dynamicTyping=r,i.transform=!!E(i.transform)&&i.transform,i.worker&&c.WORKERS_SUPPORTED){var l=function(){if(!c.WORKERS_SUPPORTED)return!1;if(!o&&null===c.SCRIPT_PATH)throw new Error("Script path cannot be determined automatically when Papa Parse is loaded asynchronously. You need to set Papa.SCRIPT_PATH manually.");var e=c.SCRIPT_PATH||t;e+=(-1!==e.indexOf("?")?"&":"?")+"papaworker";var i=new n.Worker(e);return i.onmessage=y,i.id=a++,s[i.id]=i}();return l.userStep=i.step,l.userChunk=i.chunk,l.userComplete=i.complete,l.userError=i.error,i.step=E(i.step),i.chunk=E(i.chunk),i.complete=E(i.complete),i.error=E(i.error),delete i.worker,void l.postMessage({input:e,config:i,workerId:l.id})}var u=null;return c.NODE_STREAM_INPUT,"string"==typeof e?u=i.download?new h(i):new f(i):!0===e.readable&&E(e.read)&&E(e.on)?u=new p(i):(n.File&&e instanceof File||e instanceof Object)&&(u=new d(i)),u.stream(e)},unparse:function(t,e){var n=!1,i=!0,r=",",o="\r\n",s='"',a=!1;"object"==typeof e&&("string"!=typeof e.delimiter||c.BAD_DELIMITERS.filter(function(t){return-1!==e.delimiter.indexOf(t)}).length||(r=e.delimiter),("boolean"==typeof e.quotes||Array.isArray(e.quotes))&&(n=e.quotes),"boolean"!=typeof e.skipEmptyLines&&"string"!=typeof e.skipEmptyLines||(a=e.skipEmptyLines),"string"==typeof e.newline&&(o=e.newline),"string"==typeof e.quoteChar&&(s=e.quoteChar),"boolean"==typeof e.header&&(i=e.header));var l=new RegExp(s,"g");if("string"==typeof t&&(t=JSON.parse(t)),Array.isArray(t)){if(!t.length||Array.isArray(t[0]))return h(null,t,a);if("object"==typeof t[0])return h(u(t[0]),t,a)}else if("object"==typeof t)return"string"==typeof t.data&&(t.data=JSON.parse(t.data)),Array.isArray(t.data)&&(t.fields||(t.fields=t.meta&&t.meta.fields),t.fields||(t.fields=Array.isArray(t.data[0])?t.fields:u(t.data[0])),Array.isArray(t.data[0])||"object"==typeof t.data[0]||(t.data=[t.data])),h(t.fields||[],t.data||[],a);throw"exception: Unable to serialize unrecognized input";function u(t){if("object"!=typeof t)return[];var e=[];for(var n in t)e.push(n);return e}function h(t,e,n){var s="";"string"==typeof t&&(t=JSON.parse(t)),"string"==typeof e&&(e=JSON.parse(e));var a=Array.isArray(t)&&0<t.length,c=!Array.isArray(e[0]);if(a&&i){for(var l=0;l<t.length;l++)0<l&&(s+=r),s+=d(t[l],l);0<e.length&&(s+=o)}for(var u=0;u<e.length;u++){var h=a?t.length:e[u].length,f=!1,p=a?0===Object.keys(e[u]).length:0===e[u].length;if(n&&!a&&(f="greedy"===n?""===e[u].join("").trim():1===e[u].length&&0===e[u][0].length),"greedy"===n&&a){for(var g=[],_=0;_<h;_++){var m=c?t[_]:_;g.push(e[u][m])}f=""===g.join("").trim()}if(!f){for(var y=0;y<h;y++){0<y&&!p&&(s+=r);var v=a&&c?t[y]:y;s+=d(e[u][v],y)}u<e.length-1&&(!n||0<h&&!p)&&(s+=o)}}return s}function d(t,e){return null==t?"":t.constructor===Date?JSON.stringify(t).slice(1,25):(t=t.toString().replace(l,s+s),"boolean"==typeof n&&n||Array.isArray(n)&&n[e]||function(t,e){for(var n=0;n<e.length;n++)if(-1<t.indexOf(e[n]))return!0;return!1}(t,c.BAD_DELIMITERS)||-1<t.indexOf(r)||" "===t.charAt(0)||" "===t.charAt(t.length-1)?s+t+s:t)}}};if(c.RECORD_SEP=String.fromCharCode(30),c.UNIT_SEP=String.fromCharCode(31),c.BYTE_ORDER_MARK="\ufeff",c.BAD_DELIMITERS=["\r","\n",'"',c.BYTE_ORDER_MARK],c.WORKERS_SUPPORTED=!i&&!!n.Worker,c.SCRIPT_PATH=null,c.NODE_STREAM_INPUT=1,c.LocalChunkSize=10485760,c.RemoteChunkSize=5242880,c.DefaultDelimiter=",",c.Parser=m,c.ParserHandle=g,c.NetworkStreamer=h,c.FileStreamer=d,c.StringStreamer=f,c.ReadableStreamStreamer=p,n.jQuery){var l=n.jQuery;l.fn.parse=function(t){var e=t.config||{},i=[];return this.each(function(t){if("INPUT"!==l(this).prop("tagName").toUpperCase()||"file"!==l(this).attr("type").toLowerCase()||!n.FileReader||!this.files||0===this.files.length)return!0;for(var r=0;r<this.files.length;r++)i.push({file:this.files[r],inputElem:this,instanceConfig:l.extend({},e)})}),r(),this;function r(){if(0!==i.length){var e,n,r,s=i[0];if(E(t.before)){var a=t.before(s.file,s.inputElem);if("object"==typeof a){if("abort"===a.action)return e=s.file,n=s.inputElem,r=a.reason,void(E(t.error)&&t.error({name:"AbortError"},e,n,r));if("skip"===a.action)return void o();"object"==typeof a.config&&(s.instanceConfig=l.extend(s.instanceConfig,a.config))}else if("skip"===a)return void o()}var u=s.instanceConfig.complete;s.instanceConfig.complete=function(t){E(u)&&u(t,s.file,s.inputElem),o()},c.parse(s.file,s.instanceConfig)}else E(t.complete)&&t.complete()}function o(){i.splice(0,1),r()}}}function u(t){this._handle=null,this._finished=!1,this._completed=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(t){var e=C(t);e.chunkSize=parseInt(e.chunkSize),t.step||t.chunk||(e.chunkSize=null),this._handle=new g(e),(this._handle.streamer=this)._config=e}.call(this,t),this.parseChunk=function(t,e){if(this.isFirstChunk&&E(this._config.beforeFirstChunk)){var i=this._config.beforeFirstChunk(t);void 0!==i&&(t=i)}this.isFirstChunk=!1;var o=this._partialLine+t;this._partialLine="";var s=this._handle.parse(o,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var a=s.meta.cursor;this._finished||(this._partialLine=o.substring(a-this._baseIndex),this._baseIndex=a),s&&s.data&&(this._rowCount+=s.data.length);var l=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(r)n.postMessage({results:s,workerId:c.WORKER_ID,finished:l});else if(E(this._config.chunk)&&!e){if(this._config.chunk(s,this._handle),this._handle.paused()||this._handle.aborted())return;s=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(s.data),this._completeResults.errors=this._completeResults.errors.concat(s.errors),this._completeResults.meta=s.meta),this._completed||!l||!E(this._config.complete)||s&&s.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),l||s&&s.meta.paused||this._nextChunk(),s}},this._sendError=function(t){E(this._config.error)?this._config.error(t):r&&this._config.error&&n.postMessage({workerId:c.WORKER_ID,error:t,finished:!1})}}function h(t){var e;(t=t||{}).chunkSize||(t.chunkSize=c.RemoteChunkSize),u.call(this,t),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(t){this._input=t,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(e=new XMLHttpRequest,this._config.withCredentials&&(e.withCredentials=this._config.withCredentials),i||(e.onload=w(this._chunkLoaded,this),e.onerror=w(this._chunkError,this)),e.open("GET",this._input,!i),this._config.downloadRequestHeaders){var t=this._config.downloadRequestHeaders;for(var n in t)e.setRequestHeader(n,t[n])}if(this._config.chunkSize){var r=this._start+this._config.chunkSize-1;e.setRequestHeader("Range","bytes="+this._start+"-"+r),e.setRequestHeader("If-None-Match","webkit-no-cache")}try{e.send()}catch(t){this._chunkError(t.message)}i&&0===e.status?this._chunkError():this._start+=this._config.chunkSize}},this._chunkLoaded=function(){var t;4===e.readyState&&(e.status<200||400<=e.status?this._chunkError():(this._finished=!this._config.chunkSize||this._start>(null===(t=e.getResponseHeader("Content-Range"))?-1:parseInt(t.substr(t.lastIndexOf("/")+1))),this.parseChunk(e.responseText)))},this._chunkError=function(t){var n=e.statusText||t;this._sendError(new Error(n))}}function d(t){var e,n;(t=t||{}).chunkSize||(t.chunkSize=c.LocalChunkSize),u.call(this,t);var i="undefined"!=typeof FileReader;this.stream=function(t){this._input=t,n=t.slice||t.webkitSlice||t.mozSlice,i?((e=new FileReader).onload=w(this._chunkLoaded,this),e.onerror=w(this._chunkError,this)):e=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var t=this._input;if(this._config.chunkSize){var r=Math.min(this._start+this._config.chunkSize,this._input.size);t=n.call(t,this._start,r)}var o=e.readAsText(t,this._config.encoding);i||this._chunkLoaded({target:{result:o}})},this._chunkLoaded=function(t){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(t.target.result)},this._chunkError=function(){this._sendError(e.error)}}function f(t){var e;u.call(this,t=t||{}),this.stream=function(t){return e=t,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var t=this._config.chunkSize,n=t?e.substr(0,t):e;return e=t?e.substr(t):"",this._finished=!e,this.parseChunk(n)}}}function p(t){u.call(this,t=t||{});var e=[],n=!0,i=!1;this.pause=function(){u.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){u.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(t){this._input=t,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){i&&1===e.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),e.length?this.parseChunk(e.shift()):n=!0},this._streamData=w(function(t){try{e.push("string"==typeof t?t:t.toString(this._config.encoding)),n&&(n=!1,this._checkIsFinished(),this.parseChunk(e.shift()))}catch(t){this._streamError(t)}},this),this._streamError=w(function(t){this._streamCleanUp(),this._sendError(t)},this),this._streamEnd=w(function(){this._streamCleanUp(),i=!0,this._streamData("")},this),this._streamCleanUp=w(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function g(t){var e,n,i,r=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,o=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,s=this,a=0,l=0,u=!1,h=!1,d=[],f={data:[],errors:[],meta:{}};if(E(t.step)){var p=t.step;t.step=function(e){if(f=e,v())y();else{if(y(),0===f.data.length)return;a+=e.data.length,t.preview&&a>t.preview?n.abort():p(f,s)}}}function g(e){return"greedy"===t.skipEmptyLines?""===e.join("").trim():1===e.length&&0===e[0].length}function y(){if(f&&i&&(w("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+c.DefaultDelimiter+"'"),i=!1),t.skipEmptyLines)for(var e=0;e<f.data.length;e++)g(f.data[e])&&f.data.splice(e--,1);return v()&&function(){if(f){for(var e=0;v()&&e<f.data.length;e++)for(var n=0;n<f.data[e].length;n++){var i=f.data[e][n];t.trimHeaders&&(i=i.trim()),d.push(i)}f.data.splice(0,1)}}(),function(){if(!f||!t.header&&!t.dynamicTyping&&!t.transform)return f;for(var e=0;e<f.data.length;e++){var n,i=t.header?{}:[];for(n=0;n<f.data[e].length;n++){var r=n,o=f.data[e][n];t.header&&(r=n>=d.length?"__parsed_extra":d[n]),t.transform&&(o=t.transform(o,r)),o=b(r,o),"__parsed_extra"===r?(i[r]=i[r]||[],i[r].push(o)):i[r]=o}f.data[e]=i,t.header&&(n>d.length?w("FieldMismatch","TooManyFields","Too many fields: expected "+d.length+" fields but parsed "+n,l+e):n<d.length&&w("FieldMismatch","TooFewFields","Too few fields: expected "+d.length+" fields but parsed "+n,l+e))}return t.header&&f.meta&&(f.meta.fields=d),l+=f.data.length,f}()}function v(){return t.header&&0===d.length}function b(e,n){return i=e,t.dynamicTypingFunction&&void 0===t.dynamicTyping[i]&&(t.dynamicTyping[i]=t.dynamicTypingFunction(i)),!0===(t.dynamicTyping[i]||t.dynamicTyping)?"true"===n||"TRUE"===n||"false"!==n&&"FALSE"!==n&&(r.test(n)?parseFloat(n):o.test(n)?new Date(n):""===n?null:n):n;var i}function w(t,e,n,i){f.errors.push({type:t,code:e,message:n,row:i})}this.parse=function(r,o,s){var a=t.quoteChar||'"';if(t.newline||(t.newline=function(t,e){t=t.substr(0,1048576);var n=new RegExp(_(e)+"([^]*?)"+_(e),"gm"),i=(t=t.replace(n,"")).split("\r"),r=t.split("\n"),o=1<r.length&&r[0].length<i[0].length;if(1===i.length||o)return"\n";for(var s=0,a=0;a<i.length;a++)"\n"===i[a][0]&&s++;return s>=i.length/2?"\r\n":"\r"}(r,a)),i=!1,t.delimiter)E(t.delimiter)&&(t.delimiter=t.delimiter(r),f.meta.delimiter=t.delimiter);else{var l=function(e,n,i,r){for(var o,s,a,l=[",","\t","|",";",c.RECORD_SEP,c.UNIT_SEP],u=0;u<l.length;u++){var h=l[u],d=0,f=0,p=0;a=void 0;for(var _=new m({comments:r,delimiter:h,newline:n,preview:10}).parse(e),y=0;y<_.data.length;y++)if(i&&g(_.data[y]))p++;else{var v=_.data[y].length;f+=v,void 0!==a?1<v&&(d+=Math.abs(v-a),a=v):a=v}0<_.data.length&&(f/=_.data.length-p),(void 0===s||d<s)&&1.99<f&&(s=d,o=h)}return{successful:!!(t.delimiter=o),bestDelimiter:o}}(r,t.newline,t.skipEmptyLines,t.comments);l.successful?t.delimiter=l.bestDelimiter:(i=!0,t.delimiter=c.DefaultDelimiter),f.meta.delimiter=t.delimiter}var h=C(t);return t.preview&&t.header&&h.preview++,e=r,n=new m(h),f=n.parse(e,o,s),y(),u?{meta:{paused:!0}}:f||{meta:{paused:!1}}},this.paused=function(){return u},this.pause=function(){u=!0,n.abort(),e=e.substr(n.getCharIndex())},this.resume=function(){u=!1,s.streamer.parseChunk(e,!0)},this.aborted=function(){return h},this.abort=function(){h=!0,n.abort(),f.meta.aborted=!0,E(t.complete)&&t.complete(f),e=""}}function _(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function m(t){var e,n=(t=t||{}).delimiter,i=t.newline,r=t.comments,o=t.step,s=t.preview,a=t.fastMode,l=e=void 0===t.quoteChar?'"':t.quoteChar;if(void 0!==t.escapeChar&&(l=t.escapeChar),("string"!=typeof n||-1<c.BAD_DELIMITERS.indexOf(n))&&(n=","),r===n)throw"Comment character same as delimiter";!0===r?r="#":("string"!=typeof r||-1<c.BAD_DELIMITERS.indexOf(r))&&(r=!1),"\n"!==i&&"\r"!==i&&"\r\n"!==i&&(i="\n");var u=0,h=!1;this.parse=function(t,c,d){if("string"!=typeof t)throw"Input must be a string";var f=t.length,p=n.length,g=i.length,_=r.length,m=E(o),y=[],v=[],b=[],C=u=0;if(!t)return k();if(a||!1!==a&&-1===t.indexOf(e)){for(var w=t.split(i),T=0;T<w.length;T++){if(b=w[T],u+=b.length,T!==w.length-1)u+=i.length;else if(d)return k();if(!r||b.substr(0,_)!==r){if(m){if(y=[],M(b.split(n)),F(),h)return k()}else M(b.split(n));if(s&&s<=T)return y=y.slice(0,s),k(!0)}}return k()}for(var S,x=t.indexOf(n,u),R=t.indexOf(i,u),A=new RegExp(l.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&")+e,"g");;)if(t[u]!==e)if(r&&0===b.length&&t.substr(u,_)===r){if(-1===R)return k();u=R+g,R=t.indexOf(i,u),x=t.indexOf(n,u)}else if(-1!==x&&(x<R||-1===R))b.push(t.substring(u,x)),u=x+p,x=t.indexOf(n,u);else{if(-1===R)break;if(b.push(t.substring(u,R)),D(R+g),m&&(F(),h))return k();if(s&&y.length>=s)return k(!0)}else for(S=u,u++;;){if(-1===(S=t.indexOf(e,S+1)))return d||v.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:y.length,index:u}),L();if(S===f-1)return L(t.substring(u,S).replace(A,e));if(e!==l||t[S+1]!==l){if(e===l||0===S||t[S-1]!==l){var O=P(-1===R?x:Math.min(x,R));if(t[S+1+O]===n){b.push(t.substring(u,S).replace(A,e)),u=S+1+O+p,x=t.indexOf(n,u),R=t.indexOf(i,u);break}var I=P(R);if(t.substr(S+1+I,g)===i){if(b.push(t.substring(u,S).replace(A,e)),D(S+1+I+g),x=t.indexOf(n,u),m&&(F(),h))return k();if(s&&y.length>=s)return k(!0);break}v.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:y.length,index:u}),S++}}else S++}return L();function M(t){y.push(t),C=u}function P(e){var n=0;if(-1!==e){var i=t.substring(S+1,e);i&&""===i.trim()&&(n=i.length)}return n}function L(e){return d||(void 0===e&&(e=t.substr(u)),b.push(e),u=f,M(b),m&&F()),k()}function D(e){u=e,M(b),b=[],R=t.indexOf(i,u)}function k(t){return{data:y,errors:v,meta:{delimiter:n,linebreak:i,aborted:h,truncated:!!t,cursor:C+(c||0)}}}function F(){o(k()),y=[],v=[]}},this.abort=function(){h=!0},this.getCharIndex=function(){return u}}function y(t){var e=t.data,n=s[e.workerId],i=!1;if(e.error)n.userError(e.error,e.file);else if(e.results&&e.results.data){var r={abort:function(){i=!0,v(e.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:b,resume:b};if(E(n.userStep)){for(var o=0;o<e.results.data.length&&(n.userStep({data:[e.results.data[o]],errors:e.results.errors,meta:e.results.meta},r),!i);o++);delete e.results}else E(n.userChunk)&&(n.userChunk(e.results,r,e.file),delete e.results)}e.finished&&!i&&v(e.workerId,e.results)}function v(t,e){var n=s[t];E(n.userComplete)&&n.userComplete(e),n.terminate(),delete s[t]}function b(){throw"Not implemented."}function C(t){if("object"!=typeof t||null===t)return t;var e=Array.isArray(t)?[]:{};for(var n in t)e[n]=C(t[n]);return e}function w(t,e){return function(){t.apply(e,arguments)}}function E(t){return"function"==typeof t}return r?n.onmessage=function(t){var e=t.data;if(void 0===c.WORKER_ID&&e&&(c.WORKER_ID=e.workerId),"string"==typeof e.input)n.postMessage({workerId:c.WORKER_ID,results:c.parse(e.input,e.config),finished:!0});else if(n.File&&e.input instanceof File||e.input instanceof Object){var i=c.parse(e.input,e.config);i&&n.postMessage({workerId:c.WORKER_ID,results:i,finished:!0})}}:c.WORKERS_SUPPORTED&&(e=document.getElementsByTagName("script"),t=e.length?e[e.length-1].src:"",document.body?document.addEventListener("DOMContentLoaded",function(){o=!0},!0):o=!0),(h.prototype=Object.create(u.prototype)).constructor=h,(d.prototype=Object.create(u.prototype)).constructor=d,(f.prototype=Object.create(f.prototype)).constructor=f,(p.prototype=Object.create(u.prototype)).constructor=p,c})?i.apply(e,r):i)||(t.exports=o)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(68),r=n(67),o=[],s=function(){function t(t){this.$$observationTargets=[],this.$$activeTargets=[],this.$$skippedTargets=[];var e=function(t){if(void 0===t)return"Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.";if("function"!=typeof t)return"Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function."}(t);if(e)throw TypeError(e);this.$$callback=t,o.push(this)}return t.prototype.observe=function(t){var e=a("observe",t);if(e)throw TypeError(e);c(this.$$observationTargets,t)>0||(this.$$observationTargets.push(new i.ResizeObservation(t)),p())},t.prototype.unobserve=function(t){var e=a("unobserve",t);if(e)throw TypeError(e);var n=c(this.$$observationTargets,t);n<0||(this.$$observationTargets.splice(n,1),_())},t.prototype.disconnect=function(){this.$$observationTargets=[],this.$$activeTargets=[]},t}();function a(t,e){return void 0===e?"Failed to execute '"+t+"' on 'ResizeObserver': 1 argument required, but only 0 present.":e instanceof window.Element?void 0:"Failed to execute '"+t+"' on 'ResizeObserver': parameter 1 is not of type 'Element'."}function c(t,e){for(var n=0;n<t.length;n+=1)if(t[n].target===e)return n;return-1}e.ResizeObserver=s;var l,u=function(t){o.forEach(function(e){e.$$activeTargets=[],e.$$skippedTargets=[],e.$$observationTargets.forEach(function(n){n.isActive()&&(d(n.target)>t?e.$$activeTargets.push(n):e.$$skippedTargets.push(n))})})},h=function(){var t=1/0;return o.forEach(function(e){if(e.$$activeTargets.length){var n=[];e.$$activeTargets.forEach(function(e){var i=new r.ResizeObserverEntry(e.target);n.push(i),e.$$broadcastWidth=i.contentRect.width,e.$$broadcastHeight=i.contentRect.height;var o=d(e.target);o<t&&(t=o)}),e.$$callback(n,e),e.$$activeTargets=[]}}),t},d=function(t){for(var e=0;t.parentNode;)t=t.parentNode,e+=1;return e},f=function(){var t,e=0;for(u(e);o.some(function(t){return!!t.$$activeTargets.length});)e=h(),u(e);o.some(function(t){return!!t.$$skippedTargets.length})&&(t=new window.ErrorEvent("ResizeLoopError",{message:"ResizeObserver loop completed with undelivered notifications."}),window.dispatchEvent(t))},p=function(){l||g()},g=function(){l=window.requestAnimationFrame(function(){f(),g()})},_=function(){l&&!o.some(function(t){return!!t.$$observationTargets.length})&&(window.cancelAnimationFrame(l),l=void 0)};e.install=function(){return window.ResizeObserver=s}},function(t,e,n){var i,r,o;r=[n(4),n(5)],void 0===(o="function"==typeof(i=function(t){return t.ui.plugin={add:function(e,n,i){var r,o=t.ui[e].prototype;for(r in i)o.plugins[r]=o.plugins[r]||[],o.plugins[r].push([n,i[r]])},call:function(t,e,n,i){var r,o=t.plugins[e];if(o&&(i||t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType))for(r=0;r<o.length;r++)t.options[o[r][0]]&&o[r][1].apply(t.element,n)}}})?i.apply(e,r):i)||(t.exports=o)},,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(25),r=n(40),o=function(){function t(t){this._binding=t}return t.prototype.when=function(t){return this._binding.constraint=t,new i.BindingOnSyntax(this._binding)},t.prototype.whenTargetNamed=function(t){return this._binding.constraint=r.namedConstraint(t),new i.BindingOnSyntax(this._binding)},t.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(t){return null!==t.target&&!t.target.isNamed()&&!t.target.isTagged()},new i.BindingOnSyntax(this._binding)},t.prototype.whenTargetTagged=function(t,e){return this._binding.constraint=r.taggedConstraint(t)(e),new i.BindingOnSyntax(this._binding)},t.prototype.whenInjectedInto=function(t){return this._binding.constraint=function(e){return r.typeConstraint(t)(e.parentRequest)},new i.BindingOnSyntax(this._binding)},t.prototype.whenParentNamed=function(t){return this._binding.constraint=function(e){return r.namedConstraint(t)(e.parentRequest)},new i.BindingOnSyntax(this._binding)},t.prototype.whenParentTagged=function(t,e){return this._binding.constraint=function(n){return r.taggedConstraint(t)(e)(n.parentRequest)},new i.BindingOnSyntax(this._binding)},t.prototype.whenAnyAncestorIs=function(t){return this._binding.constraint=function(e){return r.traverseAncerstors(e,r.typeConstraint(t))},new i.BindingOnSyntax(this._binding)},t.prototype.whenNoAncestorIs=function(t){return this._binding.constraint=function(e){return!r.traverseAncerstors(e,r.typeConstraint(t))},new i.BindingOnSyntax(this._binding)},t.prototype.whenAnyAncestorNamed=function(t){return this._binding.constraint=function(e){return r.traverseAncerstors(e,r.namedConstraint(t))},new i.BindingOnSyntax(this._binding)},t.prototype.whenNoAncestorNamed=function(t){return this._binding.constraint=function(e){return!r.traverseAncerstors(e,r.namedConstraint(t))},new i.BindingOnSyntax(this._binding)},t.prototype.whenAnyAncestorTagged=function(t,e){return this._binding.constraint=function(n){return r.traverseAncerstors(n,r.taggedConstraint(t)(e))},new i.BindingOnSyntax(this._binding)},t.prototype.whenNoAncestorTagged=function(t,e){return this._binding.constraint=function(n){return!r.traverseAncerstors(n,r.taggedConstraint(t)(e))},new i.BindingOnSyntax(this._binding)},t.prototype.whenAnyAncestorMatches=function(t){return this._binding.constraint=function(e){return r.traverseAncerstors(e,t)},new i.BindingOnSyntax(this._binding)},t.prototype.whenNoAncestorMatches=function(t){return this._binding.constraint=function(e){return!r.traverseAncerstors(e,t)},new i.BindingOnSyntax(this._binding)},t}();e.BindingWhenSyntax=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(24),r=function(){function t(t){this._binding=t}return t.prototype.onActivation=function(t){return this._binding.onActivation=t,new i.BindingWhenSyntax(this._binding)},t}();e.BindingOnSyntax=r},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){var i,r,o;
/**
 * gridstack.js 0.3.0
 * http://troolee.github.io/gridstack.js/
 * (c) 2014-2016 Pavel Reznikov, Dylan Weiss
 * gridstack.js may be freely distributed under the MIT license.
 * @preserve
*/r=[n(4),n(65)],void 0===(o="function"==typeof(i=function(t,e){var n=window,i=function(t,e,n){var i=function(){return console.warn("gridstack.js: Function `"+e+"` is deprecated as of v0.2.5 and has been replaced with `"+n+"`. It will be **completely** removed in v1.0."),t.apply(this,arguments)};return i.prototype=t.prototype,i},r=function(t,e){console.warn("gridstack.js: Option `"+t+"` is deprecated as of v0.2.5 and has been replaced with `"+e+"`. It will be **completely** removed in v1.0.")},o={isIntercepted:function(t,e){return!(t.x+t.width<=e.x||e.x+e.width<=t.x||t.y+t.height<=e.y||e.y+e.height<=t.y)},sort:function(t,n,i){return i=i||e.chain(t).map(function(t){return t.x+t.width}).max().value(),n=-1!=n?1:-1,e.sortBy(t,function(t){return n*(t.x+t.y*i)})},createStylesheet:function(t){var e=document.createElement("style");return e.setAttribute("type","text/css"),e.setAttribute("data-gs-style-id",t),e.styleSheet?e.styleSheet.cssText="":e.appendChild(document.createTextNode("")),document.getElementsByTagName("head")[0].appendChild(e),e.sheet},removeStylesheet:function(e){t("STYLE[data-gs-style-id="+e+"]").remove()},insertCSSRule:function(t,e,n,i){"function"==typeof t.insertRule?t.insertRule(e+"{"+n+"}",i):"function"==typeof t.addRule&&t.addRule(e,n,i)},toBool:function(t){return"boolean"==typeof t?t:"string"==typeof t?!(""===(t=t.toLowerCase())||"no"==t||"false"==t||"0"==t):Boolean(t)},_collisionNodeCheck:function(t){return t!=this.node&&o.isIntercepted(t,this.nn)},_didCollide:function(t){return o.isIntercepted({x:this.n.x,y:this.newY,width:this.n.width,height:this.n.height},t)},_isAddNodeIntercepted:function(t){return o.isIntercepted({x:this.x,y:this.y,width:this.node.width,height:this.node.height},t)},parseHeight:function(t){var n=t,i="px";if(n&&e.isString(n)){var r=n.match(/^(-[0-9]+\.[0-9]+|[0-9]*\.[0-9]+|-[0-9]+|[0-9]+)(px|em|rem|vh|vw)?$/);if(!r)throw new Error("Invalid height");i=r[2]||"px",n=parseFloat(r[1])}return{height:n,unit:i}}};function s(t){this.grid=t}o.is_intercepted=i(o.isIntercepted,"is_intercepted","isIntercepted"),o.create_stylesheet=i(o.createStylesheet,"create_stylesheet","createStylesheet"),o.remove_stylesheet=i(o.removeStylesheet,"remove_stylesheet","removeStylesheet"),o.insert_css_rule=i(o.insertCSSRule,"insert_css_rule","insertCSSRule"),s.registeredPlugins=[],s.registerPlugin=function(t){s.registeredPlugins.push(t)},s.prototype.resizable=function(t,e){return this},s.prototype.draggable=function(t,e){return this},s.prototype.droppable=function(t,e){return this},s.prototype.isDroppable=function(t){return!1},s.prototype.on=function(t,e,n){return this};var a=0,c=function(t,e,n,i,r){this.width=t,this.float=n||!1,this.height=i||0,this.nodes=r||[],this.onchange=e||function(){},this._updateCounter=0,this._float=this.float,this._addedNodes=[],this._removedNodes=[]};c.prototype.batchUpdate=function(){this._updateCounter=1,this.float=!0},c.prototype.commit=function(){0!==this._updateCounter&&(this._updateCounter=0,this.float=this._float,this._packNodes(),this._notify())},c.prototype.getNodeDataByDOMEl=function(t){return e.find(this.nodes,function(e){return t.get(0)===e.el.get(0)})},c.prototype._fixCollisions=function(t){this._sortNodes(-1);var n=t,i=Boolean(e.find(this.nodes,function(t){return t.locked}));for(this.float||i||(n={x:0,y:t.y,width:this.width,height:t.height});;){var r=e.find(this.nodes,e.bind(o._collisionNodeCheck,{node:t,nn:n}));if(void 0===r)return;this.moveNode(r,r.x,t.y+t.height,r.width,r.height,!0)}},c.prototype.isAreaEmpty=function(t,n,i,r){var s={x:t||0,y:n||0,width:i||1,height:r||1},a=e.find(this.nodes,e.bind(function(t){return o.isIntercepted(t,s)},this));return null==a},c.prototype._sortNodes=function(t){this.nodes=o.sort(this.nodes,t,this.width)},c.prototype._packNodes=function(){this._sortNodes(),this.float?e.each(this.nodes,e.bind(function(t,n){if(!t._updating&&void 0!==t._origY&&t.y!=t._origY)for(var i=t.y;i>=t._origY;)e.chain(this.nodes).find(e.bind(o._didCollide,{n:t,newY:i})).value()||(t._dirty=!0,t.y=i),--i},this)):e.each(this.nodes,e.bind(function(t,n){if(!t.locked)for(;t.y>0;){var i=t.y-1,r=0===n;if(n>0&&(r=void 0===e.chain(this.nodes).take(n).find(e.bind(o._didCollide,{n:t,newY:i})).value()),!r)break;t._dirty=t.y!=i,t.y=i}},this))},c.prototype._prepareNode=function(t,n){return(t=e.defaults(t||{},{width:1,height:1,x:0,y:0})).x=parseInt(""+t.x),t.y=parseInt(""+t.y),t.width=parseInt(""+t.width),t.height=parseInt(""+t.height),t.autoPosition=t.autoPosition||!1,t.noResize=t.noResize||!1,t.noMove=t.noMove||!1,t.width>this.width?t.width=this.width:t.width<1&&(t.width=1),t.height<1&&(t.height=1),t.x<0&&(t.x=0),t.x+t.width>this.width&&(n?t.width=this.width-t.x:t.x=this.width-t.width),t.y<0&&(t.y=0),t},c.prototype._notify=function(){var t=Array.prototype.slice.call(arguments,0);if(t[0]=void 0===t[0]?[]:[t[0]],t[1]=void 0===t[1]||t[1],!this._updateCounter){var e=t[0].concat(this.getDirtyNodes());this.onchange(e,t[1])}},c.prototype.cleanNodes=function(){this._updateCounter||e.each(this.nodes,function(t){t._dirty=!1})},c.prototype.getDirtyNodes=function(){return e.filter(this.nodes,function(t){return t._dirty})},c.prototype.addNode=function(t,n){if(void 0!==(t=this._prepareNode(t)).maxWidth&&(t.width=Math.min(t.width,t.maxWidth)),void 0!==t.maxHeight&&(t.height=Math.min(t.height,t.maxHeight)),void 0!==t.minWidth&&(t.width=Math.max(t.width,t.minWidth)),void 0!==t.minHeight&&(t.height=Math.max(t.height,t.minHeight)),t._id=++a,t._dirty=!0,t.autoPosition){this._sortNodes();for(var i=0;;++i){var r=i%this.width,s=Math.floor(i/this.width);if(!(r+t.width>this.width||e.find(this.nodes,e.bind(o._isAddNodeIntercepted,{x:r,y:s,node:t})))){t.x=r,t.y=s;break}}}return this.nodes.push(t),void 0!==n&&n&&this._addedNodes.push(e.clone(t)),this._fixCollisions(t),this._packNodes(),this._notify(),t},c.prototype.removeNode=function(t,n){n=void 0===n||n,this._removedNodes.push(e.clone(t)),t._id=null,this.nodes=e.without(this.nodes,t),this._packNodes(),this._notify(t,n)},c.prototype.canMoveNode=function(n,i,r,o,s){if(!this.isNodeChangedPosition(n,i,r,o,s))return!1;var a,l=Boolean(e.find(this.nodes,function(t){return t.locked}));if(!this.height&&!l)return!0;var u=new c(this.width,null,this.float,0,e.map(this.nodes,function(e){return e==n?a=t.extend({},e):t.extend({},e)}));if(void 0===a)return!0;u.moveNode(a,i,r,o,s);var h=!0;return l&&(h&=!Boolean(e.find(u.nodes,function(t){return t!=a&&Boolean(t.locked)&&Boolean(t._dirty)}))),this.height&&(h&=u.getGridHeight()<=this.height),h},c.prototype.canBePlacedWithRespectToHeight=function(n){if(!this.height)return!0;var i=new c(this.width,null,this.float,0,e.map(this.nodes,function(e){return t.extend({},e)}));return i.addNode(n),i.getGridHeight()<=this.height},c.prototype.isNodeChangedPosition=function(t,e,n,i,r){return"number"!=typeof e&&(e=t.x),"number"!=typeof n&&(n=t.y),"number"!=typeof i&&(i=t.width),"number"!=typeof r&&(r=t.height),void 0!==t.maxWidth&&(i=Math.min(i,t.maxWidth)),void 0!==t.maxHeight&&(r=Math.min(r,t.maxHeight)),void 0!==t.minWidth&&(i=Math.max(i,t.minWidth)),void 0!==t.minHeight&&(r=Math.max(r,t.minHeight)),t.x!=e||t.y!=n||t.width!=i||t.height!=r},c.prototype.moveNode=function(t,e,n,i,r,o){if(!this.isNodeChangedPosition(t,e,n,i,r))return t;if("number"!=typeof e&&(e=t.x),"number"!=typeof n&&(n=t.y),"number"!=typeof i&&(i=t.width),"number"!=typeof r&&(r=t.height),void 0!==t.maxWidth&&(i=Math.min(i,t.maxWidth)),void 0!==t.maxHeight&&(r=Math.min(r,t.maxHeight)),void 0!==t.minWidth&&(i=Math.max(i,t.minWidth)),void 0!==t.minHeight&&(r=Math.max(r,t.minHeight)),t.x==e&&t.y==n&&t.width==i&&t.height==r)return t;var s=t.width!=i;return t._dirty=!0,t.x=e,t.y=n,t.width=i,t.height=r,t.lastTriedX=e,t.lastTriedY=n,t.lastTriedWidth=i,t.lastTriedHeight=r,t=this._prepareNode(t,s),this._fixCollisions(t),o||(this._packNodes(),this._notify()),t},c.prototype.getGridHeight=function(){return e.reduce(this.nodes,function(t,e){return Math.max(t,e.y+e.height)},0)},c.prototype.beginUpdate=function(t){e.each(this.nodes,function(t){t._origY=t.y}),t._updating=!0},c.prototype.endUpdate=function(){e.each(this.nodes,function(t){t._origY=t.y});var t=e.find(this.nodes,function(t){return t._updating});t&&(t._updating=!1)};var l=function(n,i){var o,a,l=this;i=i||{},this.container=t(n),void 0!==i.handle_class&&(i.handleClass=i.handle_class,r("handle_class","handleClass")),void 0!==i.item_class&&(i.itemClass=i.item_class,r("item_class","itemClass")),void 0!==i.placeholder_class&&(i.placeholderClass=i.placeholder_class,r("placeholder_class","placeholderClass")),void 0!==i.placeholder_text&&(i.placeholderText=i.placeholder_text,r("placeholder_text","placeholderText")),void 0!==i.cell_height&&(i.cellHeight=i.cell_height,r("cell_height","cellHeight")),void 0!==i.vertical_margin&&(i.verticalMargin=i.vertical_margin,r("vertical_margin","verticalMargin")),void 0!==i.min_width&&(i.minWidth=i.min_width,r("min_width","minWidth")),void 0!==i.static_grid&&(i.staticGrid=i.static_grid,r("static_grid","staticGrid")),void 0!==i.is_nested&&(i.isNested=i.is_nested,r("is_nested","isNested")),void 0!==i.always_show_resize_handle&&(i.alwaysShowResizeHandle=i.always_show_resize_handle,r("always_show_resize_handle","alwaysShowResizeHandle")),i.itemClass=i.itemClass||"grid-stack-item";var u=this.container.closest("."+i.itemClass).length>0;if(this.opts=e.defaults(i||{},{width:parseInt(this.container.attr("data-gs-width"))||12,height:parseInt(this.container.attr("data-gs-height"))||0,itemClass:"grid-stack-item",placeholderClass:"grid-stack-placeholder",placeholderText:"",handle:".grid-stack-item-content",handleClass:null,cellHeight:60,verticalMargin:20,auto:!0,minWidth:768,float:!1,staticGrid:!1,_class:"grid-stack-instance-"+(1e4*Math.random()).toFixed(0),animate:Boolean(this.container.attr("data-gs-animate"))||!1,alwaysShowResizeHandle:i.alwaysShowResizeHandle||!1,resizable:e.defaults(i.resizable||{},{autoHide:!i.alwaysShowResizeHandle,handles:"se"}),draggable:e.defaults(i.draggable||{},{handle:(i.handleClass?"."+i.handleClass:i.handle?i.handle:"")||".grid-stack-item-content",scroll:!1,appendTo:"body"}),disableDrag:i.disableDrag||!1,disableResize:i.disableResize||!1,rtl:"auto",removable:!1,removeTimeout:2e3,verticalMarginUnit:"px",cellHeightUnit:"px",disableOneColumnMode:i.disableOneColumnMode||!1,oneColumnModeClass:i.oneColumnModeClass||"grid-stack-one-column-mode",ddPlugin:null}),!1===this.opts.ddPlugin?this.opts.ddPlugin=s:null===this.opts.ddPlugin&&(this.opts.ddPlugin=e.first(s.registeredPlugins)||s),this.dd=new this.opts.ddPlugin(this),"auto"===this.opts.rtl&&(this.opts.rtl="rtl"===this.container.css("direction")),this.opts.rtl&&this.container.addClass("grid-stack-rtl"),this.opts.isNested=u,(a="auto"===this.opts.cellHeight)?l.cellHeight(l.cellWidth(),!0):this.cellHeight(this.opts.cellHeight,!0),this.verticalMargin(this.opts.verticalMargin,!0),this.container.addClass(this.opts._class),this._setStaticClass(),u&&this.container.addClass("grid-stack-nested"),this._initStyles(),this.grid=new c(this.opts.width,function(t,n){n=void 0===n||n;var i=0;e.each(t,function(t){n&&null===t._id?t.el&&t.el.remove():(t.el.attr("data-gs-x",t.x).attr("data-gs-y",t.y).attr("data-gs-width",t.width).attr("data-gs-height",t.height),i=Math.max(i,t.y+t.height))}),l._updateStyles(i+10)},this.opts.float,this.opts.height),this.opts.auto){var h=[],d=this;this.container.children("."+this.opts.itemClass+":not(."+this.opts.placeholderClass+")").each(function(e,n){n=t(n),h.push({el:n,i:parseInt(n.attr("data-gs-x"))+parseInt(n.attr("data-gs-y"))*d.opts.width})}),e.chain(h).sortBy(function(t){return t.i}).each(function(t){l._prepareElement(t.el)}).value()}if(this.setAnimation(this.opts.animate),this.placeholder=t('<div class="'+this.opts.placeholderClass+" "+this.opts.itemClass+'"><div class="placeholder-content">'+this.opts.placeholderText+"</div></div>").hide(),this._updateContainerHeight(),this._updateHeightsOnResize=e.throttle(function(){l.cellHeight(l.cellWidth(),!1)},100),this.onResizeHandler=function(){if(a&&l._updateHeightsOnResize(),l._isOneColumnMode()&&!l.opts.disableOneColumnMode){if(o)return;l.container.addClass(l.opts.oneColumnModeClass),o=!0,l.grid._sortNodes(),e.each(l.grid.nodes,function(t){l.container.append(t.el),l.opts.staticGrid||(l.dd.draggable(t.el,"disable"),l.dd.resizable(t.el,"disable"),t.el.trigger("resize"))})}else{if(!o)return;if(l.container.removeClass(l.opts.oneColumnModeClass),o=!1,l.opts.staticGrid)return;e.each(l.grid.nodes,function(t){t.noMove||l.opts.disableDrag||l.dd.draggable(t.el,"enable"),t.noResize||l.opts.disableResize||l.dd.resizable(t.el,"enable"),t.el.trigger("resize")})}},t(window).resize(this.onResizeHandler),this.onResizeHandler(),!l.opts.staticGrid&&"string"==typeof l.opts.removable){var f=t(l.opts.removable);this.dd.isDroppable(f)||this.dd.droppable(f,{accept:"."+l.opts.itemClass}),this.dd.on(f,"dropover",function(e,n){var i=t(n.draggable);i.data("_gridstack_node")._grid===l&&l._setupRemovingTimeout(i)}).on(f,"dropout",function(e,n){var i=t(n.draggable);i.data("_gridstack_node")._grid===l&&l._clearRemovingTimeout(i)})}if(!l.opts.staticGrid&&l.opts.acceptWidgets){var p=null,g=function(t,e){var n=p,i=n.data("_gridstack_node"),r=l.getCellFromPixel(e.offset,!0),o=Math.max(0,r.x),s=Math.max(0,r.y);if(i._added){if(!l.grid.canMoveNode(i,o,s))return;l.grid.moveNode(i,o,s),l._updateContainerHeight()}else i._added=!0,i.el=n,i.x=o,i.y=s,l.grid.cleanNodes(),l.grid.beginUpdate(i),l.grid.addNode(i),l.container.append(l.placeholder),l.placeholder.attr("data-gs-x",i.x).attr("data-gs-y",i.y).attr("data-gs-width",i.width).attr("data-gs-height",i.height).show(),i.el=l.placeholder,i._beforeDragX=i.x,i._beforeDragY=i.y,l._updateContainerHeight()};this.dd.droppable(l.container,{accept:function(e){var n=(e=t(e)).data("_gridstack_node");return(!n||n._grid!==l)&&e.is(!0===l.opts.acceptWidgets?".grid-stack-item":l.opts.acceptWidgets)}}).on(l.container,"dropover",function(e,n){l.container.offset();var i=t(n.draggable),r=l.cellWidth(),o=l.cellHeight(),s=i.data("_gridstack_node"),a=s?s.width:Math.ceil(i.outerWidth()/r),c=s?s.height:Math.ceil(i.outerHeight()/o);p=i;var u=l.grid._prepareNode({width:a,height:c,_added:!1,_temporary:!0});i.data("_gridstack_node",u),i.data("_gridstack_node_orig",s),i.on("drag",g)}).on(l.container,"dropout",function(e,n){var i=t(n.draggable);i.unbind("drag",g);var r=i.data("_gridstack_node");r.el=null,l.grid.removeNode(r),l.placeholder.detach(),l._updateContainerHeight(),i.data("_gridstack_node",i.data("_gridstack_node_orig"))}).on(l.container,"drop",function(e,n){l.placeholder.detach();var i=t(n.draggable).data("_gridstack_node");i._grid=l;var r=t(n.draggable).clone(!1);r.data("_gridstack_node",i);var o=t(n.draggable).data("_gridstack_node_orig");void 0!==o&&o._grid._triggerRemoveEvent(),t(n.draggable).remove(),i.el=r,l.placeholder.hide(),r.attr("data-gs-x",i.x).attr("data-gs-y",i.y).attr("data-gs-width",i.width).attr("data-gs-height",i.height).addClass(l.opts.itemClass).removeAttr("style").enableSelection().removeData("draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled").unbind("drag",g),l.container.append(r),l._prepareElementsByNode(r,i),l._updateContainerHeight(),l.grid._addedNodes.push(i),l._triggerAddEvent(),l._triggerChangeEvent(),l.grid.endUpdate()})}};return l.prototype._triggerChangeEvent=function(t){var e=this.grid.getDirtyNodes(),n=!1,i=[];e&&e.length&&(i.push(e),n=!0),(n||!0===t)&&this.container.trigger("change",i)},l.prototype._triggerAddEvent=function(){this.grid._addedNodes&&this.grid._addedNodes.length>0&&(this.container.trigger("added",[e.map(this.grid._addedNodes,e.clone)]),this.grid._addedNodes=[])},l.prototype._triggerRemoveEvent=function(){this.grid._removedNodes&&this.grid._removedNodes.length>0&&(this.container.trigger("removed",[e.map(this.grid._removedNodes,e.clone)]),this.grid._removedNodes=[])},l.prototype._initStyles=function(){this._stylesId&&o.removeStylesheet(this._stylesId),this._stylesId="gridstack-style-"+(1e5*Math.random()).toFixed(),this._styles=o.createStylesheet(this._stylesId),null!==this._styles&&(this._styles._max=0)},l.prototype._updateStyles=function(t){if(null!==this._styles&&void 0!==this._styles){var e,n="."+this.opts._class+" ."+this.opts.itemClass,i=this;if(void 0===t&&(t=this._styles._max),this._initStyles(),this._updateContainerHeight(),this.opts.cellHeight&&!(0!==this._styles._max&&t<=this._styles._max)&&(e=this.opts.verticalMargin&&this.opts.cellHeightUnit!==this.opts.verticalMarginUnit?function(t,e){return t&&e?"calc("+(i.opts.cellHeight*t+i.opts.cellHeightUnit)+" + "+(i.opts.verticalMargin*e+i.opts.verticalMarginUnit)+")":i.opts.cellHeight*t+i.opts.verticalMargin*e+i.opts.cellHeightUnit}:function(t,e){return i.opts.cellHeight*t+i.opts.verticalMargin*e+i.opts.cellHeightUnit},0===this._styles._max&&o.insertCSSRule(this._styles,n,"min-height: "+e(1,0)+";",0),t>this._styles._max)){for(var r=this._styles._max;r<t;++r)o.insertCSSRule(this._styles,n+'[data-gs-height="'+(r+1)+'"]',"height: "+e(r+1,r)+";",r),o.insertCSSRule(this._styles,n+'[data-gs-min-height="'+(r+1)+'"]',"min-height: "+e(r+1,r)+";",r),o.insertCSSRule(this._styles,n+'[data-gs-max-height="'+(r+1)+'"]',"max-height: "+e(r+1,r)+";",r),o.insertCSSRule(this._styles,n+'[data-gs-y="'+r+'"]',"top: "+e(r,r)+";",r);this._styles._max=t}}},l.prototype._updateContainerHeight=function(){if(!this.grid._updateCounter){var t=this.grid.getGridHeight();this.container.attr("data-gs-current-height",t),this.opts.cellHeight&&(this.opts.verticalMargin?this.opts.cellHeightUnit===this.opts.verticalMarginUnit?this.container.css("height",t*(this.opts.cellHeight+this.opts.verticalMargin)-this.opts.verticalMargin+this.opts.cellHeightUnit):this.container.css("height","calc("+(t*this.opts.cellHeight+this.opts.cellHeightUnit)+" + "+(t*(this.opts.verticalMargin-1)+this.opts.verticalMarginUnit)+")"):this.container.css("height",t*this.opts.cellHeight+this.opts.cellHeightUnit))}},l.prototype._isOneColumnMode=function(){return(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)<=this.opts.minWidth},l.prototype._setupRemovingTimeout=function(e){var n=t(e).data("_gridstack_node");!n._removeTimeout&&this.opts.removable&&(n._removeTimeout=setTimeout(function(){e.addClass("grid-stack-item-removing"),n._isAboutToRemove=!0},this.opts.removeTimeout))},l.prototype._clearRemovingTimeout=function(e){var n=t(e).data("_gridstack_node");n._removeTimeout&&(clearTimeout(n._removeTimeout),n._removeTimeout=null,e.removeClass("grid-stack-item-removing"),n._isAboutToRemove=!1)},l.prototype._prepareElementsByNode=function(e,n){var i,r,o=this,s=function(t,s){var a,c,l=Math.round(s.position.left/i),u=Math.floor((s.position.top+r/2)/r);if("drag"!=t.type&&(a=Math.round(s.size.width/i),c=Math.round(s.size.height/r)),"drag"==t.type)l<0||l>=o.grid.width||u<0||!o.grid.float&&u>o.grid.getGridHeight()?n._temporaryRemoved||(!0===o.opts.removable&&o._setupRemovingTimeout(e),l=n._beforeDragX,u=n._beforeDragY,o.placeholder.detach(),o.placeholder.hide(),o.grid.removeNode(n),o._updateContainerHeight(),n._temporaryRemoved=!0):(o._clearRemovingTimeout(e),n._temporaryRemoved&&(o.grid.addNode(n),o.placeholder.attr("data-gs-x",l).attr("data-gs-y",u).attr("data-gs-width",a).attr("data-gs-height",c).show(),o.container.append(o.placeholder),n.el=o.placeholder,n._temporaryRemoved=!1));else if("resize"==t.type&&l<0)return;var h=void 0!==a?a:n.lastTriedWidth,d=void 0!==c?c:n.lastTriedHeight;!o.grid.canMoveNode(n,l,u,a,c)||n.lastTriedX===l&&n.lastTriedY===u&&n.lastTriedWidth===h&&n.lastTriedHeight===d||(n.lastTriedX=l,n.lastTriedY=u,n.lastTriedWidth=a,n.lastTriedHeight=c,o.grid.moveNode(n,l,u,a,c),o._updateContainerHeight())},a=function(s,a){o.container.append(o.placeholder);var c=t(this);o.grid.cleanNodes(),o.grid.beginUpdate(n),i=o.cellWidth();var l=Math.ceil(c.outerHeight()/c.attr("data-gs-height"));r=o.container.height()/parseInt(o.container.attr("data-gs-current-height")),o.placeholder.attr("data-gs-x",c.attr("data-gs-x")).attr("data-gs-y",c.attr("data-gs-y")).attr("data-gs-width",c.attr("data-gs-width")).attr("data-gs-height",c.attr("data-gs-height")).show(),n.el=o.placeholder,n._beforeDragX=n.x,n._beforeDragY=n.y,o.dd.resizable(e,"option","minWidth",i*(n.minWidth||1)),o.dd.resizable(e,"option","minHeight",l*(n.minHeight||1)),"resizestart"==s.type&&c.find(".grid-stack-item").trigger("resizestart")},c=function(i,r){var s=t(this);if(s.data("_gridstack_node")){var a=!1;o.placeholder.detach(),n.el=s,o.placeholder.hide(),n._isAboutToRemove?(a=!0,e.data("_gridstack_node")._grid._triggerRemoveEvent(),e.removeData("_gridstack_node"),e.remove()):(o._clearRemovingTimeout(e),n._temporaryRemoved?(s.attr("data-gs-x",n._beforeDragX).attr("data-gs-y",n._beforeDragY).attr("data-gs-width",n.width).attr("data-gs-height",n.height).removeAttr("style"),n.x=n._beforeDragX,n.y=n._beforeDragY,o.grid.addNode(n)):s.attr("data-gs-x",n.x).attr("data-gs-y",n.y).attr("data-gs-width",n.width).attr("data-gs-height",n.height).removeAttr("style")),o._updateContainerHeight(),o._triggerChangeEvent(a),o.grid.endUpdate();var c=s.find(".grid-stack");c.length&&"resizestop"==i.type&&(c.each(function(e,n){t(n).data("gridstack").onResizeHandler()}),s.find(".grid-stack-item").trigger("resizestop"),s.find(".grid-stack-item").trigger("gsresizestop")),"resizestop"==i.type&&o.container.trigger("gsresizestop",s)}};this.dd.draggable(e,{start:a,stop:c,drag:s}).resizable(e,{start:a,stop:c,resize:s}),(n.noMove||this._isOneColumnMode()&&!o.opts.disableOneColumnMode||this.opts.disableDrag)&&this.dd.draggable(e,"disable"),(n.noResize||this._isOneColumnMode()&&!o.opts.disableOneColumnMode||this.opts.disableResize)&&this.dd.resizable(e,"disable"),e.attr("data-gs-locked",n.locked?"yes":null)},l.prototype._prepareElement=function(e,n){n=void 0!==n&&n,(e=t(e)).addClass(this.opts.itemClass);var i=this.grid.addNode({x:e.attr("data-gs-x"),y:e.attr("data-gs-y"),width:e.attr("data-gs-width"),height:e.attr("data-gs-height"),maxWidth:e.attr("data-gs-max-width"),minWidth:e.attr("data-gs-min-width"),maxHeight:e.attr("data-gs-max-height"),minHeight:e.attr("data-gs-min-height"),autoPosition:o.toBool(e.attr("data-gs-auto-position")),noResize:o.toBool(e.attr("data-gs-no-resize")),noMove:o.toBool(e.attr("data-gs-no-move")),locked:o.toBool(e.attr("data-gs-locked")),el:e,id:e.attr("data-gs-id"),_grid:this},n);e.data("_gridstack_node",i),this._prepareElementsByNode(e,i)},l.prototype.setAnimation=function(t){t?this.container.addClass("grid-stack-animate"):this.container.removeClass("grid-stack-animate")},l.prototype.addWidget=function(e,n,i,r,o,s,a,c,l,u,h){return e=t(e),void 0!==n&&e.attr("data-gs-x",n),void 0!==i&&e.attr("data-gs-y",i),void 0!==r&&e.attr("data-gs-width",r),void 0!==o&&e.attr("data-gs-height",o),void 0!==s&&e.attr("data-gs-auto-position",s?"yes":null),void 0!==a&&e.attr("data-gs-min-width",a),void 0!==c&&e.attr("data-gs-max-width",c),void 0!==l&&e.attr("data-gs-min-height",l),void 0!==u&&e.attr("data-gs-max-height",u),void 0!==h&&e.attr("data-gs-id",h),this.container.append(e),this._prepareElement(e,!0),this._triggerAddEvent(),this._updateContainerHeight(),this._triggerChangeEvent(!0),e},l.prototype.makeWidget=function(e){return e=t(e),this._prepareElement(e,!0),this._triggerAddEvent(),this._updateContainerHeight(),this._triggerChangeEvent(!0),e},l.prototype.willItFit=function(t,e,n,i,r){var o={x:t,y:e,width:n,height:i,autoPosition:r};return this.grid.canBePlacedWithRespectToHeight(o)},l.prototype.removeWidget=function(e,n){n=void 0===n||n;var i=(e=t(e)).data("_gridstack_node");i||(i=this.grid.getNodeDataByDOMEl(e)),this.grid.removeNode(i,n),e.removeData("_gridstack_node"),this._updateContainerHeight(),n&&e.remove(),this._triggerChangeEvent(!0),this._triggerRemoveEvent()},l.prototype.removeAll=function(t){e.each(this.grid.nodes,e.bind(function(e){this.removeWidget(e.el,t)},this)),this.grid.nodes=[],this._updateContainerHeight()},l.prototype.destroy=function(e){t(window).off("resize",this.onResizeHandler),this.disable(),void 0===e||e?this.container.remove():(this.removeAll(!1),this.container.removeData("gridstack")),o.removeStylesheet(this._stylesId),this.grid&&(this.grid=null)},l.prototype.resizable=function(e,n){var i=this;return(e=t(e)).each(function(e,r){var o=(r=t(r)).data("_gridstack_node");null!=o&&(o.noResize=!n,o.noResize||i._isOneColumnMode()&&!i.opts.disableOneColumnMode?i.dd.resizable(r,"disable"):i.dd.resizable(r,"enable"))}),this},l.prototype.movable=function(e,n){var i=this;return(e=t(e)).each(function(e,r){var o=(r=t(r)).data("_gridstack_node");null!=o&&(o.noMove=!n,o.noMove||i._isOneColumnMode()&&!i.opts.disableOneColumnMode?(i.dd.draggable(r,"disable"),r.removeClass("ui-draggable-handle")):(i.dd.draggable(r,"enable"),r.addClass("ui-draggable-handle")))}),this},l.prototype.enableMove=function(t,e){this.movable(this.container.children("."+this.opts.itemClass),t),e&&(this.opts.disableDrag=!t)},l.prototype.enableResize=function(t,e){this.resizable(this.container.children("."+this.opts.itemClass),t),e&&(this.opts.disableResize=!t)},l.prototype.disable=function(){this.movable(this.container.children("."+this.opts.itemClass),!1),this.resizable(this.container.children("."+this.opts.itemClass),!1),this.container.trigger("disable")},l.prototype.enable=function(){this.movable(this.container.children("."+this.opts.itemClass),!0),this.resizable(this.container.children("."+this.opts.itemClass),!0),this.container.trigger("enable")},l.prototype.locked=function(e,n){return(e=t(e)).each(function(e,i){var r=(i=t(i)).data("_gridstack_node");null!=r&&(r.locked=n||!1,i.attr("data-gs-locked",r.locked?"yes":null))}),this},l.prototype.maxHeight=function(e,n){return(e=t(e)).each(function(e,i){var r=(i=t(i)).data("_gridstack_node");null!=r&&(isNaN(n)||(r.maxHeight=n||!1,i.attr("data-gs-max-height",n)))}),this},l.prototype.minHeight=function(e,n){return(e=t(e)).each(function(e,i){var r=(i=t(i)).data("_gridstack_node");null!=r&&(isNaN(n)||(r.minHeight=n||!1,i.attr("data-gs-min-height",n)))}),this},l.prototype.maxWidth=function(e,n){return(e=t(e)).each(function(e,i){var r=(i=t(i)).data("_gridstack_node");null!=r&&(isNaN(n)||(r.maxWidth=n||!1,i.attr("data-gs-max-width",n)))}),this},l.prototype.minWidth=function(e,n){return(e=t(e)).each(function(e,i){var r=(i=t(i)).data("_gridstack_node");null!=r&&(isNaN(n)||(r.minWidth=n||!1,i.attr("data-gs-min-width",n)))}),this},l.prototype._updateElement=function(e,n){var i=(e=t(e).first()).data("_gridstack_node");null!=i&&(this.grid.cleanNodes(),this.grid.beginUpdate(i),n.call(this,e,i),this._updateContainerHeight(),this._triggerChangeEvent(),this.grid.endUpdate())},l.prototype.resize=function(t,e,n){this._updateElement(t,function(t,i){e=null!=e?e:i.width,n=null!=n?n:i.height,this.grid.moveNode(i,i.x,i.y,e,n)})},l.prototype.move=function(t,e,n){this._updateElement(t,function(t,i){e=null!=e?e:i.x,n=null!=n?n:i.y,this.grid.moveNode(i,e,n,i.width,i.height)})},l.prototype.update=function(t,e,n,i,r){this._updateElement(t,function(t,o){e=null!=e?e:o.x,n=null!=n?n:o.y,i=null!=i?i:o.width,r=null!=r?r:o.height,this.grid.moveNode(o,e,n,i,r)})},l.prototype.verticalMargin=function(t,e){if(void 0===t)return this.opts.verticalMargin;var n=o.parseHeight(t);this.opts.verticalMarginUnit===n.unit&&this.opts.height===n.height||(this.opts.verticalMarginUnit=n.unit,this.opts.verticalMargin=n.height,e||this._updateStyles())},l.prototype.cellHeight=function(t,e){if(void 0===t){if(this.opts.cellHeight)return this.opts.cellHeight;var n=this.container.children("."+this.opts.itemClass).first();return Math.ceil(n.outerHeight()/n.attr("data-gs-height"))}var i=o.parseHeight(t);this.opts.cellHeightUnit===i.heightUnit&&this.opts.height===i.height||(this.opts.cellHeightUnit=i.unit,this.opts.cellHeight=i.height,e||this._updateStyles())},l.prototype.cellWidth=function(){return Math.round(this.container.outerWidth()/this.opts.width)},l.prototype.getCellFromPixel=function(t,e){var n=void 0!==e&&e?this.container.offset():this.container.position(),i=t.left-n.left,r=t.top-n.top,o=Math.floor(this.container.width()/this.opts.width),s=Math.floor(this.container.height()/parseInt(this.container.attr("data-gs-current-height")));return{x:Math.floor(i/o),y:Math.floor(r/s)}},l.prototype.batchUpdate=function(){this.grid.batchUpdate()},l.prototype.commit=function(){this.grid.commit(),this._updateContainerHeight()},l.prototype.isAreaEmpty=function(t,e,n,i){return this.grid.isAreaEmpty(t,e,n,i)},l.prototype.setStatic=function(t){this.opts.staticGrid=!0===t,this.enableMove(!t),this.enableResize(!t),this._setStaticClass()},l.prototype._setStaticClass=function(){!0===this.opts.staticGrid?this.container.addClass("grid-stack-static"):this.container.removeClass("grid-stack-static")},l.prototype._updateNodeWidths=function(t,e){this.grid._sortNodes(),this.grid.batchUpdate();for(var n={},i=0;i<this.grid.nodes.length;i++)n=this.grid.nodes[i],this.update(n.el,Math.round(n.x*e/t),void 0,Math.round(n.width*e/t),void 0);this.grid.commit()},l.prototype.setGridWidth=function(t,e){this.container.removeClass("grid-stack-"+this.opts.width),!0!==e&&this._updateNodeWidths(this.opts.width,t),this.opts.width=t,this.grid.width=t,this.container.addClass("grid-stack-"+t)},c.prototype.batch_update=i(c.prototype.batchUpdate),c.prototype._fix_collisions=i(c.prototype._fixCollisions,"_fix_collisions","_fixCollisions"),c.prototype.is_area_empty=i(c.prototype.isAreaEmpty,"is_area_empty","isAreaEmpty"),c.prototype._sort_nodes=i(c.prototype._sortNodes,"_sort_nodes","_sortNodes"),c.prototype._pack_nodes=i(c.prototype._packNodes,"_pack_nodes","_packNodes"),c.prototype._prepare_node=i(c.prototype._prepareNode,"_prepare_node","_prepareNode"),c.prototype.clean_nodes=i(c.prototype.cleanNodes,"clean_nodes","cleanNodes"),c.prototype.get_dirty_nodes=i(c.prototype.getDirtyNodes,"get_dirty_nodes","getDirtyNodes"),c.prototype.add_node=i(c.prototype.addNode,"add_node","addNode, "),c.prototype.remove_node=i(c.prototype.removeNode,"remove_node","removeNode"),c.prototype.can_move_node=i(c.prototype.canMoveNode,"can_move_node","canMoveNode"),c.prototype.move_node=i(c.prototype.moveNode,"move_node","moveNode"),c.prototype.get_grid_height=i(c.prototype.getGridHeight,"get_grid_height","getGridHeight"),c.prototype.begin_update=i(c.prototype.beginUpdate,"begin_update","beginUpdate"),c.prototype.end_update=i(c.prototype.endUpdate,"end_update","endUpdate"),c.prototype.can_be_placed_with_respect_to_height=i(c.prototype.canBePlacedWithRespectToHeight,"can_be_placed_with_respect_to_height","canBePlacedWithRespectToHeight"),l.prototype._trigger_change_event=i(l.prototype._triggerChangeEvent,"_trigger_change_event","_triggerChangeEvent"),l.prototype._init_styles=i(l.prototype._initStyles,"_init_styles","_initStyles"),l.prototype._update_styles=i(l.prototype._updateStyles,"_update_styles","_updateStyles"),l.prototype._update_container_height=i(l.prototype._updateContainerHeight,"_update_container_height","_updateContainerHeight"),l.prototype._is_one_column_mode=i(l.prototype._isOneColumnMode,"_is_one_column_mode","_isOneColumnMode"),l.prototype._prepare_element=i(l.prototype._prepareElement,"_prepare_element","_prepareElement"),l.prototype.set_animation=i(l.prototype.setAnimation,"set_animation","setAnimation"),l.prototype.add_widget=i(l.prototype.addWidget,"add_widget","addWidget"),l.prototype.make_widget=i(l.prototype.makeWidget,"make_widget","makeWidget"),l.prototype.will_it_fit=i(l.prototype.willItFit,"will_it_fit","willItFit"),l.prototype.remove_widget=i(l.prototype.removeWidget,"remove_widget","removeWidget"),l.prototype.remove_all=i(l.prototype.removeAll,"remove_all","removeAll"),l.prototype.min_height=i(l.prototype.minHeight,"min_height","minHeight"),l.prototype.min_width=i(l.prototype.minWidth,"min_width","minWidth"),l.prototype._update_element=i(l.prototype._updateElement,"_update_element","_updateElement"),l.prototype.cell_height=i(l.prototype.cellHeight,"cell_height","cellHeight"),l.prototype.cell_width=i(l.prototype.cellWidth,"cell_width","cellWidth"),l.prototype.get_cell_from_pixel=i(l.prototype.getCellFromPixel,"get_cell_from_pixel","getCellFromPixel"),l.prototype.batch_update=i(l.prototype.batchUpdate,"batch_update","batchUpdate"),l.prototype.is_area_empty=i(l.prototype.isAreaEmpty,"is_area_empty","isAreaEmpty"),l.prototype.set_static=i(l.prototype.setStatic,"set_static","setStatic"),l.prototype._set_static_class=i(l.prototype._setStaticClass,"_set_static_class","_setStaticClass"),n.GridStackUI=l,n.GridStackUI.Utils=o,n.GridStackUI.Engine=c,n.GridStackUI.GridStackDragDropPlugin=s,t.fn.gridstack=function(e){return this.each(function(){var n=t(this);n.data("gridstack")||n.data("gridstack",new l(this,e))})},n.GridStackUI})?i.apply(e,r):i)||(t.exports=o)},function(t,e,n){var i;!function(){"use strict";var r,o={name:"doT",version:"1.1.1",templateSettings:{evaluate:/\{\{([\s\S]+?(\}?)+)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,encode:/\{\{!([\s\S]+?)\}\}/g,use:/\{\{#([\s\S]+?)\}\}/g,useParams:/(^|[^\w$])def(?:\.|\[[\'\"])([\w$\.]+)(?:[\'\"]\])?\s*\:\s*([\w$\.]+|\"[^\"]+\"|\'[^\']+\'|\{[^\}]+\})/g,define:/\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\}\}/g,defineParams:/^\s*([\w$]+):([\s\S]+)/,conditional:/\{\{\?(\?)?\s*([\s\S]*?)\s*\}\}/g,iterate:/\{\{~\s*(?:\}\}|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\}\})/g,varname:"it",strip:!0,append:!0,selfcontained:!1,doNotSkipEncoded:!1},template:void 0,compile:void 0,log:!0};o.encodeHTMLSource=function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},n=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(n,function(t){return e[t]||t}):""}},r=function(){return this||(0,eval)("this")}(),void 0!==t&&t.exports?t.exports=o:void 0===(i=function(){return o}.call(e,n,e,t))||(t.exports=i);var s={append:{start:"'+(",end:")+'",startencode:"'+encodeHTML("},split:{start:"';out+=(",end:");out+='",startencode:"';out+=encodeHTML("}},a=/$^/;function c(t){return t.replace(/\\('|\\)/g,"$1").replace(/[\r\t\n]/g," ")}o.template=function(t,e,n){var i,l,u=(e=e||o.templateSettings).append?s.append:s.split,h=0,d=e.use||e.define?function t(e,n,i){return("string"==typeof n?n:n.toString()).replace(e.define||a,function(t,n,r,o){return 0===n.indexOf("def.")&&(n=n.substring(4)),n in i||(":"===r?(e.defineParams&&o.replace(e.defineParams,function(t,e,r){i[n]={arg:e,text:r}}),n in i||(i[n]=o)):new Function("def","def['"+n+"']="+o)(i)),""}).replace(e.use||a,function(n,r){e.useParams&&(r=r.replace(e.useParams,function(t,e,n,r){if(i[n]&&i[n].arg&&r){var o=(n+":"+r).replace(/'|\\/g,"_");return i.__exp=i.__exp||{},i.__exp[o]=i[n].text.replace(new RegExp("(^|[^\\w$])"+i[n].arg+"([^\\w$])","g"),"$1"+r+"$2"),e+"def.__exp['"+o+"']"}}));var o=new Function("def","return "+r)(i);return o?t(e,o,i):o})}(e,t,n||{}):t;d=("var out='"+(e.strip?d.replace(/(^|\r|\n)\t* +| +\t*(\r|\n|$)/g," ").replace(/\r|\n|\t|\/\*[\s\S]*?\*\//g,""):d).replace(/'|\\/g,"\\$&").replace(e.interpolate||a,function(t,e){return u.start+c(e)+u.end}).replace(e.encode||a,function(t,e){return i=!0,u.startencode+c(e)+u.end}).replace(e.conditional||a,function(t,e,n){return e?n?"';}else if("+c(n)+"){out+='":"';}else{out+='":n?"';if("+c(n)+"){out+='":"';}out+='"}).replace(e.iterate||a,function(t,e,n,i){return e?(h+=1,l=i||"i"+h,e=c(e),"';var arr"+h+"="+e+";if(arr"+h+"){var "+n+","+l+"=-1,l"+h+"=arr"+h+".length-1;while("+l+"<l"+h+"){"+n+"=arr"+h+"["+l+"+=1];out+='"):"';} } out+='"}).replace(e.evaluate||a,function(t,e){return"';"+c(e)+"out+='"})+"';return out;").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/(\s|;|\}|^|\{)out\+='';/g,"$1").replace(/\+''/g,""),i&&(e.selfcontained||!r||r._encodeHTML||(r._encodeHTML=o.encodeHTMLSource(e.doNotSkipEncoded)),d="var encodeHTML = typeof _encodeHTML !== 'undefined' ? _encodeHTML : ("+o.encodeHTMLSource.toString()+"("+(e.doNotSkipEncoded||"")+"));"+d);try{return new Function(e.varname,d)}catch(t){throw"undefined"!=typeof console&&console.log("Could not create a template function: "+d),t}},o.compile=function(t,e){return o.template(t,null,e)}}()},function(t,e,n){var i,r,o;
/*!
 * jQuery UI Draggable 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */r=[n(4),n(17),n(36),n(22),n(32),n(31),n(30),n(5),n(13)],void 0===(o="function"==typeof(i=function(t){return t.widget("ui.draggable",t.ui.mouse,{version:"1.12.1",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this._addClass("ui-draggable"),this._setHandleClassName(),this._mouseInit()},_setOption:function(t,e){this._super(t,e),"handle"===t&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){(this.helper||this.element).is(".ui-draggable-dragging")?this.destroyOnClear=!0:(this._removeHandleClassName(),this._mouseDestroy())},_mouseCapture:function(e){var n=this.options;return!(this.helper||n.disabled||t(e.target).closest(".ui-resizable-handle").length>0||(this.handle=this._getHandle(e),!this.handle||(this._blurActiveElement(e),this._blockFrames(!0===n.iframeFix?"iframe":n.iframeFix),0)))},_blockFrames:function(e){this.iframeBlocks=this.document.find(e).map(function(){var e=t(this);return t("<div>").css("position","absolute").appendTo(e.parent()).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()).offset(e.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(e){var n=t.ui.safeActiveElement(this.document[0]);t(e.target).closest(n).length||t.ui.safeBlur(n)},_mouseStart:function(e){var n=this.options;return this.helper=this._createHelper(e),this._addClass(this.helper,"ui-draggable-dragging"),this._cacheHelperProportions(),t.ui.ddmanager&&(t.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===t(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(e),this.originalPosition=this.position=this._generatePosition(e,!1),this.originalPageX=e.pageX,this.originalPageY=e.pageY,n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt),this._setContainment(),!1===this._trigger("start",e)?(this._clear(),!1):(this._cacheHelperProportions(),t.ui.ddmanager&&!n.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this._mouseDrag(e,!0),t.ui.ddmanager&&t.ui.ddmanager.dragStart(this,e),!0)},_refreshOffsets:function(t){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:t.pageX-this.offset.left,top:t.pageY-this.offset.top}},_mouseDrag:function(e,n){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(e,!0),this.positionAbs=this._convertPositionTo("absolute"),!n){var i=this._uiHash();if(!1===this._trigger("drag",e,i))return this._mouseUp(new t.Event("mouseup",e)),!1;this.position=i.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var n=this,i=!1;return t.ui.ddmanager&&!this.options.dropBehaviour&&(i=t.ui.ddmanager.drop(this,e)),this.dropped&&(i=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!i||"valid"===this.options.revert&&i||!0===this.options.revert||t.isFunction(this.options.revert)&&this.options.revert.call(this.element,i)?t(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==n._trigger("stop",e)&&n._clear()}):!1!==this._trigger("stop",e)&&this._clear(),!1},_mouseUp:function(e){return this._unblockFrames(),t.ui.ddmanager&&t.ui.ddmanager.dragStop(this,e),this.handleElement.is(e.target)&&this.element.trigger("focus"),t.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp(new t.Event("mouseup",{target:this.element[0]})):this._clear(),this},_getHandle:function(e){return!this.options.handle||!!t(e.target).closest(this.element.find(this.options.handle)).length},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this._addClass(this.handleElement,"ui-draggable-handle")},_removeHandleClassName:function(){this._removeClass(this.handleElement,"ui-draggable-handle")},_createHelper:function(e){var n=this.options,i=t.isFunction(n.helper),r=i?t(n.helper.apply(this.element[0],[e])):"clone"===n.helper?this.element.clone().removeAttr("id"):this.element;return r.parents("body").length||r.appendTo("parent"===n.appendTo?this.element[0].parentNode:n.appendTo),i&&r[0]===this.element[0]&&this._setPositionRelative(),r[0]===this.element[0]||/(fixed|absolute)/.test(r.css("position"))||r.css("position","absolute"),r},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_isRootNode:function(t){return/(html|body)/i.test(t.tagName)||t===this.document[0]},_getParentOffset:function(){var e=this.offsetParent.offset(),n=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==n&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var t=this.element.position(),e=this._isRootNode(this.scrollParent[0]);return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+(e?0:this.scrollParent.scrollTop()),left:t.left-(parseInt(this.helper.css("left"),10)||0)+(e?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,n,i,r=this.options,o=this.document[0];this.relativeContainer=null,r.containment?"window"!==r.containment?"document"!==r.containment?r.containment.constructor!==Array?("parent"===r.containment&&(r.containment=this.helper[0].parentNode),(i=(n=t(r.containment))[0])&&(e=/(scroll|auto)/.test(n.css("overflow")),this.containment=[(parseInt(n.css("borderLeftWidth"),10)||0)+(parseInt(n.css("paddingLeft"),10)||0),(parseInt(n.css("borderTopWidth"),10)||0)+(parseInt(n.css("paddingTop"),10)||0),(e?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(n.css("borderRightWidth"),10)||0)-(parseInt(n.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(n.css("borderBottomWidth"),10)||0)-(parseInt(n.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=n)):this.containment=r.containment:this.containment=[0,0,t(o).width()-this.helperProportions.width-this.margins.left,(t(o).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:this.containment=[t(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,t(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,t(window).scrollLeft()+t(window).width()-this.helperProportions.width-this.margins.left,t(window).scrollTop()+(t(window).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:this.containment=null},_convertPositionTo:function(t,e){e||(e=this.position);var n="absolute"===t?1:-1,i=this._isRootNode(this.scrollParent[0]);return{top:e.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.offset.scroll.top:i?0:this.offset.scroll.top)*n,left:e.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.offset.scroll.left:i?0:this.offset.scroll.left)*n}},_generatePosition:function(t,e){var n,i,r,o,s=this.options,a=this._isRootNode(this.scrollParent[0]),c=t.pageX,l=t.pageY;return a&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),e&&(this.containment&&(this.relativeContainer?(i=this.relativeContainer.offset(),n=[this.containment[0]+i.left,this.containment[1]+i.top,this.containment[2]+i.left,this.containment[3]+i.top]):n=this.containment,t.pageX-this.offset.click.left<n[0]&&(c=n[0]+this.offset.click.left),t.pageY-this.offset.click.top<n[1]&&(l=n[1]+this.offset.click.top),t.pageX-this.offset.click.left>n[2]&&(c=n[2]+this.offset.click.left),t.pageY-this.offset.click.top>n[3]&&(l=n[3]+this.offset.click.top)),s.grid&&(r=s.grid[1]?this.originalPageY+Math.round((l-this.originalPageY)/s.grid[1])*s.grid[1]:this.originalPageY,l=n?r-this.offset.click.top>=n[1]||r-this.offset.click.top>n[3]?r:r-this.offset.click.top>=n[1]?r-s.grid[1]:r+s.grid[1]:r,o=s.grid[0]?this.originalPageX+Math.round((c-this.originalPageX)/s.grid[0])*s.grid[0]:this.originalPageX,c=n?o-this.offset.click.left>=n[0]||o-this.offset.click.left>n[2]?o:o-this.offset.click.left>=n[0]?o-s.grid[0]:o+s.grid[0]:o),"y"===s.axis&&(c=this.originalPageX),"x"===s.axis&&(l=this.originalPageY)),{top:l-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:a?0:this.offset.scroll.top),left:c-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:a?0:this.offset.scroll.left)}},_clear:function(){this._removeClass(this.helper,"ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_trigger:function(e,n,i){return i=i||this._uiHash(),t.ui.plugin.call(this,e,[n,i,this],!0),/^(drag|start|stop)/.test(e)&&(this.positionAbs=this._convertPositionTo("absolute"),i.offset=this.positionAbs),t.Widget.prototype._trigger.call(this,e,n,i)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),t.ui.plugin.add("draggable","connectToSortable",{start:function(e,n,i){var r=t.extend({},n,{item:i.element});i.sortables=[],t(i.options.connectToSortable).each(function(){var n=t(this).sortable("instance");n&&!n.options.disabled&&(i.sortables.push(n),n.refreshPositions(),n._trigger("activate",e,r))})},stop:function(e,n,i){var r=t.extend({},n,{item:i.element});i.cancelHelperRemoval=!1,t.each(i.sortables,function(){this.isOver?(this.isOver=0,i.cancelHelperRemoval=!0,this.cancelHelperRemoval=!1,this._storedCSS={position:this.placeholder.css("position"),top:this.placeholder.css("top"),left:this.placeholder.css("left")},this._mouseStop(e),this.options.helper=this.options._helper):(this.cancelHelperRemoval=!0,this._trigger("deactivate",e,r))})},drag:function(e,n,i){t.each(i.sortables,function(){var r=!1,o=this;o.positionAbs=i.positionAbs,o.helperProportions=i.helperProportions,o.offset.click=i.offset.click,o._intersectsWith(o.containerCache)&&(r=!0,t.each(i.sortables,function(){return this.positionAbs=i.positionAbs,this.helperProportions=i.helperProportions,this.offset.click=i.offset.click,this!==o&&this._intersectsWith(this.containerCache)&&t.contains(o.element[0],this.element[0])&&(r=!1),r})),r?(o.isOver||(o.isOver=1,i._parent=n.helper.parent(),o.currentItem=n.helper.appendTo(o.element).data("ui-sortable-item",!0),o.options._helper=o.options.helper,o.options.helper=function(){return n.helper[0]},e.target=o.currentItem[0],o._mouseCapture(e,!0),o._mouseStart(e,!0,!0),o.offset.click.top=i.offset.click.top,o.offset.click.left=i.offset.click.left,o.offset.parent.left-=i.offset.parent.left-o.offset.parent.left,o.offset.parent.top-=i.offset.parent.top-o.offset.parent.top,i._trigger("toSortable",e),i.dropped=o.element,t.each(i.sortables,function(){this.refreshPositions()}),i.currentItem=i.element,o.fromOutside=i),o.currentItem&&(o._mouseDrag(e),n.position=o.position)):o.isOver&&(o.isOver=0,o.cancelHelperRemoval=!0,o.options._revert=o.options.revert,o.options.revert=!1,o._trigger("out",e,o._uiHash(o)),o._mouseStop(e,!0),o.options.revert=o.options._revert,o.options.helper=o.options._helper,o.placeholder&&o.placeholder.remove(),n.helper.appendTo(i._parent),i._refreshOffsets(e),n.position=i._generatePosition(e,!0),i._trigger("fromSortable",e),i.dropped=!1,t.each(i.sortables,function(){this.refreshPositions()}))})}}),t.ui.plugin.add("draggable","cursor",{start:function(e,n,i){var r=t("body"),o=i.options;r.css("cursor")&&(o._cursor=r.css("cursor")),r.css("cursor",o.cursor)},stop:function(e,n,i){var r=i.options;r._cursor&&t("body").css("cursor",r._cursor)}}),t.ui.plugin.add("draggable","opacity",{start:function(e,n,i){var r=t(n.helper),o=i.options;r.css("opacity")&&(o._opacity=r.css("opacity")),r.css("opacity",o.opacity)},stop:function(e,n,i){var r=i.options;r._opacity&&t(n.helper).css("opacity",r._opacity)}}),t.ui.plugin.add("draggable","scroll",{start:function(t,e,n){n.scrollParentNotHidden||(n.scrollParentNotHidden=n.helper.scrollParent(!1)),n.scrollParentNotHidden[0]!==n.document[0]&&"HTML"!==n.scrollParentNotHidden[0].tagName&&(n.overflowOffset=n.scrollParentNotHidden.offset())},drag:function(e,n,i){var r=i.options,o=!1,s=i.scrollParentNotHidden[0],a=i.document[0];s!==a&&"HTML"!==s.tagName?(r.axis&&"x"===r.axis||(i.overflowOffset.top+s.offsetHeight-e.pageY<r.scrollSensitivity?s.scrollTop=o=s.scrollTop+r.scrollSpeed:e.pageY-i.overflowOffset.top<r.scrollSensitivity&&(s.scrollTop=o=s.scrollTop-r.scrollSpeed)),r.axis&&"y"===r.axis||(i.overflowOffset.left+s.offsetWidth-e.pageX<r.scrollSensitivity?s.scrollLeft=o=s.scrollLeft+r.scrollSpeed:e.pageX-i.overflowOffset.left<r.scrollSensitivity&&(s.scrollLeft=o=s.scrollLeft-r.scrollSpeed))):(r.axis&&"x"===r.axis||(e.pageY-t(a).scrollTop()<r.scrollSensitivity?o=t(a).scrollTop(t(a).scrollTop()-r.scrollSpeed):t(window).height()-(e.pageY-t(a).scrollTop())<r.scrollSensitivity&&(o=t(a).scrollTop(t(a).scrollTop()+r.scrollSpeed))),r.axis&&"y"===r.axis||(e.pageX-t(a).scrollLeft()<r.scrollSensitivity?o=t(a).scrollLeft(t(a).scrollLeft()-r.scrollSpeed):t(window).width()-(e.pageX-t(a).scrollLeft())<r.scrollSensitivity&&(o=t(a).scrollLeft(t(a).scrollLeft()+r.scrollSpeed)))),!1!==o&&t.ui.ddmanager&&!r.dropBehaviour&&t.ui.ddmanager.prepareOffsets(i,e)}}),t.ui.plugin.add("draggable","snap",{start:function(e,n,i){var r=i.options;i.snapElements=[],t(r.snap.constructor!==String?r.snap.items||":data(ui-draggable)":r.snap).each(function(){var e=t(this),n=e.offset();this!==i.element[0]&&i.snapElements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:n.top,left:n.left})})},drag:function(e,n,i){var r,o,s,a,c,l,u,h,d,f,p=i.options,g=p.snapTolerance,_=n.offset.left,m=_+i.helperProportions.width,y=n.offset.top,v=y+i.helperProportions.height;for(d=i.snapElements.length-1;d>=0;d--)l=(c=i.snapElements[d].left-i.margins.left)+i.snapElements[d].width,h=(u=i.snapElements[d].top-i.margins.top)+i.snapElements[d].height,m<c-g||_>l+g||v<u-g||y>h+g||!t.contains(i.snapElements[d].item.ownerDocument,i.snapElements[d].item)?(i.snapElements[d].snapping&&i.options.snap.release&&i.options.snap.release.call(i.element,e,t.extend(i._uiHash(),{snapItem:i.snapElements[d].item})),i.snapElements[d].snapping=!1):("inner"!==p.snapMode&&(r=Math.abs(u-v)<=g,o=Math.abs(h-y)<=g,s=Math.abs(c-m)<=g,a=Math.abs(l-_)<=g,r&&(n.position.top=i._convertPositionTo("relative",{top:u-i.helperProportions.height,left:0}).top),o&&(n.position.top=i._convertPositionTo("relative",{top:h,left:0}).top),s&&(n.position.left=i._convertPositionTo("relative",{top:0,left:c-i.helperProportions.width}).left),a&&(n.position.left=i._convertPositionTo("relative",{top:0,left:l}).left)),f=r||o||s||a,"outer"!==p.snapMode&&(r=Math.abs(u-y)<=g,o=Math.abs(h-v)<=g,s=Math.abs(c-_)<=g,a=Math.abs(l-m)<=g,r&&(n.position.top=i._convertPositionTo("relative",{top:u,left:0}).top),o&&(n.position.top=i._convertPositionTo("relative",{top:h-i.helperProportions.height,left:0}).top),s&&(n.position.left=i._convertPositionTo("relative",{top:0,left:c}).left),a&&(n.position.left=i._convertPositionTo("relative",{top:0,left:l-i.helperProportions.width}).left)),!i.snapElements[d].snapping&&(r||o||s||a||f)&&i.options.snap.snap&&i.options.snap.snap.call(i.element,e,t.extend(i._uiHash(),{snapItem:i.snapElements[d].item})),i.snapElements[d].snapping=r||o||s||a||f)}}),t.ui.plugin.add("draggable","stack",{start:function(e,n,i){var r,o=i.options,s=t.makeArray(t(o.stack)).sort(function(e,n){return(parseInt(t(e).css("zIndex"),10)||0)-(parseInt(t(n).css("zIndex"),10)||0)});s.length&&(r=parseInt(t(s[0]).css("zIndex"),10)||0,t(s).each(function(e){t(this).css("zIndex",r+e)}),this.css("zIndex",r+s.length))}}),t.ui.plugin.add("draggable","zIndex",{start:function(e,n,i){var r=t(n.helper),o=i.options;r.css("zIndex")&&(o._zIndex=r.css("zIndex")),r.css("zIndex",o.zIndex)},stop:function(e,n,i){var r=i.options;r._zIndex&&t(n.helper).css("zIndex",r._zIndex)}}),t.ui.draggable})?i.apply(e,r):i)||(t.exports=o)},function(t,e,n){var i,r,o;
/*!
 * jQuery UI Scroll Parent 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */r=[n(4),n(5)],void 0===(o="function"==typeof(i=function(t){return t.fn.scrollParent=function(e){var n=this.css("position"),i="absolute"===n,r=e?/(auto|scroll|hidden)/:/(auto|scroll)/,o=this.parents().filter(function(){var e=t(this);return(!i||"static"!==e.css("position"))&&r.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))}).eq(0);return"fixed"!==n&&o.length?o:t(this[0].ownerDocument||document)}})?i.apply(e,r):i)||(t.exports=o)},function(t,e,n){var i,r,o;r=[n(4),n(5)],void 0===(o="function"==typeof(i=function(t){return t.ui.safeBlur=function(e){e&&"body"!==e.nodeName.toLowerCase()&&t(e).trigger("blur")}})?i.apply(e,r):i)||(t.exports=o)},function(t,e,n){var i,r,o;r=[n(4),n(5)],void 0===(o="function"==typeof(i=function(t){return t.ui.safeActiveElement=function(t){var e;try{e=t.activeElement}catch(n){e=t.body}return e||(e=t.body),e.nodeName||(e=t.body),e}})?i.apply(e,r):i)||(t.exports=o)},function(t,e,n){var i,r,o;r=[n(4),n(5)],void 0===(o="function"==typeof(i=function(t){return t.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase())})?i.apply(e,r):i)||(t.exports=o)},function(t,e,n){var i,r,o;
/*!
 * jQuery UI Focusable 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */r=[n(4),n(5)],void 0===(o="function"==typeof(i=function(t){return t.ui.focusable=function(e,n){var i,r,o,s,a,c=e.nodeName.toLowerCase();return"area"===c?(r=(i=e.parentNode).name,!(!e.href||!r||"map"!==i.nodeName.toLowerCase())&&(o=t("img[usemap='#"+r+"']")).length>0&&o.is(":visible")):(/^(input|select|textarea|button|object)$/.test(c)?(s=!e.disabled)&&(a=t(e).closest("fieldset")[0])&&(s=!a.disabled):s="a"===c&&e.href||n,s&&t(e).is(":visible")&&function(t){for(var e=t.css("visibility");"inherit"===e;)t=t.parent(),e=t.css("visibility");return"hidden"!==e}(t(e)))},t.extend(t.expr[":"],{focusable:function(e){return t.ui.focusable(e,null!=t.attr(e,"tabindex"))}}),t.ui.focusable})?i.apply(e,r):i)||(t.exports=o)},function(t,e,n){var i,r,o;
/*!
 * jQuery UI Disable Selection 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */r=[n(4),n(5)],void 0===(o="function"==typeof(i=function(t){return t.fn.extend({disableSelection:(e="onselectstart"in document.createElement("div")?"selectstart":"mousedown",function(){return this.on(e+".ui-disableSelection",function(t){t.preventDefault()})}),enableSelection:function(){return this.off(".ui-disableSelection")}});var e})?i.apply(e,r):i)||(t.exports=o)},function(t,e,n){var i,r,o;
/*!
 * jQuery UI :data 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */r=[n(4),n(5)],void 0===(o="function"==typeof(i=function(t){return t.extend(t.expr[":"],{data:t.expr.createPseudo?t.expr.createPseudo(function(e){return function(n){return!!t.data(n,e)}}):function(e,n,i){return!!t.data(e,i[3])}})})?i.apply(e,r):i)||(t.exports=o)},function(t,e,n){"use strict";var i=window.URL||window.webkitURL;t.exports=function(t,e){try{try{var n;try{(n=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder)).append(t),n=n.getBlob()}catch(e){n=new Blob([t])}return new Worker(i.createObjectURL(n))}catch(e){return new Worker("data:application/javascript,"+encodeURIComponent(t))}}catch(t){if(!e)throw Error("Inline worker is not supported");return new Worker(e)}}},,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.ContentRect=function(t){if("getBBox"in t){var e=t.getBBox();return Object.freeze({height:e.height,left:0,top:0,width:e.width})}var n=window.getComputedStyle(t);return Object.freeze({height:parseFloat(n.height||"0"),left:parseFloat(n.paddingLeft||"0"),top:parseFloat(n.paddingTop||"0"),width:parseFloat(n.width||"0")})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(6),r=n(8),o=function(t,e){var n=t.parentRequest;return null!==n&&(!!e(n)||o(n,e))};e.traverseAncerstors=o;var s=function(t){return function(e){var n=function(n){return null!==n&&null!==n.target&&n.target.matchesTag(t)(e)};return n.metaData=new r.Metadata(t,e),n}};e.taggedConstraint=s;var a=s(i.NAMED_TAG);e.namedConstraint=a;e.typeConstraint=function(t){return function(e){var n=null;if(null!==e){if(n=e.bindings[0],"string"==typeof t)return n.serviceIdentifier===t;var i=e.bindings[0].implementationType;return t===i}return!1}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(25),r=n(24),o=function(){function t(t){this._binding=t,this._bindingWhenSyntax=new r.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new i.BindingOnSyntax(this._binding)}return t.prototype.when=function(t){return this._bindingWhenSyntax.when(t)},t.prototype.whenTargetNamed=function(t){return this._bindingWhenSyntax.whenTargetNamed(t)},t.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},t.prototype.whenTargetTagged=function(t,e){return this._bindingWhenSyntax.whenTargetTagged(t,e)},t.prototype.whenInjectedInto=function(t){return this._bindingWhenSyntax.whenInjectedInto(t)},t.prototype.whenParentNamed=function(t){return this._bindingWhenSyntax.whenParentNamed(t)},t.prototype.whenParentTagged=function(t,e){return this._bindingWhenSyntax.whenParentTagged(t,e)},t.prototype.whenAnyAncestorIs=function(t){return this._bindingWhenSyntax.whenAnyAncestorIs(t)},t.prototype.whenNoAncestorIs=function(t){return this._bindingWhenSyntax.whenNoAncestorIs(t)},t.prototype.whenAnyAncestorNamed=function(t){return this._bindingWhenSyntax.whenAnyAncestorNamed(t)},t.prototype.whenAnyAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenAnyAncestorTagged(t,e)},t.prototype.whenNoAncestorNamed=function(t){return this._bindingWhenSyntax.whenNoAncestorNamed(t)},t.prototype.whenNoAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenNoAncestorTagged(t,e)},t.prototype.whenAnyAncestorMatches=function(t){return this._bindingWhenSyntax.whenAnyAncestorMatches(t)},t.prototype.whenNoAncestorMatches=function(t){return this._bindingWhenSyntax.whenNoAncestorMatches(t)},t.prototype.onActivation=function(t){return this._bindingOnSyntax.onActivation(t)},t}();e.BindingWhenOnSyntax=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(6),r=n(11),o=n(8),s=n(87),a=function(){function t(t,e,n,a){this.id=r.id(),this.type=t,this.serviceIdentifier=n,this.name=new s.QueryableString(e||""),this.metadata=new Array;var c=null;"string"==typeof a?c=new o.Metadata(i.NAMED_TAG,a):a instanceof o.Metadata&&(c=a),null!==c&&this.metadata.push(c)}return t.prototype.hasTag=function(t){for(var e=0,n=this.metadata;e<n.length;e++){if(n[e].key===t)return!0}return!1},t.prototype.isArray=function(){return this.hasTag(i.MULTI_INJECT_TAG)},t.prototype.matchesArray=function(t){return this.matchesTag(i.MULTI_INJECT_TAG)(t)},t.prototype.isNamed=function(){return this.hasTag(i.NAMED_TAG)},t.prototype.isTagged=function(){return this.metadata.some(function(t){return t.key!==i.INJECT_TAG&&t.key!==i.MULTI_INJECT_TAG&&t.key!==i.NAME_TAG&&t.key!==i.UNMANAGED_TAG&&t.key!==i.NAMED_TAG})},t.prototype.isOptional=function(){return this.matchesTag(i.OPTIONAL_TAG)(!0)},t.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(t){return t.key===i.NAMED_TAG})[0]:null},t.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(t){return t.key!==i.INJECT_TAG&&t.key!==i.MULTI_INJECT_TAG&&t.key!==i.NAME_TAG&&t.key!==i.UNMANAGED_TAG&&t.key!==i.NAMED_TAG}):null},t.prototype.matchesNamedTag=function(t){return this.matchesTag(i.NAMED_TAG)(t)},t.prototype.matchesTag=function(t){var e=this;return function(n){for(var i=0,r=e.metadata;i<r.length;i++){var o=r[i];if(o.key===t&&o.value===n)return!0}return!1}},t}();e.Target=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(7),r=n(6),o=n(8),s=n(10),a=function(){function t(t){this._cb=t}return t.prototype.unwrap=function(){return this._cb()},t}();e.LazyServiceIdentifer=a,e.inject=function(t){return function(e,n,a){if(void 0===t)throw new Error(i.UNDEFINED_INJECT_ANNOTATION(e.name));var c=new o.Metadata(r.INJECT_TAG,t);"number"==typeof a?s.tagParameter(e,n,a,c):s.tagProperty(e,n,c)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(7);e.isStackOverflowExeption=function(t){return t instanceof RangeError||t.message===i.STACK_OVERFLOW}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(6),r=function(){function t(){}return t.prototype.getConstructorMetadata=function(t){return{compilerGeneratedMetadata:Reflect.getMetadata(i.PARAM_TYPES,t),userGeneratedMetadata:Reflect.getMetadata(i.TAGGED,t)||{}}},t.prototype.getPropertiesMetadata=function(t){return Reflect.getMetadata(i.TAGGED_PROP,t)||[]},t}();e.MetadataReader=r},function(t,e,n){var i,r,o;r=[],void 0===(o="function"==typeof(i=function(){return function t(e,n,i){var r,o,s=window,a="application/octet-stream",c=i||a,l=e,u=!n&&!i&&l,h=document.createElement("a"),d=function(t){return String(t)},f=s.Blob||s.MozBlob||s.WebKitBlob||d,p=n||"download";if(f=f.call?f.bind(s):Blob,"true"===String(this)&&(c=(l=[l,c])[0],l=l[1]),u&&u.length<2048&&(p=u.split("/").pop().split("?")[0],h.href=u,-1!==h.href.indexOf(u))){var g=new XMLHttpRequest;return g.open("GET",u,!0),g.responseType="blob",g.onload=function(e){t(e.target.response,p,a)},setTimeout(function(){g.send()},0),g}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(l)){if(!(l.length>2096103.424&&f!==d))return navigator.msSaveBlob?navigator.msSaveBlob(v(l),p):b(l);c=(l=v(l)).type||a}else if(/([\x80-\xff])/.test(l)){for(var _=0,m=new Uint8Array(l.length),y=m.length;_<y;++_)m[_]=l.charCodeAt(_);l=new f([m],{type:c})}function v(t){for(var e=t.split(/[:;,]/),n=e[1],i=("base64"==e[2]?atob:decodeURIComponent)(e.pop()),r=i.length,o=0,s=new Uint8Array(r);o<r;++o)s[o]=i.charCodeAt(o);return new f([s],{type:n})}function b(t,e){if("download"in h)return h.href=t,h.setAttribute("download",p),h.className="download-js-link",h.innerHTML="downloading...",h.style.display="none",document.body.appendChild(h),setTimeout(function(){h.click(),document.body.removeChild(h),!0===e&&setTimeout(function(){s.URL.revokeObjectURL(h.href)},250)},66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(t)&&(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,a)),window.open(t)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=t),!0;var n=document.createElement("iframe");document.body.appendChild(n),!e&&/^data:/.test(t)&&(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,a)),n.src=t,setTimeout(function(){document.body.removeChild(n)},333)}if(r=l instanceof f?l:new f([l],{type:c}),navigator.msSaveBlob)return navigator.msSaveBlob(r,p);if(s.URL)b(s.URL.createObjectURL(r),!0);else{if("string"==typeof r||r.constructor===d)try{return b("data:"+c+";base64,"+s.btoa(r))}catch(t){return b("data:"+c+","+encodeURIComponent(r))}(o=new FileReader).onload=function(t){b(this.result)},o.readAsDataURL(r)}return!0}})?i.apply(e,r):i)||(t.exports=o)},function(t,e,n){var i;t.exports=((i=function(){function t(t){return r.appendChild(t.dom),t}function e(t){for(var e=0;e<r.children.length;e++)r.children[e].style.display=e===t?"block":"none";n=t}var n=0,r=document.createElement("div");r.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",r.addEventListener("click",function(t){t.preventDefault(),e(++n%r.children.length)},!1);var o=(performance||Date).now(),s=o,a=0,c=t(new i.Panel("FPS","#0ff","#002")),l=t(new i.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var u=t(new i.Panel("MB","#f08","#201"));return e(0),{REVISION:16,dom:r,addPanel:t,showPanel:e,begin:function(){o=(performance||Date).now()},end:function(){a++;var t=(performance||Date).now();if(l.update(t-o,200),t>s+1e3&&(c.update(1e3*a/(t-s),100),s=t,a=0,u)){var e=performance.memory;u.update(e.usedJSHeapSize/1048576,e.jsHeapSizeLimit/1048576)}return t},update:function(){o=this.end()},domElement:r,setMode:e}}).Panel=function(t,e,n){var i=1/0,r=0,o=Math.round,s=o(window.devicePixelRatio||1),a=80*s,c=48*s,l=3*s,u=2*s,h=3*s,d=15*s,f=74*s,p=30*s,g=document.createElement("canvas");g.width=a,g.height=c,g.style.cssText="width:80px;height:48px";var _=g.getContext("2d");return _.font="bold "+9*s+"px Helvetica,Arial,sans-serif",_.textBaseline="top",_.fillStyle=n,_.fillRect(0,0,a,c),_.fillStyle=e,_.fillText(t,l,u),_.fillRect(h,d,f,p),_.fillStyle=n,_.globalAlpha=.9,_.fillRect(h,d,f,p),{dom:g,update:function(c,m){i=Math.min(i,c),r=Math.max(r,c),_.fillStyle=n,_.globalAlpha=1,_.fillRect(0,0,a,d),_.fillStyle=e,_.fillText(o(c)+" "+t+" ("+o(i)+"-"+o(r)+")",l,u),_.drawImage(g,h+s,d,f-s,p,h,d,f-s,p),_.fillRect(h+f-s,d,s,p),_.fillStyle=n,_.globalAlpha=.9,_.fillRect(h+f-s,d,s,o((1-c/m)*p))}}},i)},function(t,e,n){(function(n){var i,r,o;r=[],void 0===(o="function"==typeof(i=function(){"use strict";function e(t,e,n){var i=new XMLHttpRequest;i.open("GET",t),i.responseType="blob",i.onload=function(){s(i.response,e,n)},i.onerror=function(){console.error("could not download file")},i.send()}function i(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function r(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(n){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var o="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n&&n.global===n?n:void 0,s=o.saveAs||("object"!=typeof window||window!==o?function(){}:"download"in HTMLAnchorElement.prototype?function(t,n,s){var a=o.URL||o.webkitURL,c=document.createElement("a");n=n||t.name||"download",c.download=n,c.rel="noopener","string"==typeof t?(c.href=t,c.origin===location.origin?r(c):i(c.href)?e(t,n,s):r(c,c.target="_blank")):(c.href=a.createObjectURL(t),setTimeout(function(){a.revokeObjectURL(c.href)},4e4),setTimeout(function(){r(c)},0))}:"msSaveOrOpenBlob"in navigator?function(t,n,o){if(n=n||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(function(t,e){return void 0===e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}(t,o),n);else if(i(t))e(t,n,o);else{var s=document.createElement("a");s.href=t,s.target="_blank",setTimeout(function(){r(s)})}}:function(t,n,i,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),"string"==typeof t)return e(t,n,i);var s="application/octet-stream"===t.type,a=/constructor/i.test(o.HTMLElement)||o.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||s&&a)&&"object"==typeof FileReader){var l=new FileReader;l.onloadend=function(){var t=l.result;t=c?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=t:location=t,r=null},l.readAsDataURL(t)}else{var u=o.URL||o.webkitURL,h=u.createObjectURL(t);r?r.location=h:location.href=h,r=null,setTimeout(function(){u.revokeObjectURL(h)},4e4)}});o.saveAs=s.saveAs=s,void 0!==t&&(t.exports=s)})?i.apply(e,r):i)||(t.exports=o)}).call(this,n(26))},function(t,e,n){var i,r,o;
/**
 * gridstack.js 1.0.0-dev
 * http://troolee.github.io/gridstack.js/
 * (c) 2014-2017 Pavel Reznikov, Dylan Weiss
 * gridstack.js may be freely distributed under the MIT license.
 * @preserve
 */r=[n(4),n(27),e,n(36),n(35),n(34),n(63),n(33),n(62),n(61),n(59),n(22),n(32),n(31),n(30),n(58),n(57),n(5),n(13),n(17),n(29),n(56),n(55)],void 0===(o="function"==typeof(i=function(t,e,n){function i(t){e.GridStackDragDropPlugin.call(this,t)}return e.GridStackDragDropPlugin.registerPlugin(i),i.prototype=Object.create(e.GridStackDragDropPlugin.prototype),i.prototype.constructor=i,i.prototype.resizable=function(e,n){if(e=t(e),"disable"===n||"enable"===n)e.resizable(n);else if("option"===n){var i=arguments[2],r=arguments[3];e.resizable(n,i,r)}else{var o=e.data("gs-resize-handles")?e.data("gs-resize-handles"):this.grid.opts.resizable.handles;e.resizable(t.extend({},this.grid.opts.resizable,{handles:o},{start:n.start||function(){},stop:n.stop||function(){},resize:n.resize||function(){}}))}return this},i.prototype.draggable=function(e,n){return e=t(e),"disable"===n||"enable"===n?e.draggable(n):e.draggable(t.extend({},this.grid.opts.draggable,{containment:this.grid.opts.isNested?this.grid.container.parent():null,start:n.start||function(){},stop:n.stop||function(){},drag:n.drag||function(){}})),this},i.prototype.droppable=function(e,n){return(e=t(e)).droppable(n),this},i.prototype.isDroppable=function(e,n){return e=t(e),Boolean(e.data("droppable"))},i.prototype.on=function(e,n,i){return t(e).on(n,i),this},n.JQueryUIGridStackDragDropPlugin=i,i})?i.apply(e,r):i)||(t.exports=o)},function(t,e,n){t.exports=function(){return n(37)('!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n(n.s=17)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NAMED_TAG="named",e.NAME_TAG="name",e.UNMANAGED_TAG="unmanaged",e.OPTIONAL_TAG="optional",e.INJECT_TAG="inject",e.MULTI_INJECT_TAG="multi_inject",e.TAGGED="inversify:tagged",e.TAGGED_PROP="inversify:tagged_props",e.PARAM_TYPES="inversify:paramtypes",e.DESIGN_PARAM_TYPES="design:paramtypes",e.POST_CONSTRUCT="post_construct"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",e.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",e.NULL_ARGUMENT="NULL argument",e.KEY_NOT_FOUND="Key Not Found",e.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",e.CANNOT_UNBIND="Could not unbind serviceIdentifier:",e.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",e.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",e.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:",e.UNDEFINED_INJECT_ANNOTATION=function(t){return"@inject called with undefined this could mean that the class "+t+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},e.CIRCULAR_DEPENDENCY="Circular dependency found:",e.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",e.INVALID_BINDING_TYPE="Invalid binding type:",e.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",e.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",e.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",e.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",e.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",e.ARGUMENTS_LENGTH_MISMATCH=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return"The number of constructor arguments in the derived class "+t[0]+" must be >= than the number of constructor arguments of its base class."},e.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",e.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string (\'singleton\' or \'transient\').",e.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",e.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",e.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class",e.POST_CONSTRUCT_ERROR=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return"@postConstruct error in class "+t[0]+": "+t[1]},e.CIRCULAR_DEPENDENCY_IN_FACTORY=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return"It looks like there is a circular dependency in one of the \'"+t[0]+"\' bindings. Please investigate bindings withservice identifier \'"+t[1]+"\'."},e.STACK_OVERFLOW="Maximum call stack size exceeded"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=function(){function t(t,e){this.key=t,this.value=e}return t.prototype.toString=function(){return this.key===r.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},t}();e.Metadata=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.BindingScopeEnum={Request:"Request",Singleton:"Singleton",Transient:"Transient"};e.BindingTypeEnum={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};e.TargetTypeEnum={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n(0);function o(t,e,n,i,o){var a={},s="number"==typeof o,u=void 0!==o&&s?o.toString():n;if(s&&void 0!==n)throw new Error(r.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(t,e)&&(a=Reflect.getMetadata(t,e));var c=a[u];if(Array.isArray(c))for(var f=0,d=c;f<d.length;f++){var h=d[f];if(h.key===i.key)throw new Error(r.DUPLICATED_METADATA+" "+h.key.toString())}else c=[];c.push(i),a[u]=c,Reflect.defineMetadata(t,a,e)}function a(t,e){Reflect.decorate(t,e)}function s(t,e){return function(n,r){e(n,r,t)}}e.tagParameter=function(t,e,n,r){o(i.TAGGED,t,e,r,n)},e.tagProperty=function(t,e,n){o(i.TAGGED_PROP,t.constructor,e,n)},e.decorate=function(t,e,n){"number"==typeof n?a([s(n,t)],e):"string"==typeof n?Reflect.decorate([t],e,n):a([t],e)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=0;e.id=function(){return r++}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1);function i(t){return"function"==typeof t?t.name:"symbol"==typeof t?t.toString():t}function o(t){if(t.name)return t.name;var e=t.toString(),n=e.match(/^function\\s*([^\\s(]+)/);return n?n[1]:"Anonymous function: "+e}e.getServiceIdentifierAsString=i,e.listRegisteredBindingsForServiceIdentifier=function(t,e,n){var r="",i=n(t,e);return 0!==i.length&&(r="\\nRegistered bindings:",i.forEach(function(t){var e="Object";null!==t.implementationType&&(e=o(t.implementationType)),r=r+"\\n "+e,t.constraint.metaData&&(r=r+" - "+t.constraint.metaData)})),r},e.circularDependencyToException=function t(e){e.childRequests.forEach(function(e){if(function t(e,n){return null!==e.parentRequest&&(e.parentRequest.serviceIdentifier===n||t(e.parentRequest,n))}(e,e.serviceIdentifier)){var n=function(t){return function t(e,n){void 0===n&&(n=[]);var r=i(e.serviceIdentifier);return n.push(r),null!==e.parentRequest?t(e.parentRequest,n):n}(t).reverse().join(" --\\x3e ")}(e);throw new Error(r.CIRCULAR_DEPENDENCY+" "+n)}t(e)})},e.listMetadataForTarget=function(t,e){if(e.isTagged()||e.isNamed()){var n="",r=e.getNamedTag(),i=e.getCustomTags();return null!==r&&(n+=r.toString()+"\\n"),null!==i&&i.forEach(function(t){n+=t.toString()+"\\n"})," "+t+"\\n "+t+" - "+n}return" "+t},e.getFunctionName=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(8),i=n(9),o=function(){function t(t){this._binding=t}return t.prototype.when=function(t){return this._binding.constraint=t,new r.BindingOnSyntax(this._binding)},t.prototype.whenTargetNamed=function(t){return this._binding.constraint=i.namedConstraint(t),new r.BindingOnSyntax(this._binding)},t.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(t){return null!==t.target&&!t.target.isNamed()&&!t.target.isTagged()},new r.BindingOnSyntax(this._binding)},t.prototype.whenTargetTagged=function(t,e){return this._binding.constraint=i.taggedConstraint(t)(e),new r.BindingOnSyntax(this._binding)},t.prototype.whenInjectedInto=function(t){return this._binding.constraint=function(e){return i.typeConstraint(t)(e.parentRequest)},new r.BindingOnSyntax(this._binding)},t.prototype.whenParentNamed=function(t){return this._binding.constraint=function(e){return i.namedConstraint(t)(e.parentRequest)},new r.BindingOnSyntax(this._binding)},t.prototype.whenParentTagged=function(t,e){return this._binding.constraint=function(n){return i.taggedConstraint(t)(e)(n.parentRequest)},new r.BindingOnSyntax(this._binding)},t.prototype.whenAnyAncestorIs=function(t){return this._binding.constraint=function(e){return i.traverseAncerstors(e,i.typeConstraint(t))},new r.BindingOnSyntax(this._binding)},t.prototype.whenNoAncestorIs=function(t){return this._binding.constraint=function(e){return!i.traverseAncerstors(e,i.typeConstraint(t))},new r.BindingOnSyntax(this._binding)},t.prototype.whenAnyAncestorNamed=function(t){return this._binding.constraint=function(e){return i.traverseAncerstors(e,i.namedConstraint(t))},new r.BindingOnSyntax(this._binding)},t.prototype.whenNoAncestorNamed=function(t){return this._binding.constraint=function(e){return!i.traverseAncerstors(e,i.namedConstraint(t))},new r.BindingOnSyntax(this._binding)},t.prototype.whenAnyAncestorTagged=function(t,e){return this._binding.constraint=function(n){return i.traverseAncerstors(n,i.taggedConstraint(t)(e))},new r.BindingOnSyntax(this._binding)},t.prototype.whenNoAncestorTagged=function(t,e){return this._binding.constraint=function(n){return!i.traverseAncerstors(n,i.taggedConstraint(t)(e))},new r.BindingOnSyntax(this._binding)},t.prototype.whenAnyAncestorMatches=function(t){return this._binding.constraint=function(e){return i.traverseAncerstors(e,t)},new r.BindingOnSyntax(this._binding)},t.prototype.whenNoAncestorMatches=function(t){return this._binding.constraint=function(e){return!i.traverseAncerstors(e,t)},new r.BindingOnSyntax(this._binding)},t}();e.BindingWhenSyntax=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(7),i=function(){function t(t){this._binding=t}return t.prototype.onActivation=function(t){return this._binding.onActivation=t,new r.BindingWhenSyntax(this._binding)},t}();e.BindingOnSyntax=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(2),o=function(t,e){var n=t.parentRequest;return null!==n&&(!!e(n)||o(n,e))};e.traverseAncerstors=o;var a=function(t){return function(e){var n=function(n){return null!==n&&null!==n.target&&n.target.matchesTag(t)(e)};return n.metaData=new i.Metadata(t,e),n}};e.taggedConstraint=a;var s=a(r.NAMED_TAG);e.namedConstraint=s;e.typeConstraint=function(t){return function(e){var n=null;if(null!==e){if(n=e.bindings[0],"string"==typeof t)return n.serviceIdentifier===t;var r=e.bindings[0].implementationType;return t===r}return!1}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(8),i=n(7),o=function(){function t(t){this._binding=t,this._bindingWhenSyntax=new i.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new r.BindingOnSyntax(this._binding)}return t.prototype.when=function(t){return this._bindingWhenSyntax.when(t)},t.prototype.whenTargetNamed=function(t){return this._bindingWhenSyntax.whenTargetNamed(t)},t.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},t.prototype.whenTargetTagged=function(t,e){return this._bindingWhenSyntax.whenTargetTagged(t,e)},t.prototype.whenInjectedInto=function(t){return this._bindingWhenSyntax.whenInjectedInto(t)},t.prototype.whenParentNamed=function(t){return this._bindingWhenSyntax.whenParentNamed(t)},t.prototype.whenParentTagged=function(t,e){return this._bindingWhenSyntax.whenParentTagged(t,e)},t.prototype.whenAnyAncestorIs=function(t){return this._bindingWhenSyntax.whenAnyAncestorIs(t)},t.prototype.whenNoAncestorIs=function(t){return this._bindingWhenSyntax.whenNoAncestorIs(t)},t.prototype.whenAnyAncestorNamed=function(t){return this._bindingWhenSyntax.whenAnyAncestorNamed(t)},t.prototype.whenAnyAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenAnyAncestorTagged(t,e)},t.prototype.whenNoAncestorNamed=function(t){return this._bindingWhenSyntax.whenNoAncestorNamed(t)},t.prototype.whenNoAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenNoAncestorTagged(t,e)},t.prototype.whenAnyAncestorMatches=function(t){return this._bindingWhenSyntax.whenAnyAncestorMatches(t)},t.prototype.whenNoAncestorMatches=function(t){return this._bindingWhenSyntax.whenNoAncestorMatches(t)},t.prototype.onActivation=function(t){return this._bindingOnSyntax.onActivation(t)},t}();e.BindingWhenOnSyntax=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(5),o=n(2),a=n(39),s=function(){function t(t,e,n,s){this.id=i.id(),this.type=t,this.serviceIdentifier=n,this.name=new a.QueryableString(e||""),this.metadata=new Array;var u=null;"string"==typeof s?u=new o.Metadata(r.NAMED_TAG,s):s instanceof o.Metadata&&(u=s),null!==u&&this.metadata.push(u)}return t.prototype.hasTag=function(t){for(var e=0,n=this.metadata;e<n.length;e++){if(n[e].key===t)return!0}return!1},t.prototype.isArray=function(){return this.hasTag(r.MULTI_INJECT_TAG)},t.prototype.matchesArray=function(t){return this.matchesTag(r.MULTI_INJECT_TAG)(t)},t.prototype.isNamed=function(){return this.hasTag(r.NAMED_TAG)},t.prototype.isTagged=function(){return this.metadata.some(function(t){return t.key!==r.INJECT_TAG&&t.key!==r.MULTI_INJECT_TAG&&t.key!==r.NAME_TAG&&t.key!==r.UNMANAGED_TAG&&t.key!==r.NAMED_TAG})},t.prototype.isOptional=function(){return this.matchesTag(r.OPTIONAL_TAG)(!0)},t.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(t){return t.key===r.NAMED_TAG})[0]:null},t.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(t){return t.key!==r.INJECT_TAG&&t.key!==r.MULTI_INJECT_TAG&&t.key!==r.NAME_TAG&&t.key!==r.UNMANAGED_TAG&&t.key!==r.NAMED_TAG}):null},t.prototype.matchesNamedTag=function(t){return this.matchesTag(r.NAMED_TAG)(t)},t.prototype.matchesTag=function(t){var e=this;return function(n){for(var r=0,i=e.metadata;r<i.length;r++){var o=i[r];if(o.key===t&&o.value===n)return!0}return!1}},t}();e.Target=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n(0),o=n(2),a=n(4),s=function(){function t(t){this._cb=t}return t.prototype.unwrap=function(){return this._cb()},t}();e.LazyServiceIdentifer=s,e.inject=function(t){return function(e,n,s){if(void 0===t)throw new Error(r.UNDEFINED_INJECT_ANNOTATION(e.name));var u=new o.Metadata(i.INJECT_TAG,t);"number"==typeof s?a.tagParameter(e,n,s,u):a.tagProperty(e,n,u)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1);e.isStackOverflowExeption=function(t){return t instanceof RangeError||t.message===r.STACK_OVERFLOW}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=function(){function t(){}return t.prototype.getConstructorMetadata=function(t){return{compilerGeneratedMetadata:Reflect.getMetadata(r.PARAM_TYPES,t),userGeneratedMetadata:Reflect.getMetadata(r.TAGGED,t)||{}}},t.prototype.getPropertiesMetadata=function(t){return Reflect.getMetadata(r.TAGGED_PROP,t)||[]},t}();e.MetadataReader=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0);e.METADATA_KEY=r;var i=n(46);e.Container=i.Container;var o=n(3);e.BindingScopeEnum=o.BindingScopeEnum,e.BindingTypeEnum=o.BindingTypeEnum,e.TargetTypeEnum=o.TargetTypeEnum;var a=n(30);e.AsyncContainerModule=a.AsyncContainerModule,e.ContainerModule=a.ContainerModule;var s=n(29);e.injectable=s.injectable;var u=n(28);e.tagged=u.tagged;var c=n(27);e.named=c.named;var f=n(12);e.inject=f.inject,e.LazyServiceIdentifer=f.LazyServiceIdentifer;var d=n(26);e.optional=d.optional;var h=n(25);e.unmanaged=h.unmanaged;var l=n(24);e.multiInject=l.multiInject;var p=n(23);e.targetName=p.targetName;var y=n(22);e.postConstruct=y.postConstruct;var g=n(14);e.MetadataReader=g.MetadataReader;var _=n(5);e.id=_.id;var v=n(4);e.decorate=v.decorate;var m=n(9);e.traverseAncerstors=m.traverseAncerstors,e.taggedConstraint=m.taggedConstraint,e.namedConstraint=m.namedConstraint,e.typeConstraint=m.typeConstraint;var T=n(6);e.getServiceIdentifierAsString=T.getServiceIdentifierAsString;var E=n(21);e.multiBindToService=E.multiBindToService},function(t,e,n){var r,i,o;\n/* @license\nPapa Parse\nv4.6.2\nhttps://github.com/mholt/PapaParse\nLicense: MIT\n*/Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),i=[],void 0===(o="function"==typeof(r=function(){"use strict";var t,e,n="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n?n:{},r=!n.document&&!!n.postMessage,i=r&&/(\\?|&)papaworker(=|&|$)/.test(n.location.search),o=!1,a={},s=0,u={parse:function(e,r){var i=(r=r||{}).dynamicTyping||!1;if(A(i)&&(r.dynamicTypingFunction=i,i={}),r.dynamicTyping=i,r.transform=!!A(r.transform)&&r.transform,r.worker&&u.WORKERS_SUPPORTED){var c=function(){if(!u.WORKERS_SUPPORTED)return!1;if(!o&&null===u.SCRIPT_PATH)throw new Error("Script path cannot be determined automatically when Papa Parse is loaded asynchronously. You need to set Papa.SCRIPT_PATH manually.");var e=u.SCRIPT_PATH||t;e+=(-1!==e.indexOf("?")?"&":"?")+"papaworker";var r=new n.Worker(e);return r.onmessage=v,r.id=s++,a[r.id]=r}();return c.userStep=r.step,c.userChunk=r.chunk,c.userComplete=r.complete,c.userError=r.error,r.step=A(r.step),r.chunk=A(r.chunk),r.complete=A(r.complete),r.error=A(r.error),delete r.worker,void c.postMessage({input:e,config:r,workerId:c.id})}var f=null;return u.NODE_STREAM_INPUT,"string"==typeof e?f=r.download?new d(r):new l(r):!0===e.readable&&A(e.read)&&A(e.on)?f=new p(r):(n.File&&e instanceof File||e instanceof Object)&&(f=new h(r)),f.stream(e)},unparse:function(t,e){var n=!1,r=!0,i=",",o="\\r\\n",a=\'"\',s=!1;"object"==typeof e&&("string"!=typeof e.delimiter||u.BAD_DELIMITERS.filter(function(t){return-1!==e.delimiter.indexOf(t)}).length||(i=e.delimiter),("boolean"==typeof e.quotes||Array.isArray(e.quotes))&&(n=e.quotes),"boolean"!=typeof e.skipEmptyLines&&"string"!=typeof e.skipEmptyLines||(s=e.skipEmptyLines),"string"==typeof e.newline&&(o=e.newline),"string"==typeof e.quoteChar&&(a=e.quoteChar),"boolean"==typeof e.header&&(r=e.header));var c=new RegExp(a,"g");if("string"==typeof t&&(t=JSON.parse(t)),Array.isArray(t)){if(!t.length||Array.isArray(t[0]))return d(null,t,s);if("object"==typeof t[0])return d(f(t[0]),t,s)}else if("object"==typeof t)return"string"==typeof t.data&&(t.data=JSON.parse(t.data)),Array.isArray(t.data)&&(t.fields||(t.fields=t.meta&&t.meta.fields),t.fields||(t.fields=Array.isArray(t.data[0])?t.fields:f(t.data[0])),Array.isArray(t.data[0])||"object"==typeof t.data[0]||(t.data=[t.data])),d(t.fields||[],t.data||[],s);throw"exception: Unable to serialize unrecognized input";function f(t){if("object"!=typeof t)return[];var e=[];for(var n in t)e.push(n);return e}function d(t,e,n){var a="";"string"==typeof t&&(t=JSON.parse(t)),"string"==typeof e&&(e=JSON.parse(e));var s=Array.isArray(t)&&0<t.length,u=!Array.isArray(e[0]);if(s&&r){for(var c=0;c<t.length;c++)0<c&&(a+=i),a+=h(t[c],c);0<e.length&&(a+=o)}for(var f=0;f<e.length;f++){var d=s?t.length:e[f].length,l=!1,p=s?0===Object.keys(e[f]).length:0===e[f].length;if(n&&!s&&(l="greedy"===n?""===e[f].join("").trim():1===e[f].length&&0===e[f][0].length),"greedy"===n&&s){for(var y=[],g=0;g<d;g++){var _=u?t[g]:g;y.push(e[f][_])}l=""===y.join("").trim()}if(!l){for(var v=0;v<d;v++){0<v&&!p&&(a+=i);var m=s&&u?t[v]:v;a+=h(e[f][m],v)}f<e.length-1&&(!n||0<d&&!p)&&(a+=o)}}return a}function h(t,e){return null==t?"":t.constructor===Date?JSON.stringify(t).slice(1,25):(t=t.toString().replace(c,a+a),"boolean"==typeof n&&n||Array.isArray(n)&&n[e]||function(t,e){for(var n=0;n<e.length;n++)if(-1<t.indexOf(e[n]))return!0;return!1}(t,u.BAD_DELIMITERS)||-1<t.indexOf(i)||" "===t.charAt(0)||" "===t.charAt(t.length-1)?a+t+a:t)}}};if(u.RECORD_SEP=String.fromCharCode(30),u.UNIT_SEP=String.fromCharCode(31),u.BYTE_ORDER_MARK="\\ufeff",u.BAD_DELIMITERS=["\\r","\\n",\'"\',u.BYTE_ORDER_MARK],u.WORKERS_SUPPORTED=!r&&!!n.Worker,u.SCRIPT_PATH=null,u.NODE_STREAM_INPUT=1,u.LocalChunkSize=10485760,u.RemoteChunkSize=5242880,u.DefaultDelimiter=",",u.Parser=_,u.ParserHandle=y,u.NetworkStreamer=d,u.FileStreamer=h,u.StringStreamer=l,u.ReadableStreamStreamer=p,n.jQuery){var c=n.jQuery;c.fn.parse=function(t){var e=t.config||{},r=[];return this.each(function(t){if("INPUT"!==c(this).prop("tagName").toUpperCase()||"file"!==c(this).attr("type").toLowerCase()||!n.FileReader||!this.files||0===this.files.length)return!0;for(var i=0;i<this.files.length;i++)r.push({file:this.files[i],inputElem:this,instanceConfig:c.extend({},e)})}),i(),this;function i(){if(0!==r.length){var e,n,i,a=r[0];if(A(t.before)){var s=t.before(a.file,a.inputElem);if("object"==typeof s){if("abort"===s.action)return e=a.file,n=a.inputElem,i=s.reason,void(A(t.error)&&t.error({name:"AbortError"},e,n,i));if("skip"===s.action)return void o();"object"==typeof s.config&&(a.instanceConfig=c.extend(a.instanceConfig,s.config))}else if("skip"===s)return void o()}var f=a.instanceConfig.complete;a.instanceConfig.complete=function(t){A(f)&&f(t,a.file,a.inputElem),o()},u.parse(a.file,a.instanceConfig)}else A(t.complete)&&t.complete()}function o(){r.splice(0,1),i()}}}function f(t){this._handle=null,this._finished=!1,this._completed=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(t){var e=E(t);e.chunkSize=parseInt(e.chunkSize),t.step||t.chunk||(e.chunkSize=null),this._handle=new y(e),(this._handle.streamer=this)._config=e}.call(this,t),this.parseChunk=function(t,e){if(this.isFirstChunk&&A(this._config.beforeFirstChunk)){var r=this._config.beforeFirstChunk(t);void 0!==r&&(t=r)}this.isFirstChunk=!1;var o=this._partialLine+t;this._partialLine="";var a=this._handle.parse(o,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var s=a.meta.cursor;this._finished||(this._partialLine=o.substring(s-this._baseIndex),this._baseIndex=s),a&&a.data&&(this._rowCount+=a.data.length);var c=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(i)n.postMessage({results:a,workerId:u.WORKER_ID,finished:c});else if(A(this._config.chunk)&&!e){if(this._config.chunk(a,this._handle),this._handle.paused()||this._handle.aborted())return;a=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(a.data),this._completeResults.errors=this._completeResults.errors.concat(a.errors),this._completeResults.meta=a.meta),this._completed||!c||!A(this._config.complete)||a&&a.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),c||a&&a.meta.paused||this._nextChunk(),a}},this._sendError=function(t){A(this._config.error)?this._config.error(t):i&&this._config.error&&n.postMessage({workerId:u.WORKER_ID,error:t,finished:!1})}}function d(t){var e;(t=t||{}).chunkSize||(t.chunkSize=u.RemoteChunkSize),f.call(this,t),this._nextChunk=r?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(t){this._input=t,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(e=new XMLHttpRequest,this._config.withCredentials&&(e.withCredentials=this._config.withCredentials),r||(e.onload=b(this._chunkLoaded,this),e.onerror=b(this._chunkError,this)),e.open("GET",this._input,!r),this._config.downloadRequestHeaders){var t=this._config.downloadRequestHeaders;for(var n in t)e.setRequestHeader(n,t[n])}if(this._config.chunkSize){var i=this._start+this._config.chunkSize-1;e.setRequestHeader("Range","bytes="+this._start+"-"+i),e.setRequestHeader("If-None-Match","webkit-no-cache")}try{e.send()}catch(t){this._chunkError(t.message)}r&&0===e.status?this._chunkError():this._start+=this._config.chunkSize}},this._chunkLoaded=function(){var t;4===e.readyState&&(e.status<200||400<=e.status?this._chunkError():(this._finished=!this._config.chunkSize||this._start>(null===(t=e.getResponseHeader("Content-Range"))?-1:parseInt(t.substr(t.lastIndexOf("/")+1))),this.parseChunk(e.responseText)))},this._chunkError=function(t){var n=e.statusText||t;this._sendError(new Error(n))}}function h(t){var e,n;(t=t||{}).chunkSize||(t.chunkSize=u.LocalChunkSize),f.call(this,t);var r="undefined"!=typeof FileReader;this.stream=function(t){this._input=t,n=t.slice||t.webkitSlice||t.mozSlice,r?((e=new FileReader).onload=b(this._chunkLoaded,this),e.onerror=b(this._chunkError,this)):e=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var t=this._input;if(this._config.chunkSize){var i=Math.min(this._start+this._config.chunkSize,this._input.size);t=n.call(t,this._start,i)}var o=e.readAsText(t,this._config.encoding);r||this._chunkLoaded({target:{result:o}})},this._chunkLoaded=function(t){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(t.target.result)},this._chunkError=function(){this._sendError(e.error)}}function l(t){var e;f.call(this,t=t||{}),this.stream=function(t){return e=t,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var t=this._config.chunkSize,n=t?e.substr(0,t):e;return e=t?e.substr(t):"",this._finished=!e,this.parseChunk(n)}}}function p(t){f.call(this,t=t||{});var e=[],n=!0,r=!1;this.pause=function(){f.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){f.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(t){this._input=t,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){r&&1===e.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),e.length?this.parseChunk(e.shift()):n=!0},this._streamData=b(function(t){try{e.push("string"==typeof t?t:t.toString(this._config.encoding)),n&&(n=!1,this._checkIsFinished(),this.parseChunk(e.shift()))}catch(t){this._streamError(t)}},this),this._streamError=b(function(t){this._streamCleanUp(),this._sendError(t)},this),this._streamEnd=b(function(){this._streamCleanUp(),r=!0,this._streamData("")},this),this._streamCleanUp=b(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function y(t){var e,n,r,i=/^\\s*-?(\\d*\\.?\\d+|\\d+\\.?\\d*)(e[-+]?\\d+)?\\s*$/i,o=/(\\d{4}-[01]\\d-[0-3]\\dT[0-2]\\d:[0-5]\\d:[0-5]\\d\\.\\d+([+-][0-2]\\d:[0-5]\\d|Z))|(\\d{4}-[01]\\d-[0-3]\\dT[0-2]\\d:[0-5]\\d:[0-5]\\d([+-][0-2]\\d:[0-5]\\d|Z))|(\\d{4}-[01]\\d-[0-3]\\dT[0-2]\\d:[0-5]\\d([+-][0-2]\\d:[0-5]\\d|Z))/,a=this,s=0,c=0,f=!1,d=!1,h=[],l={data:[],errors:[],meta:{}};if(A(t.step)){var p=t.step;t.step=function(e){if(l=e,m())v();else{if(v(),0===l.data.length)return;s+=e.data.length,t.preview&&s>t.preview?n.abort():p(l,a)}}}function y(e){return"greedy"===t.skipEmptyLines?""===e.join("").trim():1===e.length&&0===e[0].length}function v(){if(l&&r&&(b("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to \'"+u.DefaultDelimiter+"\'"),r=!1),t.skipEmptyLines)for(var e=0;e<l.data.length;e++)y(l.data[e])&&l.data.splice(e--,1);return m()&&function(){if(l){for(var e=0;m()&&e<l.data.length;e++)for(var n=0;n<l.data[e].length;n++){var r=l.data[e][n];t.trimHeaders&&(r=r.trim()),h.push(r)}l.data.splice(0,1)}}(),function(){if(!l||!t.header&&!t.dynamicTyping&&!t.transform)return l;for(var e=0;e<l.data.length;e++){var n,r=t.header?{}:[];for(n=0;n<l.data[e].length;n++){var i=n,o=l.data[e][n];t.header&&(i=n>=h.length?"__parsed_extra":h[n]),t.transform&&(o=t.transform(o,i)),o=T(i,o),"__parsed_extra"===i?(r[i]=r[i]||[],r[i].push(o)):r[i]=o}l.data[e]=r,t.header&&(n>h.length?b("FieldMismatch","TooManyFields","Too many fields: expected "+h.length+" fields but parsed "+n,c+e):n<h.length&&b("FieldMismatch","TooFewFields","Too few fields: expected "+h.length+" fields but parsed "+n,c+e))}return t.header&&l.meta&&(l.meta.fields=h),c+=l.data.length,l}()}function m(){return t.header&&0===h.length}function T(e,n){return r=e,t.dynamicTypingFunction&&void 0===t.dynamicTyping[r]&&(t.dynamicTyping[r]=t.dynamicTypingFunction(r)),!0===(t.dynamicTyping[r]||t.dynamicTyping)?"true"===n||"TRUE"===n||"false"!==n&&"FALSE"!==n&&(i.test(n)?parseFloat(n):o.test(n)?new Date(n):""===n?null:n):n;var r}function b(t,e,n,r){l.errors.push({type:t,code:e,message:n,row:r})}this.parse=function(i,o,a){var s=t.quoteChar||\'"\';if(t.newline||(t.newline=function(t,e){t=t.substr(0,1048576);var n=new RegExp(g(e)+"([^]*?)"+g(e),"gm"),r=(t=t.replace(n,"")).split("\\r"),i=t.split("\\n"),o=1<i.length&&i[0].length<r[0].length;if(1===r.length||o)return"\\n";for(var a=0,s=0;s<r.length;s++)"\\n"===r[s][0]&&a++;return a>=r.length/2?"\\r\\n":"\\r"}(i,s)),r=!1,t.delimiter)A(t.delimiter)&&(t.delimiter=t.delimiter(i),l.meta.delimiter=t.delimiter);else{var c=function(e,n,r,i){for(var o,a,s,c=[",","\\t","|",";",u.RECORD_SEP,u.UNIT_SEP],f=0;f<c.length;f++){var d=c[f],h=0,l=0,p=0;s=void 0;for(var g=new _({comments:i,delimiter:d,newline:n,preview:10}).parse(e),v=0;v<g.data.length;v++)if(r&&y(g.data[v]))p++;else{var m=g.data[v].length;l+=m,void 0!==s?1<m&&(h+=Math.abs(m-s),s=m):s=m}0<g.data.length&&(l/=g.data.length-p),(void 0===a||h<a)&&1.99<l&&(a=h,o=d)}return{successful:!!(t.delimiter=o),bestDelimiter:o}}(i,t.newline,t.skipEmptyLines,t.comments);c.successful?t.delimiter=c.bestDelimiter:(r=!0,t.delimiter=u.DefaultDelimiter),l.meta.delimiter=t.delimiter}var d=E(t);return t.preview&&t.header&&d.preview++,e=i,n=new _(d),l=n.parse(e,o,a),v(),f?{meta:{paused:!0}}:l||{meta:{paused:!1}}},this.paused=function(){return f},this.pause=function(){f=!0,n.abort(),e=e.substr(n.getCharIndex())},this.resume=function(){f=!1,a.streamer.parseChunk(e,!0)},this.aborted=function(){return d},this.abort=function(){d=!0,n.abort(),l.meta.aborted=!0,A(t.complete)&&t.complete(l),e=""}}function g(t){return t.replace(/[.*+?^${}()|[\\]\\\\]/g,"\\\\$&")}function _(t){var e,n=(t=t||{}).delimiter,r=t.newline,i=t.comments,o=t.step,a=t.preview,s=t.fastMode,c=e=void 0===t.quoteChar?\'"\':t.quoteChar;if(void 0!==t.escapeChar&&(c=t.escapeChar),("string"!=typeof n||-1<u.BAD_DELIMITERS.indexOf(n))&&(n=","),i===n)throw"Comment character same as delimiter";!0===i?i="#":("string"!=typeof i||-1<u.BAD_DELIMITERS.indexOf(i))&&(i=!1),"\\n"!==r&&"\\r"!==r&&"\\r\\n"!==r&&(r="\\n");var f=0,d=!1;this.parse=function(t,u,h){if("string"!=typeof t)throw"Input must be a string";var l=t.length,p=n.length,y=r.length,g=i.length,_=A(o),v=[],m=[],T=[],E=f=0;if(!t)return L();if(s||!1!==s&&-1===t.indexOf(e)){for(var b=t.split(r),S=0;S<b.length;S++){if(T=b[S],f+=T.length,S!==b.length-1)f+=r.length;else if(h)return L();if(!i||T.substr(0,g)!==i){if(_){if(v=[],M(T.split(n)),x(),d)return L()}else M(T.split(n));if(a&&a<=S)return v=v.slice(0,a),L(!0)}}return L()}for(var w,O=t.indexOf(n,f),C=t.indexOf(r,f),I=new RegExp(c.replace(/[-[\\]/{}()*+?.\\\\^$|]/g,"\\\\$&")+e,"g");;)if(t[f]!==e)if(i&&0===T.length&&t.substr(f,g)===i){if(-1===C)return L();f=C+y,C=t.indexOf(r,f),O=t.indexOf(n,f)}else if(-1!==O&&(O<C||-1===C))T.push(t.substring(f,O)),f=O+p,O=t.indexOf(n,f);else{if(-1===C)break;if(T.push(t.substring(f,C)),k(C+y),_&&(x(),d))return L();if(a&&v.length>=a)return L(!0)}else for(w=f,f++;;){if(-1===(w=t.indexOf(e,w+1)))return h||m.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:v.length,index:f}),P();if(w===l-1)return P(t.substring(f,w).replace(I,e));if(e!==c||t[w+1]!==c){if(e===c||0===w||t[w-1]!==c){var N=D(-1===C?O:Math.min(O,C));if(t[w+1+N]===n){T.push(t.substring(f,w).replace(I,e)),f=w+1+N+p,O=t.indexOf(n,f),C=t.indexOf(r,f);break}var R=D(C);if(t.substr(w+1+R,y)===r){if(T.push(t.substring(f,w).replace(I,e)),k(w+1+R+y),O=t.indexOf(n,f),_&&(x(),d))return L();if(a&&v.length>=a)return L(!0);break}m.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:v.length,index:f}),w++}}else w++}return P();function M(t){v.push(t),E=f}function D(e){var n=0;if(-1!==e){var r=t.substring(w+1,e);r&&""===r.trim()&&(n=r.length)}return n}function P(e){return h||(void 0===e&&(e=t.substr(f)),T.push(e),f=l,M(T),_&&x()),L()}function k(e){f=e,M(T),T=[],C=t.indexOf(r,f)}function L(t){return{data:v,errors:m,meta:{delimiter:n,linebreak:r,aborted:d,truncated:!!t,cursor:E+(u||0)}}}function x(){o(L()),v=[],m=[]}},this.abort=function(){d=!0},this.getCharIndex=function(){return f}}function v(t){var e=t.data,n=a[e.workerId],r=!1;if(e.error)n.userError(e.error,e.file);else if(e.results&&e.results.data){var i={abort:function(){r=!0,m(e.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:T,resume:T};if(A(n.userStep)){for(var o=0;o<e.results.data.length&&(n.userStep({data:[e.results.data[o]],errors:e.results.errors,meta:e.results.meta},i),!r);o++);delete e.results}else A(n.userChunk)&&(n.userChunk(e.results,i,e.file),delete e.results)}e.finished&&!r&&m(e.workerId,e.results)}function m(t,e){var n=a[t];A(n.userComplete)&&n.userComplete(e),n.terminate(),delete a[t]}function T(){throw"Not implemented."}function E(t){if("object"!=typeof t||null===t)return t;var e=Array.isArray(t)?[]:{};for(var n in t)e[n]=E(t[n]);return e}function b(t,e){return function(){t.apply(e,arguments)}}function A(t){return"function"==typeof t}return i?n.onmessage=function(t){var e=t.data;if(void 0===u.WORKER_ID&&e&&(u.WORKER_ID=e.workerId),"string"==typeof e.input)n.postMessage({workerId:u.WORKER_ID,results:u.parse(e.input,e.config),finished:!0});else if(n.File&&e.input instanceof File||e.input instanceof Object){var r=u.parse(e.input,e.config);r&&n.postMessage({workerId:u.WORKER_ID,results:r,finished:!0})}}:u.WORKERS_SUPPORTED&&(e=document.getElementsByTagName("script"),t=e.length?e[e.length-1].src:"",document.body?document.addEventListener("DOMContentLoaded",function(){o=!0},!0):o=!0),(d.prototype=Object.create(f.prototype)).constructor=d,(h.prototype=Object.create(f.prototype)).constructor=h,(l.prototype=Object.create(l.prototype)).constructor=l,(p.prototype=Object.create(f.prototype)).constructor=p,u})?r.apply(e,i):r)||(t.exports=o)},function(t,e,n){"use strict";n.r(e);var r,i=n(16),o=n(15);class a{}a.GeoJSON={TYPE:"type",FEATURE_COLLECTION:"FeatureCollection",FEATURES:"features"},a.Injection={SELECTION_MANAGER:"selectionManager"},a.Module={LAYER:"layer",MAP:"map",CHART:"chart",CONTROL:"control",WIDGET_CONTROL:"widget control",BUTTON_CONTROL:"button control",DRAWER:"drawer"},a.Properties={DOM_ID:"domId",LAYERS:"layers",EXTENSIONS:"extensions",ATTRIBUTIONS:"attributions",LAYER_ID:"layerId",DATA_SOURCE:"dataSource",CLUSTERED_BY_PROPERTY:"clusteredByProperty",STYLE_FUNCTION:"styleFunction",SELECTED_STYLE_FUNCTION:"selectedStyleFunction",CREATE_FEATURE_FUNCTION:"createFeatureFunction",LAYER:"layer",DARK_LAYER:"darkLayer",SELECTIONS:"selections",NORMAL_ICON:"normalIcon",ACTIVE_ICON:"activeIcon",POSITION:"position",ICON_SIZE:"iconSize",BUTTON_CONTROL:"buttonControl",WIDGET:"widget",WIDGETS:"widgets",ON_CLICK_EMPTY_SPACE:"onClickEmptySpace",ON_CLICK_CLUSTER:"onClickCluster",HIT_TOLERANCE:"hitTolerance"},a.Chart={MARGIN_TYPES:new Set(["top","left","bottom","right"])},a.Map={},a.Layer={ID:"__layerId",KEY:"__layerKey",SELECTABLE:"__selectable",SUB_DATA_SIZE:2e5},a.Feature={KEY:"__featureKey",CLUSTER_PROPERTY:"__clusterProperty",FEATURES:"features",NUMBER_OF_POINTS:"numPoints",ALL_FEATURES:"allFeatures",VISIBLE:"visible"},a.DataSource={RECORD_KEY:"__key",GEOMETRY:"__geometry",SUB_DATA_SIZE:25e3},a.Selection={FEATURE_SELECTOR:"feature",CLUSTER_SELECTOR:"cluster",SINGLE_SELECTORS:["feature","cluster"],DONT_CARE:"*",SPLIT_SEPARATOR:"."},a.DrawManager={IS_DRAWN_FEATURE:"isDrawnFeature",DRAWN_FEATURE_COLORS:["#2ecc71","#0891eb","#e74c3c","#f1c40e","#8e44ad"]},a.WindRoseChart={BUCKET_SIZE:20,LABELS:["N","NNE","NE","ENE","E","ESE","SE","SSE","S","SSW","SW","WSW","W","WNW","NW","NNW"],SLICE_NUMBER:16,BASE_CHART_COLOR:"#333333"},function(t){t[t.BaseLayer=0]="BaseLayer",t[t.VectorLayer=1]="VectorLayer",t[t.CanvasLayer=2]="CanvasLayer",t[t.WebGlLayer=4]="WebGlLayer",t[t.LayerGroup=8]="LayerGroup",t[t.WMSLayer=16]="WMSLayer"}(r||(r={}));var s=r;class u{static isArray(t){return!!t&&t.constructor==[].constructor}static arrayOf(t,e){for(const n of e)if(!t(n))return!1;return!0}static percentageOrNumber(t){return u.percentage(t)||u.isNumber(t)}static percentage(t){return/[0-9]*\\.?[0-9]*%/.test(t)}isObject(t){return!!t&&t.constructor=={}.constructor}static isSintiumWidget(t){return!!t.getHTMLElement}static isWidget(t){const e=t;return!!(e.getHTMLElement&&e.onAddedToWidgetContainer&&e.getID&&e.onWidgetContainerSizeChange)}static isWidgetContainer(t){const e=t;return!!e.addWidget&&!!e.getWidgets}static isDataSource(t){return!!t.getDataContainerAsync}static isMapContainerExtension(t){return!!t.initializeExtension}static isMapControl(t){return!!t.addedToMap}static isMapBaseControl(t){const e=t;return!!(e.getHTMLElement&&e.getIndex&&e.getPosition&&e.getMapContainer)}static isMapButtonControl(t){const e=t;return u.isMapControl(e)&&!!e.onClick&&!!e.setActive}static isSelectionSpecificationContainer(t){return!!t.getSelectionSpecifications}static isLayerContainer(t){const e=t;return!!(e.getType&&e.getId&&e.getLayers&&e.getLayerCollection&&e.getVisible&&e.setVisible)}static isZoomableLayer(t){return!!t.getClusterExtent}static isSelectableLayer(t){const e=t;return!!e.addSelection&&!!e.featureSelection&&!!e.multiFeatureSelection}static isDataLayer(t){return!!t.getDataSource}static isClusterableLayer(t){const e=t;return!!e.isClustered&&!!e.setClustered}static isConfigurableLayer(t){return!!t.getAvailableUserConfigurations}static isLayerGroup(t){const e=t;return t.getType()==s.LayerGroup&&!!e.getLayerContainersInGroup}static isChartContainer(t){const e=t;return!!e.getChart&&!!e.resetChart}static isResponsiveChart(t){return!!t.onChartSizeChanged}static isOpenLayerTileLayer(t){return!!t.getUseInterimTilesOnError}static isString(t){return"string"==typeof t}static isObject(t){return t.constructor=={}.constructor}static isNumber(t){return"number"==typeof t}static isBoolean(t){return"boolean"==typeof t}static isFunction(t){return t&&"[object Function]"==={}.toString.call(t)}static isInEnum(t,e){for(const n of Object.keys(t))if(t[n]==e)return!0;return!1}static isObservable(t){return!!t.on}}var c;n(20);!function(t){t.STRING="string",t.NUMBER="number"}(c||(c={}));const f=()=>new Error("Unlabeled data must pass labels to datasource.");var d;!function(t){t[t.UNAUTHORIZED=0]="UNAUTHORIZED",t[t.SOURCE_NOT_FOUND=1]="SOURCE_NOT_FOUND",t[t.DONT_CARE=2]="DONT_CARE"}(d||(d={}));var h=d,l=function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};const{RECORD_KEY:p,GEOMETRY:y}=a.DataSource;let g=class{fetchRecords(t,e,n,r,i,o,a,s,u){this._getPromise(t,n).then(t=>{switch(t.status){case 200:return t.text();case 401:return Promise.reject(h.UNAUTHORIZED);case 404:return Promise.reject(h.SOURCE_NOT_FOUND);default:return Promise.reject(h.DONT_CARE)}}).then(t=>{try{t&&u&&(t=u(t));const{records:e,labels:n}=this.parseData(t,r,i,o,s);a(e,n)}catch(t){throw new Error(t)}}).catch(e=>{switch(e){case h.SOURCE_NOT_FOUND:throw Error(`Source not found: ${t}`);case h.UNAUTHORIZED:throw Error("Source requires authentication.");default:console.trace(e)}})}_getPromise(t,e){return e?fetch(t,e):fetch(t)}parseData(t,e,n,r,i){const o=this._tryToParseDataAsJSON(t);if(o)return this._isValidGeoJSON(o)?this._recordsFromGeoJSON(o):this._recordsFromJSON(o,e,n);const a=this._tryToParseDataAsCSV(t,i);if(a)return this._recordsFromCSV(a,e,r);throw(()=>new Error("Data is not valid."))()}_tryToParseDataAsJSON(t){if(this._isValidJSON(t))return t;try{return JSON.parse(t)}catch(t){return null}}_tryToParseDataAsCSV(t,e){const n=i.parse(t,{delimiter:e,dynamicTyping:!0,skipEmptyLines:"greedy"});if(0==n.errors.length)return n}_recordsFromGeoJSON(t){if(0===(t.features||[]).length)return{records:[],labels:[]};const e=t.features[0],n=Object.keys(e.properties);return{records:t.features.map((t,e)=>{const r=new Array(n.length+2);return r[0]=e,r[1]=t.geometry,n.forEach((e,n)=>{r[n+2]=t.properties[e]}),r}),labels:[p,y].concat(n)}}_recordsFromJSON(t,e,n){const r=t[0];let i;if(u.isArray(r)){if(!e)throw f();i=t.map((t,n)=>{const r=new Array(e.length+1);return r[0]=n,t.forEach((t,e)=>r[e+1]=t),r})}else u.isObject(r)&&(e=e||Object.keys(r),n?i=t.map((t,n)=>{const r=new Array(e.length+1);return r[0]=n,e.forEach((e,n)=>r[n+1]=t[e]),r}):(t.forEach((t,e)=>{t[p]=e}),i=t));return{records:i,labels:[p].concat(e)}}_recordsFromCSV(t,e,n){const r=t.data;let i=n?r.shift():e;if(!i)throw f();return{records:r.map((t,e)=>{const n=new Array(this._columnCount(r)+1);return n[0]=e,t.forEach((t,e)=>n[e+1]=t),n}),labels:i=[p].concat(i)}}_isValidGeoJSON(t){return t[a.GeoJSON.TYPE]==a.GeoJSON.FEATURE_COLLECTION&&t[a.GeoJSON.FEATURES]instanceof Array}_isValidJSON(t){return u.isArray(t)||u.isObject(t)}_columnCount(t){return t[0].length}};g=l([Object(o.injectable)()],g);const _=self,v=new g;function m(t,e,n){const{SUB_DATA_SIZE:r}=a.DataSource,i=Math.ceil(e.length/r);for(let n=0;n<i;n++){const i=n*r,o=(n+1)*r;T(t,e.slice(i,o))}!function(t,e){const n={type:"done",source:t,labels:e};_.postMessage(n)}(t,n)}function T(t,e){const n={type:"data",source:t,records:e};_.postMessage(n)}_.addEventListener("message",t=>{const{type:e,source:n,authenticationData:r,dataLabels:i,compact:o,csvHasHeader:a,idColumn:s,preprocessString:u,delimiter:c}=t.data;switch(e){case"fetch":const t=u?new Function("return "+u)():null,f=m.bind(null,n);v.fetchRecords(n,s,r,i,o,a,f,c,t)}});e.default=null},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var u,c=[],f=!1,d=-1;function h(){f&&u&&(f=!1,u.length?c=u.concat(c):d=-1,c.length&&l())}function l(){if(!f){var t=s(h);f=!0;for(var e=c.length;e;){for(u=c,c=[];++d<e;)u&&u[d].run();d=-1,e=c.length}u=null,f=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function y(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new p(t,e)),1!==c.length||f||s(l)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=y,i.addListener=y,i.once=y,i.off=y,i.removeListener=y,i.removeAllListeners=y,i.emit=y,i.prependListener=y,i.prependOnceListener=y,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){(function(t,e){\n/*! *****************************************************************************\nCopyright (C) Microsoft. All rights reserved.\nLicensed under the Apache License, Version 2.0 (the "License"); you may not use\nthis file except in compliance with the License. You may obtain a copy of the\nLicense at http://www.apache.org/licenses/LICENSE-2.0\n\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\nMERCHANTABLITY OR NON-INFRINGEMENT.\n\nSee the Apache Version 2.0 License for specific language governing permissions\nand limitations under the License.\n***************************************************************************** */\nvar n;!function(n){!function(r){var i="object"==typeof e?e:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),o=a(n);function a(t,e){return function(n,r){"function"!=typeof t[n]&&Object.defineProperty(t,n,{configurable:!0,writable:!0,value:r}),e&&e(n,r)}}void 0===i.Reflect?i.Reflect=n:o=a(i.Reflect,o),function(e){var n=Object.prototype.hasOwnProperty,r="function"==typeof Symbol,i=r&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",o=r&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",a="function"==typeof Object.create,s={__proto__:[]}instanceof Array,u=!a&&!s,c={create:a?function(){return P(Object.create(null))}:s?function(){return P({__proto__:null})}:function(){return P({})},has:u?function(t,e){return n.call(t,e)}:function(t,e){return e in t},get:u?function(t,e){return n.call(t,e)?t[e]:void 0}:function(t,e){return t[e]}},f=Object.getPrototypeOf(Function),d="object"==typeof t&&t.env&&"true"===t.env.REFLECT_METADATA_USE_MAP_POLYFILL,h=d||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function(){var t={},e=[],n=function(){function t(t,e,n){this._index=0,this._keys=t,this._values=e,this._selector=n}return t.prototype["@@iterator"]=function(){return this},t.prototype[o]=function(){return this},t.prototype.next=function(){var t=this._index;if(t>=0&&t<this._keys.length){var n=this._selector(this._keys[t],this._values[t]);return t+1>=this._keys.length?(this._index=-1,this._keys=e,this._values=e):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},t.prototype.throw=function(t){throw this._index>=0&&(this._index=-1,this._keys=e,this._values=e),t},t.prototype.return=function(t){return this._index>=0&&(this._index=-1,this._keys=e,this._values=e),{value:t,done:!0}},t}();return function(){function e(){this._keys=[],this._values=[],this._cacheKey=t,this._cacheIndex=-2}return Object.defineProperty(e.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),e.prototype.has=function(t){return this._find(t,!1)>=0},e.prototype.get=function(t){var e=this._find(t,!1);return e>=0?this._values[e]:void 0},e.prototype.set=function(t,e){var n=this._find(t,!0);return this._values[n]=e,this},e.prototype.delete=function(e){var n=this._find(e,!1);if(n>=0){for(var r=this._keys.length,i=n+1;i<r;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,e===this._cacheKey&&(this._cacheKey=t,this._cacheIndex=-2),!0}return!1},e.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=t,this._cacheIndex=-2},e.prototype.keys=function(){return new n(this._keys,this._values,r)},e.prototype.values=function(){return new n(this._keys,this._values,i)},e.prototype.entries=function(){return new n(this._keys,this._values,a)},e.prototype["@@iterator"]=function(){return this.entries()},e.prototype[o]=function(){return this.entries()},e.prototype._find=function(t,e){return this._cacheKey!==t&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=t)),this._cacheIndex<0&&e&&(this._cacheIndex=this._keys.length,this._keys.push(t),this._values.push(void 0)),this._cacheIndex},e}();function r(t,e){return t}function i(t,e){return e}function a(t,e){return[t,e]}}():Map,l=d||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function(){function t(){this._map=new h}return Object.defineProperty(t.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),t.prototype.has=function(t){return this._map.has(t)},t.prototype.add=function(t){return this._map.set(t,t),this},t.prototype.delete=function(t){return this._map.delete(t)},t.prototype.clear=function(){this._map.clear()},t.prototype.keys=function(){return this._map.keys()},t.prototype.values=function(){return this._map.values()},t.prototype.entries=function(){return this._map.entries()},t.prototype["@@iterator"]=function(){return this.keys()},t.prototype[o]=function(){return this.keys()},t}():Set,p=new(d||"function"!=typeof WeakMap?function(){var t=16,e=c.create(),r=i();return function(){function t(){this._key=i()}return t.prototype.has=function(t){var e=o(t,!1);return void 0!==e&&c.has(e,this._key)},t.prototype.get=function(t){var e=o(t,!1);return void 0!==e?c.get(e,this._key):void 0},t.prototype.set=function(t,e){return o(t,!0)[this._key]=e,this},t.prototype.delete=function(t){var e=o(t,!1);return void 0!==e&&delete e[this._key]},t.prototype.clear=function(){this._key=i()},t}();function i(){var t;do{t="@@WeakMap@@"+s()}while(c.has(e,t));return e[t]=!0,t}function o(t,e){if(!n.call(t,r)){if(!e)return;Object.defineProperty(t,r,{value:c.create()})}return t[r]}function a(t,e){for(var n=0;n<e;++n)t[n]=255*Math.random()|0;return t}function s(){var e,n=(e=t,"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):a(new Uint8Array(e),e):a(new Array(e),e));n[6]=79&n[6]|64,n[8]=191&n[8]|128;for(var r="",i=0;i<t;++i){var o=n[i];4!==i&&6!==i&&8!==i||(r+="-"),o<16&&(r+="0"),r+=o.toString(16).toLowerCase()}return r}}():WeakMap);function y(t,e,n){var r=p.get(t);if(E(r)){if(!n)return;r=new h,p.set(t,r)}var i=r.get(e);if(E(i)){if(!n)return;i=new h,r.set(e,i)}return i}function g(t,e,n){var r=y(e,n,!1);return!E(r)&&!!r.has(t)}function _(t,e,n){var r=y(e,n,!1);if(!E(r))return r.get(t)}function v(t,e,n,r){y(n,r,!0).set(t,e)}function m(t,e){var n=[],r=y(t,e,!1);if(E(r))return n;for(var i=function(t){var e=N(t,o);if(!C(e))throw new TypeError;var n=e.call(t);if(!A(n))throw new TypeError;return n}(r.keys()),a=0;;){var s=R(i);if(!s)return n.length=a,n;var u=s.value;try{n[a]=u}catch(t){try{M(i)}finally{throw t}}a++}}function T(t){if(null===t)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}function E(t){return void 0===t}function b(t){return null===t}function A(t){return"object"==typeof t?null!==t:"function"==typeof t}function S(t,e){switch(T(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}var n=3===e?"string":5===e?"number":"default",r=N(t,i);if(void 0!==r){var o=r.call(t,n);if(A(o))throw new TypeError;return o}return function(t,e){if("string"===e){var n=t.toString;if(C(n))if(!A(i=n.call(t)))return i;if(C(r=t.valueOf))if(!A(i=r.call(t)))return i}else{var r;if(C(r=t.valueOf))if(!A(i=r.call(t)))return i;var i,o=t.toString;if(C(o))if(!A(i=o.call(t)))return i}throw new TypeError}(t,"default"===n?"number":n)}function w(t){var e=S(t,3);return"symbol"==typeof e?e:function(t){return""+t}(e)}function O(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:"[object Array]"===Object.prototype.toString.call(t)}function C(t){return"function"==typeof t}function I(t){return"function"==typeof t}function N(t,e){var n=t[e];if(null!=n){if(!C(n))throw new TypeError;return n}}function R(t){var e=t.next();return!e.done&&e}function M(t){var e=t.return;e&&e.call(t)}function D(t){var e=Object.getPrototypeOf(t);if("function"!=typeof t||t===f)return e;if(e!==f)return e;var n=t.prototype,r=n&&Object.getPrototypeOf(n);if(null==r||r===Object.prototype)return e;var i=r.constructor;return"function"!=typeof i?e:i===t?e:i}function P(t){return t.__=void 0,delete t.__,t}e("decorate",function(t,e,n,r){if(E(n)){if(!O(t))throw new TypeError;if(!I(e))throw new TypeError;return function(t,e){for(var n=t.length-1;n>=0;--n){var r=(0,t[n])(e);if(!E(r)&&!b(r)){if(!I(r))throw new TypeError;e=r}}return e}(t,e)}if(!O(t))throw new TypeError;if(!A(e))throw new TypeError;if(!A(r)&&!E(r)&&!b(r))throw new TypeError;return b(r)&&(r=void 0),function(t,e,n,r){for(var i=t.length-1;i>=0;--i){var o=(0,t[i])(e,n,r);if(!E(o)&&!b(o)){if(!A(o))throw new TypeError;r=o}}return r}(t,e,n=w(n),r)}),e("metadata",function(t,e){return function(n,r){if(!A(n))throw new TypeError;if(!E(r)&&!function(t){switch(T(t)){case 3:case 4:return!0;default:return!1}}(r))throw new TypeError;v(t,e,n,r)}}),e("defineMetadata",function(t,e,n,r){if(!A(n))throw new TypeError;return E(r)||(r=w(r)),v(t,e,n,r)}),e("hasMetadata",function(t,e,n){if(!A(e))throw new TypeError;return E(n)||(n=w(n)),function t(e,n,r){var i=g(e,n,r);if(i)return!0;var o=D(n);if(!b(o))return t(e,o,r);return!1}(t,e,n)}),e("hasOwnMetadata",function(t,e,n){if(!A(e))throw new TypeError;return E(n)||(n=w(n)),g(t,e,n)}),e("getMetadata",function(t,e,n){if(!A(e))throw new TypeError;return E(n)||(n=w(n)),function t(e,n,r){var i=g(e,n,r);if(i)return _(e,n,r);var o=D(n);if(!b(o))return t(e,o,r);return}(t,e,n)}),e("getOwnMetadata",function(t,e,n){if(!A(e))throw new TypeError;return E(n)||(n=w(n)),_(t,e,n)}),e("getMetadataKeys",function(t,e){if(!A(t))throw new TypeError;return E(e)||(e=w(e)),function t(e,n){var r=m(e,n);var i=D(e);if(null===i)return r;var o=t(i,n);if(o.length<=0)return r;if(r.length<=0)return o;var a=new l;var s=[];for(var u=0,c=r;u<c.length;u++){var f=c[u];a.has(f)||(a.add(f),s.push(f))}for(var d=0,h=o;d<h.length;d++){f=h[d];a.has(f)||(a.add(f),s.push(f))}return s}(t,e)}),e("getOwnMetadataKeys",function(t,e){if(!A(t))throw new TypeError;return E(e)||(e=w(e)),m(t,e)}),e("deleteMetadata",function(t,e,n){if(!A(e))throw new TypeError;E(n)||(n=w(n));var r=y(e,n,!1);if(E(r))return!1;if(!r.delete(t))return!1;if(r.size>0)return!0;var i=p.get(e);return i.delete(n),i.size>0||(p.delete(e),!0)})}(o)}()}(n||(n={}))}).call(this,n(19),n(18))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.multiBindToService=function(t){return function(e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return n.forEach(function(n){return t.bind(n).toService(e)})}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n(0),o=n(2);e.postConstruct=function(){return function(t,e,n){var a=new o.Metadata(i.POST_CONSTRUCT,e);if(Reflect.hasOwnMetadata(i.POST_CONSTRUCT,t.constructor))throw new Error(r.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(i.POST_CONSTRUCT,a,t.constructor)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(2),o=n(4);e.targetName=function(t){return function(e,n,a){var s=new i.Metadata(r.NAME_TAG,t);o.tagParameter(e,n,a,s)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(2),o=n(4);e.multiInject=function(t){return function(e,n,a){var s=new i.Metadata(r.MULTI_INJECT_TAG,t);"number"==typeof a?o.tagParameter(e,n,a,s):o.tagProperty(e,n,s)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(2),o=n(4);e.unmanaged=function(){return function(t,e,n){var a=new i.Metadata(r.UNMANAGED_TAG,!0);o.tagParameter(t,e,n,a)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(2),o=n(4);e.optional=function(){return function(t,e,n){var a=new i.Metadata(r.OPTIONAL_TAG,!0);"number"==typeof n?o.tagParameter(t,e,n,a):o.tagProperty(t,e,a)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(2),o=n(4);e.named=function(t){return function(e,n,a){var s=new i.Metadata(r.NAMED_TAG,t);"number"==typeof a?o.tagParameter(e,n,a,s):o.tagProperty(e,n,s)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(4);e.tagged=function(t,e){return function(n,o,a){var s=new r.Metadata(t,e);"number"==typeof a?i.tagParameter(n,o,a,s):i.tagProperty(n,o,s)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n(0);e.injectable=function(){return function(t){if(Reflect.hasOwnMetadata(i.PARAM_TYPES,t))throw new Error(r.DUPLICATED_INJECTABLE_DECORATOR);var e=Reflect.getMetadata(i.DESIGN_PARAM_TYPES,t)||[];return Reflect.defineMetadata(i.PARAM_TYPES,e,t),t}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(5),i=function(t){this.id=r.id(),this.registry=t};e.ContainerModule=i;var o=function(t){this.id=r.id(),this.registry=t};e.AsyncContainerModule=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=function(){function t(){this._map=new Map}return t.prototype.getMap=function(){return this._map},t.prototype.add=function(t,e){if(null==t)throw new Error(r.NULL_ARGUMENT);if(null==e)throw new Error(r.NULL_ARGUMENT);var n=this._map.get(t);void 0!==n?(n.push(e),this._map.set(t,n)):this._map.set(t,[e])},t.prototype.get=function(t){if(null==t)throw new Error(r.NULL_ARGUMENT);var e=this._map.get(t);if(void 0!==e)return e;throw new Error(r.KEY_NOT_FOUND)},t.prototype.remove=function(t){if(null==t)throw new Error(r.NULL_ARGUMENT);if(!this._map.delete(t))throw new Error(r.KEY_NOT_FOUND)},t.prototype.removeByCondition=function(t){var e=this;this._map.forEach(function(n,r){var i=n.filter(function(e){return!t(e)});i.length>0?e._map.set(r,i):e._map.delete(r)})},t.prototype.hasKey=function(t){if(null==t)throw new Error(r.NULL_ARGUMENT);return this._map.has(t)},t.prototype.clone=function(){var e=new t;return this._map.forEach(function(t,n){t.forEach(function(t){return e.add(n,t.clone())})}),e},t.prototype.traverse=function(t){this._map.forEach(function(e,n){t(n,e)})},t}();e.Lookup=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t.of=function(e,n){var r=new t;return r.bindings=e,r.middleware=n,r},t}();e.ContainerSnapshot=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),i=n(10),o=function(){function t(t){this._binding=t}return t.prototype.inRequestScope=function(){return this._binding.scope=r.BindingScopeEnum.Request,new i.BindingWhenOnSyntax(this._binding)},t.prototype.inSingletonScope=function(){return this._binding.scope=r.BindingScopeEnum.Singleton,new i.BindingWhenOnSyntax(this._binding)},t.prototype.inTransientScope=function(){return this._binding.scope=r.BindingScopeEnum.Transient,new i.BindingWhenOnSyntax(this._binding)},t}();e.BindingInSyntax=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(33),i=n(8),o=n(7),a=function(){function t(t){this._binding=t,this._bindingWhenSyntax=new o.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new i.BindingOnSyntax(this._binding),this._bindingInSyntax=new r.BindingInSyntax(t)}return t.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},t.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},t.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},t.prototype.when=function(t){return this._bindingWhenSyntax.when(t)},t.prototype.whenTargetNamed=function(t){return this._bindingWhenSyntax.whenTargetNamed(t)},t.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},t.prototype.whenTargetTagged=function(t,e){return this._bindingWhenSyntax.whenTargetTagged(t,e)},t.prototype.whenInjectedInto=function(t){return this._bindingWhenSyntax.whenInjectedInto(t)},t.prototype.whenParentNamed=function(t){return this._bindingWhenSyntax.whenParentNamed(t)},t.prototype.whenParentTagged=function(t,e){return this._bindingWhenSyntax.whenParentTagged(t,e)},t.prototype.whenAnyAncestorIs=function(t){return this._bindingWhenSyntax.whenAnyAncestorIs(t)},t.prototype.whenNoAncestorIs=function(t){return this._bindingWhenSyntax.whenNoAncestorIs(t)},t.prototype.whenAnyAncestorNamed=function(t){return this._bindingWhenSyntax.whenAnyAncestorNamed(t)},t.prototype.whenAnyAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenAnyAncestorTagged(t,e)},t.prototype.whenNoAncestorNamed=function(t){return this._bindingWhenSyntax.whenNoAncestorNamed(t)},t.prototype.whenNoAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenNoAncestorTagged(t,e)},t.prototype.whenAnyAncestorMatches=function(t){return this._bindingWhenSyntax.whenAnyAncestorMatches(t)},t.prototype.whenNoAncestorMatches=function(t){return this._bindingWhenSyntax.whenNoAncestorMatches(t)},t.prototype.onActivation=function(t){return this._bindingOnSyntax.onActivation(t)},t}();e.BindingInWhenOnSyntax=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n(3),o=n(34),a=n(10),s=function(){function t(t){this._binding=t}return t.prototype.to=function(t){return this._binding.type=i.BindingTypeEnum.Instance,this._binding.implementationType=t,new o.BindingInWhenOnSyntax(this._binding)},t.prototype.toSelf=function(){if("function"!=typeof this._binding.serviceIdentifier)throw new Error(""+r.INVALID_TO_SELF_VALUE);var t=this._binding.serviceIdentifier;return this.to(t)},t.prototype.toConstantValue=function(t){return this._binding.type=i.BindingTypeEnum.ConstantValue,this._binding.cache=t,this._binding.dynamicValue=null,this._binding.implementationType=null,new a.BindingWhenOnSyntax(this._binding)},t.prototype.toDynamicValue=function(t){return this._binding.type=i.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=t,this._binding.implementationType=null,new o.BindingInWhenOnSyntax(this._binding)},t.prototype.toConstructor=function(t){return this._binding.type=i.BindingTypeEnum.Constructor,this._binding.implementationType=t,new a.BindingWhenOnSyntax(this._binding)},t.prototype.toFactory=function(t){return this._binding.type=i.BindingTypeEnum.Factory,this._binding.factory=t,new a.BindingWhenOnSyntax(this._binding)},t.prototype.toFunction=function(t){if("function"!=typeof t)throw new Error(r.INVALID_FUNCTION_BINDING);var e=this.toConstantValue(t);return this._binding.type=i.BindingTypeEnum.Function,e},t.prototype.toAutoFactory=function(t){return this._binding.type=i.BindingTypeEnum.Factory,this._binding.factory=function(e){return function(){return e.container.get(t)}},new a.BindingWhenOnSyntax(this._binding)},t.prototype.toProvider=function(t){return this._binding.type=i.BindingTypeEnum.Provider,this._binding.provider=t,new a.BindingWhenOnSyntax(this._binding)},t.prototype.toService=function(t){this.toDynamicValue(function(e){return e.container.get(t)})},t}();e.BindingToSyntax=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n(3),o=n(0);e.resolveInstance=function(t,e,n){var a,s,u=null;if(e.length>0){var c=e.filter(function(t){return null!==t.target&&t.target.type===i.TargetTypeEnum.ConstructorArgument}).map(n);s=c,u=function(t,e,n){var r=e.filter(function(t){return null!==t.target&&t.target.type===i.TargetTypeEnum.ClassProperty}),o=r.map(n);return r.forEach(function(e,n){var r;r=e.target.name.value();var i=o[n];t[r]=i}),t}(u=new((a=t).bind.apply(a,[void 0].concat(s))),e,n)}else u=new t;return function(t,e){if(Reflect.hasMetadata(o.POST_CONSTRUCT,t)){var n=Reflect.getMetadata(o.POST_CONSTRUCT,t);try{e[n.value]()}catch(e){throw new Error(r.POST_CONSTRUCT_ERROR(t.name,e.message))}}}(t,u),u}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n(3),o=n(13),a=n(6),s=n(36),u=function(t,e,n){try{return n()}catch(n){throw o.isStackOverflowExeption(n)?new Error(r.CIRCULAR_DEPENDENCY_IN_FACTORY(t,e.toString())):n}},c=function(t){return function(e){e.parentContext.setCurrentRequest(e);var n=e.bindings,o=e.childRequests,f=e.target&&e.target.isArray(),d=!(e.parentRequest&&e.parentRequest.target&&e.target&&e.parentRequest.target.matchesArray(e.target.serviceIdentifier));if(f&&d)return o.map(function(e){return c(t)(e)});var h=null;if(!e.target.isOptional()||0!==n.length){var l=n[0],p=l.scope===i.BindingScopeEnum.Singleton,y=l.scope===i.BindingScopeEnum.Request;if(p&&l.activated)return l.cache;if(y&&null!==t&&t.has(l.id))return t.get(l.id);if(l.type===i.BindingTypeEnum.ConstantValue)h=l.cache;else if(l.type===i.BindingTypeEnum.Function)h=l.cache;else if(l.type===i.BindingTypeEnum.Constructor)h=l.implementationType;else if(l.type===i.BindingTypeEnum.DynamicValue&&null!==l.dynamicValue)h=u("toDynamicValue",l.serviceIdentifier,function(){return l.dynamicValue(e.parentContext)});else if(l.type===i.BindingTypeEnum.Factory&&null!==l.factory)h=u("toFactory",l.serviceIdentifier,function(){return l.factory(e.parentContext)});else if(l.type===i.BindingTypeEnum.Provider&&null!==l.provider)h=u("toProvider",l.serviceIdentifier,function(){return l.provider(e.parentContext)});else{if(l.type!==i.BindingTypeEnum.Instance||null===l.implementationType){var g=a.getServiceIdentifierAsString(e.serviceIdentifier);throw new Error(r.INVALID_BINDING_TYPE+" "+g)}h=s.resolveInstance(l.implementationType,o,c(t))}return"function"==typeof l.onActivation&&(h=l.onActivation(e.parentContext,h)),p&&(l.cache=h,l.activated=!0),y&&null!==t&&!t.has(l.id)&&t.set(l.id,h),h}}};e.resolve=function(t){return c(t.plan.rootRequest.requestScope)(t.plan.rootRequest)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(5),i=function(){function t(t,e,n,i,o){this.id=r.id(),this.serviceIdentifier=t,this.parentContext=e,this.parentRequest=n,this.target=o,this.childRequests=[],this.bindings=Array.isArray(i)?i:[i],this.requestScope=null===n?new Map:null}return t.prototype.addChildRequest=function(e,n,r){var i=new t(e,this.parentContext,this,n,r);return this.childRequests.push(i),i},t}();e.Request=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this.str=t}return t.prototype.startsWith=function(t){return 0===this.str.indexOf(t)},t.prototype.endsWith=function(t){var e,n=t.split("").reverse().join("");return e=this.str.split("").reverse().join(""),this.startsWith.call({str:e},n)},t.prototype.contains=function(t){return-1!==this.str.indexOf(t)},t.prototype.equals=function(t){return this.str===t},t.prototype.value=function(){return this.str},t}();e.QueryableString=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(12),i=n(1),o=n(3),a=n(0),s=n(6);e.getFunctionName=s.getFunctionName;var u=n(11);function c(t,e,n,r){var a=t.getConstructorMetadata(n),s=a.compilerGeneratedMetadata;if(void 0===s){var c=i.MISSING_INJECTABLE_ANNOTATION+" "+e+".";throw new Error(c)}var h=a.userGeneratedMetadata,l=Object.keys(h),p=function(t,e,n,r,i){for(var o=[],a=0;a<i;a++){var s=f(a,t,e,n,r);null!==s&&o.push(s)}return o}(r,e,s,h,0===n.length&&l.length>0?l.length:n.length),y=function t(e,n){var r=e.getPropertiesMetadata(n);var i=[];var a=Object.keys(r);for(var s=0,c=a;s<c.length;s++){var f=c[s],h=r[f],l=d(r[f]),p=l.targetName||f,y=l.inject||l.multiInject,g=new u.Target(o.TargetTypeEnum.ClassProperty,p,y);g.metadata=h,i.push(g)}var _=Object.getPrototypeOf(n.prototype).constructor;if(_!==Object){var v=t(e,_);i=i.concat(v)}return i}(t,n);return p.concat(y)}function f(t,e,n,a,s){var c=s[t.toString()]||[],f=d(c),h=!0!==f.unmanaged,l=a[t],p=f.inject||f.multiInject;if((l=p||l)instanceof r.LazyServiceIdentifer&&(l=l.unwrap()),h){var y=l===Object,g=l===Function;if(!e&&(y||g||void 0===l)){var _=i.MISSING_INJECT_ANNOTATION+" argument "+t+" in class "+n+".";throw new Error(_)}var v=new u.Target(o.TargetTypeEnum.ConstructorArgument,f.targetName,l);return v.metadata=c,v}return null}function d(t){var e={};return t.forEach(function(t){e[t.key.toString()]=t.value}),{inject:e[a.INJECT_TAG],multiInject:e[a.MULTI_INJECT_TAG],targetName:e[a.NAME_TAG],unmanaged:e[a.UNMANAGED_TAG]}}e.getDependencies=function(t,e){return c(t,s.getFunctionName(e),e,!1)},e.getBaseClassDependencyCount=function t(e,n){var r=Object.getPrototypeOf(n.prototype).constructor;if(r!==Object){var i=c(e,s.getFunctionName(r),r,!0),o=i.map(function(t){return t.metadata.filter(function(t){return t.key===a.UNMANAGED_TAG})}),u=[].concat.apply([],o).length,f=i.length-u;return f>0?f:t(e,r)}return 0}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(t,e){this.parentContext=t,this.rootRequest=e};e.Plan=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(5),i=function(){function t(t){this.id=r.id(),this.container=t}return t.prototype.addPlan=function(t){this.plan=t},t.prototype.setCurrentRequest=function(t){this.currentRequest=t},t}();e.Context=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.BindingCount={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(43),i=n(1),o=n(3),a=n(0),s=n(13),u=n(6),c=n(42),f=n(2),d=n(41),h=n(40),l=n(38),p=n(11);function y(t){return t._bindingDictionary}function g(t,e,n,o,a){var s=_(n.container,a.serviceIdentifier),c=[];return s.length===r.BindingCount.NoBindingsAvailable&&n.container.options.autoBindInjectable&&"function"==typeof a.serviceIdentifier&&t.getConstructorMetadata(a.serviceIdentifier).compilerGeneratedMetadata&&(n.container.bind(a.serviceIdentifier).toSelf(),s=_(n.container,a.serviceIdentifier)),c=e?s:s.filter(function(t){var e=new l.Request(t.serviceIdentifier,n,o,t,a);return t.constraint(e)}),function(t,e,n,o){switch(e.length){case r.BindingCount.NoBindingsAvailable:if(n.isOptional())return e;var a=u.getServiceIdentifierAsString(t),s=i.NOT_REGISTERED;throw s+=u.listMetadataForTarget(a,n),s+=u.listRegisteredBindingsForServiceIdentifier(o,a,_),new Error(s);case r.BindingCount.OnlyOneBindingAvailable:if(!n.isArray())return e;case r.BindingCount.MultipleBindingsAvailable:default:if(n.isArray())return e;a=u.getServiceIdentifierAsString(t),s=i.AMBIGUOUS_MATCH+" "+a;throw s+=u.listRegisteredBindingsForServiceIdentifier(o,a,_),new Error(s)}}(a.serviceIdentifier,c,a,n.container),c}function _(t,e){var n=[],r=y(t);return r.hasKey(e)?n=r.get(e):null!==t.parent&&(n=_(t.parent,e)),n}e.getBindingDictionary=y,e.plan=function(t,e,n,r,y,_,v,m){void 0===m&&(m=!1);var T=new c.Context(e),E=function(t,e,n,r,i,o){var s=t?a.MULTI_INJECT_TAG:a.INJECT_TAG,u=new f.Metadata(s,n),c=new p.Target(e,r,n,u);if(void 0!==i){var d=new f.Metadata(i,o);c.metadata.push(d)}return c}(n,r,y,"",_,v);try{return function t(e,n,r,a,s,u){var c,f;if(null===s){c=g(e,n,a,null,u),f=new l.Request(r,a,null,c,u);var p=new d.Plan(a,f);a.addPlan(p)}else c=g(e,n,a,s,u),f=s.addChildRequest(u.serviceIdentifier,c,u);c.forEach(function(n){var r=null;if(u.isArray())r=f.addChildRequest(n.serviceIdentifier,n,u);else{if(n.cache)return;r=f}if(n.type===o.BindingTypeEnum.Instance&&null!==n.implementationType){var s=h.getDependencies(e,n.implementationType);if(!a.container.options.skipBaseClassChecks){var c=h.getBaseClassDependencyCount(e,n.implementationType);if(s.length<c){var d=i.ARGUMENTS_LENGTH_MISMATCH(h.getFunctionName(n.implementationType));throw new Error(d)}}s.forEach(function(n){t(e,!1,n.serviceIdentifier,a,r,n)})}})}(t,m,y,T,null,E),T}catch(t){throw s.isStackOverflowExeption(t)&&T.plan&&u.circularDependencyToException(T.plan.rootRequest),t}},e.createMockRequest=function(t,e,n,r){var i=new p.Target(o.TargetTypeEnum.Variable,"",e,new f.Metadata(n,r)),a=new c.Context(t);return new l.Request(e,a,null,[],i)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),i=n(5),o=function(){function t(t,e){this.id=i.id(),this.activated=!1,this.serviceIdentifier=t,this.scope=e,this.type=r.BindingTypeEnum.Invalid,this.constraint=function(t){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return t.prototype.clone=function(){var e=new t(this.serviceIdentifier,this.scope);return e.activated=!1,e.implementationType=this.implementationType,e.dynamicValue=this.dynamicValue,e.scope=this.scope,e.type=this.type,e.factory=this.factory,e.provider=this.provider,e.constraint=this.constraint,e.onActivation=this.onActivation,e.cache=this.cache,e},t}();e.Binding=o},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(45),a=n(1),s=n(3),u=n(0),c=n(14),f=n(44),d=n(37),h=n(35),l=n(5),p=n(6),y=n(32),g=n(31),_=function(){function t(t){var e=t||{};if("object"!=typeof e)throw new Error(""+a.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(void 0===e.defaultScope)e.defaultScope=s.BindingScopeEnum.Transient;else if(e.defaultScope!==s.BindingScopeEnum.Singleton&&e.defaultScope!==s.BindingScopeEnum.Transient&&e.defaultScope!==s.BindingScopeEnum.Request)throw new Error(""+a.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(void 0===e.autoBindInjectable)e.autoBindInjectable=!1;else if("boolean"!=typeof e.autoBindInjectable)throw new Error(""+a.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(void 0===e.skipBaseClassChecks)e.skipBaseClassChecks=!1;else if("boolean"!=typeof e.skipBaseClassChecks)throw new Error(""+a.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:e.autoBindInjectable,defaultScope:e.defaultScope,skipBaseClassChecks:e.skipBaseClassChecks},this.id=l.id(),this._bindingDictionary=new g.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new c.MetadataReader}return t.merge=function(e,n){var r=new t,i=f.getBindingDictionary(r),o=f.getBindingDictionary(e),a=f.getBindingDictionary(n);function s(t,e){t.traverse(function(t,n){n.forEach(function(t){e.add(t.serviceIdentifier,t.clone())})})}return s(o,i),s(a,i),r},t.prototype.load=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=this._getContainerModuleHelpersFactory(),r=0,i=t;r<i.length;r++){var o=i[r],a=n(o.id);o.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction)}},t.prototype.loadAsync=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return r(this,void 0,void 0,function(){var e,n,r,o,a;return i(this,function(i){switch(i.label){case 0:e=this._getContainerModuleHelpersFactory(),n=0,r=t,i.label=1;case 1:return n<r.length?(o=r[n],a=e(o.id),[4,o.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction)]):[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},t.prototype.unload=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(t){return function(e){return e.moduleId===t}};e.forEach(function(e){var n=r(e.id);t._bindingDictionary.removeByCondition(n)})},t.prototype.bind=function(t){var e=this.options.defaultScope||s.BindingScopeEnum.Transient,n=new o.Binding(t,e);return this._bindingDictionary.add(t,n),new h.BindingToSyntax(n)},t.prototype.rebind=function(t){return this.unbind(t),this.bind(t)},t.prototype.unbind=function(t){try{this._bindingDictionary.remove(t)}catch(e){throw new Error(a.CANNOT_UNBIND+" "+p.getServiceIdentifierAsString(t))}},t.prototype.unbindAll=function(){this._bindingDictionary=new g.Lookup},t.prototype.isBound=function(t){var e=this._bindingDictionary.hasKey(t);return!e&&this.parent&&(e=this.parent.isBound(t)),e},t.prototype.isBoundNamed=function(t,e){return this.isBoundTagged(t,u.NAMED_TAG,e)},t.prototype.isBoundTagged=function(t,e,n){var r=!1;if(this._bindingDictionary.hasKey(t)){var i=this._bindingDictionary.get(t),o=f.createMockRequest(this,t,e,n);r=i.some(function(t){return t.constraint(o)})}return!r&&this.parent&&(r=this.parent.isBoundTagged(t,e,n)),r},t.prototype.snapshot=function(){this._snapshots.push(y.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},t.prototype.restore=function(){var t=this._snapshots.pop();if(void 0===t)throw new Error(a.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=t.bindings,this._middleware=t.middleware},t.prototype.createChild=function(e){var n=new t(e||this.options);return n.parent=this,n},t.prototype.applyMiddleware=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=t.reduce(function(t,e){return e(t)},n)},t.prototype.applyCustomMetadataReader=function(t){this._metadataReader=t},t.prototype.get=function(t){return this._get(!1,!1,s.TargetTypeEnum.Variable,t)},t.prototype.getTagged=function(t,e,n){return this._get(!1,!1,s.TargetTypeEnum.Variable,t,e,n)},t.prototype.getNamed=function(t,e){return this.getTagged(t,u.NAMED_TAG,e)},t.prototype.getAll=function(t){return this._get(!0,!0,s.TargetTypeEnum.Variable,t)},t.prototype.getAllTagged=function(t,e,n){return this._get(!1,!0,s.TargetTypeEnum.Variable,t,e,n)},t.prototype.getAllNamed=function(t,e){return this.getAllTagged(t,u.NAMED_TAG,e)},t.prototype.resolve=function(t){var e=this.createChild();return e.bind(t).toSelf(),e.get(t)},t.prototype._getContainerModuleHelpersFactory=function(){var t=this,e=function(t,e){t._binding.moduleId=e},n=function(n){return function(r){var i=t.rebind.bind(t)(r);return e(i,n),i}};return function(r){return{bindFunction:(i=r,function(n){var r=t.bind.bind(t)(n);return e(r,i),r}),isboundFunction:function(e){return t.isBound.bind(t)(e)},rebindFunction:n(r),unbindFunction:function(e){t.unbind.bind(t)(e)}};var i}},t.prototype._get=function(t,e,n,r,i,o){var s=null,u={avoidConstraints:t,contextInterceptor:function(t){return t},isMultiInject:e,key:i,serviceIdentifier:r,targetType:n,value:o};if(this._middleware){if(null==(s=this._middleware(u)))throw new Error(a.INVALID_MIDDLEWARE_RETURN)}else s=this._planAndResolve()(u);return s},t.prototype._planAndResolve=function(){var t=this;return function(e){var n=f.plan(t._metadataReader,t,e.isMultiInject,e.targetType,e.serviceIdentifier,e.key,e.value,e.avoidConstraints);return n=e.contextInterceptor(n),d.resolve(n)}},t}();e.Container=_}]);',null)}},function(t,e,n){"use strict";
/*!
 * assign-deep <https://github.com/jonschlinkert/assign-deep>
 *
 * Copyright (c) 2017-present, Jon Schlinkert.
 * Released under the MIT License.
 */const i=Object.prototype.toString,r=n(66),o=t=>"__proto__"!==t&&"constructor"!==t&&"prototype"!==t,s=t.exports=(t,...e)=>{let n=0;for(function(t){return"object"==typeof t?null===t:"function"!=typeof t}(t)&&(t=e[n++]),t||(t={});n<e.length;n++)if(a(e[n])){for(const i of Object.keys(e[n]))o(i)&&(a(t[i])&&a(e[n][i])?s(t[i],e[n][i]):t[i]=e[n][i]);r(t,e[n])}return t};function a(t){return"function"==typeof t||"[object Object]"===i.call(t)}},function(t,e){t.exports=crossfilter},function(t,e,n){"use strict";t.exports=r,t.exports.default=r;var i=n(95);function r(t,e){if(!(this instanceof r))return new r(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function o(t,e,n){if(!n)return e.indexOf(t);for(var i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}function s(t,e){a(t,0,t.children.length,e,t)}function a(t,e,n,i,r){r||(r=g(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var o,s=e;s<n;s++)o=t.children[s],c(r,t.leaf?i(o):o);return r}function c(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function l(t,e){return t.minX-e.minX}function u(t,e){return t.minY-e.minY}function h(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function d(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function p(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function g(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function _(t,e,n,r,o){for(var s,a=[e,n];a.length;)(n=a.pop())-(e=a.pop())<=r||(s=e+Math.ceil((n-e)/r/2)*r,i(t,s,e,n,o),a.push(e,s,s,n))}r.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],i=this.toBBox;if(!p(t,e))return n;for(var r,o,s,a,c=[];e;){for(r=0,o=e.children.length;r<o;r++)s=e.children[r],p(t,a=e.leaf?i(s):s)&&(e.leaf?n.push(s):f(t,a)?this._all(s,n):c.push(s));e=c.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!p(t,e))return!1;for(var i,r,o,s,a=[];e;){for(i=0,r=e.children.length;i<r;i++)if(o=e.children[i],p(t,s=e.leaf?n(o):o)){if(e.leaf||f(t,s))return!0;a.push(o)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var r=this.data;this.data=i,i=r}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=g([]),this},remove:function(t,e){if(!t)return this;for(var n,i,r,s,a=this.data,c=this.toBBox(t),l=[],u=[];a||l.length;){if(a||(a=l.pop(),i=l[l.length-1],n=u.pop(),s=!0),a.leaf&&-1!==(r=o(t,a.children,e)))return a.children.splice(r,1),l.push(a),this._condense(l),this;s||a.leaf||!f(a,c)?i?(n++,a=i.children[n],s=!1):a=null:(l.push(a),u.push(n),n=0,i=a,a=a.children[0])}return this},toBBox:function(t){return t},compareMinX:l,compareMinY:u,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,i){var r,o=n-e+1,a=this._maxEntries;if(o<=a)return s(r=g(t.slice(e,n+1)),this.toBBox),r;i||(i=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,i-1))),(r=g([])).leaf=!1,r.height=i;var c,l,u,h,d=Math.ceil(o/a),f=d*Math.ceil(Math.sqrt(a));for(_(t,e,n,f,this.compareMinX),c=e;c<=n;c+=f)for(_(t,c,u=Math.min(c+f-1,n),d,this.compareMinY),l=c;l<=u;l+=d)h=Math.min(l+d-1,u),r.children.push(this._build(t,l,h,i-1));return s(r,this.toBBox),r},_chooseSubtree:function(t,e,n,i){for(var r,o,s,a,c,l,u,d,f,p;i.push(e),!e.leaf&&i.length-1!==n;){for(u=d=1/0,r=0,o=e.children.length;r<o;r++)c=h(s=e.children[r]),f=t,p=s,(l=(Math.max(p.maxX,f.maxX)-Math.min(p.minX,f.minX))*(Math.max(p.maxY,f.maxY)-Math.min(p.minY,f.minY))-c)<d?(d=l,u=c<u?c:u,a=s):l===d&&c<u&&(u=c,a=s);e=a||e.children[0]}return e},_insert:function(t,e,n){var i=this.toBBox,r=n?t:i(t),o=[],s=this._chooseSubtree(r,this.data,e,o);for(s.children.push(t),c(s,r);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(r,o,e)},_split:function(t,e){var n=t[e],i=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,i);var o=this._chooseSplitIndex(n,r,i),a=g(n.children.splice(o,n.children.length-o));a.height=n.height,a.leaf=n.leaf,s(n,this.toBBox),s(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(n,a)},_splitRoot:function(t,e){this.data=g([t,e]),this.data.height=t.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var i,r,o,s,c,l,u,d,f,p,g,_,m,y;for(l=u=1/0,i=e;i<=n-e;i++)r=a(t,0,i,this.toBBox),o=a(t,i,n,this.toBBox),f=r,p=o,g=void 0,_=void 0,m=void 0,y=void 0,g=Math.max(f.minX,p.minX),_=Math.max(f.minY,p.minY),m=Math.min(f.maxX,p.maxX),y=Math.min(f.maxY,p.maxY),s=Math.max(0,m-g)*Math.max(0,y-_),c=h(r)+h(o),s<l?(l=s,d=i,u=c<u?c:u):s===l&&c<u&&(u=c,d=i);return d},_chooseSplitAxis:function(t,e,n){var i=t.leaf?this.compareMinX:l,r=t.leaf?this.compareMinY:u;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,r)&&t.children.sort(i)},_allDistMargin:function(t,e,n,i){t.children.sort(i);var r,o,s=this.toBBox,l=a(t,0,e,s),u=a(t,n-e,n,s),h=d(l)+d(u);for(r=e;r<n-e;r++)o=t.children[r],c(l,t.leaf?s(o):o),h+=d(l);for(r=n-e-1;r>=e;r--)o=t.children[r],c(u,t.leaf?s(o):o),h+=d(u);return h},_adjustParentBBoxes:function(t,e,n){for(var i=n;i>=0;i--)c(e[i],t)},_condense:function(t){for(var e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():s(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n.n(i),o=n(2),s=n(12);s.config.defaultColors(o.schemeSet3);var a=s;n(15),n(125),n(123),n(121),n(119),n(117),n(115),n(113),n(111),n(109),n(107),n(105),n(103),n(101),n(99),n(97);function c(){return!0}function l(){}var u="postrender";function h(){return function(){throw new Error("Unimplemented abstract method.")}()}var d=0;function f(t){return t.ol_uid||(t.ol_uid=String(++d))}var p="5.3.0",g="propertychange",_="function"==typeof Object.assign?Object.assign:function(t,e){var n=arguments;if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(t),r=1,o=arguments.length;r<o;++r){var s=n[r];if(null!=s)for(var a in s)s.hasOwnProperty(a)&&(i[a]=s[a])}return i};function m(t){for(var e in t)delete t[e]}function y(t){var e;for(e in t)return!1;return!e}function v(t,e,n,i){for(var r,o=0,s=t.length;o<s;++o)if((r=t[o]).listener===e&&r.bindTo===n)return i&&(r.deleteIndex=o),r}function b(t,e){var n=C(t);return n?n[e]:void 0}function C(t,e){var n=t.ol_lm;return!n&&e&&(n=t.ol_lm={}),n}function w(t,e){var n=b(t,e);if(n){for(var i=0,r=n.length;i<r;++i)t.removeEventListener(e,n[i].boundListener),m(n[i]);n.length=0;var o=C(t);o&&(delete o[e],0===Object.keys(o).length&&function(t){delete t.ol_lm}(t))}}function E(t,e,n,i,r){var o=C(t,!0),s=o[e];s||(s=o[e]=[]);var a=v(s,n,i,!1);return a?r||(a.callOnce=!1):(a={bindTo:i,callOnce:!!r,listener:n,target:t,type:e},t.addEventListener(e,function(t){var e=function(e){var n=t.listener,i=t.bindTo||t.target;return t.callOnce&&x(t),n.call(i,e)};return t.boundListener=e,e}(a)),s.push(a)),a}function T(t,e,n,i){return E(t,e,n,i,!0)}function S(t,e,n,i){var r=b(t,e);if(r){var o=v(r,n,i,!0);o&&x(o)}}function x(t){if(t&&t.target){t.target.removeEventListener(t.type,t.boundListener);var e=b(t.target,t.type);if(e){var n="deleteIndex"in t?t.deleteIndex:e.indexOf(t);-1!==n&&e.splice(n,1),0===e.length&&w(t.target,t.type)}m(t)}}var R=function(){this.disposed_=!1};R.prototype.dispose=function(){this.disposed_||(this.disposed_=!0,this.disposeInternal())},R.prototype.disposeInternal=function(){};var A=R,O=function(t){this.propagationStopped,this.type=t,this.target=null};O.prototype.preventDefault=function(){this.propagationStopped=!0},O.prototype.stopPropagation=function(){this.propagationStopped=!0};var I=O,P=function(t){function e(){t.call(this),this.pendingRemovals_={},this.dispatching_={},this.listeners_={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addEventListener=function(t,e){var n=this.listeners_[t];n||(n=this.listeners_[t]=[]),-1===n.indexOf(e)&&n.push(e)},e.prototype.dispatchEvent=function(t){var e="string"==typeof t?new I(t):t,n=e.type;e.target=this;var i,r=this.listeners_[n];if(r){n in this.dispatching_||(this.dispatching_[n]=0,this.pendingRemovals_[n]=0),++this.dispatching_[n];for(var o=0,s=r.length;o<s;++o)if(!1===r[o].call(this,e)||e.propagationStopped){i=!1;break}if(--this.dispatching_[n],0===this.dispatching_[n]){var a=this.pendingRemovals_[n];for(delete this.pendingRemovals_[n];a--;)this.removeEventListener(n,l);delete this.dispatching_[n]}return i}},e.prototype.disposeInternal=function(){!function(t){var e=C(t);if(e)for(var n in e)w(t,n)}(this)},e.prototype.getListeners=function(t){return this.listeners_[t]},e.prototype.hasListener=function(t){return t?t in this.listeners_:Object.keys(this.listeners_).length>0},e.prototype.removeEventListener=function(t,e){var n=this.listeners_[t];if(n){var i=n.indexOf(e);t in this.pendingRemovals_?(n[i]=l,++this.pendingRemovals_[t]):(n.splice(i,1),0===n.length&&delete this.listeners_[t])}},e}(A),L="change",D="clear",k="error",F="load";var N=function(t){function e(){t.call(this),this.revision_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.changed=function(){++this.revision_,this.dispatchEvent(L)},e.prototype.getRevision=function(){return this.revision_},e.prototype.on=function(t,e){if(Array.isArray(t)){for(var n=t.length,i=new Array(n),r=0;r<n;++r)i[r]=E(this,t[r],e);return i}return E(this,t,e)},e.prototype.once=function(t,e){if(Array.isArray(t)){for(var n=t.length,i=new Array(n),r=0;r<n;++r)i[r]=T(this,t[r],e);return i}return T(this,t,e)},e.prototype.un=function(t,e){if(Array.isArray(t))for(var n=0,i=t.length;n<i;++n)S(this,t[n],e);else S(this,t,e)},e}(P),j=function(t){function e(e,n,i){t.call(this,e),this.key=n,this.oldValue=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(I),B={};function z(t){return B.hasOwnProperty(t)?B[t]:B[t]="change:"+t}var U=function(t){function e(e){t.call(this),f(this),this.values_={},void 0!==e&&this.setProperties(e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){var e;return this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e},e.prototype.getKeys=function(){return Object.keys(this.values_)},e.prototype.getProperties=function(){return _({},this.values_)},e.prototype.notify=function(t,e){var n;n=z(t),this.dispatchEvent(new j(n,t,e)),n=g,this.dispatchEvent(new j(n,t,e))},e.prototype.set=function(t,e,n){if(n)this.values_[t]=e;else{var i=this.values_[t];this.values_[t]=e,i!==e&&this.notify(t,i)}},e.prototype.setProperties=function(t,e){for(var n in t)this.set(n,t[n],e)},e.prototype.unset=function(t,e){if(t in this.values_){var n=this.values_[t];delete this.values_[t],e||this.notify(t,n)}},e}(N);function H(t,e){var n=document.createElement("canvas");return t&&(n.width=t),e&&(n.height=e),n.getContext("2d")}function W(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}var G,V=function(t){function e(e){t.call(this),this.element=e.element?e.element:null,this.target_=null,this.map_=null,this.listenerKeys=[],this.render=e.render?e.render:l,e.target&&this.setTarget(e.target)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){W(this.element),t.prototype.disposeInternal.call(this)},e.prototype.getMap=function(){return this.map_},e.prototype.setMap=function(t){this.map_&&W(this.element);for(var e=0,n=this.listenerKeys.length;e<n;++e)x(this.listenerKeys[e]);(this.listenerKeys.length=0,this.map_=t,this.map_)&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==l&&this.listenerKeys.push(E(t,u,this.render,this)),t.render())},e.prototype.setTarget=function(t){this.target_="string"==typeof t?document.getElementById(t):t},e}(U);class Y{static zeroPad(t,e){const n=e-t.toString().length+1;return(new Array(parseInt(n>0&&n,10)).join("0")+t).toString().slice(-e)}static modulo(t,e){const n=t%e;return n*e<0?n+e:n}static assert(t,e="Assertion failed"){if(!t)throw new Error(e)}static isArray(t){return"[object Array]"===Object.prototype.toString.call(t)}static corsRequest(t,e,n,i,r,o){let s,a=null;null!=o&&(a=o),XMLHttpRequest?"withCredentials"in(s=new XMLHttpRequest)&&(s.open(e,t,!0),s.setRequestHeader("Authorization","Bearer "+a),s.onerror=r,s.onreadystatechange=function(){4===s.readyState&&(s.status>=200&&s.status<400?i(s.responseText):r(new Error("Response returned with non-OK status "+s.status)))},s.send(n)):r(new Error("CORS not supported"))}static nFormatter(t,e=0){const n=[{value:1,symbol:""},{value:1e3,symbol:"k"},{value:1e6,symbol:"M"},{value:1e9,symbol:"G"},{value:1e12,symbol:"T"},{value:1e15,symbol:"P"},{value:1e18,symbol:"E"}];let i;for(i=n.length-1;i>0&&!(t>=n[i].value);i--);return(t/n[i].value).toFixed(e).replace(/\.0+$|(\.[0-9]*[1-9])0+$/,"$1")+n[i].symbol}static guidGenerator(){const t=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}}class q{static getBounds(t){const e=t.getBoundingClientRect();return{x0:e.x,y0:e.y,x1:e.x+e.width,y1:e.y+e.height}}static generateEmptyWidgetDomId(){let t=document.querySelector(".sintium-temporary-widget-storage");t||(t=q.createElement("div","sintium-temporary-widget-storage"),document.body.appendChild(t));const e=`sintium-Widget-${Y.guidGenerator()}`,n=document.createElement("div");return n.innerHTML=`\n            <div id="${e}" class="widget"></div>\n        `,t.appendChild(n),e}static removeChildren(t){for(;t.lastChild;)t.removeChild(t.lastChild)}static createElement(t,e,n){const i=document.createElement(t);return i.className=e||"",i.innerHTML=n||"",i}static appendContainer(t,e){const n=document.createElement("div");return n.className=e,t.appendChild(n),n}static appendInput(t,e,n){const i=document.createElement("input");if(i.type=e?"password":"text",n){const e=q.createElement("div","input-field"),r=q.createElement("label",null,n);e.appendChild(i),e.appendChild(r),t.appendChild(e)}else t.appendChild(i);return i}static appendText(t,e,n){const i=document.createElement("div");return i.className=n||"text",i.innerText=e,t.appendChild(i),i}static appendButton(t,e,n){const i=document.createElement("a");return i.className="waves-effect waves-light btn",n&&i.classList.add("btn-flat"),i.innerText=e,t.appendChild(i),i}static appendSubmitButton(t,e){const n=this.appendButton(t,e);return n.type="submit",n}static appendIcon(t,e){const n=document.createElement("div"),i=document.createElement("i");return n.className="toggle-container",i.className=`fa fa-${e}`,n.appendChild(i),t.appendChild(n),i}static appendForm(t){const e=document.createElement("form");return t.appendChild(e),e}static appendCheckButton(t,e){const n=document.createElement("div");n.innerHTML='\n              <label>\n                <input type="checkbox" class="filled-in"/>\n                <span></span>\n              </label>\n        ';const i=n.firstElementChild;t.appendChild(i);const r=i.querySelector("input");return e&&(r.checked=e),r}static appendLoader(t){const e=document.createElement("div");e.innerHTML='\n            <div class="preloader-wrapper big active">\n                <div class="spinner-layer spinner-blue">\n                    <div class="circle-clipper left">\n                        <div class="circle"></div>\n                    </div><div class="gap-patch">\n                    <div class="circle"></div>\n                </div><div class="circle-clipper right">\n                    <div class="circle"></div>\n                </div>\n            </div>\n        ';const n=e.firstChild;return t.appendChild(n),n}static createModal(t,e,n){}static appendHeader4(t,e){const n=document.createElement("h4");return n.textContent=e,t.appendChild(n),n}static appendTable(t,e){const n=document.createElement("table");return t.appendChild(n),n.className="data-table",this.appendRowToTable(n,e,!0),n}static appendSelect(t,e,n){const i=q.createElement("select");return n&&q.appendOption(i,n,!0,!0),e.forEach(t=>q.appendOption(i,t,!1,!1)),t.appendChild(i),M.FormSelect.init(q._createFauxNodeListFromElement(i),{}),i}static appendOption(t,e,n,i,r){r=r||e;const o=q.createElement("option");return o.setAttribute("value",r),o.innerText=e,i&&o.setAttribute("disabled","disabled"),n&&o.setAttribute("selected","selected"),t.appendChild(o),o}static appendRowToTable(t,e,n=!1){let i=document.createElement("tr");t.appendChild(i),e.forEach(t=>{const e=n?document.createElement("th"):document.createElement("td");e.innerText=t,i.appendChild(e)})}static _createFauxNodeListFromElement(t){const e=document.createDocumentFragment().childNodes;return Object.create(e,{0:{value:t,enumerable:!0},length:{value:1},item:{value:function(t){return this[+t||0]},enumerable:!0}})}}q.CLOSE_TEXT="close";class X extends V{constructor(t){const e=X._createControlElement(t);super({element:e}),this._element=e,this._redraw=this._draw.bind(this)}static _createControlElement(t){const e=document.createElement("div");return e.className=`control-layerswitcher-element control-layerswitcher-element-${t} ol-unselectable`,e}initializeExtension(t){this._contentElement=q.appendContainer(this._element,"content"),this._layerHandler=t.getLayerHandler(),this._draw(),t.getMap().addInteraction(this)}_draw(){}static get Builder(){return class{constructor(){this._position="top"}position(t){return"bottom"==t&&(this._position=t),this}build(){return new X(this._position)}}}}class K{constructor(t){this._domId=t.domId,this._locations=t.locations,this._transition=t.transition,this._button=t.button,this._buttonText=t.buttonText,this._durationTime=t.durationTime}initializeExtension(t){this._mapContainer=t;const e=document.getElementById(this._domId),n=this._locations.map(t=>t.getName()),i=q.appendContainer(e,"select-location-switcher"),r=q.appendSelect(i,n,"Select a location");if(this._button){q.appendButton(i,this._buttonText).onclick=()=>{this._selectedLocation&&this._animateTo(this._selectedLocation)}}r.onchange=t=>{this._shouldAnimate=!0;const e=t.target.selectedIndex;this._selectedLocation=this._locations[e-1],this._button||this._animateTo(this._selectedLocation)}}_animateTo(t){if(this._shouldAnimate)switch(this._transition){case"fly-to":this._flyTo(t);break;default:this._pan(t)}this._shouldAnimate=!1}_pan(t){this._mapContainer.getMap().getView().animate({center:t.getCoordinates(),duration:this._durationTime})}_flyTo(t){const e=this._mapContainer.getMap().getView(),n=e.getZoom();let i=2,r=!1;const o=t=>{--i,r||0!==i&&t||(r=!0)};e.animate({center:t.getCoordinates(),duration:this._durationTime},o),e.animate({zoom:n-1,duration:this._durationTime/2},{zoom:n,duration:this._durationTime/2},o)}}class Z{constructor(t,e,n){this._name=t,this._coordinates=e,this._zoom=n}getCoordinates(){return this._coordinates}getZoom(){return this._zoom}getName(){return this._name}}!function(t){t[t.BaseLayer=0]="BaseLayer",t[t.VectorLayer=1]="VectorLayer",t[t.CanvasLayer=2]="CanvasLayer",t[t.WebGlLayer=4]="WebGlLayer",t[t.LayerGroup=8]="LayerGroup",t[t.WMSLayer=16]="WMSLayer"}(G||(G={}));var J=G;class Q{static isArray(t){return!!t&&t.constructor==[].constructor}static arrayOf(t,e){for(const n of e)if(!t(n))return!1;return!0}static percentageOrNumber(t){return Q.percentage(t)||Q.isNumber(t)}static percentage(t){return/[0-9]*\.?[0-9]*%/.test(t)}isObject(t){return!!t&&t.constructor=={}.constructor}static isSintiumWidget(t){return!!t.getHTMLElement}static isWidget(t){const e=t;return!!(e.getHTMLElement&&e.onAddedToWidgetContainer&&e.getID&&e.onWidgetContainerSizeChange)}static isWidgetContainer(t){const e=t;return!!e.addWidget&&!!e.getWidgets}static isDataSource(t){return!!t.getDataContainerAsync}static isMapContainerExtension(t){return!!t.initializeExtension}static isMapControl(t){return!!t.addedToMap}static isMapBaseControl(t){const e=t;return!!(e.getHTMLElement&&e.getIndex&&e.getPosition&&e.getMapContainer)}static isMapButtonControl(t){const e=t;return Q.isMapControl(e)&&!!e.onClick&&!!e.setActive}static isSelectionSpecificationContainer(t){return!!t.getSelectionSpecifications}static isLayerContainer(t){const e=t;return!!(e.getType&&e.getId&&e.getLayers&&e.getLayerCollection&&e.getVisible&&e.setVisible)}static isZoomableLayer(t){return!!t.getClusterExtent}static isSelectableLayer(t){const e=t;return!!e.addSelection&&!!e.featureSelection&&!!e.multiFeatureSelection}static isDataLayer(t){return!!t.getDataSource}static isClusterableLayer(t){const e=t;return!!e.isClustered&&!!e.setClustered}static isConfigurableLayer(t){return!!t.getAvailableUserConfigurations}static isLayerGroup(t){const e=t;return t.getType()==J.LayerGroup&&!!e.getLayerContainersInGroup}static isChartContainer(t){const e=t;return!!e.getChart&&!!e.resetChart}static isResponsiveChart(t){return!!t.onChartSizeChanged}static isOpenLayerTileLayer(t){return!!t.getUseInterimTilesOnError}static isString(t){return"string"==typeof t}static isObject(t){return t.constructor=={}.constructor}static isNumber(t){return"number"==typeof t}static isBoolean(t){return"boolean"==typeof t}static isFunction(t){return t&&"[object Function]"==={}.toString.call(t)}static isInEnum(t,e){for(const n of Object.keys(t))if(t[n]==e)return!0;return!1}static isObservable(t){return!!t.on}}class tt{}tt.GeoJSON={TYPE:"type",FEATURE_COLLECTION:"FeatureCollection",FEATURES:"features"},tt.Injection={SELECTION_MANAGER:"selectionManager"},tt.Module={LAYER:"layer",MAP:"map",CHART:"chart",CONTROL:"control",WIDGET_CONTROL:"widget control",BUTTON_CONTROL:"button control",DRAWER:"drawer"},tt.Properties={DOM_ID:"domId",LAYERS:"layers",EXTENSIONS:"extensions",ATTRIBUTIONS:"attributions",LAYER_ID:"layerId",DATA_SOURCE:"dataSource",CLUSTERED_BY_PROPERTY:"clusteredByProperty",STYLE_FUNCTION:"styleFunction",SELECTED_STYLE_FUNCTION:"selectedStyleFunction",CREATE_FEATURE_FUNCTION:"createFeatureFunction",LAYER:"layer",DARK_LAYER:"darkLayer",SELECTIONS:"selections",NORMAL_ICON:"normalIcon",ACTIVE_ICON:"activeIcon",POSITION:"position",ICON_SIZE:"iconSize",BUTTON_CONTROL:"buttonControl",WIDGET:"widget",WIDGETS:"widgets",ON_CLICK_EMPTY_SPACE:"onClickEmptySpace",ON_CLICK_CLUSTER:"onClickCluster",HIT_TOLERANCE:"hitTolerance"},tt.Chart={MARGIN_TYPES:new Set(["top","left","bottom","right"])},tt.Map={},tt.Layer={ID:"__layerId",KEY:"__layerKey",SELECTABLE:"__selectable",SUB_DATA_SIZE:2e5},tt.Feature={KEY:"__featureKey",CLUSTER_PROPERTY:"__clusterProperty",FEATURES:"features",NUMBER_OF_POINTS:"numPoints",ALL_FEATURES:"allFeatures",VISIBLE:"visible"},tt.DataSource={RECORD_KEY:"__key",GEOMETRY:"__geometry",SUB_DATA_SIZE:25e3},tt.Selection={FEATURE_SELECTOR:"feature",CLUSTER_SELECTOR:"cluster",SINGLE_SELECTORS:["feature","cluster"],DONT_CARE:"*",SPLIT_SEPARATOR:"."},tt.DrawManager={IS_DRAWN_FEATURE:"isDrawnFeature",DRAWN_FEATURE_COLORS:["#2ecc71","#0891eb","#e74c3c","#f1c40e","#8e44ad"]},tt.WindRoseChart={BUCKET_SIZE:20,LABELS:["N","NNE","NE","ENE","E","ESE","SE","SSE","S","SSW","SW","WSW","W","WNW","NW","NNW"],SLICE_NUMBER:16,BASE_CHART_COLOR:"#333333"};var et,nt=n(0);!function(t){t.STRING="string",t.NUMBER="number"}(et||(et={}));const it=()=>new Error("Data is not valid."),rt=()=>new Error("Unlabeled data must pass labels to datasource."),ot=(t,e,n)=>new Error(`Column with label '${t}' does not exist for ${e} with id "${n}".`),st=(t,e)=>new Error(`Property ${t} is required for ${e}.`),at=(t,e)=>new Error(`Property ${t} has wrong input type in ${e}.`),ct=(t,e)=>new Error(`Property ${t} has invalid value in ${e}.`),lt=(t,e,n)=>new Error(`Property ${t} has wrong input type in ${e} with id "${n}".`),ut=()=>new Error("Your browser doesn't support WegGl.");let ht=class{initialize(t){this.checkIfBaseOptionsAreValid(t),this._layerId=t.layerId,this._layerCollection=new r.a.layer.Group,this._layerCollection.setVisible(!1)}checkIfBaseOptionsAreValid(t){const{layerId:e}=t;if(!e)throw st(tt.Properties.LAYER_ID,tt.Module.LAYER);if(!Q.isString(e))throw at(tt.Properties.LAYER_ID,tt.Module.LAYER)}getLayerCollection(){return this._layerCollection}getLayers(){return this._layerCollection.getLayers().getArray()}addLayer(t){this._layerCollection.getLayers().push(t)}clearLayers(){this._layerCollection.getLayers().clear()}setLayersVisible(t){this._layerCollection.setVisible(t)}getVisible(){return this._layerCollection.getVisible()}getId(){return this._layerId}};var dt,ft=ht=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)()],ht);class pt extends ft{constructor(t,e){super(),super.initialize({layerId:t});for(const t of e)this.addLayer(t.getLayerCollection());this.setVisible(!0),this._layerContainers=e}getType(){return J.LayerGroup}setVisible(t){this.setLayersVisible(t)}getLayerContainersInGroup(){return this._layerContainers}}class gt{constructor(t,e,n){this._type=t,this._condition=e,this._callback=n}get callBack(){return this._callback}validateCondition(t){return t==this._condition}validate(t,e){return t==this._type&&e==this._condition}getType(){return this._type}getCondition(){return this._condition}}!function(t){t[t.Single=0]="Single",t[t.Cluster=2]="Cluster",t[t.Box=4]="Box",t[t.Polygon=8]="Polygon",t[t.ViewPort=16]="ViewPort"}(dt||(dt={}));var _t,mt=dt;!function(t){t[t.Empty=0]="Empty",t[t.Unselect=1]="Unselect",t[t.DoubleClick=2]="DoubleClick",t[t.Click=4]="Click",t[t.Alt=8]="Alt",t[t.Ctrl=16]="Ctrl",t[t.Shift=32]="Shift",t[t.Change=64]="Change"}(_t||(_t={}));var yt=_t;class vt{constructor(t,e){this._selectionSpecifications=[];for(const n of t){const t=vt._generateSelectionEvent(n,e);this._selectionSpecifications.push(t)}}getSelectionSpecifications(){return this._selectionSpecifications}static _generateSelectionEvent(t,e){const n=t.split(" "),i=this._getSelectionType(n),r=this._getSelectionCondition(n);return new gt(i,r,e)}static _getSelectionType(t){for(const e of t)switch(e.toLowerCase()){case"polygon":return mt.Polygon;case"box":return mt.Box;case"cluster":return mt.Cluster;case"single":return mt.Single;case"viewport":return mt.ViewPort;default:throw new Error(`Missing type, ${e.toLowerCase()}, in selection specification.`)}}static _getSelectionCondition(t){let e=yt.Empty;for(const n of t)switch(n){case"click":e|=yt.Click;break;case"doubleClick":e|=yt.DoubleClick;break;case"alt":e|=yt.Alt;break;case"ctrl":e|=yt.Ctrl;break;case"shift":e|=yt.Shift;break;case"unselect":e|=yt.Unselect;break;case"change":e|=yt.Change}if(e==yt.Empty)throw new Error("Missing at least one condition in selection specification.");return e}}const bt={name:"Spectral",chromaColors:["#2b83ba","#abdda4","#fdae61","#d7191c"]},Ct={name:"Highchart",colors:["#91e8e1","#90ed7d","#f7a35c","#8085e9","#4b6ebb","#f45b5b","#e4d354","#2b908f","#434348","#f15c80","#7cb5ec"]};class wt{constructor(){this._filters=[],this._once=!1}addFilter(t){this._filters.push(t)}get filters(){return this._filters}setOnce(){this._once=!0}get once(){return this._once}}let Et=class{constructor(){this._observers={}}subscribe(t,e,n){this._observers[t]||(this._observers[t]=[]),this._observers[t].push({filterOptions:n,observer:e})}publish(t,e){this._observers[t]&&this._observers[t].forEach(({observer:n,filterOptions:i},r)=>{let o=!0;i&&(i.filters.forEach(t=>{t(e)||(o=!1)}),i.once&&this._observers[t].splice(r,1)),o&&n(e)})}filter(t,e){const n=e||new wt;return n.addFilter(t),this.getMediatorSubscribe(n)}once(t){const e=t||new wt;return e.setOnce(),this.getMediatorSubscribe(e)}getMediatorSubscribe(t){return{subscribe:(e,n)=>this.subscribe(e,n,t),filter:e=>this.filter(e,t),once:()=>this.once(t)}}};var Tt=Et=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)()],Et);let St=class{constructor(){this._layerContainers=[]}addLayerContainer(t){this._layerContainers.push(t)}getLayerNames(){return this.getAllLayerContainers().map(t=>t.getId())}setLayerVisibleById(t,e){const n=this.getLayerContainerById(t);this.setLayerVisible(n,e)}setLayerVisible(t,e){t.getType()==J.BaseLayer&&this.getBaseLayerContainers().forEach(t=>{t.setVisible(!1)}),t.setVisible(e)}getLayerContainerById(t){return this.getAllLayerContainers().filter(e=>e.getId()==t).pop()}getLayerContainerByFeature(t){const e=t.getLayerId();return this.getLayerContainerById(e)}hasLayerContainerById(t){return!!this.getLayerContainerById(t)}getLayerContainers(){return this._layerContainers}getAllLayerContainers(){const t=this._layerContainers.filter(t=>t.getType()!=J.BaseLayer).map(t=>Q.isLayerGroup(t)?t.getLayerContainersInGroup():t);return[].concat(...t)}getBaseLayerContainers(){return this._layerContainers.filter(t=>t.getType()==J.BaseLayer)}hasBaseLayerContainers(){return this.getBaseLayerContainers().length>0}getDataLayerContainers(t=!1){return(t?this.getAllLayerContainers():this.getLayerContainers()).filter(t=>t.getType()!=J.BaseLayer)}getSelectableLayerContainers(t=!1){let e=this.getAllLayerContainers().filter(t=>Q.isSelectableLayer(t));return t?this._onlyVisible(e):e}getVisibleSelectableLayerContainers(){return this.getSelectableLayerContainers().filter(t=>t.getVisible())}getClusterableLayers(t=!1){let e=this.getAllLayerContainers().filter(t=>Q.isClusterableLayer(t));return t?this._onlyVisible(e):e}getVisibleClusterableLayers(){return this.getClusterableLayers().filter(t=>t.getVisible())}getClusteredLayers(t=!1){return this.getClusterableLayers(t).filter(t=>t.isClustered())}getVisibleClusteredLayers(){return this.getClusteredLayers().filter(t=>t.getVisible())}_onlyVisible(t){return t.filter(t=>t.getVisible())}};var xt,Rt=St=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)()],St),At=n(21);!function(t){t.LEFT="left",t.BOTTOM="bottom",t.RIGHT="right"}(xt||(xt={}));var Ot,It=xt;!function(t){t.TOP_LEFT="top-left",t.BOTTOM_LEFT="bottom-left",t.TOP_RIGHT="top-right",t.BOTTOM_RIGHT="bottom-right",t.BOTTOM_CENTER="bottom-center",t.TOP_CENTER="top-center"}(Ot||(Ot={}));var Mt=Ot,Pt=function(t){function e(e){var n="Assertion failed. See https://openlayers.org/en/"+("latest"===p?p:"v"+p.split("-")[0])+"/doc/errors/#"+e+" for details.";t.call(this,n),this.code=e,this.name="AssertionError",this.message=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error);function Lt(t,e){if(!t)throw new Pt(e)}function Dt(t,e,n){return Math.min(Math.max(t,e),n)}var kt="cosh"in Math?Math.cosh:function(t){var e=Math.exp(t);return(e+1/e)/2};function Ft(t,e,n,i,r,o){var s=r-n,a=o-i;if(0!==s||0!==a){var c=((t-n)*s+(e-i)*a)/(s*s+a*a);c>1?(n=r,i=o):c>0&&(n+=s*c,i+=a*c)}return Nt(t,e,n,i)}function Nt(t,e,n,i){var r=n-t,o=i-e;return r*r+o*o}function jt(t){return t*Math.PI/180}function Bt(t,e){var n=t%e;return n*e<0?n+e:n}function zt(t,e,n){return t+n*(e-t)}var Ut={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"},Ht=6371008.8;
/**
 * @license
 * Latitude/longitude spherical geodesy formulae taken from
 * http://www.movable-type.co.uk/scripts/latlong.html
 * Licensed under CC-BY-3.0.
 */function Wt(t,e,n){var i=n||Ht,r=jt(t[1]),o=jt(e[1]),s=(o-r)/2,a=jt(e[0]-t[0])/2,c=Math.sin(s)*Math.sin(s)+Math.sin(a)*Math.sin(a)*Math.cos(r)*Math.cos(o);return 2*i*Math.atan2(Math.sqrt(c),Math.sqrt(1-c))}var Gt={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"},Vt={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function Yt(t){for(var e=Jt(),n=0,i=t.length;n<i;++n)ne(e,t[n]);return e}function qt(t,e,n){var i,r;return(i=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0)*i+(r=n<t[1]?t[1]-n:t[3]<n?n-t[3]:0)*r}function Xt(t,e){return $t(t,e[0],e[1])}function Kt(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function $t(t,e,n){return t[0]<=e&&e<=t[2]&&t[1]<=n&&n<=t[3]}function Zt(t,e){var n=t[0],i=t[1],r=t[2],o=t[3],s=e[0],a=e[1],c=Vt.UNKNOWN;return s<n?c|=Vt.LEFT:s>r&&(c|=Vt.RIGHT),a<i?c|=Vt.BELOW:a>o&&(c|=Vt.ABOVE),c===Vt.UNKNOWN&&(c=Vt.INTERSECTING),c}function Jt(){return[1/0,1/0,-1/0,-1/0]}function Qt(t,e,n,i,r){return r?(r[0]=t,r[1]=e,r[2]=n,r[3]=i,r):[t,e,n,i]}function te(t){return Qt(1/0,1/0,-1/0,-1/0,t)}function ee(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function ne(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function ie(t,e,n,i,r){for(;n<i;n+=r)re(t,e[n],e[n+1]);return t}function re(t,e,n){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],n),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],n)}function oe(t){var e=0;return _e(t)||(e=pe(t)*ue(t)),e}function se(t){return[t[0],t[1]]}function ae(t){return[t[2],t[1]]}function ce(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function le(t,e){var n;return e===Gt.BOTTOM_LEFT?n=se(t):e===Gt.BOTTOM_RIGHT?n=ae(t):e===Gt.TOP_LEFT?n=de(t):e===Gt.TOP_RIGHT?n=fe(t):Lt(!1,13),n}function ue(t){return t[3]-t[1]}function he(t,e,n){var i=n||[1/0,1/0,-1/0,-1/0];return ge(t,e)?(t[0]>e[0]?i[0]=t[0]:i[0]=e[0],t[1]>e[1]?i[1]=t[1]:i[1]=e[1],t[2]<e[2]?i[2]=t[2]:i[2]=e[2],t[3]<e[3]?i[3]=t[3]:i[3]=e[3]):te(i),i}function de(t){return[t[0],t[3]]}function fe(t){return[t[2],t[3]]}function pe(t){return t[2]-t[0]}function ge(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function _e(t){return t[2]<t[0]||t[3]<t[1]}function me(t,e,n){var i=[t[0],t[1],t[0],t[3],t[2],t[1],t[2],t[3]];return e(i,i,2),function(t,e,n){return Qt(Math.min.apply(null,t),Math.min.apply(null,e),Math.max.apply(null,t),Math.max.apply(null,e),n)}([i[0],i[2],i[4],i[6]],[i[1],i[3],i[5],i[7]],n)}var ye={DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},ve={};ve[ye.DEGREES]=2*Math.PI*6370997/360,ve[ye.FEET]=.3048,ve[ye.METERS]=1,ve[ye.USFEET]=1200/3937;var be=ye,Ce=function(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit};Ce.prototype.canWrapX=function(){return this.canWrapX_},Ce.prototype.getCode=function(){return this.code_},Ce.prototype.getExtent=function(){return this.extent_},Ce.prototype.getUnits=function(){return this.units_},Ce.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||ve[this.units_]},Ce.prototype.getWorldExtent=function(){return this.worldExtent_},Ce.prototype.getAxisOrientation=function(){return this.axisOrientation_},Ce.prototype.isGlobal=function(){return this.global_},Ce.prototype.setGlobal=function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)},Ce.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},Ce.prototype.setDefaultTileGrid=function(t){this.defaultTileGrid_=t},Ce.prototype.setExtent=function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)},Ce.prototype.setWorldExtent=function(t){this.worldExtent_=t},Ce.prototype.setGetPointResolution=function(t){this.getPointResolutionFunc_=t},Ce.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_};var we=Ce,Ee=6378137,Te=Math.PI*Ee,Se=[-Te,-Te,Te,Te],xe=[-180,-85,180,85],Re=function(t){function e(e){t.call(this,{code:e,units:be.METERS,extent:Se,global:!0,worldExtent:xe,getPointResolution:function(t,e){return t/kt(e[1]/Ee)}})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(we),Ae=[new Re("EPSG:3857"),new Re("EPSG:102100"),new Re("EPSG:102113"),new Re("EPSG:900913"),new Re("urn:ogc:def:crs:EPSG:6.18:3:3857"),new Re("urn:ogc:def:crs:EPSG::3857"),new Re("http://www.opengis.net/gml/srs/epsg.xml#3857")];function Oe(t,e,n){var i=t.length,r=n>1?n:2,o=e;void 0===o&&(o=r>2?t.slice():new Array(i));for(var s=Te,a=0;a<i;a+=r){o[a]=s*t[a]/180;var c=Ee*Math.log(Math.tan(Math.PI*(t[a+1]+90)/360));c>s?c=s:c<-s&&(c=-s),o[a+1]=c}return o}function Ie(t,e,n){var i=t.length,r=n>1?n:2,o=e;void 0===o&&(o=r>2?t.slice():new Array(i));for(var s=0;s<i;s+=r)o[s]=180*t[s]/Te,o[s+1]=360*Math.atan(Math.exp(t[s+1]/Ee))/Math.PI-90;return o}var Me=[-180,-90,180,90],Pe=6378137*Math.PI/180,Le=function(t){function e(e,n){t.call(this,{code:e,units:be.DEGREES,extent:Me,axisOrientation:n,global:!0,metersPerUnit:Pe,worldExtent:Me})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(we),De=[new Le("CRS:84"),new Le("EPSG:4326","neu"),new Le("urn:ogc:def:crs:EPSG::4326","neu"),new Le("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new Le("urn:ogc:def:crs:OGC:1.3:CRS84"),new Le("urn:ogc:def:crs:OGC:2:84"),new Le("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Le("urn:x-ogc:def:crs:EPSG:4326","neu")],ke={};var Fe,Ne,je,Be={};function ze(t,e,n){var i=t.getCode(),r=e.getCode();i in Be||(Be[i]={}),Be[i][r]=n}function Ue(t,e,n){var i;if(void 0!==e){for(var r=0,o=t.length;r<o;++r)e[r]=t[r];i=e}else i=t.slice();return i}function He(t,e,n){if(void 0!==e&&t!==e){for(var i=0,r=t.length;i<r;++i)e[i]=t[i];t=e}return t}function We(t){!function(t,e){ke[t]=e}(t.getCode(),t),ze(t,t,Ue)}function Ge(t){return"string"==typeof t?ke[t]||null:t||null}function Ve(t,e,n,i){var r,o=(t=Ge(t)).getPointResolutionFunc();if(o)r=o(e,n);else if(t.getUnits()==be.DEGREES&&!i||i==be.DEGREES)r=e;else{var s=$e(t,Ge("EPSG:4326")),a=[n[0]-e/2,n[1],n[0]+e/2,n[1],n[0],n[1]-e/2,n[0],n[1]+e/2];r=(Wt((a=s(a,a,2)).slice(0,2),a.slice(2,4))+Wt(a.slice(4,6),a.slice(6,8)))/2;var c=i?ve[i]:t.getMetersPerUnit();void 0!==c&&(r/=c)}return r}function Ye(t){!function(t){t.forEach(We)}(t),t.forEach(function(e){t.forEach(function(t){e!==t&&ze(e,t,Ue)})})}function qe(t,e){return t?"string"==typeof t?Ge(t):t:Ge(e)}function Xe(t,e){return Je(t,"EPSG:4326",void 0!==e?e:"EPSG:3857")}function Ke(t,e){if(t===e)return!0;var n=t.getUnits()===e.getUnits();return t.getCode()===e.getCode()?n:$e(t,e)===Ue&&n}function $e(t,e){var n=function(t,e){var n;return t in Be&&e in Be[t]&&(n=Be[t][e]),n}(t.getCode(),e.getCode());return n||(n=He),n}function Ze(t,e){return $e(Ge(t),Ge(e))}function Je(t,e,n){return Ze(e,n)(t,void 0,t.length)}function Qe(t,e,n){return me(t,Ze(e,n))}Ye(Ae),Ye(De),Fe=Ae,Ne=Oe,je=Ie,De.forEach(function(t){Fe.forEach(function(e){ze(t,e,Ne),ze(e,t,je)})});var tn=42,en=256;function nn(t){return t}function rn(t,e){return t>e?1:t<e?-1:0}function on(t,e,n){var i,r=t.length;if(t[0]<=e)return 0;if(e<=t[r-1])return r-1;if(n>0){for(i=1;i<r;++i)if(t[i]<e)return i-1}else if(n<0){for(i=1;i<r;++i)if(t[i]<=e)return i}else for(i=1;i<r;++i){if(t[i]==e)return i;if(t[i]<e)return t[i-1]-e<e-t[i]?i-1:i}return r-1}function sn(t,e){for(var n=Array.isArray(e)?e:[e],i=n.length,r=0;r<i;r++)t[t.length]=n[r]}function an(t,e){return void 0!==t?0:void 0}function cn(t,e){return void 0!==t?t+e:void 0}var ln=0,un=1,hn="center",dn="resolution",fn="rotation";function pn(t){return Math.pow(t,3)}function gn(t){return 3*t*t-2*t*t*t}var _n={XY:"XY",XYZ:"XYZ",XYM:"XYM",XYZM:"XYZM"};function mn(t,e,n,i,r,o){for(var s=o||[],a=0,c=e;c<n;c+=i){var l=t[c],u=t[c+1];s[a++]=r[0]*l+r[2]*u+r[4],s[a++]=r[1]*l+r[3]*u+r[5]}return o&&s.length!=a&&(s.length=a),s}new Array(6);var yn=[1,0,0,1,0,0];function vn(t){var e;return t==_n.XY?e=2:t==_n.XYZ||t==_n.XYM?e=3:t==_n.XYZM&&(e=4),e}var bn=function(t){function e(){t.call(this),this.layout=_n.XY,this.stride=2,this.flatCoordinates=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.computeExtent=function(t){return e=this.flatCoordinates,n=0,i=this.flatCoordinates.length,r=this.stride,ie(te(t),e,n,i,r);var e,n,i,r},e.prototype.getCoordinates=function(){return h()},e.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.getFlatCoordinates=function(){return this.flatCoordinates},e.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},e.prototype.getLayout=function(){return this.layout},e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!=this.getRevision()&&(m(this.simplifiedGeometryCache),this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var e=t.toString();if(this.simplifiedGeometryCache.hasOwnProperty(e))return this.simplifiedGeometryCache[e];var n=this.getSimplifiedGeometryInternal(t);return n.getFlatCoordinates().length<this.flatCoordinates.length?(this.simplifiedGeometryCache[e]=n,n):(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)},e.prototype.getSimplifiedGeometryInternal=function(t){return this},e.prototype.getStride=function(){return this.stride},e.prototype.setFlatCoordinates=function(t,e){this.stride=vn(t),this.layout=t,this.flatCoordinates=e},e.prototype.setCoordinates=function(t,e){h()},e.prototype.setLayout=function(t,e,n){var i;if(t)i=vn(t);else{for(var r=0;r<n;++r){if(0===e.length)return this.layout=_n.XY,void(this.stride=2);e=e[0]}t=function(t){var e;2==t?e=_n.XY:3==t?e=_n.XYZ:4==t&&(e=_n.XYZM);return e}(i=e.length)}this.layout=t,this.stride=i},e.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},e.prototype.rotate=function(t,e){var n=this.getFlatCoordinates();if(n){var i=this.getStride();!function(t,e,n,i,r,o,s){for(var a=s||[],c=Math.cos(r),l=Math.sin(r),u=o[0],h=o[1],d=0,f=e;f<n;f+=i){var p=t[f]-u,g=t[f+1]-h;a[d++]=u+p*c-g*l,a[d++]=h+p*l+g*c;for(var _=f+2;_<f+i;++_)a[d++]=t[_]}s&&a.length!=d&&(a.length=d)}(n,0,n.length,i,t,e,n),this.changed()}},e.prototype.scale=function(t,e,n){var i=e;void 0===i&&(i=t);var r=n;r||(r=ce(this.getExtent()));var o=this.getFlatCoordinates();if(o){var s=this.getStride();!function(t,e,n,i,r,o,s,a){for(var c=a||[],l=s[0],u=s[1],h=0,d=e;d<n;d+=i){var f=t[d]-l,p=t[d+1]-u;c[h++]=l+r*f,c[h++]=u+o*p;for(var g=d+2;g<d+i;++g)c[h++]=t[g]}a&&c.length!=h&&(c.length=h)}(o,0,o.length,s,t,i,r,o),this.changed()}},e.prototype.translate=function(t,e){var n=this.getFlatCoordinates();if(n){var i=this.getStride();!function(t,e,n,i,r,o,s){for(var a=s||[],c=0,l=e;l<n;l+=i){a[c++]=t[l]+r,a[c++]=t[l+1]+o;for(var u=l+2;u<l+i;++u)a[c++]=t[u]}s&&a.length!=c&&(a.length=c)}(n,0,n.length,i,t,e,n),this.changed()}},e}(function(t){function e(){t.call(this),this.extent_=[1/0,1/0,-1/0,-1/0],this.extentRevision_=-1,this.simplifiedGeometryCache={},this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return h()},e.prototype.closestPointXY=function(t,e,n,i){return h()},e.prototype.containsXY=function(t,e){return!1},e.prototype.getClosestPoint=function(t,e){var n=e||[NaN,NaN];return this.closestPointXY(t[0],t[1],n,1/0),n},e.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},e.prototype.computeExtent=function(t){return h()},e.prototype.getExtent=function(t){return this.extentRevision_!=this.getRevision()&&(this.extent_=this.computeExtent(this.extent_),this.extentRevision_=this.getRevision()),function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}(this.extent_,t)},e.prototype.rotate=function(t,e){h()},e.prototype.scale=function(t,e,n){h()},e.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},e.prototype.getSimplifiedGeometry=function(t){return h()},e.prototype.getType=function(){return h()},e.prototype.applyTransform=function(t){h()},e.prototype.intersectsExtent=function(t){return h()},e.prototype.translate=function(t,e){h()},e.prototype.transform=function(t,e){var n=Ge(t),i=n.getUnits()==be.TILE_PIXELS?function(t,i,r){var o=n.getExtent(),s=n.getWorldExtent(),a=ue(s)/ue(o);return function(t,e,n,i,r,o,s,a){var c=Math.sin(o),l=Math.cos(o);t[0]=i*l,t[1]=r*c,t[2]=-i*c,t[3]=r*l,t[4]=s*i*l-a*i*c+e,t[5]=s*r*c+a*r*l+n}(yn,s[0],s[3],a,-a,0,0,0),mn(t,0,t.length,r,yn,i),Ze(n,e)(t,i,r)}:Ze(n,e);return this.applyTransform(i),this},e}(U));function Cn(t,e,n,i){for(var r=0,o=t[n-i],s=t[n-i+1];e<n;e+=i){var a=t[e],c=t[e+1];r+=s*a-o*c,o=a,s=c}return r/2}function wn(t,e,n,i){for(var r=0,o=0,s=n.length;o<s;++o){var a=n[o];r+=Cn(t,e,a,i),e=a}return r}function En(t,e,n,i,r,o,s){var a,c=t[e],l=t[e+1],u=t[n]-c,h=t[n+1]-l;if(0===u&&0===h)a=e;else{var d=((r-c)*u+(o-l)*h)/(u*u+h*h);if(d>1)a=n;else{if(d>0){for(var f=0;f<i;++f)s[f]=zt(t[e+f],t[n+f],d);return void(s.length=i)}a=e}}for(var p=0;p<i;++p)s[p]=t[a+p];s.length=i}function Tn(t,e,n,i,r){var o=t[e],s=t[e+1];for(e+=i;e<n;e+=i){var a=t[e],c=t[e+1],l=Nt(o,s,a,c);l>r&&(r=l),o=a,s=c}return r}function Sn(t,e,n,i,r){for(var o=0,s=n.length;o<s;++o){var a=n[o];r=Tn(t,e,a,i,r),e=a}return r}function xn(t,e,n,i,r,o,s,a,c,l,u){if(e==n)return l;var h,d;if(0===r){if((d=Nt(s,a,t[e],t[e+1]))<l){for(h=0;h<i;++h)c[h]=t[e+h];return c.length=i,d}return l}for(var f=u||[NaN,NaN],p=e+i;p<n;)if(En(t,p-i,p,i,s,a,f),(d=Nt(s,a,f[0],f[1]))<l){for(l=d,h=0;h<i;++h)c[h]=f[h];c.length=i,p+=i}else p+=i*Math.max((Math.sqrt(d)-Math.sqrt(l))/r|0,1);if(o&&(En(t,n-i,e,i,s,a,f),(d=Nt(s,a,f[0],f[1]))<l)){for(l=d,h=0;h<i;++h)c[h]=f[h];c.length=i}return l}function Rn(t,e,n,i,r,o,s,a,c,l,u){for(var h=u||[NaN,NaN],d=0,f=n.length;d<f;++d){var p=n[d];l=xn(t,e,p,i,r,o,s,a,c,l,h),e=p}return l}function An(t,e,n,i){for(var r=0,o=n.length;r<o;++r)for(var s=n[r],a=0;a<i;++a)t[e++]=s[a];return e}function On(t,e,n,i,r){for(var o=r||[],s=0,a=0,c=n.length;a<c;++a){var l=An(t,e,n[a],i);o[s++]=l,e=l}return o.length=s,o}function In(t,e,n,i,r){for(var o=void 0!==r?r:[],s=0,a=e;a<n;a+=i)o[s++]=t.slice(a,a+i);return o.length=s,o}function Mn(t,e,n,i,r){for(var o=void 0!==r?r:[],s=0,a=0,c=n.length;a<c;++a){var l=n[a];o[s++]=In(t,e,l,i,o[s]),e=l}return o.length=s,o}function Pn(t,e,n,i,r,o,s){var a=(n-e)/i;if(a<3){for(;e<n;e+=i)o[s++]=t[e],o[s++]=t[e+1];return s}var c=new Array(a);c[0]=1,c[a-1]=1;for(var l=[e,n-i],u=0;l.length>0;){for(var h=l.pop(),d=l.pop(),f=0,p=t[d],g=t[d+1],_=t[h],m=t[h+1],y=d+i;y<h;y+=i){var v=Ft(t[y],t[y+1],p,g,_,m);v>f&&(u=y,f=v)}f>r&&(c[(u-e)/i]=1,d+i<u&&l.push(d,u),u+i<h&&l.push(u,h))}for(var b=0;b<a;++b)c[b]&&(o[s++]=t[e+b*i],o[s++]=t[e+b*i+1]);return s}function Ln(t,e){return e*Math.round(t/e)}function Dn(t,e,n,i,r,o,s){if(e==n)return s;var a,c,l=Ln(t[e],r),u=Ln(t[e+1],r);e+=i,o[s++]=l,o[s++]=u;do{if(a=Ln(t[e],r),c=Ln(t[e+1],r),(e+=i)==n)return o[s++]=a,o[s++]=c,s}while(a==l&&c==u);for(;e<n;){var h=Ln(t[e],r),d=Ln(t[e+1],r);if(e+=i,h!=a||d!=c){var f=a-l,p=c-u,g=h-l,_=d-u;f*_==p*g&&(f<0&&g<f||f==g||f>0&&g>f)&&(p<0&&_<p||p==_||p>0&&_>p)?(a=h,c=d):(o[s++]=a,o[s++]=c,l=a,u=c,a=h,c=d)}}return o[s++]=a,o[s++]=c,s}function kn(t,e,n,i,r,o,s,a){for(var c=0,l=n.length;c<l;++c){var u=n[c];s=Dn(t,e,u,i,r,o,s),a.push(s),e=u}return s}var Fn=function(t){function e(e,n){t.call(this),this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===n||Array.isArray(e[0])?this.setCoordinates(e,n):this.setFlatCoordinates(n,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,n,i){return i<qt(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Tn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),xn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,n,i))},e.prototype.getArea=function(){return Cn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinates=function(){return In(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getSimplifiedGeometryInternal=function(t){var n=[];return n.length=Pn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,n,0),new e(n,_n.XY)},e.prototype.getType=function(){return Ut.LINEAR_RING},e.prototype.intersectsExtent=function(t){return!1},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=An(this.flatCoordinates,0,t,this.stride),this.changed()},e}(bn),Nn=function(t){function e(e,n){t.call(this),this.setCoordinates(e,n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,n,i){var r=this.flatCoordinates,o=Nt(t,e,r[0],r[1]);if(o<i){for(var s=this.stride,a=0;a<s;++a)n[a]=r[a];return n.length=s,o}return i},e.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},e.prototype.computeExtent=function(t){return e=this.flatCoordinates,n=t,i=e[0],r=e[1],Qt(i,r,i,r,n);var e,n,i,r},e.prototype.getType=function(){return Ut.POINT},e.prototype.intersectsExtent=function(t){return $t(t,this.flatCoordinates[0],this.flatCoordinates[1])},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=function(t,e,n,i){for(var r=0,o=n.length;r<o;++r)t[e++]=n[r];return e}(this.flatCoordinates,0,t,this.stride),this.changed()},e}(bn);function jn(t,e,n,i,r){return!function(t,e,n){var i;return(i=e.call(n,se(t)))?i:(i=e.call(n,ae(t)))?i:(i=e.call(n,fe(t)))?i:(i=e.call(n,de(t)))||!1}(r,function(r){return!Bn(t,e,n,i,r[0],r[1])})}function Bn(t,e,n,i,r,o){for(var s=0,a=t[n-i],c=t[n-i+1];e<n;e+=i){var l=t[e],u=t[e+1];c<=o?u>o&&(l-a)*(o-c)-(r-a)*(u-c)>0&&s++:u<=o&&(l-a)*(o-c)-(r-a)*(u-c)<0&&s--,a=l,c=u}return 0!==s}function zn(t,e,n,i,r,o){if(0===n.length)return!1;if(!Bn(t,e,n[0],i,r,o))return!1;for(var s=1,a=n.length;s<a;++s)if(Bn(t,n[s-1],n[s],i,r,o))return!1;return!0}function Un(t,e,n,i,r,o,s){for(var a,c,l,u,h,d,f,p=r[o+1],g=[],_=0,m=n.length;_<m;++_){var y=n[_];for(u=t[y-i],d=t[y-i+1],a=e;a<y;a+=i)h=t[a],f=t[a+1],(p<=d&&f<=p||d<=p&&p<=f)&&(l=(p-d)/(f-d)*(h-u)+u,g.push(l)),u=h,d=f}var v=NaN,b=-1/0;for(g.sort(rn),u=g[0],a=1,c=g.length;a<c;++a){h=g[a];var C=Math.abs(h-u);C>b&&zn(t,e,n,i,l=(u+h)/2,p)&&(v=l,b=C),u=h}return isNaN(v)&&(v=r[o]),s?(s.push(v,p,b),s):[v,p,b]}function Hn(t,e,n,i,r){var o=ie([1/0,1/0,-1/0,-1/0],t,e,n,i);return!!ge(r,o)&&(!!Kt(r,o)||(o[0]>=r[0]&&o[2]<=r[2]||(o[1]>=r[1]&&o[3]<=r[3]||function(t,e,n,i,r,o){for(var s,a=[t[e],t[e+1]],c=[];e+i<n;e+=i){if(c[0]=t[e+i],c[1]=t[e+i+1],s=r.call(o,a,c))return s;a[0]=c[0],a[1]=c[1]}return!1}(t,e,n,i,function(t,e){return function(t,e,n){var i=!1,r=Zt(t,e),o=Zt(t,n);if(r===Vt.INTERSECTING||o===Vt.INTERSECTING)i=!0;else{var s,a,c=t[0],l=t[1],u=t[2],h=t[3],d=e[0],f=e[1],p=n[0],g=n[1],_=(g-f)/(p-d);o&Vt.ABOVE&&!(r&Vt.ABOVE)&&(i=(s=p-(g-h)/_)>=c&&s<=u),i||!(o&Vt.RIGHT)||r&Vt.RIGHT||(i=(a=g-(p-u)*_)>=l&&a<=h),i||!(o&Vt.BELOW)||r&Vt.BELOW||(i=(s=p-(g-l)/_)>=c&&s<=u),i||!(o&Vt.LEFT)||r&Vt.LEFT||(i=(a=g-(p-c)*_)>=l&&a<=h)}return i}(r,t,e)}))))}function Wn(t,e,n,i,r){if(!function(t,e,n,i,r){return!!Hn(t,e,n,i,r)||(!!Bn(t,e,n,i,r[0],r[1])||(!!Bn(t,e,n,i,r[0],r[3])||(!!Bn(t,e,n,i,r[2],r[1])||!!Bn(t,e,n,i,r[2],r[3]))))}(t,e,n[0],i,r))return!1;if(1===n.length)return!0;for(var o=1,s=n.length;o<s;++o)if(jn(t,n[o-1],n[o],i,r)&&!Hn(t,n[o-1],n[o],i,r))return!1;return!0}function Gn(t,e,n,i){for(;e<n-i;){for(var r=0;r<i;++r){var o=t[e+r];t[e+r]=t[n-i+r],t[n-i+r]=o}e+=i,n-=i}}function Vn(t,e,n,i){for(var r=0,o=t[n-i],s=t[n-i+1];e<n;e+=i){var a=t[e],c=t[e+1];r+=(a-o)*(c+s),o=a,s=c}return r>0}function Yn(t,e,n,i,r){for(var o=void 0!==r&&r,s=0,a=n.length;s<a;++s){var c=n[s],l=Vn(t,e,c,i);if(0===s){if(o&&l||!o&&!l)return!1}else if(o&&!l||!o&&l)return!1;e=c}return!0}function qn(t,e,n,i,r){for(var o=void 0!==r&&r,s=0,a=n.length;s<a;++s){var c=n[s],l=Vn(t,e,c,i);(0===s?o&&l||!o&&!l:o&&!l||!o&&l)&&Gn(t,e,c,i),e=c}return e}var Xn=function(t){function e(e,n,i){t.call(this),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,void 0!==n&&i?(this.setFlatCoordinates(n,e),this.ends_=i):this.setCoordinates(e,n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.appendLinearRing=function(t){this.flatCoordinates?sn(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},e.prototype.closestPointXY=function(t,e,n,i){return i<qt(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Sn(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Rn(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,n,i))},e.prototype.containsXY=function(t,e){return zn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)},e.prototype.getArea=function(){return wn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},e.prototype.getCoordinates=function(t){var e;return void 0!==t?qn(e=this.getOrientedFlatCoordinates().slice(),0,this.ends_,this.stride,t):e=this.flatCoordinates,Mn(e,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=ce(this.getExtent());this.flatInteriorPoint_=Un(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},e.prototype.getInteriorPoint=function(){return new Nn(this.getFlatInteriorPoint(),_n.XYM)},e.prototype.getLinearRingCount=function(){return this.ends_.length},e.prototype.getLinearRing=function(t){return t<0||this.ends_.length<=t?null:new Fn(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLinearRings=function(){for(var t=this.layout,e=this.flatCoordinates,n=this.ends_,i=[],r=0,o=0,s=n.length;o<s;++o){var a=n[o],c=new Fn(e.slice(r,a),t);i.push(c),r=a}return i},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;Yn(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=qn(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var n=[],i=[];return n.length=kn(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),n,0,i),new e(n,_n.XY,i)},e.prototype.getType=function(){return Ut.POLYGON},e.prototype.intersectsExtent=function(t){return Wn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var n=On(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===n.length?0:n[n.length-1],this.changed()},e}(bn);function Kn(t){var e=t[0],n=t[1],i=t[2],r=t[3],o=[e,n,e,r,i,r,i,n,e,n];return new Xn(o,_n.XY,[o.length])}var $n=0;function Zn(t,e){setTimeout(function(){t(e)},0)}function Jn(t){return!(t.sourceCenter&&t.targetCenter&&!function(t,e){for(var n=!0,i=t.length-1;i>=0;--i)if(t[i]!=e[i]){n=!1;break}return n}(t.sourceCenter,t.targetCenter))&&(t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation)}var Qn=function(t){function e(e){t.call(this);var n=_({},e);this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.updateAnimations_=this.updateAnimations_.bind(this),this.projection_=qe(n.projection,"EPSG:3857"),this.applyOptions_(n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.applyOptions_=function(t){var e={};e[hn]=void 0!==t.center?t.center:null;var n=function(t){var e,n,i,r=void 0!==t.minZoom?t.minZoom:$n,o=void 0!==t.maxZoom?t.maxZoom:28,s=void 0!==t.zoomFactor?t.zoomFactor:2;if(void 0!==t.resolutions){var a=t.resolutions;n=a[r],i=void 0!==a[o]?a[o]:a[a.length-1],e=function(t){return function(e,n,i){if(void 0!==e){var r=on(t,e,i);r=Dt(r+n,0,t.length-1);var o=Math.floor(r);if(r!=o&&o<t.length-1){var s=t[o]/t[o+1];return t[o]/Math.pow(s,r-o)}return t[o]}}}(a)}else{var c=qe(t.projection,"EPSG:3857"),l=c.getExtent(),u=(l?Math.max(pe(l),ue(l)):360*ve[be.DEGREES]/c.getMetersPerUnit())/en/Math.pow(2,$n),h=u/Math.pow(2,28-$n);void 0!==(n=t.maxResolution)?r=0:n=u/Math.pow(s,r),void 0===(i=t.minResolution)&&(i=void 0!==t.maxZoom?void 0!==t.maxResolution?n/Math.pow(s,o):u/Math.pow(s,o):h),o=r+Math.floor(Math.log(n/i)/Math.log(s)),i=n/Math.pow(s,o-r),e=function(t,e,n){return function(i,r,o){if(void 0!==i){var s=-o/2+.5,a=Math.floor(Math.log(e/i)/Math.log(t)+s),c=Math.max(a+r,0);return void 0!==n&&(c=Math.min(c,n)),e/Math.pow(t,c)}}}(s,n,o-r)}return{constraint:e,maxResolution:n,minResolution:i,minZoom:r,zoomFactor:s}}(t);this.maxResolution_=n.maxResolution,this.minResolution_=n.minResolution,this.zoomFactor_=n.zoomFactor,this.resolutions_=t.resolutions,this.minZoom_=n.minZoom;var i=function(t){return void 0!==t.extent?(e=t.extent,function(t){return t?[Dt(t[0],e[0],e[2]),Dt(t[1],e[1],e[3])]:void 0}):nn;var e}(t),r=n.constraint,o=function(t){if(void 0===t.enableRotation||t.enableRotation){var e=t.constrainRotation;return void 0===e||!0===e?(o=r||jt(5),function(t,e){return void 0!==t?Math.abs(t+e)<=o?0:t+e:void 0}):!1===e?cn:"number"==typeof e?(n=e,i=2*Math.PI/n,function(t,e){return void 0!==t?t=Math.floor((t+e)/i+.5)*i:void 0}):cn}return an;var n,i;var r,o}(t);this.constraints_={center:i,resolution:r,rotation:o},void 0!==t.resolution?e[dn]=t.resolution:void 0!==t.zoom&&(e[dn]=this.constrainResolution(this.maxResolution_,t.zoom-this.minZoom_),this.resolutions_&&(e[dn]=Dt(Number(this.getResolution()||e[dn]),this.minResolution_,this.maxResolution_))),e[fn]=void 0!==t.rotation?t.rotation:0,this.setProperties(e),this.options_=t},e.prototype.getUpdatedOptions_=function(t){var e=_({},this.options_);return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenter(),e.rotation=this.getRotation(),_({},e,t)},e.prototype.animate=function(t){var e,n=arguments,i=arguments.length;if(i>1&&"function"==typeof arguments[i-1]&&(e=arguments[i-1],--i),!this.isDef()){var r=arguments[i-1];return r.center&&this.setCenter(r.center),void 0!==r.zoom&&this.setZoom(r.zoom),void 0!==r.rotation&&this.setRotation(r.rotation),void(e&&Zn(e,!0))}for(var o=Date.now(),s=this.getCenter().slice(),a=this.getResolution(),c=this.getRotation(),l=[],u=0;u<i;++u){var h=n[u],d={start:o,complete:!1,anchor:h.anchor,duration:void 0!==h.duration?h.duration:1e3,easing:h.easing||gn};if(h.center&&(d.sourceCenter=s,d.targetCenter=h.center,s=d.targetCenter),void 0!==h.zoom?(d.sourceResolution=a,d.targetResolution=this.constrainResolution(this.maxResolution_,h.zoom-this.minZoom_,0),a=d.targetResolution):h.resolution&&(d.sourceResolution=a,d.targetResolution=h.resolution,a=d.targetResolution),void 0!==h.rotation){d.sourceRotation=c;var f=Bt(h.rotation-c+Math.PI,2*Math.PI)-Math.PI;d.targetRotation=c+f,c=d.targetRotation}d.callback=e,Jn(d)?d.complete=!0:o+=d.duration,l.push(d)}this.animations_.push(l),this.setHint(ln,1),this.updateAnimations_()},e.prototype.getAnimating=function(){return this.hints_[ln]>0},e.prototype.getInteracting=function(){return this.hints_[un]>0},e.prototype.cancelAnimations=function(){this.setHint(ln,-this.hints_[ln]);for(var t=0,e=this.animations_.length;t<e;++t){var n=this.animations_[t];n[0].callback&&Zn(n[0].callback,!1)}this.animations_.length=0},e.prototype.updateAnimations_=function(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){for(var t=Date.now(),e=!1,n=this.animations_.length-1;n>=0;--n){for(var i=this.animations_[n],r=!0,o=0,s=i.length;o<s;++o){var a=i[o];if(!a.complete){var c=t-a.start,l=a.duration>0?c/a.duration:1;l>=1?(a.complete=!0,l=1):r=!1;var u=a.easing(l);if(a.sourceCenter){var h=a.sourceCenter[0],d=a.sourceCenter[1],f=h+u*(a.targetCenter[0]-h),p=d+u*(a.targetCenter[1]-d);this.set(hn,[f,p])}if(a.sourceResolution&&a.targetResolution){var g=1===u?a.targetResolution:a.sourceResolution+u*(a.targetResolution-a.sourceResolution);a.anchor&&this.set(hn,this.calculateCenterZoom(g,a.anchor)),this.set(dn,g)}if(void 0!==a.sourceRotation&&void 0!==a.targetRotation){var _=1===u?Bt(a.targetRotation+Math.PI,2*Math.PI)-Math.PI:a.sourceRotation+u*(a.targetRotation-a.sourceRotation);a.anchor&&this.set(hn,this.calculateCenterRotate(_,a.anchor)),this.set(fn,_)}if(e=!0,!a.complete)break}}if(r){this.animations_[n]=null,this.setHint(ln,-1);var m=i[0].callback;m&&Zn(m,!0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_))}},e.prototype.calculateCenterRotate=function(t,e){var n,i,r,o,s,a,c,l=this.getCenter();return void 0!==l&&(n=[l[0]-e[0],l[1]-e[1]],i=n,r=t-this.getRotation(),o=Math.cos(r),s=Math.sin(r),a=i[0]*o-i[1]*s,c=i[1]*o+i[0]*s,i[0]=a,i[1]=c,function(t,e){t[0]+=e[0],t[1]+=e[1]}(n,e)),n},e.prototype.calculateCenterZoom=function(t,e){var n,i=this.getCenter(),r=this.getResolution();void 0!==i&&void 0!==r&&(n=[e[0]-t*(e[0]-i[0])/r,e[1]-t*(e[1]-i[1])/r]);return n},e.prototype.getSizeFromViewport_=function(){var t=[100,100],e='.ol-viewport[data-view="'+f(this)+'"]',n=document.querySelector(e);if(n){var i=getComputedStyle(n);t[0]=parseInt(i.width,10),t[1]=parseInt(i.height,10)}return t},e.prototype.constrainCenter=function(t){return this.constraints_.center(t)},e.prototype.constrainResolution=function(t,e,n){var i=e||0,r=n||0;return this.constraints_.resolution(t,i,r)},e.prototype.constrainRotation=function(t,e){var n=e||0;return this.constraints_.rotation(t,n)},e.prototype.getCenter=function(){return this.get(hn)},e.prototype.getConstraints=function(){return this.constraints_},e.prototype.getHints=function(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()},e.prototype.calculateExtent=function(t){var e=t||this.getSizeFromViewport_(),n=this.getCenter();Lt(n,1);var i=this.getResolution();Lt(void 0!==i,2);var r=this.getRotation();return Lt(void 0!==r,3),function(t,e,n,i,r){var o=e*i[0]/2,s=e*i[1]/2,a=Math.cos(n),c=Math.sin(n),l=o*a,u=o*c,h=s*a,d=s*c,f=t[0],p=t[1],g=f-l+d,_=f-l-d,m=f+l-d,y=f+l+d,v=p-u-h,b=p-u+h,C=p+u+h,w=p+u-h;return Qt(Math.min(g,_,m,y),Math.min(v,b,C,w),Math.max(g,_,m,y),Math.max(v,b,C,w),r)}(n,i,r,e)},e.prototype.getMaxResolution=function(){return this.maxResolution_},e.prototype.getMinResolution=function(){return this.minResolution_},e.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},e.prototype.setMaxZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))},e.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},e.prototype.setMinZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))},e.prototype.getProjection=function(){return this.projection_},e.prototype.getResolution=function(){return this.get(dn)},e.prototype.getResolutions=function(){return this.resolutions_},e.prototype.getResolutionForExtent=function(t,e){var n=e||this.getSizeFromViewport_(),i=pe(t)/n[0],r=ue(t)/n[1];return Math.max(i,r)},e.prototype.getResolutionForValueFunction=function(t){var e=t||2,n=this.maxResolution_,i=this.minResolution_,r=Math.log(n/i)/Math.log(e);return function(t){return n/Math.pow(e,t*r)}},e.prototype.getRotation=function(){return this.get(fn)},e.prototype.getValueForResolutionFunction=function(t){var e=t||2,n=this.maxResolution_,i=this.minResolution_,r=Math.log(n/i)/Math.log(e);return function(t){return Math.log(n/t)/Math.log(e)/r}},e.prototype.getState=function(t){var e=this.getCenter(),n=this.getProjection(),i=this.getResolution(),r=i/t,o=this.getRotation();return{center:[Math.round(e[0]/r)*r,Math.round(e[1]/r)*r],projection:void 0!==n?n:null,resolution:i,rotation:o,zoom:this.getZoom()}},e.prototype.getZoom=function(){var t,e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t},e.prototype.getZoomForResolution=function(t){var e,n,i=this.minZoom_||0;if(this.resolutions_){var r=on(this.resolutions_,t,1);i=r,e=this.resolutions_[r],n=r==this.resolutions_.length-1?2:e/this.resolutions_[r+1]}else e=this.maxResolution_,n=this.zoomFactor_;return i+Math.log(e/t)/Math.log(n)},e.prototype.getResolutionForZoom=function(t){return this.constrainResolution(this.maxResolution_,t-this.minZoom_,0)},e.prototype.fit=function(t,e){var n,i=e||{},r=i.size;r||(r=this.getSizeFromViewport_()),Lt(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,24),Array.isArray(t)?(Lt(!_e(t),25),n=Kn(t)):t.getType()===Ut.CIRCLE?(n=Kn(t=t.getExtent())).rotate(this.getRotation(),ce(t)):n=t;var o,s=void 0!==i.padding?i.padding:[0,0,0,0],a=void 0===i.constrainResolution||i.constrainResolution,c=void 0!==i.nearest&&i.nearest;o=void 0!==i.minResolution?i.minResolution:void 0!==i.maxZoom?this.constrainResolution(this.maxResolution_,i.maxZoom-this.minZoom_,0):0;for(var u=n.getFlatCoordinates(),h=this.getRotation(),d=Math.cos(-h),f=Math.sin(-h),p=1/0,g=1/0,_=-1/0,m=-1/0,y=n.getStride(),v=0,b=u.length;v<b;v+=y){var C=u[v]*d-u[v+1]*f,w=u[v]*f+u[v+1]*d;p=Math.min(p,C),g=Math.min(g,w),_=Math.max(_,C),m=Math.max(m,w)}var E=this.getResolutionForExtent([p,g,_,m],[r[0]-s[1]-s[3],r[1]-s[0]-s[2]]);if(E=isNaN(E)?o:Math.max(E,o),a){var T=this.constrainResolution(E,0,0);!c&&T<E&&(T=this.constrainResolution(T,-1,0)),E=T}f=-f;var S=(p+_)/2,x=(g+m)/2,R=[(S+=(s[1]-s[3])/2*E)*d-(x+=(s[0]-s[2])/2*E)*f,x*d+S*f],A=i.callback?i.callback:l;void 0!==i.duration?this.animate({resolution:E,center:R,duration:i.duration,easing:i.easing},A):(this.setResolution(E),this.setCenter(R),Zn(A,!0))},e.prototype.centerOn=function(t,e,n){var i=this.getRotation(),r=Math.cos(-i),o=Math.sin(-i),s=t[0]*r-t[1]*o,a=t[1]*r+t[0]*o,c=this.getResolution(),l=(s+=(e[0]/2-n[0])*c)*r-(a+=(n[1]-e[1]/2)*c)*(o=-o),u=a*r+s*o;this.setCenter([l,u])},e.prototype.isDef=function(){return!!this.getCenter()&&void 0!==this.getResolution()},e.prototype.rotate=function(t,e){if(void 0!==e){var n=this.calculateCenterRotate(t,e);this.setCenter(n)}this.setRotation(t)},e.prototype.setCenter=function(t){this.set(hn,t),this.getAnimating()&&this.cancelAnimations()},e.prototype.setHint=function(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]},e.prototype.setResolution=function(t){this.set(dn,t),this.getAnimating()&&this.cancelAnimations()},e.prototype.setRotation=function(t){this.set(fn,t),this.getAnimating()&&this.cancelAnimations()},e.prototype.setZoom=function(t){this.setResolution(this.getResolutionForZoom(t))},e}(U),ti=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,ei=/^([a-z]*)$/i;function ni(t){return"string"==typeof t?t:ai(t)}var ii,ri,oi=(ii={},ri=0,function(t){var e;if(ii.hasOwnProperty(t))e=ii[t];else{if(ri>=1024){var n=0;for(var i in ii)0==(3&n++)&&(delete ii[i],--ri)}e=function(t){var e,n,i,r,o;if(ei.exec(t)&&(t=function(t){var e=document.createElement("div");if(e.style.color=t,""!==e.style.color){document.body.appendChild(e);var n=getComputedStyle(e).color;return document.body.removeChild(e),n}return""}(t)),ti.exec(t)){var s,a=t.length-1;s=a<=4?1:2;var c=4===a||8===a;e=parseInt(t.substr(1+0*s,s),16),n=parseInt(t.substr(1+1*s,s),16),i=parseInt(t.substr(1+2*s,s),16),r=c?parseInt(t.substr(1+3*s,s),16):255,1==s&&(e=(e<<4)+e,n=(n<<4)+n,i=(i<<4)+i,c&&(r=(r<<4)+r)),o=[e,n,i,r/255]}else 0==t.indexOf("rgba(")?si(o=t.slice(5,-1).split(",").map(Number)):0==t.indexOf("rgb(")?((o=t.slice(4,-1).split(",").map(Number)).push(1),si(o)):Lt(!1,14);return o}(t),ii[t]=e,++ri}return e});function si(t){return t[0]=Dt(t[0]+.5|0,0,255),t[1]=Dt(t[1]+.5|0,0,255),t[2]=Dt(t[2]+.5|0,0,255),t[3]=Dt(t[3],0,1),t}function ai(t){var e=t[0];e!=(0|e)&&(e=e+.5|0);var n=t[1];n!=(0|n)&&(n=n+.5|0);var i=t[2];return i!=(0|i)&&(i=i+.5|0),"rgba("+e+","+n+","+i+","+(void 0===t[3]?1:t[3])+")"}function ci(t){return Array.isArray(t)?ai(t):t}var li="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",ui=(li.indexOf("firefox"),-1!==li.indexOf("safari")&&li.indexOf("chrom"),-1!==li.indexOf("webkit")&&li.indexOf("edge"),li.indexOf("macintosh"),window.devicePixelRatio,function(){var t=!1;try{t=!!document.createElement("canvas").getContext("2d").setLineDash}catch(t){}return t}()),hi=(navigator,window,window,navigator.msPointerEnabled,{IDLE:0,LOADING:1,LOADED:2,ERROR:3}),di=function(){var t,e={};return function(n){if(t||(t=document.createElement("div").style),!(n in e)){t.font=n;var i=t.fontFamily;if(t.font="",!i)return null;e[n]=i.split(/,\s?/)}return e[n]}}(),fi=function(t){function e(e){t.call(this),this.highWaterMark=void 0!==e?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.canExpireCache=function(){return this.getCount()>this.highWaterMark},e.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null,this.dispatchEvent(D)},e.prototype.containsKey=function(t){return this.entries_.hasOwnProperty(t)},e.prototype.forEach=function(t,e){for(var n=this.oldest_;n;)t.call(e,n.value_,n.key_,this),n=n.newer},e.prototype.get=function(t){var e=this.entries_[t];return Lt(void 0!==e,15),e===this.newest_?e.value_:(e===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(e.newer.older=e.older,e.older.newer=e.newer),e.newer=null,e.older=this.newest_,this.newest_.newer=e,this.newest_=e,e.value_)},e.prototype.remove=function(t){var e=this.entries_[t];return Lt(void 0!==e,15),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_},e.prototype.getCount=function(){return this.count_},e.prototype.getKeys=function(){var t,e=new Array(this.count_),n=0;for(t=this.newest_;t;t=t.older)e[n++]=t.key_;return e},e.prototype.getValues=function(){var t,e=new Array(this.count_),n=0;for(t=this.newest_;t;t=t.older)e[n++]=t.value_;return e},e.prototype.peekLast=function(){return this.oldest_.value_},e.prototype.peekLastKey=function(){return this.oldest_.key_},e.prototype.peekFirstKey=function(){return this.newest_.key_},e.prototype.pop=function(){var t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_},e.prototype.replace=function(t,e){this.get(t),this.entries_[t].value_=e},e.prototype.set=function(t,e){Lt(!(t in this.entries_),16);var n={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=n:this.oldest_=n,this.newest_=n,this.entries_[t]=n,++this.count_},e.prototype.setSize=function(t){this.highWaterMark=t},e.prototype.prune=function(){for(;this.canExpireCache();)this.pop()},e}(P),pi=[0,0,0,1],gi=[0,0,0,1],_i=new fi,mi={},yi=null,vi={};!function(){var t,e,n=60,i=mi,r="32px ",o=["monospace","serif"],s=o.length,a="wmytzilWMYTZIL@#/&?$%10";function c(t){for(var n=bi(),i=100;i<=700;i+=300){for(var c=i+" ",l=!0,u=0;u<s;++u){var h=o[u];if(n.font=c+r+h,e=n.measureText(a).width,t!=h){n.font=c+r+t+","+h;var d=n.measureText(a).width;l=l&&d!=e}}if(l)return!0}return!1}function l(){var e=!0;for(var r in i)i[r]<n&&(c(r)?(i[r]=n,m(vi),yi=null,_i.clear()):(++i[r],e=!1));e&&(clearInterval(t),t=void 0)}}();function bi(){return yi||(yi=H(1,1)),yi}var Ci,wi;wi=vi;var Ei=function(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale};Ei.prototype.clone=function(){return new Ei({opacity:this.getOpacity(),scale:this.getScale(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},Ei.prototype.getOpacity=function(){return this.opacity_},Ei.prototype.getRotateWithView=function(){return this.rotateWithView_},Ei.prototype.getRotation=function(){return this.rotation_},Ei.prototype.getScale=function(){return this.scale_},Ei.prototype.getSnapToPixel=function(){return!1},Ei.prototype.getAnchor=function(){return h()},Ei.prototype.getImage=function(t){return h()},Ei.prototype.getHitDetectionImage=function(t){return h()},Ei.prototype.getImageState=function(){return h()},Ei.prototype.getImageSize=function(){return h()},Ei.prototype.getHitDetectionImageSize=function(){return h()},Ei.prototype.getOrigin=function(){return h()},Ei.prototype.getSize=function(){return h()},Ei.prototype.setOpacity=function(t){this.opacity_=t},Ei.prototype.setRotateWithView=function(t){this.rotateWithView_=t},Ei.prototype.setRotation=function(t){this.rotation_=t},Ei.prototype.setScale=function(t){this.scale_=t},Ei.prototype.setSnapToPixel=function(t){},Ei.prototype.listenImageChange=function(t,e){return h()},Ei.prototype.load=function(){h()},Ei.prototype.unlistenImageChange=function(t,e){h()};var Ti=Ei,Si=function(t){function e(e){var n=void 0!==e.rotateWithView&&e.rotateWithView;t.call(this,{opacity:1,rotateWithView:n,rotation:void 0!==e.rotation?e.rotation:0,scale:1}),this.checksums_=null,this.canvas_=null,this.hitDetectionCanvas_=null,this.fill_=void 0!==e.fill?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius_=void 0!==e.radius?e.radius:e.radius1,this.radius2_=e.radius2,this.angle_=void 0!==e.angle?e.angle:0,this.stroke_=void 0!==e.stroke?e.stroke:null,this.anchor_=null,this.size_=null,this.imageSize_=null,this.hitDetectionImageSize_=null,this.atlasManager_=e.atlasManager,this.render_(this.atlasManager_)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),atlasManager:this.atlasManager_});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},e.prototype.getAnchor=function(){return this.anchor_},e.prototype.getAngle=function(){return this.angle_},e.prototype.getFill=function(){return this.fill_},e.prototype.getHitDetectionImage=function(t){return this.hitDetectionCanvas_},e.prototype.getImage=function(t){return this.canvas_},e.prototype.getImageSize=function(){return this.imageSize_},e.prototype.getHitDetectionImageSize=function(){return this.hitDetectionImageSize_},e.prototype.getImageState=function(){return hi.LOADED},e.prototype.getOrigin=function(){return this.origin_},e.prototype.getPoints=function(){return this.points_},e.prototype.getRadius=function(){return this.radius_},e.prototype.getRadius2=function(){return this.radius2_},e.prototype.getSize=function(){return this.size_},e.prototype.getStroke=function(){return this.stroke_},e.prototype.listenImageChange=function(t,e){},e.prototype.load=function(){},e.prototype.unlistenImageChange=function(t,e){},e.prototype.render_=function(t){var e,n,i="",r="",o=0,s=null,a=0,c=0;this.stroke_&&(null===(n=this.stroke_.getColor())&&(n=gi),n=ci(n),void 0===(c=this.stroke_.getWidth())&&(c=1),s=this.stroke_.getLineDash(),a=this.stroke_.getLineDashOffset(),ui||(s=null,a=0),void 0===(r=this.stroke_.getLineJoin())&&(r="round"),void 0===(i=this.stroke_.getLineCap())&&(i="round"),void 0===(o=this.stroke_.getMiterLimit())&&(o=10));var l=2*(this.radius_+c)+1,u={strokeStyle:n,strokeWidth:c,size:l,lineCap:i,lineDash:s,lineDashOffset:a,lineJoin:r,miterLimit:o};if(void 0===t){var h=H(l,l);this.canvas_=h.canvas,e=l=this.canvas_.width,this.draw_(u,h,0,0),this.createHitDetectionCanvas_(u)}else{l=Math.round(l);var d,f=!this.fill_;f&&(d=this.drawHitDetectionCanvas_.bind(this,u));var p=this.getChecksum(),g=t.add(p,l,l,this.draw_.bind(this,u),d);this.canvas_=g.image,this.origin_=[g.offsetX,g.offsetY],e=g.image.width,f?(this.hitDetectionCanvas_=g.hitImage,this.hitDetectionImageSize_=[g.hitImage.width,g.hitImage.height]):(this.hitDetectionCanvas_=this.canvas_,this.hitDetectionImageSize_=[e,e])}this.anchor_=[l/2,l/2],this.size_=[l,l],this.imageSize_=[e,e]},e.prototype.draw_=function(t,e,n,i){var r,o,s;e.setTransform(1,0,0,1,0,0),e.translate(n,i),e.beginPath();var a=this.points_;if(a===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var c=void 0!==this.radius2_?this.radius2_:this.radius_;for(c!==this.radius_&&(a*=2),r=0;r<=a;r++)o=2*r*Math.PI/a-Math.PI/2+this.angle_,s=r%2==0?this.radius_:c,e.lineTo(t.size/2+s*Math.cos(o),t.size/2+s*Math.sin(o))}if(this.fill_){var l=this.fill_.getColor();null===l&&(l=pi),e.fillStyle=ci(l),e.fill()}this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke()),e.closePath()},e.prototype.createHitDetectionCanvas_=function(t){if(this.hitDetectionImageSize_=[t.size,t.size],this.fill_)this.hitDetectionCanvas_=this.canvas_;else{var e=H(t.size,t.size);this.hitDetectionCanvas_=e.canvas,this.drawHitDetectionCanvas_(t,e,0,0)}},e.prototype.drawHitDetectionCanvas_=function(t,e,n,i){e.setTransform(1,0,0,1,0,0),e.translate(n,i),e.beginPath();var r=this.points_;if(r===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var o,s,a,c=void 0!==this.radius2_?this.radius2_:this.radius_;for(c!==this.radius_&&(r*=2),o=0;o<=r;o++)a=2*o*Math.PI/r-Math.PI/2+this.angle_,s=o%2==0?this.radius_:c,e.lineTo(t.size/2+s*Math.cos(a),t.size/2+s*Math.sin(a))}e.fillStyle=ni(pi),e.fill(),this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.stroke()),e.closePath()},e.prototype.getChecksum=function(){var t=this.stroke_?this.stroke_.getChecksum():"-",e=this.fill_?this.fill_.getChecksum():"-";if(!this.checksums_||t!=this.checksums_[1]||e!=this.checksums_[2]||this.radius_!=this.checksums_[3]||this.radius2_!=this.checksums_[4]||this.angle_!=this.checksums_[5]||this.points_!=this.checksums_[6]){var n="r"+t+e+(void 0!==this.radius_?this.radius_.toString():"-")+(void 0!==this.radius2_?this.radius2_.toString():"-")+(void 0!==this.angle_?this.angle_.toString():"-")+(void 0!==this.points_?this.points_.toString():"-");this.checksums_=[n,t,e,this.radius_,this.radius2_,this.angle_,this.points_]}return this.checksums_[0]},e}(Ti),xi=function(t){function e(e){var n=e||{};t.call(this,{points:1/0,fill:n.fill,radius:n.radius,stroke:n.stroke,atlasManager:n.atlasManager})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),atlasManager:this.atlasManager_});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},e.prototype.setRadius=function(t){this.radius_=t,this.render_(this.atlasManager_)},e}(Si),Ri=function(t){var e=t||{};this.color_=void 0!==e.color?e.color:null,this.checksum_=void 0};Ri.prototype.clone=function(){var t=this.getColor();return new Ri({color:Array.isArray(t)?t.slice():t||void 0})},Ri.prototype.getColor=function(){return this.color_},Ri.prototype.setColor=function(t){this.color_=t,this.checksum_=void 0},Ri.prototype.getChecksum=function(){if(void 0===this.checksum_){var t=this.color_;t?Array.isArray(t)||"string"==typeof t?this.checksum_="f"+ni(t):this.checksum_=f(this.color_):this.checksum_="f-"}return this.checksum_};var Ai=Ri,Oi=function(t){var e=t||{};this.color_=void 0!==e.color?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=void 0!==e.lineDash?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width,this.checksum_=void 0};Oi.prototype.clone=function(){var t=this.getColor();return new Oi({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},Oi.prototype.getColor=function(){return this.color_},Oi.prototype.getLineCap=function(){return this.lineCap_},Oi.prototype.getLineDash=function(){return this.lineDash_},Oi.prototype.getLineDashOffset=function(){return this.lineDashOffset_},Oi.prototype.getLineJoin=function(){return this.lineJoin_},Oi.prototype.getMiterLimit=function(){return this.miterLimit_},Oi.prototype.getWidth=function(){return this.width_},Oi.prototype.setColor=function(t){this.color_=t,this.checksum_=void 0},Oi.prototype.setLineCap=function(t){this.lineCap_=t,this.checksum_=void 0},Oi.prototype.setLineDash=function(t){this.lineDash_=t,this.checksum_=void 0},Oi.prototype.setLineDashOffset=function(t){this.lineDashOffset_=t,this.checksum_=void 0},Oi.prototype.setLineJoin=function(t){this.lineJoin_=t,this.checksum_=void 0},Oi.prototype.setMiterLimit=function(t){this.miterLimit_=t,this.checksum_=void 0},Oi.prototype.setWidth=function(t){this.width_=t,this.checksum_=void 0},Oi.prototype.getChecksum=function(){return void 0===this.checksum_&&(this.checksum_="s",this.color_?"string"==typeof this.color_?this.checksum_+=this.color_:this.checksum_+=f(this.color_):this.checksum_+="-",this.checksum_+=","+(void 0!==this.lineCap_?this.lineCap_.toString():"-")+","+(this.lineDash_?this.lineDash_.toString():"-")+","+(void 0!==this.lineDashOffset_?this.lineDashOffset_:"-")+","+(void 0!==this.lineJoin_?this.lineJoin_:"-")+","+(void 0!==this.miterLimit_?this.miterLimit_.toString():"-")+","+(void 0!==this.width_?this.width_.toString():"-")),this.checksum_};var Ii=Oi,Mi=function(t){var e=t||{};this.geometry_=null,this.geometryFunction_=Di,void 0!==e.geometry&&this.setGeometry(e.geometry),this.fill_=void 0!==e.fill?e.fill:null,this.image_=void 0!==e.image?e.image:null,this.renderer_=void 0!==e.renderer?e.renderer:null,this.stroke_=void 0!==e.stroke?e.stroke:null,this.text_=void 0!==e.text?e.text:null,this.zIndex_=e.zIndex};Mi.prototype.clone=function(){var t=this.getGeometry();return t&&"object"==typeof t&&(t=t.clone()),new Mi({geometry:t,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},Mi.prototype.getRenderer=function(){return this.renderer_},Mi.prototype.setRenderer=function(t){this.renderer_=t},Mi.prototype.getGeometry=function(){return this.geometry_},Mi.prototype.getGeometryFunction=function(){return this.geometryFunction_},Mi.prototype.getFill=function(){return this.fill_},Mi.prototype.setFill=function(t){this.fill_=t},Mi.prototype.getImage=function(){return this.image_},Mi.prototype.setImage=function(t){this.image_=t},Mi.prototype.getStroke=function(){return this.stroke_},Mi.prototype.setStroke=function(t){this.stroke_=t},Mi.prototype.getText=function(){return this.text_},Mi.prototype.setText=function(t){this.text_=t},Mi.prototype.getZIndex=function(){return this.zIndex_},Mi.prototype.setGeometry=function(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=Di,this.geometry_=t},Mi.prototype.setZIndex=function(t){this.zIndex_=t};var Pi=null;function Li(t,e){if(!Pi){var n=new Ai({color:"rgba(255,255,255,0.4)"}),i=new Ii({color:"#3399CC",width:1.25});Pi=[new Mi({image:new xi({fill:n,stroke:i,radius:5}),fill:n,stroke:i})]}return Pi}function Di(t){return t.getGeometry()}var ki=Mi,Fi={FRACTION:"fraction",PIXELS:"pixels"},Ni=function(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32};function ji(t,e,n){return e+":"+t+":"+(n?ni(n):"null")}Ni.prototype.clear=function(){this.cache_={},this.cacheSize_=0},Ni.prototype.expire=function(){if(this.cacheSize_>this.maxCacheSize_){var t=0;for(var e in this.cache_){var n=this.cache_[e];0!=(3&t++)||n.hasListener()||(delete this.cache_[e],--this.cacheSize_)}}},Ni.prototype.get=function(t,e,n){var i=ji(t,e,n);return i in this.cache_?this.cache_[i]:null},Ni.prototype.set=function(t,e,n,i){var r=ji(t,e,n);this.cache_[r]=i,++this.cacheSize_},Ni.prototype.setSize=function(t){this.maxCacheSize_=t,this.expire()};var Bi=new Ni,zi=function(t){function e(e,n,i,r,o,s){t.call(this),this.hitDetectionImage_=null,this.image_=e||new Image,null!==r&&(this.image_.crossOrigin=r),this.canvas_=s?document.createElement("canvas"):null,this.color_=s,this.imageListenerKeys_=null,this.imageState_=o,this.size_=i,this.src_=n,this.tainted_}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isTainted_=function(){if(void 0===this.tainted_&&this.imageState_===hi.LOADED){this.tainted_=!1;var t=H(1,1);try{t.drawImage(this.image_,0,0),t.getImageData(0,0,1,1)}catch(t){this.tainted_=!0}}return!0===this.tainted_},e.prototype.dispatchChangeEvent_=function(){this.dispatchEvent(L)},e.prototype.handleImageError_=function(){this.imageState_=hi.ERROR,this.unlistenImage_(),this.dispatchChangeEvent_()},e.prototype.handleImageLoad_=function(){this.imageState_=hi.LOADED,this.size_&&(this.image_.width=this.size_[0],this.image_.height=this.size_[1]),this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.replaceColor_(),this.dispatchChangeEvent_()},e.prototype.getImage=function(t){return this.canvas_?this.canvas_:this.image_},e.prototype.getImageState=function(){return this.imageState_},e.prototype.getHitDetectionImage=function(t){if(!this.hitDetectionImage_)if(this.isTainted_()){var e=this.size_[0],n=this.size_[1],i=H(e,n);i.fillRect(0,0,e,n),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_},e.prototype.getSize=function(){return this.size_},e.prototype.getSrc=function(){return this.src_},e.prototype.load=function(){if(this.imageState_==hi.IDLE){this.imageState_=hi.LOADING,this.imageListenerKeys_=[T(this.image_,k,this.handleImageError_,this),T(this.image_,F,this.handleImageLoad_,this)];try{this.image_.src=this.src_}catch(t){this.handleImageError_()}}},e.prototype.replaceColor_=function(){if(this.color_&&!this.isTainted_()){this.canvas_.width=this.image_.width,this.canvas_.height=this.image_.height;var t=this.canvas_.getContext("2d");t.drawImage(this.image_,0,0);for(var e=t.getImageData(0,0,this.image_.width,this.image_.height),n=e.data,i=this.color_[0]/255,r=this.color_[1]/255,o=this.color_[2]/255,s=0,a=n.length;s<a;s+=4)n[s]*=i,n[s+1]*=r,n[s+2]*=o;t.putImageData(e,0,0)}},e.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(x),this.imageListenerKeys_=null},e}(P);var Ui={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"},Hi=function(t){function e(e){var n=e||{},i=void 0!==n.opacity?n.opacity:1,r=void 0!==n.rotation?n.rotation:0,o=void 0!==n.scale?n.scale:1,s=void 0!==n.rotateWithView&&n.rotateWithView;t.call(this,{opacity:i,rotation:r,scale:o,rotateWithView:s}),this.anchor_=void 0!==n.anchor?n.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=void 0!==n.anchorOrigin?n.anchorOrigin:Ui.TOP_LEFT,this.anchorXUnits_=void 0!==n.anchorXUnits?n.anchorXUnits:Fi.FRACTION,this.anchorYUnits_=void 0!==n.anchorYUnits?n.anchorYUnits:Fi.FRACTION,this.crossOrigin_=void 0!==n.crossOrigin?n.crossOrigin:null;var a=void 0!==n.img?n.img:null,c=void 0!==n.imgSize?n.imgSize:null,l=n.src;Lt(!(void 0!==l&&a),4),Lt(!a||a&&c,5),void 0!==l&&0!==l.length||!a||(l=a.src||f(a)),Lt(void 0!==l&&l.length>0,6);var u,h=void 0!==n.src?hi.IDLE:hi.LOADED;this.color_=void 0!==n.color?(u=n.color,Array.isArray(u)?u:oi(u)):null,this.iconImage_=function(t,e,n,i,r,o){var s=Bi.get(e,i,o);return s||(s=new zi(t,e,n,i,r,o),Bi.set(e,i,o,s)),s}(a,l,c,this.crossOrigin_,h,this.color_),this.offset_=void 0!==n.offset?n.offset:[0,0],this.offsetOrigin_=void 0!==n.offsetOrigin?n.offsetOrigin:Ui.TOP_LEFT,this.origin_=null,this.size_=void 0!==n.size?n.size:null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return new e({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,crossOrigin:this.crossOrigin_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,src:this.getSrc(),offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,size:null!==this.size_?this.size_.slice():void 0,opacity:this.getOpacity(),scale:this.getScale(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},e.prototype.getAnchor=function(){if(this.normalizedAnchor_)return this.normalizedAnchor_;var t=this.anchor_,e=this.getSize();if(this.anchorXUnits_==Fi.FRACTION||this.anchorYUnits_==Fi.FRACTION){if(!e)return null;t=this.anchor_.slice(),this.anchorXUnits_==Fi.FRACTION&&(t[0]*=e[0]),this.anchorYUnits_==Fi.FRACTION&&(t[1]*=e[1])}if(this.anchorOrigin_!=Ui.TOP_LEFT){if(!e)return null;t===this.anchor_&&(t=this.anchor_.slice()),this.anchorOrigin_!=Ui.TOP_RIGHT&&this.anchorOrigin_!=Ui.BOTTOM_RIGHT||(t[0]=-t[0]+e[0]),this.anchorOrigin_!=Ui.BOTTOM_LEFT&&this.anchorOrigin_!=Ui.BOTTOM_RIGHT||(t[1]=-t[1]+e[1])}return this.normalizedAnchor_=t,this.normalizedAnchor_},e.prototype.setAnchor=function(t){this.anchor_=t,this.normalizedAnchor_=null},e.prototype.getColor=function(){return this.color_},e.prototype.getImage=function(t){return this.iconImage_.getImage(t)},e.prototype.getImageSize=function(){return this.iconImage_.getSize()},e.prototype.getHitDetectionImageSize=function(){return this.getImageSize()},e.prototype.getImageState=function(){return this.iconImage_.getImageState()},e.prototype.getHitDetectionImage=function(t){return this.iconImage_.getHitDetectionImage(t)},e.prototype.getOrigin=function(){if(this.origin_)return this.origin_;var t=this.offset_;if(this.offsetOrigin_!=Ui.TOP_LEFT){var e=this.getSize(),n=this.iconImage_.getSize();if(!e||!n)return null;t=t.slice(),this.offsetOrigin_!=Ui.TOP_RIGHT&&this.offsetOrigin_!=Ui.BOTTOM_RIGHT||(t[0]=n[0]-e[0]-t[0]),this.offsetOrigin_!=Ui.BOTTOM_LEFT&&this.offsetOrigin_!=Ui.BOTTOM_RIGHT||(t[1]=n[1]-e[1]-t[1])}return this.origin_=t,this.origin_},e.prototype.getSrc=function(){return this.iconImage_.getSrc()},e.prototype.getSize=function(){return this.size_?this.size_:this.iconImage_.getSize()},e.prototype.listenImageChange=function(t,e){return E(this.iconImage_,L,t,e)},e.prototype.load=function(){this.iconImage_.load()},e.prototype.unlistenImageChange=function(t,e){S(this.iconImage_,L,t,e)},e}(Ti),Wi="point",Gi=function(t){var e=t||{};this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.scale_=e.scale,this.text_=e.text,this.textAlign_=e.textAlign,this.textBaseline_=e.textBaseline,this.fill_=void 0!==e.fill?e.fill:new Ai({color:"#333"}),this.maxAngle_=void 0!==e.maxAngle?e.maxAngle:Math.PI/4,this.placement_=void 0!==e.placement?e.placement:Wi,this.overflow_=!!e.overflow,this.stroke_=void 0!==e.stroke?e.stroke:null,this.offsetX_=void 0!==e.offsetX?e.offsetX:0,this.offsetY_=void 0!==e.offsetY?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=void 0===e.padding?null:e.padding};Gi.prototype.clone=function(){return new Gi({font:this.getFont(),placement:this.getPlacement(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:this.getScale(),text:this.getText(),textAlign:this.getTextAlign(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0})},Gi.prototype.getOverflow=function(){return this.overflow_},Gi.prototype.getFont=function(){return this.font_},Gi.prototype.getMaxAngle=function(){return this.maxAngle_},Gi.prototype.getPlacement=function(){return this.placement_},Gi.prototype.getOffsetX=function(){return this.offsetX_},Gi.prototype.getOffsetY=function(){return this.offsetY_},Gi.prototype.getFill=function(){return this.fill_},Gi.prototype.getRotateWithView=function(){return this.rotateWithView_},Gi.prototype.getRotation=function(){return this.rotation_},Gi.prototype.getScale=function(){return this.scale_},Gi.prototype.getStroke=function(){return this.stroke_},Gi.prototype.getText=function(){return this.text_},Gi.prototype.getTextAlign=function(){return this.textAlign_},Gi.prototype.getTextBaseline=function(){return this.textBaseline_},Gi.prototype.getBackgroundFill=function(){return this.backgroundFill_},Gi.prototype.getBackgroundStroke=function(){return this.backgroundStroke_},Gi.prototype.getPadding=function(){return this.padding_},Gi.prototype.setOverflow=function(t){this.overflow_=t},Gi.prototype.setFont=function(t){this.font_=t},Gi.prototype.setMaxAngle=function(t){this.maxAngle_=t},Gi.prototype.setOffsetX=function(t){this.offsetX_=t},Gi.prototype.setOffsetY=function(t){this.offsetY_=t},Gi.prototype.setPlacement=function(t){this.placement_=t},Gi.prototype.setFill=function(t){this.fill_=t},Gi.prototype.setRotation=function(t){this.rotation_=t},Gi.prototype.setScale=function(t){this.scale_=t},Gi.prototype.setStroke=function(t){this.stroke_=t},Gi.prototype.setText=function(t){this.text_=t},Gi.prototype.setTextAlign=function(t){this.textAlign_=t},Gi.prototype.setTextBaseline=function(t){this.textBaseline_=t},Gi.prototype.setBackgroundFill=function(t){this.backgroundFill_=t},Gi.prototype.setBackgroundStroke=function(t){this.backgroundStroke_=t},Gi.prototype.setPadding=function(t){this.padding_=t};var Vi=Gi;class Yi{static getSingleFeatureType(t){return t.getGeometry().getType().toLowerCase()}static isFeatureInGeometry(t,e){return!!e.getGeometry()&&t.intersectsExtent(e.getGeometry().getExtent())}static isFeatureInExtent(t,e){return Kt(t,e.getGeometry().getExtent())}static isLayerSelectable(t){return t.get(tt.Layer.SELECTABLE)}static isCluster(t){return!!t.get("features")}static unwrapFirstFeature(t){return t.get("features")&&t.get("features").length>=1?t.get("features")[0]:t}static isSingleFeature(t){return t.get("features")&&1==t.get("features").length||!t.get("features")}static isSintiumFeature(t){return Yi.isCluster(t)&&(t=t.get("features")[0]),t.isSintiumFeature()}static getClusterProperty(t){return Yi.isCluster(t)&&(t=t.get("features")[0]),t.getClusterProperty?t.getClusterProperty():null}static getBoundingExtentFromFeatures(t){const e=[];return t.forEach(t=>{let n=t.getGeometry().getCoordinates();"number"==typeof n[0]?e.push(n):n.forEach(t=>e.push(t))}),Yt(e)}static flattenFeatures(t){const e=t.map(t=>this.flattenCluster(t));return[].concat(...e)}static flattenCluster(t){return this.isCluster(t)?t.get("features"):[t]}static generateMarkerStyle(t,e,n){return new ki({image:new Hi({scale:.7,rotateWithView:!1,anchor:[.5,1],anchorXUnits:"fraction",anchorYUnits:"fraction",opacity:1,color:e||"black",src:t}),zIndex:5,text:new Vi({text:n,font:"bold 13px sans-serif",offsetY:12,fill:new Ai({color:"black"})})})}static incrementZoomOnMap(t){t.getView().setZoom(t.getView().getZoom()+1)}static decrementZoomOnMap(t){t.getView().setZoom(t.getView().getZoom()-1)}static getDefaultView(){return new Qn({center:[1158e3,98e5],zoom:4,minZoom:1,maxZoom:17})}static zoomFromResolution(t){return Math.ceil((Math.log(t)-Math.log(156543.03390625))/Math.log(.5))}static lngToX(t){return t/360+.5}static latToY(t){const e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}static xToLng(t){return 360*(t-.5)}static yToLat(t){const e=(180-360*t)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}static transformLonLatExtent(t){return t=Qe(t,"EPSG:3857","EPSG:4326"),[Yi.lngToX(t[0]),Yi.latToY(t[3]),Yi.lngToX(t[2]),Yi.latToY(t[1])]}static objectifyExtent(t){const[e,n,i,r]=t;return{x0:e,y0:n,x1:i,y1:r}}}let qi=class{constructor(){this._controls=[],this._drawers=[]}initialize(t){this._domId=t.getDomId(),this._mapContainer=t,this._drawingHandler=t.getDrawingHandler(),this._mapUserInterfaceHTMLElement=this._createMapUserInterface(),this._viewPortElement=this._mapUserInterfaceHTMLElement.querySelector(".view-port");const e=document.getElementById(this._domId);e.style.position="relative",e.appendChild(this._mapUserInterfaceHTMLElement),this._initializePopup(),this._initializeViewPortSizeChangeListeners()}_initializeViewPortSizeChangeListeners(){new At.ResizeObserver(this._onResizeViewPort.bind(this)).observe(this._viewPortElement)}_initializePopup(){const t=this._createPopupHTMLElement();t.querySelector(".sintium-map-popup-closer").addEventListener("click",t=>(this._popupOverlay.setPosition(void 0),t.preventDefault(),!1)),this._popupOverlay=new r.a.Overlay({element:t,autoPan:!0,autoPanAnimation:{duration:250}}),this._mapContainer.getMap().addOverlay(this._popupOverlay)}showPopup(t,e){this._popupOverlay.setPosition(t);const n=this._popupOverlay.getElement().querySelector(".sintium-map-popup-content");q.removeChildren(n),e&&n.appendChild(e),this._isPopupShowing=!0}closePopup(){this._popupOverlay.setPosition(void 0),this._isPopupShowing=!1}addDrawer(t){this._drawers.push(t);const e=t.getButtonControl();t.hasButtonControl()&&Q.isMapBaseControl(e)&&this.addControl(e);const n=t.getPosition();document.querySelector(`.sintium-map-drawer-container-${n}`).appendChild(t.getDrawerHTMLElement())}showDrawer(t){const e=t.getPosition();if(this._moveAllDrawersAtPositionToBack(e),t.moveToFront(),!this._isDrawerAtPositionClosed(e))return;const n=`#${this._domId} > .sintium-map-user-interface > .sintium-map-drawer-container-${e}`,i=document.querySelector(n),r=i.querySelector(`.sintium-map-drawer-container-${e}-open-full`);if(this._addCloseOnClickEvent(t,i),t.shouldPreview()){const e=t.getPreviewSize();this._setDrawerSize(t,i,e),this._addOpenFullOnClickEvent(t,i),r.setAttribute("style",`height: ${e}px`)}else t.getOpenClass()?this._setDrawerOpenClass(t,i):this._setDrawerSize(t,i),r.setAttribute("style","height: 0")}hideDrawer(t){const e=t.getPosition();this._moveAllDrawersAtPositionToBack(e);const n=`#${this._domId} > .sintium-map-user-interface > .sintium-map-drawer-container-${e}`,i=document.querySelector(n);t.getOpenClass()?this._setDrawerOpenClass(t,i,!1):this._setDrawerSize(t,i,0)}_setDrawerSize(t,e,n){const i=t.getPosition()==It.BOTTOM?"height":"width";n=null==n?t.getSize():n,n=Q.isString(n)?n:`${n}px`,e.setAttribute("style",`${i}: ${n};`)}_setDrawerOpenClass(t,e,n=!0){e.classList.toggle(t.getOpenClass(),n)}_addOpenFullOnClickEvent(t,e){const n=e.querySelector(".sintium-map-drawer-container-bottom-open-full"),i=()=>{t.getOpenClass()?this._setDrawerOpenClass(t,e):this._setDrawerSize(t,e),n.removeEventListener("click",i,!1)};n.addEventListener("click",i.bind(this))}_addCloseOnClickEvent(t,e){const n=t.getPosition();if("bottom"===n){const i=e.querySelector(`.sintium-map-drawer-container-${n}-close-arrow`),r=()=>{this.hideDrawer(t),i.removeEventListener("click",r,!1)};i.addEventListener("click",r.bind(this))}}_moveAllDrawersAtPositionToBack(t){for(const e of this._drawers)e.getPosition()==t&&e.moveToBack()}_isDrawerAtPositionClosed(t){const e=`#${this._domId} > .sintium-map-user-interface > .sintium-map-drawer-container-${t}`;return!document.querySelector(e).classList.contains("sintium-map-drawer-container-expanded")}addControl(t){Q.isMapControl(t)&&t.addedToMap(this._mapContainer);const e=t.getPosition(),n=t.getFlow();this._controls.push(t);let i=e==Mt.BOTTOM_CENTER||e==Mt.TOP_CENTER?`.sintium-map-controls-${e}`:`.sintium-map-controls-${e} > .sintium-map-controls-${n}`;const r=this._mapUserInterfaceHTMLElement.querySelector(i),o=this._controls.filter(t=>t.getPosition()==e&&t.getFlow()==n).sort((t,e)=>t.getIndex()-e.getIndex());q.removeChildren(r);for(const t of o)r.appendChild(t.getHTMLElement())}getMapHTMLElement(){return document.getElementById(this._domId)}getMap(){return this._mapContainer.getMap()}getDrawingHandler(){return this._drawingHandler}getViewPortExtent(){const t=this.getMap(),e=t.getSize(),n=Yi.objectifyExtent(t.getView().calculateExtent(e)),i=q.getBounds(this._mapUserInterfaceHTMLElement),r=o.scaleLinear().domain([i.x0,i.x1]).range([n.x0,n.x1]),s=o.scaleLinear().domain([i.y0,i.y1]).range([n.y0,n.y1]),a=q.getBounds(this._viewPortElement);return Yi.objectifyExtent([r(a.x0),s(a.y0),r(a.x1),s(a.y1)])}setZoom(t){this._reCenterIfNecessary(),this.setCenter(this._currentCenterCoordinate,t)}zoomIn(){const t=this._getViewPortCenter(),e=this.getMap().getView().getZoom()+1;this.setCenter(t,e)}zoomOut(){const t=this._getViewPortCenter(),e=this.getMap().getView().getZoom()-1;this.setCenter(t,e)}triggerViewPortChange(){this._currentCenterCoordinate=this._getViewPortCenter()}setCenter(t,e=null,n=200){this._timer&&this._timer.stop();const i=this.getMap().getView(),[r,s]=this._currentCenterCoordinate||i.getCenter(),[a,c]=t,l=i.getZoom(),u=o.scaleLinear().domain([0,1]).range([r,a]),h=o.scaleLinear().domain([0,1]).range([s,c]),d=o.scaleLinear().domain([0,1]).range([l,e||l]);this._timer=o.timer(function(t){const e=Math.min(o.easeCubicIn(t/n),1);i.setZoom(d(e)),i.setCenter([u(e),h(e)]),this._shiftRealCenterToViewPortCenter(),t>=n&&this._timer.stop()}.bind(this),5)}_reCenterIfNecessary(){this._currentCenterCoordinate&&this.getMap().getView().setCenter(this._currentCenterCoordinate)}_shiftRealCenterToViewPortCenter(){const[t,e]=this._getViewPortCenter(),[n,i]=this.getMap().getView().getCenter();this._currentCenterCoordinate=[n,i],this.getMap().getView().setCenter([2*n-t,2*i-e])}_onResizeViewPort(){this._reCenterIfNecessary(),this._shiftRealCenterToViewPortCenter()}_getViewPortCenter(){const t=this.getViewPortExtent();return[(t.x0+t.x1)/2,(t.y0+t.y1)/2]}_createMapUserInterface(){const t=document.createElement("div");return t.classList.add("sintium-map-user-interface"),t.innerHTML='\n                <div class="sintium-map-drawer-container sintium-map-drawer-container-left">\n                    <div class="sintium-map-drawer-container-left-open-full"></div>\n                </div>\n                <div class="sintium-map-controls-space view-port">\n                    <div class="sintium-map-controls-top-left sintium-map-controls-container-left sintium-map-controls-container-top">\n                        <div class="sintium-map-controls-vertical"></div>\n                        <div class="sintium-map-controls-horizontal"></div>\n                    </div>\n                    <div class="sintium-map-controls-bottom-left sintium-map-controls-container-left sintium-map-controls-container-bottom">\n                        <div class="sintium-map-controls-vertical"></div>\n                        <div class="sintium-map-controls-horizontal"></div>\n                    </div>\n                    <div class="sintium-map-controls-bottom-center sintium-map-controls-container-center"></div>\n                    <div class="sintium-map-controls-top-center sintium-map-controls-container-center"></div>\n                    <div class="sintium-map-controls-bottom-right sintium-map-controls-container-right sintium-map-controls-container-bottom">\n                        <div class="sintium-map-controls-horizontal"></div>\n                        <div class="sintium-map-controls-vertical"></div>\n                    </div>\n                    <div class="sintium-map-controls-top-right sintium-map-controls-container-right sintium-map-controls-container-top">\n                        <div class="sintium-map-controls-horizontal"></div>\n                        <div class="sintium-map-controls-vertical"></div>\n                    </div>\n                </div>\n                <div class="sintium-map-drawer-container sintium-map-drawer-container-right">\n                    <div class="sintium-map-drawer-container-right-open-full"></div>\n                </div>\n                <div class="sintium-map-drawer-container-bottom">\n                    <div class="sintium-map-drawer-container-bottom-open-full"></div>\n                    <div class="sintium-map-drawer-container-bottom-close-arrow">\n                        <i class="fas fa-times"></i>\n                    </div>\n                 </div>\n        ',t}_createPopupHTMLElement(){const t=document.createElement("div");return t.innerHTML='\n            <div class="sintium-map-popup">\n                <a href="#" class="sintium-map-popup-closer"><i class="fas fa-times"></i></a>\n                <div class="sintium-map-popup-content"></div>\n            </div>\n        ',t.firstElementChild}};var Xi=qi=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)()],qi);const Ki="__text";r.a.Feature.prototype.setFeatureKey=function(t){this.setSintiumFeature(),this.set("__featureKey",t)},r.a.Feature.prototype.getFeatureKey=function(){return this.get("__featureKey")},r.a.Feature.prototype.getCenterCoordinate=function(){const t=this.getGeometry().getExtent(),e=r.a.extent.getCenter(t);return r.a.proj.toLonLat(e)},r.a.Feature.prototype.setText=function(t,e){this.setSintiumFeature(),this.set(Ki,t),this.set("__textOffset",e)},r.a.Feature.prototype.getText=function(){return this.get(Ki)},r.a.Feature.prototype.getTextOffset=function(){return this.get("__textOffset")},r.a.Feature.prototype.hasText=function(){return!!this.get(Ki)},r.a.Feature.prototype.removeText=function(t,e){this.set(Ki,null),this.set("__textOffset",null)},r.a.Feature.prototype.setSintiumFeature=function(){this.set("__isSintiumFeature",!0)},r.a.Feature.prototype.isSintiumFeature=function(){return!!this.get("__isSintiumFeature")},r.a.Feature.prototype.setLayerId=function(t){this.setSintiumFeature(),this.set("__layerId",t)},r.a.Feature.prototype.getLayerId=function(){return this.get("__layerId")},r.a.Feature.prototype.getFirstRecordKey=function(){return this.getRecordKeys().slice().pop()},r.a.Feature.prototype.getRecordKeys=function(){return this.get("__recordKeys")},r.a.Feature.prototype.setRecordKeys=function(t){this.setSintiumFeature(),this.set("__recordKeys",t)},r.a.Feature.prototype.isCluster=function(){const t=this.getRecordKeys();return Array.isArray(t)&&t.length>1},r.a.Feature.prototype.setClusterProperty=function(t){this.setSintiumFeature(),this.set("__clusterProperty",t)},r.a.Feature.prototype.getClusterProperty=function(){return this.get("__clusterProperty")},r.a.Feature.prototype.setClusterPropertyValue=function(t){this.setSintiumFeature(),this.set("__clusterPropertyValue",t)},r.a.Feature.prototype.getClusterPropertyValue=function(){return this.get("__clusterPropertyValue")},r.a.Feature.prototype.setSelected=function(t){this.set("__selected",t),this.changed(),this.setSintiumFeature()},r.a.Feature.prototype.getSelected=function(){return this.get("__selected")},r.a.Feature.prototype.setFilteredOut=function(t){this.set("__filteredOut",t),this.changed(),this.setSintiumFeature()},r.a.Feature.prototype.getFilteredOut=function(){return this.get("__selected")};var $i,Zi=r.a.Feature;class Ji{constructor(t){t&&(this._didComplete=!0),this._geometry=t}getGeometry(){return this._geometry}didComplete(){return this._didComplete}addToMap(){this._addToMap=!0}getAddToMap(){return this._addToMap}}!function(t){t[t.POLYGON=0]="POLYGON",t[t.BOX=1]="BOX",t[t.CIRCLE=2]="CIRCLE",t[t.POINT=3]="POINT"}($i||($i={}));var Qi=$i;let tr=class{constructor(){this._isDrawing=!1,this._isDrawInitialized=!1}initialize(t){this._map=t.getMap(),this._mapUIManager=t.getMapUIHandler(),this._initializeSelectionLayer(),this._initializeEventListeners()}_initializeSelectionLayer(){this._drawLayer=new r.a.layer.Vector({source:new r.a.source.Vector,zIndex:1e5}),this._map.addLayer(this._drawLayer)}_initializeEventListeners(){document.addEventListener("keyup",function(t){27==t.keyCode&&this._drawCallBack&&this._isDrawing&&(this.stopDrawing(),this._sendEvent())}.bind(this)),this._map.on("click",t=>{const e=(this._map.getFeaturesAtPixel(t.pixel)||[]).filter(t=>t.get(tt.DrawManager.IS_DRAWN_FEATURE));if(e.length>0){const n=e[0];this._mapUIManager.showPopup(t.coordinate,this._getEditFeatureHTMLElement(n)),t.stopPropagation()}else if(this._isDrawing&&!this._isDrawInitialized)this._initializeDrawing(t.coordinate),t.stopPropagation();else if(this._isDrawing&&this._isDrawInitialized)switch(t.stopPropagation(),this._drawType){case Qi.POLYGON:this._updateDrawPolygonFeature(t.coordinate);break;case Qi.BOX:this._finishDrawing()}}),this._map.on("dblclick",t=>{this._isDrawing&&this._drawFeature&&(this._finishDrawing(),t.stopPropagation())}),this._map.on("pointermove",t=>{if(this._isDrawing&&this._isDrawInitialized)switch(this._drawType){case Qi.POLYGON:this._updateDrawPolygonFeature(t.coordinate,!0);break;case Qi.BOX:this._updateDrawBoxFeature(t.coordinate)}})}startDrawing(t,e){this._drawType=t,this._drawCallBack=e,this._isDrawing=!0}startDrawingWithPoint(t,e,n){this._drawType=t,this._drawCallBack=n,this._isDrawing=this._ignoreFirstClick=!0,this._initializeDrawing(e),this.startDrawing(t,n)}_finishDrawing(){const t=this._getCompletedGeometryFromCoordinates();this.stopDrawing(),this._sendEvent(t)}_sendEvent(t){const e=new Ji(t);if(this._drawCallBack(e),e.getAddToMap()){const e=new Zi({geometry:t});e.set(tt.DrawManager.IS_DRAWN_FEATURE,!0),this._drawLayer.getSource().addFeature(e)}}stopDrawing(){this._drawFeature&&(this._drawLayer.getSource().removeFeature(this._drawFeature),this._drawFeature=null),this._isDrawInitialized=!1,this._unsetDrawingThrottled()}isDrawing(){return this._isDrawing}_unsetDrawingThrottled(){setTimeout(()=>{this._isDrawing=!1},300)}_initializeDrawing(t){switch(this._drawType){case Qi.POLYGON:this._initializeDrawPolygonFeature(t);break;case Qi.BOX:this._initializeDrawBoxFeature(t)}this._isDrawInitialized=!0,this._drawLayer.changed()}_initializeDrawPolygonFeature(t){this._drawFeature=new Zi({geometry:new r.a.geom.LineString([t,t])}),this._drawLayer.getSource().addFeature(this._drawFeature)}_updateDrawPolygonFeature(t,e=!1){const n=this._drawFeature.getGeometry().getCoordinates();e?n[n.length-1]=t:n.push(t),this._drawFeature.getGeometry().setCoordinates(n),this._drawFeature.changed()}_initializeDrawBoxFeature(t){this._drawFeature=new Zi({geometry:new r.a.geom.Polygon([[t,t,t,t,t]])}),this._drawLayer.getSource().addFeature(this._drawFeature)}_updateDrawBoxFeature(t){const e=this._drawFeature.getGeometry().getCoordinates()[0][0],n=[e,[t[0],e[1]],t,[e[0],t[1]],e];this._drawFeature.getGeometry().setCoordinates([n]),this._drawFeature.changed()}_getCompletedGeometryFromCoordinates(){switch(this._drawType){case Qi.POLYGON:const t=this._drawFeature.getGeometry().getCoordinates();return t.push(t[0]),new r.a.geom.Polygon([t]);case Qi.BOX:case Qi.CIRCLE:return this._drawFeature.getGeometry()}}_getEditFeatureHTMLElement(t){const e=document.createElement("div");e.innerHTML='\n            <div class="sintium-drawn-feature-popup">\n                <span class="drawn-feature-colors-header">Change feature color</span>\n                <div class="drawn-feature-colors"></div>\n                <div class="drawn-feature-delete">\n                    <span>REMOVE</span>\n                </div>\n            </div>\n        ';const n=e.firstElementChild;return this._addColorsToEditFeatureHTMLElement(t,n),this._addDeleteEventListenerToEditFeatureHTMLElement(t,n),n}_addColorsToEditFeatureHTMLElement(t,e){const n=e.querySelector(".drawn-feature-colors");tt.DrawManager.DRAWN_FEATURE_COLORS.forEach(e=>{const i=q.createElement("div","drawn-feature-color");n.appendChild(i),i.style.background=e,i.addEventListener("click",n=>{t.setStyle(this._getStyle(e))})})}_addDeleteEventListenerToEditFeatureHTMLElement(t,e){e.querySelector(".drawn-feature-delete > span").addEventListener("click",()=>{this._mapUIManager.closePopup(),this._drawLayer.getSource().removeFeature(t)})}_getStyle(t){return new r.a.style.Style({fill:new r.a.style.Fill({color:"rgba(255, 255, 255, 0.4)"}),stroke:new r.a.style.Stroke({color:t,width:1.25})})}};var er,nr=tr=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)()],tr),ir=n(3),rr=n.n(ir);!function(t){let e=0;t.throttle=function(t,e){let n=null,i=null;const r=o=>{i=o,!n&&(t(i),i=null,n=setTimeout(()=>{n=null,i&&r(i)},e))};return r},t.debounce=function(t,e,n=!1){let i;return function(){const r=this,o=arguments,s=function(){i=null,n||t.apply(r,o)},a=n&&!i;clearTimeout(i),i=setTimeout(s,e),a&&t.apply(r,o)}},t.getId=function(){return e+=1},t.nFormatter=function(t,e=0){const n=[{value:1,symbol:""},{value:1e3,symbol:"k"},{value:1e6,symbol:"M"},{value:1e9,symbol:"G"},{value:1e12,symbol:"T"},{value:1e15,symbol:"P"},{value:1e18,symbol:"E"}];let i;for(i=n.length-1;i>0&&!(t>=n[i].value);i--);return(t/n[i].value).toFixed(e).replace(/\.0+$|(\.[0-9]*[1-9])0+$/,"$1")+n[i].symbol},t.CompareArrays=function(t,e){return t.length===e.length&&t.every((t,n)=>t===e[n])},t.deepClone=function(t){return JSON.parse(JSON.stringify(t))},t.capitalizeFirstLetter=function(t){return t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()},t.minMax=function(t){let e=1/0,n=-1/0;for(let i=1;i<t.length;i++){let r=t[i];e=r<e?r:e,n=r>n?r:n}return{min:e.valueOf?e.valueOf():e,max:n.valueOf?n.valueOf():n}}}(er||(er={}));var or,sr=er;!function(t){t.CIRCLE="circle",t.TRIANGLE="triangle",t.ROMBUS="rombus"}(or||(or={}));var ar=or;var cr,lr={ColorRepository:Symbol("ColorRepository"),Mediator:Symbol("Mediator"),NightMode:Symbol("NightMode"),FullScreenUtil:Symbol("FullScreenUtil"),CookieUtil:Symbol("CookieUtil"),DataContainer:Symbol("DataContainer"),DataSource:Symbol("DataSource"),RecordContainer:Symbol("RecordContainer"),DataFetcherHandler:Symbol("DataFetcherHandler"),OAuthAuthenticator:Symbol("OAuthAuthenticator"),MapContainer:Symbol("MapContainer"),LayerManager:Symbol("LayerManager"),SelectionManager:Symbol("SelectionManager"),SelectionHandler:Symbol("SelectionManagerV2"),MapUIManager:Symbol("MapUIManager"),DrawManager:Symbol("DrawManager"),Drawer:Symbol("Drawer"),SidebarLayerSwitcher:Symbol("SidebarLayerSwitcher"),BaseLayerContainer:Symbol("BaseLayerContainer"),HeatmapLayerContainer:Symbol("HeatmapLayerContainer"),GridHeatmapLayerContainer:Symbol("GridHeatmapLayerContainer"),AnimatedLayerContainer:Symbol("AnimatedLayerContainer"),BigVectorLayerContainer:Symbol("BigVectorLayerContainer"),StaticVectorLayerContainer:Symbol("StaticVectorLayerContainer"),BigVectorLayerStyleHandler:Symbol("BigVectorLayerStyleHandler"),BigVectorSource:Symbol("BigVectorSource"),StyleCacheHandler:Symbol("StyleCacheHandler"),ClusteringHandler:Symbol("ClusteringHandler"),SelectionEvent:Symbol("SelectionEvent"),VectorLayerContainer:Symbol("VectorLayerContainer"),VectorLayerStyleHandler:Symbol("VectorLayerStyleHandler"),VectorSource:Symbol("VectorSource"),StyleCache:Symbol("StyleCache"),MapReduceLayer:Symbol("MapReduceLayer"),ChartAxesHandler:Symbol("ChartAxesHandler"),ChartLegendHandler:Symbol("ChartLegendHandler"),ChartMarginHandler:Symbol("ChartMarginHandler"),BarChartContainer:Symbol("BarChartContainer"),LineChartContainer:Symbol("LineChartContainer"),MultiLineChartContainer:Symbol("MultiLineChartContainer"),PieChartContainer:Symbol("PieChartContainer"),PieChartStyleHandler:Symbol("PieChartStyleHandler"),WindRoseChartContainer:Symbol("WindRoseChartContainer"),StackedAreaChart:Symbol("StackedAreaChart"),SunburstChartContainer:Symbol("SunburstChartContainer"),ScatterPlotContainer:Symbol("ScatterPlotContainer"),RowChartContainer:Symbol("RowChartContainer"),ButtonControl:Symbol("ButtonControl"),NightModeControl:Symbol("NightModeControl"),CompositeControl:Symbol("CompositeControl"),LegendControl:Symbol("LegendControl"),FullScreenControl:Symbol("FullScreenControl"),DrawControl:Symbol("DrawControl"),ZoomControl:Symbol("ZoomControl"),WidgetControl:Symbol("WidgetControl"),MapExportControl:Symbol("MapExportControl"),WidgetGrid:Symbol("WidgetGrid"),WidgetGridItem:Symbol("WidgetGridItem"),TemplateWidget:Symbol("TemplateWidget"),SelectWidget:Symbol("SelectWidget"),DataTableContainer:Symbol("DataTableContainer"),PlayWidget:Symbol("PlayWidget"),BetterDataTableContainer:Symbol("BetterDataTableContainer"),GraphContainer:Symbol("GraphContainer"),GraphSource:Symbol("GraphSource"),ChartStackHandler:Symbol("ChartStackHandler"),StackableChartContainer:Symbol("StackableChartContainer"),WMSLayerContainer:Symbol("WMSLayerContainer"),DownloadControl:Symbol("DownloadControl"),ExternalDownloadControl:Symbol("ExternalDownloadControl"),BoxPlotContainer:Symbol("BoxPlotContainer"),HTMLControl:Symbol("HTMLControl"),Graph:Symbol("Graph"),DataParser:Symbol("DataParser"),ThresholdFilterWidget:Symbol("ThresholdWidget"),OptionalFiltersWidget:Symbol("OptionalFiltersWidget"),TernaryDiagramRenderer:Symbol("TernaryDiagramRenderer"),TernaryDiagram:Symbol("TernaryDiagram"),LocationControl:Symbol("LocationControl")};!function(t){t[t.ADD_LAYER=0]="ADD_LAYER",t[t.REMOVE_LAYER=1]="REMOVE_LAYER",t[t.NIGHTMODE=2]="NIGHTMODE",t[t.LAYER_CHANGED_VISIBILITY=3]="LAYER_CHANGED_VISIBILITY",t[t.EXTENT_CHANGED=4]="EXTENT_CHANGED",t[t.MAP_MOVE=5]="MAP_MOVE",t[t.MAP_SIZE=6]="MAP_SIZE",t[t.FORCE_REDRAW=7]="FORCE_REDRAW",t[t.FORCE_RESET=8]="FORCE_RESET"}(cr||(cr={}));var ur,hr=function(t,e){return function(n,i){e(n,i,t)}};let dr=ur=class{constructor(t,e){this._zIndex=0,this._styleCache={},this._selectedStyleCache={},this._colorRepository=t,this._mediator=e}initializeForLayerContainer(t){if(Q.isLayerContainer(t)){const e=t.getId();this._selectedStyleCache[e]={},this._styleCache[e]={}}const e=t.getDataSource(),n=t.getClusteredByProperty();this._mediator.subscribe(cr.NIGHTMODE,()=>{Q.isLayerContainer(t)&&t.getLayers().forEach(t=>t.changed())});const{colors:i,colorScheme:r}=t.getStyle();n?(r&&this._colorRepository.setColorSchemeForColumn(e,n,r),this._colorRepository.setColorsForColumn(e,n,i)):this._colorRepository.setColor(e)}styleFunction(t,e,n){const i=e.getSelected(),r=e.getClusterPropertyValue(),o=t.getClusteredByProperty(),s=t.getDataSource();let a=[],c=i?t.getSelectedStyle():t.getStyle();c=o?this._evaluateColorsForColumn(s,c,o,r):this._evaluateColors(s,c);let l=e.isCluster()?this._generateClusterStyle(s,e,c,i):this._generateSingleFeatureStyle(s,e,c,i);if(a=a.concat(l),t.getAddPointToGeometries()&&!this._featureIsPoint(e)){const t=this._createStyleWithPointAtFirstCoordinateOfGeometry(s,e,c,i);a.push(t)}return a}_createStyleWithPointAtFirstCoordinateOfGeometry(t,e,n,i){let r=this._generatePointStyle(t,e,n.single,i);const o=e.getGeometry().getFirstCoordinate();return r.setGeometry(new Nn(o)),r}_generateSingleFeatureStyle(t,e,n,i){switch(this._getSingleFeatureType(e)){case"point":return this._generatePointStyle(t,e,n.single,i);default:return ur._generateOtherStyle(n.single,i)}}_generateClusterStyle(t,e,n,i){const r=e.getRecordKeys(),o=sr.nFormatter(r.length),s=this._generatePointStyle(t,e,n.cluster,i),a=new Vi({text:o,fill:new Ai({color:n.cluster.textColor})});return s.setZIndex(this._zIndex++),s.setText(a),s}_evaluateColors(t,e){e=this._copyStyleOptions(e);const{single:n,cluster:i}=e;n.fillColor=n.fillColor||this._colorRepository.getColor(t);const r=rr()(n.fillColor);n.strokeColor=n.strokeColor||r.brighten(1),n.textColor=n.textColor||ur._getContrastTextColor(r),i.fillColor=i.fillColor||this._colorRepository.getColor(t);const o=rr()(i.fillColor);return i.strokeColor=i.strokeColor||o.brighten(1),i.textColor=i.textColor||ur._getContrastTextColor(o),e}_evaluateColorsForColumn(t,e,n,i){e=this._copyStyleOptions(e);let{single:r,cluster:o}=e;r.fillColor=r.fillColor||this._colorRepository.getColorForColumnValue(t,n,i);const s=rr()(r.fillColor);r.strokeColor=r.strokeColor||s.brighten(1),r.textColor=r.textColor||ur._getContrastTextColor(s),o.fillColor=o.fillColor||this._colorRepository.getColorForColumnValue(t,n,i);const a=rr()(o.fillColor);return o.strokeColor=o.strokeColor||a.brighten(1),o.textColor=o.textColor||ur._getContrastTextColor(a),e}_copyStyleOptions(t){return{cluster:Object.assign({},t.cluster),single:Object.assign({},t.single)}}_featureIsPoint(t){return"point"==this._getSingleFeatureType(t)}_getSingleFeatureType(t){return t.getGeometry().getType().toLowerCase()}static _getContrastTextColor(t){return t.luminance()>.4?rr()("#000"):rr()("#fff")}_generatePointStyle(t,e,n,i){const{fillColor:r,strokeColor:o,strokeSize:s,shape:a,size:c}=n,l=new Ai({color:r}),u=new Ii({color:o,width:s});let h;switch(a){case ar.TRIANGLE:h=ur._generateTriangleShapePointStyle(l,u,c,i);break;case ar.CIRCLE:h=ur._generateCircleShapePointStyle(l,u,c,i);break;case ar.ROMBUS:default:h=ur._generateRombusShapePointStyle(l,u,c,i)}if(n.text){const{text:i,textOffset:r}=n,o=e.getFeatureKey(),s=i(t.getDataContainer().getRecord(o)),a=ur._generateTextUnderFeature(s,r);h.setText(a)}return h}static _generateCircleShapePointStyle(t,e,n,i){return new ki({image:new xi({radius:Math.ceil(n),fill:t,stroke:e}),zIndex:i?1e13:1})}static _generateRombusShapePointStyle(t,e,n,i){return new ki({image:new Si({fill:t,stroke:e,points:4,radius:Math.ceil(n)}),zIndex:i?1e13:1})}static _generateTriangleShapePointStyle(t,e,n,i=!1){return new ki({image:new Si({fill:t,stroke:e,points:3,rotation:Math.PI,radius:Math.ceil(n)}),zIndex:i?1e13:1})}static _generateOtherStyle(t,e){return new ki({fill:new Ai({color:t.fillColor}),stroke:new Ii({color:t.strokeColor,width:t.strokeSize}),zIndex:e?1e13:1})}static _generateTextUnderFeature(t,e=12){return new Vi({text:t,font:"bold 13px sans-serif",offsetY:e,fill:new Ai({color:"black"})})}};var fr=dr=ur=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)(),hr(0,Object(nt.inject)(lr.ColorRepository)),hr(1,Object(nt.inject)(lr.Mediator))],dr);function pr(t,e,n,i,r,o){if(r-i<=n)return;const s=i+r>>1;!function t(e,n,i,r,o,s){for(;o>r;){if(o-r>600){const a=o-r+1,c=i-r+1,l=Math.log(a),u=.5*Math.exp(2*l/3),h=.5*Math.sqrt(l*u*(a-u)/a)*(c-a/2<0?-1:1),d=Math.max(r,Math.floor(i-c*u/a+h)),f=Math.min(o,Math.floor(i+(a-c)*u/a+h));t(e,n,i,d,f,s)}const a=n[2*i+s];let c=r,l=o;for(gr(e,n,r,i),n[2*o+s]>a&&gr(e,n,r,o);c<l;){for(gr(e,n,c,l),c++,l--;n[2*c+s]<a;)c++;for(;n[2*l+s]>a;)l--}n[2*r+s]===a?gr(e,n,r,l):gr(e,n,++l,o),l<=i&&(r=l+1),i<=l&&(o=l-1)}}(t,e,s,i,r,o%2),pr(t,e,n,i,s-1,o+1),pr(t,e,n,s+1,r,o+1)}function gr(t,e,n,i){_r(t,n,i),_r(e,2*n,2*i),_r(e,2*n+1,2*i+1)}function _r(t,e,n){const i=t[e];t[e]=t[n],t[n]=i}function mr(t,e,n,i){const r=t-n,o=e-i;return r*r+o*o}const yr=t=>t[0],vr=t=>t[1];class br{constructor(t,e=yr,n=vr,i=64,r=Float64Array){this.nodeSize=i,this.points=t;const o=t.length<65536?Uint16Array:Uint32Array,s=this.ids=new o(t.length),a=this.coords=new r(2*t.length);for(let i=0;i<t.length;i++)s[i]=i,a[2*i]=e(t[i]),a[2*i+1]=n(t[i]);pr(s,a,i,0,s.length-1,0)}range(t,e,n,i){return function(t,e,n,i,r,o,s){const a=[0,t.length-1,0],c=[];let l,u;for(;a.length;){const h=a.pop(),d=a.pop(),f=a.pop();if(d-f<=s){for(let s=f;s<=d;s++)l=e[2*s],u=e[2*s+1],l>=n&&l<=r&&u>=i&&u<=o&&c.push(t[s]);continue}const p=Math.floor((f+d)/2);l=e[2*p],u=e[2*p+1],l>=n&&l<=r&&u>=i&&u<=o&&c.push(t[p]);const g=(h+1)%2;(0===h?n<=l:i<=u)&&(a.push(f),a.push(p-1),a.push(g)),(0===h?r>=l:o>=u)&&(a.push(p+1),a.push(d),a.push(g))}return c}(this.ids,this.coords,t,e,n,i,this.nodeSize)}within(t,e,n){return function(t,e,n,i,r,o){const s=[0,t.length-1,0],a=[],c=r*r;for(;s.length;){const l=s.pop(),u=s.pop(),h=s.pop();if(u-h<=o){for(let r=h;r<=u;r++)mr(e[2*r],e[2*r+1],n,i)<=c&&a.push(t[r]);continue}const d=Math.floor((h+u)/2),f=e[2*d],p=e[2*d+1];mr(f,p,n,i)<=c&&a.push(t[d]);const g=(l+1)%2;(0===l?n-r<=f:i-r<=p)&&(s.push(h),s.push(d-1),s.push(g)),(0===l?n+r>=f:i+r>=p)&&(s.push(d+1),s.push(u),s.push(g))}return a}(this.ids,this.coords,t,e,n,this.nodeSize)}}var Cr={BigVectorLayer:!1,DataSource:!1,GridHeatMap:!1};let wr=class{constructor(){this._allData=[],this._filterLookup={},this._filtered=!1,this._processed={},this._hasSetAllUnclusteredPoints=!1}initialize(t){Cr.BigVectorLayer&&console.log(`Cluster Radius is ${t}`),this._radius=t}addData(t){this._allData=this._allData.concat(t)}dataDone(){const t=performance.now();this._kdTree=new br(this._allData,this._getX,this._getY,8,Float32Array),Cr.BigVectorLayer&&console.log("KD tree done in",performance.now()-t,"ms")}_getX(t){return t[0]}_getY(t){return t[1]}addShowOnlyKeysFilter(t){this._filterLookup={},this._filtered=t.length!==this._allData.length,this._filtered&&t.forEach(t=>this._filterLookup[t]=!0),this._extent&&this._callback&&this.cluster(this._extent,this._zoom,this._shouldCluster,this._callback)}cluster(t,e,n,i){if(this._extent=t,this._zoom=e,this._shouldCluster=n,this._callback=i,!this._kdTree)return;const r=this._getPointsInViewPort(t,e);if(n){this._hasSetAllUnclusteredPoints=!1,i(this._getClusteredPoints(r,e))}else if(!this._hasSetAllUnclusteredPoints){i(this._getUnclusteredPoints(this._allData))}}_getPointsInViewPort(t,e){t||(t=[-1/0,-1/0,1/0,1/0]);const[n,i,r,o]=t,s=this._kdTree.range(n,i,r,o).map(t=>this._allData[t]);return this._filtered?s.filter(t=>this._filterLookup[t[2]]):s}_getClusteredPoints(t,e){this._processed={};const n=[],i=this._radius/(512*Math.pow(2,e)),r=performance.now();for(let e=0;e<t.length;e++){const r=t[e];if(this._isProccessed(r))continue;this._processed[r[2]]=!0;let o=this._kdTree.within(r[0],r[1],i),s=r[0],a=r[1];const c=[r[2]];for(let t=0;t<o.length;t++){const e=this._kdTree.points[o[t]];this._isProccessed(e)||this._isFiltered(e)||r[3]!=e[3]||(this._processed[e[2]]=!0,s+=e[0],a+=e[1],c.push(e[2]))}let l;if(c.length>1){const t=s/c.length,e=a/c.length;l=this._createCluster(t,e,-1,c,r[3])}else l=this._createCluster(r[0],r[1],r[2],[],r[3]);n.push(l)}return Cr.BigVectorLayer&&console.log("Clustering done in",performance.now()-r,"ms"),n}_getUnclusteredPoints(t){return this._hasSetAllUnclusteredPoints=!0,t.map(t=>this._createCluster(t[0],t[1],t[2],[],t[3]))}_createCluster(t,e,n,i,r){return[t,e,n,r,i]}_isProccessed(t){return this._processed[t[2]]}_isFiltered(t){return this._filtered&&!this._filterLookup[t[2]]}hasData(){return this._allData.length>0}};var Er=wr=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)()],wr),Tr=n(52);class Sr{static start(t,e=!0){this._logText=t,this._debug=e,this._startTime=performance.now()}static stop(){if(this.loggingEnabled||this._debug){if(this._startTime<0)throw new Error("Logger: stop called without calling start first");const t=performance.now();console.log(this._logText,":",t-this._startTime,"ms"),this._startTime=-1}}static log(t,e=!1){(this.loggingEnabled||e)&&console.log(t)}}Sr._startTime=-1,Sr.loggingEnabled=!1;var xr=function(t,e){return function(n,i){e(n,i,t)}};let Rr=class{constructor(t){this._data=[],this._labelLookup={},this._recordContainer=t}setUseCrossfilter(){this._crossfilter=Tr([]),this._usesCrossfilter=!0}setInfo(t,e,n,i){this._labels=t,t.forEach((t,e)=>this._labelLookup[t]=e),this._dataProjection=i,this._recordContainer.setInfo(this._labelLookup,e,n,i)}removeData(t){this._crossfilter.remove(e=>{const n=this.wrapRecord(e);return t(n)})}getData(t=!1){return this._usesCrossfilter?t?this._crossfilter.all():this._crossfilter.allFiltered():this._data}getDataLength(t=!1){return this.getData(t).length}getAddedData(){return this._lastAddedData}getAddedDataCount(){return this._lastAddedData.length}clear(){this.usesCrossfilter()?this._crossfilter.remove(()=>!0):this._data=[]}add(t){this.usesCrossfilter()?(Sr.start("Adding data to crossfilter!",Cr.DataSource),this._crossfilter.add(t),Sr.stop()):this._data=this._data.concat(t),this._lastAddedData=t}isRecordFiltered(t){if(this.usesCrossfilter())return this._crossfilter.isElementFiltered(t)}getRecord(t){const e=this.getData(!0)[t];return this.wrapRecord(e)}wrapRecord(t){return this._recordContainer.setRecord(t),this._recordContainer}usesCrossfilter(){return this._usesCrossfilter}getCrossfilter(){return this._crossfilter}getLabels(t=!1){const e=Object.keys(this._labelLookup);if(0!==e.length)return t?e.filter(t=>t!==tt.DataSource.RECORD_KEY):e}getIndexForColumn(t){return this._labelLookup[t]}getDataProjection(){return this._dataProjection}forEachRecord(t,e=!1){this.getData(e).forEach((e,n)=>{this._recordContainer.setRecord(e),t(this._recordContainer,n)})}mapRecords(t,e=!1){return this.getData(e).map((e,n)=>(this._recordContainer.setRecord(e),t(this._recordContainer,n)))}forEachAddedRecord(t){this._lastAddedData.forEach((e,n)=>{this._recordContainer.setRecord(e),t(this._recordContainer,n)})}};var Ar=Rr=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)(),xr(0,Object(nt.inject)(lr.RecordContainer))],Rr);function Or(t){if(null===t||!0===t||!1===t)return NaN;var e=Number(t);return isNaN(e)?e:e<0?Math.ceil(e):Math.floor(e)}function Ir(t,e){if(null==t)throw new TypeError("assign requires that input parameter not be null or undefined");for(var n in e=e||{})e.hasOwnProperty(n)&&(t[n]=e[n]);return t}var Mr=6e4;function Pr(t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");var e=Object.prototype.toString.call(t);return t instanceof Date||"object"==typeof t&&"[object Date]"===e?new Date(t.getTime()):"number"==typeof t||"[object Number]"===e?new Date(t):("string"!=typeof t&&"[object String]"!==e||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as arguments. Please use `parseISO` to parse strings. See: https://git.io/fpAk2"),console.warn((new Error).stack)),new Date(NaN))}function Lr(t,e){if(arguments.length<2)throw new TypeError("2 arguments required, but only "+arguments.length+" present");return function(t,e){if(arguments.length<2)throw new TypeError("2 arguments required, but only "+arguments.length+" present");var n=Pr(t).getTime(),i=Or(e);return new Date(n+i)}(t,-Or(e))}var Dr={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function kr(t){return function(e){var n=e||{},i=n.width?String(n.width):t.defaultWidth;return t.formats[i]||t.formats[t.defaultWidth]}}var Fr={date:kr({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:kr({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:kr({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},Nr={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function jr(t){return function(e,n){var i=n||{},r=i.width?String(i.width):t.defaultWidth;return("formatting"===(i.context?String(i.context):"standalone")&&t.formattingValues?t.formattingValues[r]||t.formattingValues[t.defaultFormattingWidth]:t.values[r]||t.values[t.defaultWidth])[t.argumentCallback?t.argumentCallback(e):e]}}function Br(t){return function(e,n){var i=String(e),r=n||{},o=r.width,s=o&&t.matchPatterns[o]||t.matchPatterns[t.defaultMatchWidth],a=i.match(s);if(!a)return null;var c,l=a[0],u=o&&t.parsePatterns[o]||t.parsePatterns[t.defaultParseWidth];return c="[object Array]"===Object.prototype.toString.call(u)?u.findIndex(function(t){return t.test(i)}):function(t,e){for(var n in t)if(t.hasOwnProperty(n)&&e(t[n]))return n}(u,function(t){return t.test(i)}),c=t.valueCallback?t.valueCallback(c):c,{value:c=r.valueCallback?r.valueCallback(c):c,rest:i.slice(l.length)}}}var zr,Ur={formatDistance:function(t,e,n){var i;return n=n||{},i="string"==typeof Dr[t]?Dr[t]:1===e?Dr[t].one:Dr[t].other.replace("{{count}}",e),n.addSuffix?n.comparison>0?"in "+i:i+" ago":i},formatLong:Fr,formatRelative:function(t,e,n,i){return Nr[t]},localize:{ordinalNumber:function(t,e){var n=Number(t),i=n%100;if(i>20||i<10)switch(i%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:jr({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:jr({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:function(t){return Number(t)-1}}),month:jr({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:jr({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:jr({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:(zr={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:function(t){return parseInt(t,10)}},function(t,e){var n=String(t),i=e||{},r=n.match(zr.matchPattern);if(!r)return null;var o=r[0],s=n.match(zr.parsePattern);if(!s)return null;var a=zr.valueCallback?zr.valueCallback(s[0]):s[0];return{value:a=i.valueCallback?i.valueCallback(a):a,rest:n.slice(o.length)}}),era:Br({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:Br({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:Br({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:Br({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:Br({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}};function Hr(t,e){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");var n=e||{},i=n.locale,r=i&&i.options&&i.options.weekStartsOn,o=null==r?0:Or(r),s=null==n.weekStartsOn?o:Or(n.weekStartsOn);if(!(s>=0&&s<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var a=Pr(t),c=a.getUTCDay(),l=(c<s?7:0)+c-s;return a.setUTCDate(a.getUTCDate()-l),a.setUTCHours(0,0,0,0),a}function Wr(t,e){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");var n=Pr(t,e),i=n.getUTCFullYear(),r=e||{},o=r.locale,s=o&&o.options&&o.options.firstWeekContainsDate,a=null==s?1:Or(s),c=null==r.firstWeekContainsDate?a:Or(r.firstWeekContainsDate);if(!(c>=1&&c<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var l=new Date(0);l.setUTCFullYear(i+1,0,c),l.setUTCHours(0,0,0,0);var u=Hr(l,e),h=new Date(0);h.setUTCFullYear(i,0,c),h.setUTCHours(0,0,0,0);var d=Hr(h,e);return n.getTime()>=u.getTime()?i+1:n.getTime()>=d.getTime()?i:i-1}function Gr(t,e,n){if(arguments.length<2)throw new TypeError("2 arguments required, but only "+arguments.length+" present");var i=n||{},r=i.locale,o=r&&r.options&&r.options.weekStartsOn,s=null==o?0:Or(o),a=null==i.weekStartsOn?s:Or(i.weekStartsOn);if(!(a>=0&&a<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var c=Pr(t),l=Or(e),u=((l%7+7)%7<a?7:0)+l-c.getUTCDay();return c.setUTCDate(c.getUTCDate()+u),c}var Vr=6048e5;function Yr(t,e){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");var n=Pr(t),i=Hr(n,e).getTime()-function(t,e){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");var n=e||{},i=n.locale,r=i&&i.options&&i.options.firstWeekContainsDate,o=null==r?1:Or(r),s=null==n.firstWeekContainsDate?o:Or(n.firstWeekContainsDate),a=Wr(t,e),c=new Date(0);return c.setUTCFullYear(a,0,s),c.setUTCHours(0,0,0,0),Hr(c,e)}(n,e).getTime();return Math.round(i/Vr)+1}function qr(t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");var e=Pr(t),n=e.getUTCDay(),i=(n<1?7:0)+n-1;return e.setUTCDate(e.getUTCDate()-i),e.setUTCHours(0,0,0,0),e}function Xr(t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");var e=function(t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");var e=Pr(t),n=e.getUTCFullYear(),i=new Date(0);i.setUTCFullYear(n+1,0,4),i.setUTCHours(0,0,0,0);var r=qr(i),o=new Date(0);o.setUTCFullYear(n,0,4),o.setUTCHours(0,0,0,0);var s=qr(o);return e.getTime()>=r.getTime()?n+1:e.getTime()>=s.getTime()?n:n-1}(t),n=new Date(0);return n.setUTCFullYear(e,0,4),n.setUTCHours(0,0,0,0),qr(n)}var Kr=6048e5;function $r(t,e){if(arguments.length<2)throw new TypeError("2 arguments required, but only "+arguments.length+" present");var n=Pr(t),i=Or(e),r=function(t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");var e=Pr(t),n=qr(e).getTime()-Xr(e).getTime();return Math.round(n/Kr)+1}(n)-i;return n.setUTCDate(n.getUTCDate()-7*r),n}var Zr=36e5,Jr=6e4,Qr=1e3,to={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},eo=/^([+-])(\d{2})(\d{2})?|Z/,no=/^([+-])(\d{2})(\d{2})|Z/,io=/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,ro=/^([+-])(\d{2}):(\d{2})|Z/,oo=/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/;function so(t,e,n){var i=e.match(t);if(!i)return null;var r=parseInt(i[0],10);return{value:n?n(r):r,rest:e.slice(i[0].length)}}function ao(t,e){var n=e.match(t);if(!n)return null;if("Z"===n[0])return{value:0,rest:e.slice(1)};var i="+"===n[1]?1:-1,r=n[2]?parseInt(n[2],10):0,o=n[3]?parseInt(n[3],10):0,s=n[5]?parseInt(n[5],10):0;return{value:i*(r*Zr+o*Jr+s*Qr),rest:e.slice(n[0].length)}}function co(t,e){return so(to.anyDigitsSigned,t,e)}function lo(t,e,n){switch(t){case 1:return so(to.singleDigit,e,n);case 2:return so(to.twoDigits,e,n);case 3:return so(to.threeDigits,e,n);case 4:return so(to.fourDigits,e,n);default:return so(new RegExp("^\\d{1,"+t+"}"),e,n)}}function uo(t,e,n){switch(t){case 1:return so(to.singleDigitSigned,e,n);case 2:return so(to.twoDigitsSigned,e,n);case 3:return so(to.threeDigitsSigned,e,n);case 4:return so(to.fourDigitsSigned,e,n);default:return so(new RegExp("^-?\\d{1,"+t+"}"),e,n)}}function ho(t){switch(t){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function fo(t,e){var n,i=e>0,r=i?e:1-e;if(r<=50)n=t||100;else{var o=r+50;n=t+100*Math.floor(o/100)-(t>=o%100?100:0)}return i?n:1-n}var po=[31,28,31,30,31,30,31,31,30,31,30,31],go=[31,29,31,30,31,30,31,31,30,31,30,31];function _o(t){return t%400==0||t%4==0&&t%100!=0}var mo={G:{priority:140,parse:function(t,e,n,i){switch(e){case"G":case"GG":case"GGG":return n.era(t,{width:"abbreviated"})||n.era(t,{width:"narrow"});case"GGGGG":return n.era(t,{width:"narrow"});case"GGGG":default:return n.era(t,{width:"wide"})||n.era(t,{width:"abbreviated"})||n.era(t,{width:"narrow"})}},set:function(t,e,n,i){return t.setUTCFullYear(1===n?10:-9,0,1),t.setUTCHours(0,0,0,0),t}},y:{priority:130,parse:function(t,e,n,i){var r=function(t){return{year:t,isTwoDigitYear:"yy"===e}};switch(e){case"y":return lo(4,t,r);case"yo":return n.ordinalNumber(t,{unit:"year",valueCallback:r});default:return lo(e.length,t,r)}},validate:function(t,e,n){return e.isTwoDigitYear||e.year>0},set:function(t,e,n,i){var r=Wr(t,i);if(n.isTwoDigitYear){var o=fo(n.year,r);return t.setUTCFullYear(o,0,1),t.setUTCHours(0,0,0,0),t}var s=r>0?n.year:1-n.year;return t.setUTCFullYear(s,0,1),t.setUTCHours(0,0,0,0),t}},Y:{priority:130,parse:function(t,e,n,i){var r=function(t){return{year:t,isTwoDigitYear:"YY"===e}};switch(e){case"Y":return lo(4,t,r);case"Yo":return n.ordinalNumber(t,{unit:"year",valueCallback:r});default:return lo(e.length,t,r)}},validate:function(t,e,n){return e.isTwoDigitYear||e.year>0},set:function(t,e,n,i){var r=t.getUTCFullYear();if(n.isTwoDigitYear){var o=fo(n.year,r);return t.setUTCFullYear(o,0,i.firstWeekContainsDate),t.setUTCHours(0,0,0,0),Hr(t,i)}var s=r>0?n.year:1-n.year;return t.setUTCFullYear(s,0,i.firstWeekContainsDate),t.setUTCHours(0,0,0,0),Hr(t,i)}},R:{priority:130,parse:function(t,e,n,i){return uo("R"===e?4:e.length,t)},set:function(t,e,n,i){var r=new Date(0);return r.setUTCFullYear(n,0,4),r.setUTCHours(0,0,0,0),qr(r)}},u:{priority:130,parse:function(t,e,n,i){return uo("u"===e?4:e.length,t)},set:function(t,e,n,i){return t.setUTCFullYear(n,0,1),t.setUTCHours(0,0,0,0),t}},Q:{priority:120,parse:function(t,e,n,i){switch(e){case"Q":case"QQ":return lo(e.length,t);case"Qo":return n.ordinalNumber(t,{unit:"quarter"});case"QQQ":return n.quarter(t,{width:"abbreviated",context:"formatting"})||n.quarter(t,{width:"narrow",context:"formatting"});case"QQQQQ":return n.quarter(t,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(t,{width:"wide",context:"formatting"})||n.quarter(t,{width:"abbreviated",context:"formatting"})||n.quarter(t,{width:"narrow",context:"formatting"})}},validate:function(t,e,n){return e>=1&&e<=4},set:function(t,e,n,i){return t.setUTCMonth(3*(n-1),1),t.setUTCHours(0,0,0,0),t}},q:{priority:120,parse:function(t,e,n,i){switch(e){case"q":case"qq":return lo(e.length,t);case"qo":return n.ordinalNumber(t,{unit:"quarter"});case"qqq":return n.quarter(t,{width:"abbreviated",context:"standalone"})||n.quarter(t,{width:"narrow",context:"standalone"});case"qqqqq":return n.quarter(t,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(t,{width:"wide",context:"standalone"})||n.quarter(t,{width:"abbreviated",context:"standalone"})||n.quarter(t,{width:"narrow",context:"standalone"})}},validate:function(t,e,n){return e>=1&&e<=4},set:function(t,e,n,i){return t.setUTCMonth(3*(n-1),1),t.setUTCHours(0,0,0,0),t}},M:{priority:110,parse:function(t,e,n,i){var r=function(t){return t-1};switch(e){case"M":return so(to.month,t,r);case"MM":return lo(2,t,r);case"Mo":return n.ordinalNumber(t,{unit:"month",valueCallback:r});case"MMM":return n.month(t,{width:"abbreviated",context:"formatting"})||n.month(t,{width:"narrow",context:"formatting"});case"MMMMM":return n.month(t,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(t,{width:"wide",context:"formatting"})||n.month(t,{width:"abbreviated",context:"formatting"})||n.month(t,{width:"narrow",context:"formatting"})}},validate:function(t,e,n){return e>=0&&e<=11},set:function(t,e,n,i){return t.setUTCMonth(n,1),t.setUTCHours(0,0,0,0),t}},L:{priority:110,parse:function(t,e,n,i){var r=function(t){return t-1};switch(e){case"L":return so(to.month,t,r);case"LL":return lo(2,t,r);case"Lo":return n.ordinalNumber(t,{unit:"month",valueCallback:r});case"LLL":return n.month(t,{width:"abbreviated",context:"standalone"})||n.month(t,{width:"narrow",context:"standalone"});case"LLLLL":return n.month(t,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(t,{width:"wide",context:"standalone"})||n.month(t,{width:"abbreviated",context:"standalone"})||n.month(t,{width:"narrow",context:"standalone"})}},validate:function(t,e,n){return e>=0&&e<=11},set:function(t,e,n,i){return t.setUTCMonth(n,1),t.setUTCHours(0,0,0,0),t}},w:{priority:100,parse:function(t,e,n,i){switch(e){case"w":return so(to.week,t);case"wo":return n.ordinalNumber(t,{unit:"week"});default:return lo(e.length,t)}},validate:function(t,e,n){return e>=1&&e<=53},set:function(t,e,n,i){return Hr(function(t,e,n){if(arguments.length<2)throw new TypeError("2 arguments required, but only "+arguments.length+" present");var i=Pr(t),r=Or(e),o=Yr(i,n)-r;return i.setUTCDate(i.getUTCDate()-7*o),i}(t,n,i),i)}},I:{priority:100,parse:function(t,e,n,i){switch(e){case"I":return so(to.week,t);case"Io":return n.ordinalNumber(t,{unit:"week"});default:return lo(e.length,t)}},validate:function(t,e,n){return e>=1&&e<=53},set:function(t,e,n,i){return qr($r(t,n,i),i)}},d:{priority:90,parse:function(t,e,n,i){switch(e){case"d":return so(to.date,t);case"do":return n.ordinalNumber(t,{unit:"date"});default:return lo(e.length,t)}},validate:function(t,e,n){var i=_o(t.getUTCFullYear()),r=t.getUTCMonth();return i?e>=1&&e<=go[r]:e>=1&&e<=po[r]},set:function(t,e,n,i){return t.setUTCDate(n),t.setUTCHours(0,0,0,0),t}},D:{priority:90,parse:function(t,e,n,i){switch(e){case"D":case"DD":return so(to.dayOfYear,t);case"Do":return n.ordinalNumber(t,{unit:"date"});default:return lo(e.length,t)}},validate:function(t,e,n){return _o(t.getUTCFullYear())?e>=1&&e<=366:e>=1&&e<=365},set:function(t,e,n,i){return t.setUTCMonth(0,n),t.setUTCHours(0,0,0,0),t}},E:{priority:90,parse:function(t,e,n,i){switch(e){case"E":case"EE":case"EEE":return n.day(t,{width:"abbreviated",context:"formatting"})||n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"});case"EEEEE":return n.day(t,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"});case"EEEE":default:return n.day(t,{width:"wide",context:"formatting"})||n.day(t,{width:"abbreviated",context:"formatting"})||n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"})}},validate:function(t,e,n){return e>=0&&e<=6},set:function(t,e,n,i){return(t=Gr(t,n,i)).setUTCHours(0,0,0,0),t}},e:{priority:90,parse:function(t,e,n,i){var r=function(t){var e=7*Math.floor((t-1)/7);return(t+i.weekStartsOn+6)%7+e};switch(e){case"e":case"ee":return lo(e.length,t,r);case"eo":return n.ordinalNumber(t,{unit:"day",valueCallback:r});case"eee":return n.day(t,{width:"abbreviated",context:"formatting"})||n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"});case"eeeee":return n.day(t,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"});case"eeee":default:return n.day(t,{width:"wide",context:"formatting"})||n.day(t,{width:"abbreviated",context:"formatting"})||n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"})}},validate:function(t,e,n){return e>=0&&e<=6},set:function(t,e,n,i){return(t=Gr(t,n,i)).setUTCHours(0,0,0,0),t}},c:{priority:90,parse:function(t,e,n,i){var r=function(t){var e=7*Math.floor((t-1)/7);return(t+i.weekStartsOn+6)%7+e};switch(e){case"c":case"cc":return lo(e.length,t,r);case"co":return n.ordinalNumber(t,{unit:"day",valueCallback:r});case"ccc":return n.day(t,{width:"abbreviated",context:"standalone"})||n.day(t,{width:"short",context:"standalone"})||n.day(t,{width:"narrow",context:"standalone"});case"ccccc":return n.day(t,{width:"narrow",context:"standalone"});case"cccccc":return n.day(t,{width:"short",context:"standalone"})||n.day(t,{width:"narrow",context:"standalone"});case"cccc":default:return n.day(t,{width:"wide",context:"standalone"})||n.day(t,{width:"abbreviated",context:"standalone"})||n.day(t,{width:"short",context:"standalone"})||n.day(t,{width:"narrow",context:"standalone"})}},validate:function(t,e,n){return e>=0&&e<=6},set:function(t,e,n,i){return(t=Gr(t,n,i)).setUTCHours(0,0,0,0),t}},i:{priority:90,parse:function(t,e,n,i){var r=function(t){return 0===t?7:t};switch(e){case"i":case"ii":return lo(e.length,t);case"io":return n.ordinalNumber(t,{unit:"day"});case"iii":return n.day(t,{width:"abbreviated",context:"formatting",valueCallback:r})||n.day(t,{width:"short",context:"formatting",valueCallback:r})||n.day(t,{width:"narrow",context:"formatting",valueCallback:r});case"iiiii":return n.day(t,{width:"narrow",context:"formatting",valueCallback:r});case"iiiiii":return n.day(t,{width:"short",context:"formatting",valueCallback:r})||n.day(t,{width:"narrow",context:"formatting",valueCallback:r});case"iiii":default:return n.day(t,{width:"wide",context:"formatting",valueCallback:r})||n.day(t,{width:"abbreviated",context:"formatting",valueCallback:r})||n.day(t,{width:"short",context:"formatting",valueCallback:r})||n.day(t,{width:"narrow",context:"formatting",valueCallback:r})}},validate:function(t,e,n){return e>=1&&e<=7},set:function(t,e,n,i){return(t=function(t,e){if(arguments.length<2)throw new TypeError("2 arguments required, but only "+arguments.length+" present");var n=Or(e);n%7==0&&(n-=7);var i=Pr(t),r=((n%7+7)%7<1?7:0)+n-i.getUTCDay();return i.setUTCDate(i.getUTCDate()+r),i}(t,n,i)).setUTCHours(0,0,0,0),t}},a:{priority:80,parse:function(t,e,n,i){switch(e){case"a":case"aa":case"aaa":return n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"});case"aaaaa":return n.dayPeriod(t,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(t,{width:"wide",context:"formatting"})||n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"})}},set:function(t,e,n,i){return t.setUTCHours(ho(n),0,0,0),t}},b:{priority:80,parse:function(t,e,n,i){switch(e){case"b":case"bb":case"bbb":return n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"});case"bbbbb":return n.dayPeriod(t,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(t,{width:"wide",context:"formatting"})||n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"})}},set:function(t,e,n,i){return t.setUTCHours(ho(n),0,0,0),t}},B:{priority:80,parse:function(t,e,n,i){switch(e){case"B":case"BB":case"BBB":return n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"});case"BBBBB":return n.dayPeriod(t,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(t,{width:"wide",context:"formatting"})||n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"})}},set:function(t,e,n,i){return t.setUTCHours(ho(n),0,0,0),t}},h:{priority:70,parse:function(t,e,n,i){switch(e){case"h":return so(to.hour12h,t);case"ho":return n.ordinalNumber(t,{unit:"hour"});default:return lo(e.length,t)}},validate:function(t,e,n){return e>=1&&e<=12},set:function(t,e,n,i){var r=t.getUTCHours()>=12;return r&&n<12?t.setUTCHours(n+12,0,0,0):r||12!==n?t.setUTCHours(n,0,0,0):t.setUTCHours(0,0,0,0),t}},H:{priority:70,parse:function(t,e,n,i){switch(e){case"H":return so(to.hour23h,t);case"Ho":return n.ordinalNumber(t,{unit:"hour"});default:return lo(e.length,t)}},validate:function(t,e,n){return e>=0&&e<=23},set:function(t,e,n,i){return t.setUTCHours(n,0,0,0),t}},K:{priority:70,parse:function(t,e,n,i){switch(e){case"K":return so(to.hour11h,t);case"Ko":return n.ordinalNumber(t,{unit:"hour"});default:return lo(e.length,t)}},validate:function(t,e,n){return e>=0&&e<=11},set:function(t,e,n,i){return t.getUTCHours()>=12&&n<12?t.setUTCHours(n+12,0,0,0):t.setUTCHours(n,0,0,0),t}},k:{priority:70,parse:function(t,e,n,i){switch(e){case"k":return so(to.hour24h,t);case"ko":return n.ordinalNumber(t,{unit:"hour"});default:return lo(e.length,t)}},validate:function(t,e,n){return e>=1&&e<=24},set:function(t,e,n,i){var r=n<=24?n%24:n;return t.setUTCHours(r,0,0,0),t}},m:{priority:60,parse:function(t,e,n,i){switch(e){case"m":return so(to.minute,t);case"mo":return n.ordinalNumber(t,{unit:"minute"});default:return lo(e.length,t)}},validate:function(t,e,n){return e>=0&&e<=59},set:function(t,e,n,i){return t.setUTCMinutes(n,0,0),t}},s:{priority:50,parse:function(t,e,n,i){switch(e){case"s":return so(to.second,t);case"so":return n.ordinalNumber(t,{unit:"second"});default:return lo(e.length,t)}},validate:function(t,e,n){return e>=0&&e<=59},set:function(t,e,n,i){return t.setUTCSeconds(n,0),t}},S:{priority:30,parse:function(t,e,n,i){return lo(e.length,t,function(t){return Math.floor(t*Math.pow(10,3-e.length))})},set:function(t,e,n,i){return t.setUTCMilliseconds(n),t}},X:{priority:10,parse:function(t,e,n,i){switch(e){case"X":return ao(eo,t);case"XX":return ao(no,t);case"XXXX":return ao(io,t);case"XXXXX":return ao(oo,t);case"XXX":default:return ao(ro,t)}},set:function(t,e,n,i){return e.timestampIsSet?t:new Date(t.getTime()-n)}},x:{priority:10,parse:function(t,e,n,i){switch(e){case"x":return ao(eo,t);case"xx":return ao(no,t);case"xxxx":return ao(io,t);case"xxxxx":return ao(oo,t);case"xxx":default:return ao(ro,t)}},set:function(t,e,n,i){return e.timestampIsSet?t:new Date(t.getTime()-n)}},t:{priority:40,parse:function(t,e,n,i){return co(t)},set:function(t,e,n,i){return[new Date(1e3*n),{timestampIsSet:!0}]}},T:{priority:20,parse:function(t,e,n,i){return co(t)},set:function(t,e,n,i){return[new Date(n),{timestampIsSet:!0}]}}},yo=["D","DD","YY","YYYY"];function vo(t){return-1!==yo.indexOf(t)}function bo(t){throw new RangeError("`options.awareOfUnicodeTokens` must be set to `true` to use `"+t+"` token; see: https://git.io/fxCyr")}var Co=10,wo=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Eo=/^'(.*?)'?$/,To=/''/g,So=/\S/;function xo(t,e,n,i){if(arguments.length<3)throw new TypeError("3 arguments required, but only "+arguments.length+" present");var r=String(t),o=String(e),s=i||{},a=s.locale||Ur;if(!a.match)throw new RangeError("locale must contain match property");var c=a.options&&a.options.firstWeekContainsDate,l=null==c?1:Or(c),u=null==s.firstWeekContainsDate?l:Or(s.firstWeekContainsDate);if(!(u>=1&&u<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var h=a.options&&a.options.weekStartsOn,d=null==h?0:Or(h),f=null==s.weekStartsOn?d:Or(s.weekStartsOn);if(!(f>=0&&f<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(""===o)return""===r?Pr(n):new Date(NaN);var p,g={firstWeekContainsDate:u,weekStartsOn:f,locale:a},_=[{priority:Co,set:Ro,index:0}],m=o.match(wo);for(p=0;p<m.length;p++){var y=m[p];!s.awareOfUnicodeTokens&&vo(y)&&bo(y);var v=y[0],b=mo[v];if(b){var C=b.parse(r,y,a.match,g);if(!C)return new Date(NaN);_.push({priority:b.priority,set:b.set,validate:b.validate,value:C.value,index:_.length}),r=C.rest}else{if("''"===y?y="'":"'"===v&&(y=y.match(Eo)[1].replace(To,"'")),0!==r.indexOf(y))return new Date(NaN);r=r.slice(y.length)}}if(r.length>0&&So.test(r))return new Date(NaN);var w=_.map(function(t){return t.priority}).sort(function(t,e){return e-t}).filter(function(t,e,n){return n.indexOf(t)===e}).map(function(t){return _.filter(function(e){return e.priority===t}).reverse()}).map(function(t){return t[0]}),E=Pr(n);if(isNaN(E))return new Date(NaN);var T=Lr(E,function(t){var e=new Date(t.getTime()),n=e.getTimezoneOffset();e.setSeconds(0,0);var i=e.getTime()%Mr;return n*Mr+i}(E)),S={};for(p=0;p<w.length;p++){var x=w[p];if(x.validate&&!x.validate(T,x.value,g))return new Date(NaN);var R=x.set(T,S,x.value,g);R[0]?(T=R[0],Ir(S,R[1])):T=R}return T}function Ro(t,e){if(e.timestampIsSet)return t;var n=new Date(0);return n.setFullYear(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()),n.setHours(t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds()),n}var Ao,Oo=n(51),Io=n.n(Oo);!function(t){t.VERTICAL="vertical",t.HORIZONTAL="horizontal"}(Ao||(Ao={}));var Mo=Ao;function Po(t,e){return t=t||{},Io()({},sr.deepClone(e),t)}const Lo={title:"Widget grid",toolbar:!0},Do={lineCount:50,searchable:!0,paginationCount:5},ko={hitTolerance:0},Fo=(ar.TRIANGLE,ar.ROMBUS,ar.TRIANGLE,ar.ROMBUS,{clusterRadius:30,unrollClustersAtZoom:100,style:{single:{size:6,shape:ar.TRIANGLE,strokeSize:3},cluster:{shape:ar.ROMBUS,size:15}},selectedStyle:{single:{size:10,shape:ar.TRIANGLE,strokeSize:3},cluster:{shape:ar.ROMBUS,size:15}}}),No={usesCrossfilter:!1,useThread:!0,csvHasHeader:!1,dataProjection:"EPSG:4326",compact:!0},jo={aMax:100,bMax:100,cMax:100,ticks:5,transitionDuration:250},Bo={mode:"less",initOnStart:!0,step:1,min:0},zo=(ar.TRIANGLE,ar.ROMBUS,ar.TRIANGLE,ar.ROMBUS,{title:"Title",subtitle:"",x:0,y:0,width:2,height:2}),Uo={checkedValues:[]},Ho={responsive:!0,transitionDuration:400,transitionDelay:0},Wo={legendPosition:Mt.TOP_RIGHT,legend:!0},Go={position:Mt.TOP_LEFT,index:1,flow:Mo.VERTICAL},Vo={position:Mt.BOTTOM_LEFT,index:1,flow:Mo.HORIZONTAL,size:200},Yo={position:Mt.TOP_CENTER,index:1,flow:Mo.HORIZONTAL,size:200},qo={normalIcon:"heart-broken",solidIcons:!0},Xo={},Ko={position:Mt.BOTTOM_RIGHT,height:100,width:100},$o={position:It.LEFT,size:250},Zo={position:It.LEFT,controlIndex:-3,controlPosition:Mt.TOP_LEFT,controlFlow:Mo.VERTICAL},Jo={colorScheme:Ct},Qo={brushOn:!1,nodeColor:"#2848a2",edgeColor:"black",nodeColorScheme:Ct,nodeStrokeWidth:3,arrowSize:1,fitStrategy:"default",autoZoom:!0,induceNodes:!1,margins:{left:10,top:10,right:10,bottom:10},othersLabel:"Other"},ts={type:"filter",animate:!0,skipFirst:!0},es={tree:{},dagre:{},d3v4force:{collisionRadius:50,gravityStrength:.05,initialCharge:-1e3}},ns={buttonText:"Ferdig",width:400,title:"Modal"},is={},rs={},os={dataOpacity:.9,boxSpacing:.8,boxWidth:20,dataWidth:.8},ss={nodeSize:16,fixedNodeSize:!0,nodeColor:"red",hasLayout:!1},as={forceSize:300,stepSize:100,temperatureThreshold:.5};var cs,ls=n(50),us=n.n(ls),hs=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},ds=function(t,e){return function(n,i){e(n,i,t)}};let fs=cs=class{constructor(t,e){this._dimensions={},this._fetchDataCallbacks=[],this._onInfoAddedCallbacks=[],this._onDataAddedCallbacks=[],this._onDataFilteredCallbacks=[],this._keyFilters={},this._extraColumns={},this._dataContainer=t,this._dataFetchingHandler=e,this._id=cs.getNewId()}initialize(t){this._options=Po(t,No);const{useCrossfilter:e,data:n,lazyLoad:i,labels:r}=this._options;e&&this._initializeCrossfilter(),r&&this._setInfo(r),n?this.addData(n):0==i&&this.fetchData(),this._id=this._options.id||this._id}_initializeCrossfilter(){this._dataContainer.setUseCrossfilter(),this._dataContainer.getCrossfilter().onChange(t=>{"filtered"==t&&this._triggerOnDataFiltered()})}addColumn(t,e){this._extraColumns[t]=t=>{const n=this.getDataContainer().wrapRecord(t);return e(n)}}addData(t,e=!1){let{compact:n,labels:i,csvHasHeader:r}=this._options;i=i||this.getDataContainer().getLabels(!0);const o=this._dataFetchingHandler.parseData(t,i,n,r);this._addParsedData(o.records,o.labels,e),this._mediator.publish(cr.FORCE_REDRAW,{dataSourceId:this.getId()})}_addParsedData(t,e,n=!1){n&&this._dataContainer.clear(),this._options.drop&&(t=this._dropRecords(t,e)),e=this._expandDataWithExtraColumns(t,e),this._dataContainer.add(t),this._updateDataIndexes(this._dataContainer),this._setInfo(e),this._triggerFetchDataCallbacks(n),this._triggerOnDataAdded(n),this._hasData=!0}_expandDataWithExtraColumns(t,e){return Object.keys(this._extraColumns).forEach(n=>{this._setInfo(e);const i=this._extraColumns[n];t.forEach(t=>{t.push(i(t))}),e.push(n)}),this._setInfo(e),this._triggerOnInfoAdded(),e}_dropRecords(t,e){for(const n in this._options.drop){const i=e.indexOf(n);if(i>=0){const e=this._options.drop[n];return t.filter(t=>e(t[i]))}}return t}_updateDataIndexes(t){let e=0;t.getData(!0).forEach(n=>{n[t.getIndexForColumn(tt.DataSource.RECORD_KEY)]=e++})}fetchData(t){if(!this._options||!this._options.url)return;const{authenticator:e}=this._options;e&&!e.isAuthenticated()?e.authenticate().then(()=>{this._fetchData(t)}):this._fetchData(t)}_fetchData(t){t&&(this._hasData?t(this._dataContainer):this._fetchDataCallbacks.push(t)),this._waitingForData||(this._waitingForData=!0,this._options.url&&("undefined"!=typeof Worker&&this._options.useThread?this._fetchDataOnSeparateThread():this._fetchDataOnMainThread()))}_triggerFetchDataCallbacks(t=!1){this._fetchDataCallbacks.forEach(e=>e(this._dataContainer,t)),this._fetchDataCallbacks=[]}_fetchDataOnSeparateThread(){this._addWorkerEventListener(),this._sendFetchDataMessageToWorker()}_addWorkerEventListener(){let t=[];cs.getWorker().addEventListener("message",e=>{const{data:n}=e;if(n.source==this._options.url)switch(n.type){case"data":t=t.concat(n.records);break;case"done":this._setInfo(n.labels),this._addParsedData(t,n.labels,!0)}})}_sendFetchDataMessageToWorker(){const{url:t,labels:e,csvHasHeader:n,idColumn:i,compact:r,preprocess:o}=this._options,s=this.needsAuthentication()?this.getAuthenticator().getAuthenticationData():null,a={type:"fetch",source:new URL(t,document.baseURI).href,dataLabels:e,compact:r,csvHasHeader:n,authenticationData:s,idColumn:i,preprocessString:o?o.toString():null};cs.getWorker().postMessage(a)}_fetchDataOnMainThread(){const{url:t,labels:e,csvHasHeader:n,idColumn:i,compact:r,preprocess:o,delimiter:s}=this._options,a=this.needsAuthentication()?this.getAuthenticator().getAuthenticationData():null,c=this._fetchRecordsCallback.bind(this);this._dataFetchingHandler.fetchRecords(t,i,a,e,r,n,c,s,o)}_fetchRecordsCallback(t,e){this._setInfo(e),this._addParsedData(t,e,!0)}_setInfo(t){const{dataProjection:e,compact:n,columns:i}=this._options;this._dataContainer.setInfo(t,n,i,e)}onInfoAdded(t){this._onInfoAddedCallbacks.push(t),this._hasData&&t(this._dataContainer)}onDataAdded(t,e=!1){this._hasData&&t(this._dataContainer,this._dataContainer.getData()),this._hasData&&e||this._onDataAddedCallbacks.push({callback:t,once:e})}onDataFiltered(t){this._onDataFilteredCallbacks.push(t)}_triggerOnInfoAdded(){this._onInfoAddedCallbacks.forEach(t=>t(this._dataContainer))}_triggerOnDataAdded(t=!1){const e={};for(let n=0;n<this._onDataAddedCallbacks.length;n++){const{once:i,callback:r}=this._onDataAddedCallbacks[n];r(this._dataContainer,t),e[n]=i}this._onDataAddedCallbacks=this._onDataAddedCallbacks.filter((t,n)=>!e[n])}_triggerOnDataFiltered(){for(const t of this._onDataFilteredCallbacks)t(this._dataContainer)}getDimension(t,e,n){const i=this.getDateFormat(),r=this._getApplyFunction(e,i);return Q.isFunction(t)?this._dataContainer.getCrossfilter().dimension(e=>{const n=this._dataContainer.wrapRecord(e);return r(t(n))},!!n):Q.isString(t)?this._dataContainer.getCrossfilter().dimension(e=>this._dataContainer.wrapRecord(e).get(t,r)):void 0}get2DDimension(t,e,n,i){const r=`${t}___${e}`;if(this._dimensions[r])return this._dimensions[r];const o=this.getDateFormat(),s=this._getApplyFunction(n,o),a=this._getApplyFunction(i,o);return this._dimensions[r]=this._dataContainer.getCrossfilter().dimension(n=>[this._dataContainer.wrapRecord(n).get(t,s),this._dataContainer.wrapRecord(n).get(e,a)])}createGroupByReduceSum(t,e){return t.group().reduceSum(t=>this._dataContainer.wrapRecord(t).get(e))}_getApplyFunction(t,e){let n;switch(t){case"date":n=Q.isString(e)?t=>o.timeDay(xo(t,e,new Date)):t=>o.timeDay(new Date(t));break;case"number":n=t=>parseFloat(t);break;default:n=t=>t}return n}isFiltered(){return!!this._dataContainer.usesCrossfilter()&&this._dataContainer.getData(!0).length!==this._dataContainer.getData().length}hasKeyFilter(t){return!this._keyFilters[t]}applyKeyFilter(t,e){this._keyFilters[t]=this._keyFilters[t]||this.getDimension(tt.DataSource.RECORD_KEY),this._keyFilters[t].filter(e)}removeKeyFilter(t){if(!this._keyFilters[t])return;this._keyFilters[t].dispose()}getFilteredKeys(){return this._dataContainer.getData().map(t=>this._dataContainer.wrapRecord(t).key())}getId(){return this._id}needsAuthentication(){return!!this.getAuthenticator()}getAuthenticator(){return this._options.authenticator}getSource(){return this._options.url}getUseThread(){return this._options.useThread}getDataContainer(){return this._dataContainer}getDateFormat(){return this._options.dateFormat}getDataProjection(){return this._options.dataProjection}getUseCrossfilter(){return this._options.useCrossfilter}getUniqueValuesForColumn(t,e){if(this.getUseCrossfilter()){const n=(e=e||this.getDimension(t)).group().top(1/0).map(t=>t.key);return e.dispose(),n}{const e={};return this._dataContainer.forEachRecord(n=>{const i=n.get(t);e[i]=!0}),Object.keys(e)}}getUniqueValuesFromDimension(t){return t.group().top(1/0).map(t=>t.key)}static getWorker(){return this._worker||(this._worker=new us.a),this._worker}static getNewId(){return this._currentId++}};fs._currentId=0,hs([Object(nt.inject)(lr.Mediator)],fs.prototype,"_mediator",void 0),hs([Object(nt.inject)(lr.DataParser)],fs.prototype,"_dataParser",void 0);var ps=fs=cs=hs([Object(nt.injectable)(),ds(0,Object(nt.inject)(lr.DataContainer)),ds(1,Object(nt.inject)(lr.DataFetcherHandler))],fs);let gs=class{constructor(){this._geoJSON=new r.a.format.GeoJSON,this._wkt=new r.a.format.WKT}setRecord(t){this._currentGeometry=!1,this._record=t}getRecord(){return this._record}setInfo(t,e,n,i){this._labelLookup=t,this._compact=e,this._columns=n||{},this._dataProjection=i}get(t,e){const n=this._compact?this._labelLookup[t]:t;if(null!=n){let t=this._record[n];return e?e(t):t}}key(){return this.get(tt.DataSource.RECORD_KEY)}hasGeometry(){return!!this.get(tt.DataSource.GEOMETRY)||!!this._columns.wktGeometry}getGeometry(){if(this._currentGeometry)return this._currentGeometry;let t={dataProjection:this._dataProjection||"EPSG:4326",featureProjection:"EPSG:3857"};const e=this.get(tt.DataSource.GEOMETRY);e&&(this._currentGeometry=this._geoJSON.readGeometry(e,t));const n=this.get(this._columns.wktGeometry);return n&&(this._currentGeometry=this._wkt.readGeometry(n,t)),this._currentGeometry}getCoordinatesFromGeometry(){const t=this.getGeometry().getExtent();return r.a.extent.getCenter(t)}toJSON(){const t={},e=new Array(this._record.length-1);return Object.keys(this._labelLookup).filter(t=>!!t&&t!==tt.DataSource.RECORD_KEY).forEach(t=>{const n=this._labelLookup[t]-1;e[n]=t}),e.forEach(e=>t[e]=this.get(e)),t}toJSONStringify(){const t=this.toJSON();return JSON.stringify(t)}};var _s,ms=gs=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)()],gs),ys=n(20);!function(t){t[t.UNAUTHORIZED=0]="UNAUTHORIZED",t[t.SOURCE_NOT_FOUND=1]="SOURCE_NOT_FOUND",t[t.DONT_CARE=2]="DONT_CARE"}(_s||(_s={}));var vs=_s,bs=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};const{RECORD_KEY:Cs,GEOMETRY:ws}=tt.DataSource;let Es=class{fetchRecords(t,e,n,i,r,o,s,a,c){this._getPromise(t,n).then(t=>{switch(t.status){case 200:return t.text();case 401:return Promise.reject(vs.UNAUTHORIZED);case 404:return Promise.reject(vs.SOURCE_NOT_FOUND);default:return Promise.reject(vs.DONT_CARE)}}).then(t=>{try{t&&c&&(t=c(t));const{records:e,labels:n}=this.parseData(t,i,r,o,a);s(e,n)}catch(t){throw new Error(t)}}).catch(e=>{switch(e){case vs.SOURCE_NOT_FOUND:throw Error(`Source not found: ${t}`);case vs.UNAUTHORIZED:throw Error("Source requires authentication.");default:console.trace(e)}})}_getPromise(t,e){return e?fetch(t,e):fetch(t)}parseData(t,e,n,i,r){const o=this._tryToParseDataAsJSON(t);if(o)return this._isValidGeoJSON(o)?this._recordsFromGeoJSON(o):this._recordsFromJSON(o,e,n);const s=this._tryToParseDataAsCSV(t,r);if(s)return this._recordsFromCSV(s,e,i);throw it()}_tryToParseDataAsJSON(t){if(this._isValidJSON(t))return t;try{return JSON.parse(t)}catch(t){return null}}_tryToParseDataAsCSV(t,e){const n=ys.parse(t,{delimiter:e,dynamicTyping:!0,skipEmptyLines:"greedy"});if(0==n.errors.length)return n}_recordsFromGeoJSON(t){if(0===(t.features||[]).length)return{records:[],labels:[]};const e=t.features[0],n=Object.keys(e.properties);return{records:t.features.map((t,e)=>{const i=new Array(n.length+2);return i[0]=e,i[1]=t.geometry,n.forEach((e,n)=>{i[n+2]=t.properties[e]}),i}),labels:[Cs,ws].concat(n)}}_recordsFromJSON(t,e,n){const i=t[0];let r;if(Q.isArray(i)){if(!e)throw rt();r=t.map((t,n)=>{const i=new Array(e.length+1);return i[0]=n,t.forEach((t,e)=>i[e+1]=t),i})}else Q.isObject(i)&&(e=e||Object.keys(i),n?r=t.map((t,n)=>{const i=new Array(e.length+1);return i[0]=n,e.forEach((e,n)=>i[n+1]=t[e]),i}):(t.forEach((t,e)=>{t[Cs]=e}),r=t));return{records:r,labels:[Cs].concat(e)}}_recordsFromCSV(t,e,n){const i=t.data;let r=n?i.shift():e;if(!r)throw rt();return{records:i.map((t,e)=>{const n=new Array(this._columnCount(i)+1);return n[0]=e,t.forEach((t,e)=>n[e+1]=t),n}),labels:r=[Cs].concat(r)}}_isValidGeoJSON(t){return t[tt.GeoJSON.TYPE]==tt.GeoJSON.FEATURE_COLLECTION&&t[tt.GeoJSON.FEATURES]instanceof Array}_isValidJSON(t){return Q.isArray(t)||Q.isObject(t)}_columnCount(t){return t[0].length}};var Ts=Es=bs([Object(nt.injectable)()],Es),Ss={IMAGE:"IMAGE",TILE:"TILE",VECTOR_TILE:"VECTOR_TILE",VECTOR:"VECTOR"},xs={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",SOURCE:"source"},Rs="precompose",As={UNDEFINED:"undefined",LOADING:"loading",READY:"ready",ERROR:"error"};var Os=function(t){function e(e){var n=_({},e);delete n.source,t.call(this,n),this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,e.map&&this.setMap(e.map),E(this,z(xs.SOURCE),this.handleSourcePropertyChange_,this);var i=e.source?e.source:null;this.setSource(i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getLayersArray=function(t){var e=t||[];return e.push(this),e},e.prototype.getLayerStatesArray=function(t){var e=t||[];return e.push(this.getLayerState()),e},e.prototype.getSource=function(){return this.get(xs.SOURCE)||null},e.prototype.getSourceState=function(){var t=this.getSource();return t?t.getState():As.UNDEFINED},e.prototype.handleSourceChange_=function(){this.changed()},e.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(x(this.sourceChangeKey_),this.sourceChangeKey_=null);var t=this.getSource();t&&(this.sourceChangeKey_=E(t,L,this.handleSourceChange_,this)),this.changed()},e.prototype.setMap=function(t){this.mapPrecomposeKey_&&(x(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(x(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=E(t,Rs,function(t){var e=t,n=this.getLayerState();n.managed=!1,void 0===this.getZIndex()&&(n.zIndex=1/0),e.frameState.layerStatesArray.push(n),e.frameState.layerStates[f(this)]=n},this),this.mapRenderKey_=E(this,L,t.render,t),this.changed())},e.prototype.setSource=function(t){this.set(xs.SOURCE,t)},e}(function(t){function e(e){t.call(this);var n=_({},e);n[xs.OPACITY]=void 0!==e.opacity?e.opacity:1,n[xs.VISIBLE]=void 0===e.visible||e.visible,n[xs.Z_INDEX]=e.zIndex,n[xs.MAX_RESOLUTION]=void 0!==e.maxResolution?e.maxResolution:1/0,n[xs.MIN_RESOLUTION]=void 0!==e.minResolution?e.minResolution:0,this.setProperties(n),this.state_=null,this.type}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getType=function(){return this.type},e.prototype.getLayerState=function(){var t=this.state_||{layer:this,managed:!0};return t.opacity=Dt(this.getOpacity(),0,1),t.sourceState=this.getSourceState(),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=this.getZIndex()||0,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),this.state_=t,t},e.prototype.getLayersArray=function(t){return h()},e.prototype.getLayerStatesArray=function(t){return h()},e.prototype.getExtent=function(){return this.get(xs.EXTENT)},e.prototype.getMaxResolution=function(){return this.get(xs.MAX_RESOLUTION)},e.prototype.getMinResolution=function(){return this.get(xs.MIN_RESOLUTION)},e.prototype.getOpacity=function(){return this.get(xs.OPACITY)},e.prototype.getSourceState=function(){return h()},e.prototype.getVisible=function(){return this.get(xs.VISIBLE)},e.prototype.getZIndex=function(){return this.get(xs.Z_INDEX)},e.prototype.setExtent=function(t){this.set(xs.EXTENT,t)},e.prototype.setMaxResolution=function(t){this.set(xs.MAX_RESOLUTION,t)},e.prototype.setMinResolution=function(t){this.set(xs.MIN_RESOLUTION,t)},e.prototype.setOpacity=function(t){this.set(xs.OPACITY,t)},e.prototype.setVisible=function(t){this.set(xs.VISIBLE,t)},e.prototype.setZIndex=function(t){this.set(xs.Z_INDEX,t)},e}(U)),Is={IMAGE:"image",VECTOR:"vector"},Ms="renderOrder",Ps=function(t){function e(e){var n=e||{},i=_({},n);delete i.style,delete i.renderBuffer,delete i.updateWhileAnimating,delete i.updateWhileInteracting,t.call(this,i),this.declutter_=void 0!==n.declutter&&n.declutter,this.renderBuffer_=void 0!==n.renderBuffer?n.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(n.style),this.updateWhileAnimating_=void 0!==n.updateWhileAnimating&&n.updateWhileAnimating,this.updateWhileInteracting_=void 0!==n.updateWhileInteracting&&n.updateWhileInteracting,this.renderMode_=n.renderMode||Is.VECTOR,this.type=Ss.VECTOR}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDeclutter=function(){return this.declutter_},e.prototype.setDeclutter=function(t){this.declutter_=t},e.prototype.getRenderBuffer=function(){return this.renderBuffer_},e.prototype.getRenderOrder=function(){return this.get(Ms)},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},e.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},e.prototype.setRenderOrder=function(t){this.set(Ms,t)},e.prototype.setStyle=function(t){this.style_=void 0!==t?t:Li,this.styleFunction_=null===t?void 0:function(t){var e;if("function"==typeof t)e=t;else{var n;if(Array.isArray(t))n=t;else Lt("function"==typeof t.getZIndex,41),n=[t];e=function(){return n}}return e}(this.style_),this.changed()},e.prototype.getRenderMode=function(){return this.renderMode_},e}(Os);Ps.prototype.getSource;var Ls=Ps,Ds=function(t,e){return function(n,i){e(n,i,t)}};let ks=class extends ft{constructor(t,e){super(),this._selections=[],this._instantiated=!1,this._filter=!1,this._bigVectorLayerStyle=t,this._vectorSource=e}initialize(t){super.initialize(t),t=Po(t,Fo),this._options=t,this._dataSource=t.dataSource,0==this._options.lazyLoad&&this._instantiateLayer(),0!=this._options.visible&&this.setVisible(!0),this._clustered=!!t.clusteredByProperty||!!t.clustered}_instantiateLayer(){this._dataSource.onDataAdded(()=>{const t=this._options.styleFunction?this._options.styleFunction:this._bigVectorLayerStyle.styleFunction.bind(this._bigVectorLayerStyle,this);this._bigVectorLayerStyle.initializeForLayerContainer(this),this._vectorSource.initialize(this),this._layer=new Ls({source:this._vectorSource,style:t}),this.addLayer(this._layer)},!0),this._instantiated=!0,this._dataSource.fetchData()}getType(){return J.VectorLayer}getClusteredByProperty(){return this._options.clusteredByProperty}getLatProperty(){return this._options.latProperty}getLonProperty(){return this._options.lonProperty}getUseThread(){return this._options.useThread}getClusterRadius(){return this._options.clusterRadius}getLayerId(){return this._options.layerId}hasLonLatProperties(){return!!this._options.lonProperty&&!!this._options.latProperty}getStyle(){return this._options.style}getSelectedStyle(){return this._options.selectedStyle}getUnrollClustersAtZoom(){return this._options.unrollClustersAtZoom}getAddPointToGeometries(){return this._options.addPointToGeometries}getFeatureSource(){return this._vectorSource}setVisible(t){this._instantiated||1!=t||this._instantiateLayer(),this.setLayersVisible(t)}addSelection(t){t.condition=t.condition.split(" ").sort().join("-"),this._selections.push(t)}clearSelection2(){}featureSelection(t,e,n,i){const r=this._getMatchingSelections(e,t);if(0===r.length)return;const o=[n];this._processSelection(i,o,r)}getMultiSelector(t){const e=this._getMatchingSelections(t).filter(this._isMultiSelection);if(e.length>1)throw new Error("Conflicting selection specifications.");if(0!==e.length)return e[0].selector}_isMultiSelection(t){const{selector:e}=t;return"cluster"!=e&&"single"!=e}multiFeatureSelection(t,e,n,i){const r=this._getMatchingSelections(e,t);if(0===r.length)return;const o=this._vectorSource.getFeaturesInGeometry(n);this._processSelection(i,o,r)}_processSelection(t,e,n){this._featureListener&&this._featureListener.dispose();const i=this._createRecordKeysLookup(e),r=Object.keys(i),o=cd.get(lr.SelectionEvent);o.initialize(this._dataSource,e,r),n.filter(t=>!!t.callback).forEach(t=>t.callback(o)),t(e),this._featureListener=this._vectorSource.onFeatureChange(e=>{const n=e.filter(t=>this._featureContainsValidRecordKeys(i,t));n.length>0&&t(n)}),this._filterIfRequired(n,i)}_filterIfRequired(t,e){const{dataSource:n,layerId:i}=this._options;t.filter(t=>t.filter).length>0&&(n.applyKeyFilter(i,t=>e[t]),a.redrawAll())}_featureContainsValidRecordKeys(t,e){for(const n of e.getRecordKeys())if(t[n])return!0;return!1}_createRecordKeysLookup(t){const e={};for(const n of t)n.getRecordKeys().forEach(t=>e[t]=!0);return e}_getMatchingSelections(t,e){return this._selections.filter(n=>(!e||n.selector===e)&&n.condition===t)}clearSelection(){const{dataSource:t,layerId:e}=this._options;this._filter=!1,t.removeKeyFilter(e),this._featureListener&&this._featureListener.dispose()}getClusterExtent(t){const e=t.getRecordKeys(),n=[];return e.forEach(t=>{const e=this._dataSource.getDataContainer().getRecord(t),i=this._getCoordinatesFromRecordContainer(e);n.push(i)}),Yt(n)}_getCoordinatesFromRecordContainer(t){if(this.hasLonLatProperties()){return Xe([t.get(this._options.lonProperty),t.get(this._options.latProperty)])}if(t.hasGeometry())return t.getCoordinatesFromGeometry()}setClustered(t){this._clustered=t,this._vectorSource.refresh()}isClustered(){return this._clustered}getDataSource(){return this._dataSource}getAvailableUserConfigurations(){const t=[],e={callback:t=>this.setClustered(t),getCurrentConfiguration:()=>this.isClustered(),type:"toggle",name:"Clustered"};return t.push(e),t}getFeatureByKey(t){if(this._vectorSource)for(const e of this._vectorSource.getFeatures())if(e.getFeatureKey()===t)return e}};var Fs=ks=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)(),Ds(0,Object(nt.inject)(lr.BigVectorLayerStyleHandler)),Ds(1,Object(nt.inject)(lr.BigVectorSource))],ks);let Ns=class{initialize(t,e){this._validateAxesOptions(e),this._setupAxes(t,e)}_setupAxes(t,e){let{domId:n,elasticX:i,elasticY:r,showXAxis:o,showYAxis:s,xUnits:a,yUnits:c,xRange:l,xLabel:u,yLabel:h,yRange:d,brushOn:f,padding:p}=this._options=e;i=!!i||!l,r=!!r||!l,l=l||[0,1],d=d||[0,1];let g=this._getScale(a,l);const _=this._getScale(c,d);t.elasticX(i).elasticY(r).xAxisLabel(u).yAxisLabel(h).x(g).y(_).xUnits(this._getUnits(a)).brushOn(!!f),this._setupAxisTicks(t),p&&this._setupPadding(t,e),t.on("pretransition",()=>{0==s&&document.querySelector(`#${n} g.axis.y`).classList.add("invisible"),0==o&&document.querySelector(`#${n} g.axis.x`).classList.add("invisible")})}_setupAxisTicks(t){const{xAxisTickFormat:e,yAxisTickFormat:n,yTickFormatShort:i,xTickFormatShort:r,xAxisTicks:o,xUnits:s}=this._options;i?t.yAxis().tickFormat(sr.nFormatter):Q.isFunction(n)&&t.yAxis().tickFormat(n),r?t.xAxis().tickFormat(sr.nFormatter):Q.isFunction(n)&&t.xAxis().tickFormat(e),t.on("renderlet",this._onRenderLet.bind(this))}_onRenderLet(t){const e=this._getTransform();t.selectAll("g.x text").attr("text-anchor","end").attr("transform",`${e}`);const{xAxisTicks:n}=this._options;if(n){const e=t.x();let i=e.domain();if(this._getScaleLinear(e)){const[t,e]=i;i=Array.from({length:e-t+1},(e,n)=>n+t)}const r=Math.floor(i.length/n);let o=i.filter(function(t,e){return(e+1)%r==0});t.xAxis().tickValues(o)}}_getTransform(){const{rotateLabels:t,translateLabels:e}=this._options;let n="";if(e){const[t,i]=e;n+=`translate(${t},${i}) `}return t&&(n+="rotate(315)"),n}_validateAxesOptions(t){const{domId:e,xAxis:n,dataSource:i,dimension:r}=t;if(!n&&!r)throw((t,e,n)=>new Error(`Property ${t} is required for ${e} with id "${n}".`))("xAxis",tt.Module.CHART,e);i.onInfoAdded(n=>{let{xAxis:i,yAxis:r}=t;if(Q.isString(i)&&null==n.getIndexForColumn(i))throw ot(i,tt.Module.CHART,e);if(Q.isString(r)&&null==n.getIndexForColumn(r))throw ot(r,tt.Module.CHART,e)})}_getUnits(t){switch(t){case"days":return o.timeDays;case"weeks":return o.timeWeeks;case"months":return o.timeMonths;case"years":return o.timeYears;case"distinct":default:return a.units.integers}}_getScaleLinear(t){return"linear"===this._getScaleType(t)}_getScaleType(t){const e=t.copy();return void 0===e.domain([1,2]).range([1,2])(1.5)?"distinct":1.5===e.domain([1,2]).range([1,2]).invert(1.5)?"linear":e.domain([1,2]).range([1,2]).invert(1.5)instanceof Date?"time":void 0}_getScale(t,e){switch(this.getUnitsType(t)){case"date":return o.scaleTime().domain(e);case"distinct":default:return o.scaleLinear().domain(e)}}_setupPadding(t,e){const{padding:n}=e;let i=0,r=0;Q.arrayOf(Q.percentageOrNumber,n)&&2===n.length?(i=n[0],r=n[1]):(Q.isNumber(n)||Q.isString(n))&&(i=r=n),t.xAxisPadding(i).yAxisPadding(r)}getUnitsType(t){switch(t){case"days":case"weeks":case"months":case"years":return"date";case"distinct":return"distinct";default:return"linear"}}};var js=Ns=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)()],Ns);class Bs{constructor(t,e,n,i){this._active=!0,this._dispose=!1,this._executionOrder=0,this._event=e,this._observable=t,this._callback=n,this._executionOrder=i}start(){this._active=!0}pause(){this._active=!1}dispose(){this._dispose=!0}disposed(){return this._dispose}active(){return this._active}call(t){this._callback(t)}last(){return this._observable.last(this),this}event(){return this._event}executionOrder(){return this._executionOrder}}let zs=class{constructor(){this._observers={},this._lastMessage={}}on(t,e,n=0){const i=this._observers[t]||[],r=new Bs(this,t,e,n);return i.push(r),i.sort((t,e)=>t.executionOrder()-e.executionOrder()),this._observers[t]=i,r}trigger(t,e){const n=[],i=this._observers[t]||[];i.forEach(t=>{t.disposed()?n.push(t):t.active()&&t.call(e)}),this._observers[t]=i.filter(t=>n.indexOf(t)<0),this._lastMessage[t]=e}last(t){const e=t.event();this._lastMessage[e]&&t.call(this._lastMessage[e])}};var Us=zs=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)()],zs),Hs=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};let Ws=class extends Us{constructor(){super(...arguments),this._height=0,this._width=0,this._initialized=!1}initialize(t,e){this._chartContainerOptions=Po(e,Ho),this._chartReference=t,this._domId=e.domId,this._validateChartContainerOptions(e);let{width:n,height:i,responsive:r,resetButton:o,legend:a,cap:c,othersLabel:l,titleFunction:u,dataSource:h,labelFunction:d,transitionDuration:f}=e;t.width(n).height(i).transitionDuration(f),this._hasMargins(e)&&this._setMargins(t,e),0!=r&&this._initiateResponsiveListener(),o&&this._addResetButton(),c&&t.cap(c),l&&t.othersLabel(l),u&&t.title(u),a&&t.legend(s.legend()),d&&(t.label(t=>t.key==l?l:d(t.key)),a&&t.legend().legendText(t=>t.name==l?l:d(t.name))),this._mediator.subscribe(cr.FORCE_REDRAW,e=>{this.initialized()&&(h.getId()!==e.dataSourceId&&"*"!==e.dataSourceId||t.redraw())}),this._mediator.subscribe(cr.FORCE_RESET,this.resetChart.bind(this));const p=h.getId();t.on("filtered",this.callForceRedraw.bind(this,p)),t.on("postRedraw",this._callHideLegendItems.bind(this))}_callHideLegendItems(){const t=this._chartReference.legend();if(t){const e=t._g;if(e){const t=e.selectAll(".dc-legend-item"),n=this.shouldHideLegend.bind(this),i=[];t.each(function(){i.push(o.select(this).attr("transform"))}),t.each(function(t){n(t.name)?o.select(this).style("display","none"):o.select(this).attr("transform",i.shift())})}}}shouldHideLegend(t){return!1}callForceRedraw(t){this._mediator.publish(cr.FORCE_REDRAW,{dataSourceId:t})}initialized(t){if(void 0===t)return this._initialized;this._initialized=t}getChart(){return this._chartReference}lockY(t=!1){t?this._chartReference.elasticY(!1):this._chartReference.elasticY(this._chartContainerOptions.elasticY)}lockX(t=!1){t?this._chartReference.elasticX(!1):this._chartReference.elasticX(this._chartContainerOptions.elasticX)}lockAxes(t=!1){this.lockX(t),this.lockY(t)}lockYAt(t,e=0){this._chartReference.elasticY(!1),this._chartReference.y(o.scaleLinear().domain([e,t]))}_initiateResponsiveListener(){setInterval(this._resizeChartToFitParentIfNecessary.bind(this),100)}_resizeChartToFitParentIfNecessary(){if(!this._chartReference.dimension())return;const t=this._chartDomId?document.getElementById(this._chartDomId):document.getElementById(this._domId);if(!t)return;const e=t.parentElement,{paddingTop:n,paddingBottom:i,paddingLeft:r,paddingRight:o}=getComputedStyle(e),s=this._chartContainerOptions.height?this._chartContainerOptions.height:e.clientHeight-parseFloat(n)-parseFloat(i),a=this._chartContainerOptions.width?this._chartContainerOptions.width:e.clientWidth-parseFloat(r)-parseFloat(o);if(this._height==s&&this._width==a||!this._chartReference.dimension())return;Q.isResponsiveChart(this)&&this.onChartSizeChanged(a,s);const c=this._chartReference.transitionDuration();this._chartReference.transitionDuration(0).height(s).width(a).render(),this._chartReference.transitionDuration(c),this._height=s,this._width=a}_validateChartContainerOptions(t){const{dataSource:e}=t;if(!e)throw new Error("Property 'dataSource' required for all charts.")}_isValidMarginsArray(t){return!!t&&(t.constructor==[].constructor&&(4==t.length&&!!Q.arrayOf(Q.isNumber,t)))}_isValidMarginsObject(t){if(!t)return!1;if(t.constructor!={}.constructor)return!1;return!(Object.keys(t).filter(t=>!tt.Chart.MARGIN_TYPES.has(t)).length>0)&&void 0}_addResetButton(){const t=document.getElementById(this._domId);t.style.position="relative";const e=document.createElement("div");e.className="chart-reset-button",e.innerHTML='<i class="fas fa-undo-alt"></i>',e.onclick=this.resetChart.bind(this),t.appendChild(e)}resetChart(){this.initialized()&&(this._chartReference.filterAll(),this._mediator.publish(cr.FORCE_REDRAW,{dataSourceId:this._chartContainerOptions.dataSource.getId()}))}_hasMargins(t){const{margins:e,marginTop:n,marginRight:i,marginBottom:r,marginLeft:o}=t;return e||n||i||r||o}getMargins(t){let{margins:e,marginTop:n,marginRight:i,marginBottom:r,marginLeft:o}=t,s={top:0,right:0,bottom:0,left:0};if(this._isValidMarginsArray(e)){const[t,n,i,r]=e;s={top:t,right:n,bottom:i,left:r}}else this._isValidMarginsObject(e)&&(s=Object.assign(s,e));return n&&(s.top=n),i&&(s.right=i),r&&(s.bottom=r),o&&(s.left=o),s}_setMargins(t,e){const n=this.getMargins(e);t.margins(n)}getID(){return this._chartContainerOptions.domId}onAddedToWidgetContainer(t){this._resizeChartToFitParentIfNecessary()}onWidgetContainerSizeChange(t){this._resizeChartToFitParentIfNecessary()}getHTMLElement(){return document.getElementById(this._domId)}availableOptions(){return[{class:"sintium-reset-chart-button",icon:"fas fa-redo",callback:this.resetChart.bind(this)}]}getWidth(){return this._width}getHeight(){return this._height}createChartHTMLElement(t){const{domId:e}=t;this._chartDomId=`sintium-chart-${e}`;const n=document.getElementById(e);return n.classList.add("sintium-chart"),n.innerHTML=`\n            <div class="sintium-chart-container">\n                <div id="${this._chartDomId}">\n                \n                </div>\n            </div>\n            <div class="sintium-chart-legend">\n            </div>\n        `,this._chartDomId}};Hs([Object(nt.inject)(lr.Mediator)],Ws.prototype,"_mediator",void 0);var Gs,Vs=Ws=Hs([Object(nt.injectable)()],Ws),Ys=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};let qs=Gs=class extends Vs{constructor(){super(...arguments),this._initializedStackValues=[]}initializeStackable(t,e){this._optionsStackable=Po(e,is),this._chart=t(`#${this._optionsStackable.domId}`),super.initialize(this._chart,this._optionsStackable),this._chartAxesHandler.initialize(this._chart,this._optionsStackable),this._initializeEventListener()}shouldHideLegend(t){return 0===this._group.all().map(e=>e.value[t]).filter(t=>!!t).length}lockY(t=!1){t?this._chart.elasticY(!1):this._chart.elasticY(this._optionsStackable.elasticY)}lockYAt(t,e=0){this._chart.elasticY(!1),this._chart.y(o.scaleLinear().domain([e,t]))}_initializeEventListener(){const{dataSource:t}=this._optionsStackable;t.fetchData(t=>{this.initialized()||this._initializeChart(this._chart,t)}),t.onDataAdded(t=>{this.initialized()?this._optionsStackable.stackColumn&&this.updateStacks():this._initializeChart(this._chart,t)})}_initializeChart(t,e){const{stackColumn:n,xUnits:i,brushOn:r,xAxisTickFormat:o,dimension:s}=this._optionsStackable;this._dimension=s||this._createDimension(e),this._group=this._createGroup(e);const a="distinct"===i,c=!!n;t.dimension(this._dimension).group(this._group),a&&this._setupChartForLinearToOrdinal(t,this._group,r,c),c&&this.updateStacks(),o&&this._setXAxisTickFormat(t,this._group,a),this.onDataAdded(t,this._group),this.initialized(!0),t.render()}_setXAxisTickFormat(t,e,n){const{xAxisTickFormat:i,dataSource:r}=this._optionsStackable;n&&r.onDataAdded(()=>{const n=e.all().length;t.xAxis().tickValues([...Array(n).keys()])}),t.xAxis().tickFormat(t=>(t=n?e.int2ord(t):t,i(t)))}_setupChartForLinearToOrdinal(t,e,n,i){this._chart.xUnits(a.units.ordinal).keyAccessor(t=>e.ord2int(t.key)),t.xAxis().tickFormat(function(t){return e.int2ord(t)}),n&&t.filterHandler(function(t,n){if(!n||!n.length)return t.filter(null),n;console.assert(1===n.length),console.assert("RangedFilter"===n[0].filterType);const i=e.all().filter(function(t){const i=e.ord2int(t.key);return n[0][0]<=i&&i<n[0][1]}).map(function(t){return t.key});return t.filterFunction(function(t){const e=Gs.splitKey(t)[0];return i.includes(e)}),n})}updateStacks(){if(!this._group)return;this._getStackValuesFromDimension().forEach(t=>{this._initializedStackValues.indexOf(t)<0&&(0===this._initializedStackValues.length?this._chart.group(this._group,t,Gs.sel_stack(t)):this._chart.stack(this._group,t,Gs.sel_stack(t)),this._initializedStackValues.push(t))})}_getStackValuesFromDimension(){return this._dimension?Array.from(new Set(this._dimension.group().all().map(t=>Gs.splitKey(t.key)[1]))).sort():[]}_createDimension(t){const{stackColumn:e,xAxis:n,xUnits:i,xAxisReturnsArray:r}=this._optionsStackable,o=this._chartAxesHandler.getUnitsType(i),s=t.getCrossfilter();return e?Q.isFunction(n)?s.dimension(i=>{const r=t.wrapRecord(i);return Gs.multiKey(n(r),r.get(e))},r):s.dimension(i=>{const r=t.wrapRecord(i);return Gs.multiKey(r.get(n),r.get(e))},r):this._optionsStackable.dataSource.getDimension(n,o,r)}_createGroup(t){const{stackColumn:e,yAxis:n,xUnits:i}=this._optionsStackable;let r;return r=Q.isFunction(n)?this._dimension.group().reduceSum(e=>{const i=t.wrapRecord(e);return n(i)}):Q.isString(n)?this._dimension.group().reduceSum(e=>t.wrapRecord(e).get(n)):this._dimension.group().reduceCount(),e&&(r=Gs.stackSecond(r)),"distinct"===i&&(r=this._ordinal_to_linear_group(r)),r}static sel_stack(t){return function(e){return e.value[t]}}static multiKey(t,e){return t+":-:"+e}static splitKey(t){return t.split(":-:")}static stackSecond(t){return{all:function(){const e=t.all(),n={};return e.forEach(function(t){var e=Gs.splitKey(t.key);n[e[0]]=n[e[0]]||{},n[e[0]][e[1]]=t.value}),Object.keys(n).map(function(t){return{key:t,value:n[t]}})}}}_sort_group(t,e){return{all:function(){return t.all().sort(e)}}}_ordinal_to_linear_group(t){let e,n;return{all:function(){const i=t.all();return e={},n=[],i.forEach(function(t,i){e[t.key]=i,n[i]=t.key}),i},ord2int:function(t){return e||this.all(),e[t]},int2ord:function(t){return n||this.all(),n[t]}}}};Ys([Object(nt.inject)(lr.ChartAxesHandler)],qs.prototype,"_chartAxesHandler",void 0);var Xs=qs=Gs=Ys([Object(nt.injectable)()],qs);let Ks=class extends Xs{constructor(){super(...arguments),this._stackCellFilteredLookup={}}initialize(t){this.initializeStackable(t.useCanvas?a.Canvas.barChart:a.barChart,t),this._options=t}onDataAdded(t,e){const{centerBar:n,stackColumn:i,brushOn:r,xUnits:o}=this._options;n&&t.centerBar(!0),i?(this.updateStacks(),r||this.setupStackedBarChartClickEvents(t,e,"distinct"===o)):r||this.setupBarChartClickEvents(t)}setupBarChartClickEvents(t){const e=[];t.filterHandler(function(){});const n=()=>this.trigger("filtered",{chart:t});t.fadeDeselectedArea=function(n){const i=t.chartBodyG().selectAll("rect.bar");e.length?(i.classed(a.constants.SELECTED_CLASS,function(t){return e.indexOf(t.data.key)>=0}),i.classed(a.constants.DESELECTED_CLASS,function(t){return e.indexOf(t.data.key)<0})):(i.classed(a.constants.SELECTED_CLASS,!1),i.classed(a.constants.DESELECTED_CLASS,!1))},t.on("pretransition",function(t){t.selectAll("rect.bar").on("click",function(i){const r=e.indexOf(i.data.key);r>=0?e.splice(r,1):e.push(i.data.key),e.length?(t.filter(function(t){return e.indexOf(t)>=0}),n()):(t.filter(null),n()),t.redrawGroup()})})}setupStackedBarChartClickEvents(t,e,n){const{xUnits:i,filterOnXAxisClick:r,filterOnClick:o}=this._options,s=this._filterStackedChart,c=this._stackCellFilteredLookup,l=()=>this.trigger("filtered",{chart:t});t.on("pretransition",function(t){o||t.selectAll("rect.bar").on("click",function(){}),o&&t.selectAll("rect.bar").classed("deselected",function(i){const r=n?e.int2ord(i.x):i.x,o=Xs.multiKey(r,i.layer);return t.filter()&&-1===t.filters().indexOf(o)}).on("click",function(i){const r=n?e.int2ord(i.x):i.x,o=Xs.multiKey(r,i.layer);c[o]=!c[o],t.filter(Xs.multiKey(r,i.layer)),l(),a.redrawAll()}),o&&t.selectAll(".dc-legend-item").on("click",function(t){const n=e.all().map(e=>Xs.multiKey(e.key,t.name));s(t.chart,c,n),l(),a.redrawAll()}),"distinct"===i&&(r||o)&&t.select(".axis.x").selectAll(".tick text").style("pointer-events","auto").style("cursor","pointer").on("click",function(n){const{key:i,value:r}=e.all()[n],o=Object.keys(r).map(t=>Xs.multiKey(i,t));s(t,c,o),l(),a.redrawAll()})})}_filterStackedChart(t,e,n){const i=n.filter(t=>!0!==e[t]);0===i.length?(t.filter([n]),n.forEach(t=>e[t]=!1)):(t.filter([i]),i.forEach(t=>e[t]=!0)),a.redrawAll()}availableOptions(){return[{icon:"fas fa-redo",callback:()=>{this.resetChart()}}]}};var $s=Ks=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)()],Ks);class Zs extends Vs{initialize(t){this._validatePieContainerOptions(t),this._chart=a.pieChart(`#${t.domId}`),this._options=this._removeMarginOptions(t),this._options=Po(this._options,Jo),super.initialize(this._chart,t),this._initializeEventListeners(this._chart,t)}onChartSizeChanged(t,e){const{top:n,right:i,bottom:r,left:o}=this._margins,s=(o+t-i)/2,a=(n+e-r)/2,c=Math.min((t-i-o)/2,(e-r-n)/2);this._chart.cx(s).cy(a).radius(c)}_removeMarginOptions(t){return this._margins=this.getMargins(t),t.margins=t.marginTop=t.marginRight=t.marginBottom=t.marginLeft=null,t}_initializeEventListeners(t,e){const{dataSource:n}=e;n.onDataAdded(n=>{this.initialized()?this._refreshColors(t,!0):this._initializeChart(t,e)}),t.on("renderlet",this._updateLabels.bind(this)),t.on("filtered",this._updateLabels.bind(this)),n.fetchData()}_updateLabels(){const t=o.select(this.getHTMLElement());t.selectAll("g.pie-slice-group g.pie-slice path").each(function(e){const n=o.select(this).attr("fill");t.select(`g.pie-label-group .pie-label._${e.index}`).node().classList.toggle("sintium-black-label",rr()(n).luminance()>.6)})}_initializeChart(t,e){const{dataSource:n}=e,i=n.getDataContainer();this._validateColumns(i,e);const{keyColumn:r,innerRadius:o,labels:s,externalLabels:a,valueColumn:c}=e,l=n.getDimension(r);let u=c?n.createGroupByReduceSum(l,c):l.group();t.dimension(l).group(u),o&&t.innerRadius(o),a&&t.externalLabels(30),!1===s&&document.getElementById(e.domId).classList.add("no-labels"),this._setupColors(),this._refreshColors(t,!1),t.render(),this.initialized(!0)}_setupColors(){const{dataSource:t,keyColumn:e,colorScheme:n}=this._options;this._colorRepository.setColorSchemeForColumn(t,e,n)}_refreshColors(t,e){const{dataSource:n,keyColumn:i,cap:r,othersLabel:o}=this._options;r?this._colorRepository.setColorsForColumnCapped(n,i,o):this._colorRepository.setColorsForColumn(n,i),t.colors(t=>"empty"===t?"lightgray":this._colorRepository.getColorForColumnValue(n,i,t)),e&&t.render()}_validatePieContainerOptions(t){const{keyColumn:e}=t;if(!e)throw new Error("Property 'keyColumn' required for pie chart.")}_validateColumns(t,e){const n=t.getLabels(),{keyColumn:i,valueColumn:r}=e;if(n.indexOf(i)<0)throw new Error(`Column with label '${i}' does not exist.`);if(r&&n.indexOf(r)<0)throw new Error(`Column with label '${i}' does not exist.`)}}(function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);o>3&&s&&Object.defineProperty(e,n,s)})([Object(nt.inject)(lr.ColorRepository)],Zs.prototype,"_colorRepository",void 0);let Js=class{constructor(){this._chartMarginHandler=cd.get(lr.ChartMarginHandler)}initialize(t){this._baseRadialChartOptions=t,this._margins=this._chartMarginHandler.getMargins(t),this._initializeCanvas(),0!=t.responsive&&this._initiateResponsiveListener()}_initializeCanvas(){this._canvas=document.createElement("canvas"),this._context=this._canvas.getContext("2d");const t=document.getElementById(this._baseRadialChartOptions.domId);t.classList.add("sintium-chart-radial"),t.appendChild(this._canvas),this._height=t.offsetHeight,this._width=t.offsetWidth,this._resizeChart(this._height,this._width)}drawSlice(t,e,n,i,r=0,o=0,s=0){const a=this.getCenterX()+o,c=this.getCenterY()+s;this._context.lineWidth=r,this._context.strokeStyle=rr()(n).darken().hex(),this._context.fillStyle=n,this._context.beginPath(),this._context.moveTo(a,c),this._context.arc(a,c,i-r/2,t,e),this._context.closePath(),this._context.fill(),this._context.stroke()}drawCircle(t,e=null,n=1){if((e=e||this.getRadius())>0){const i=this.getCenterX(),r=this.getCenterY();this._context.lineWidth=n,this._context.strokeStyle=t,this._context.beginPath(),this._context.arc(i,r,e-n/2,0,2*Math.PI),this._context.closePath(),this._context.stroke()}}drawRay(t,e,n=null,i=1){const r=this.getCenterX(),o=this.getCenterY(),s=r+n*Math.cos(e),a=o+n*Math.sin(e);this._context.lineWidth=i,this._context.beginPath(),this._context.moveTo(r,o),this._context.lineTo(s,a),this._context.stroke()}drawTextAtEndOfRay(t,e,n,i,r,o=15,s=0,a=0){const c=this.getCenterX(),l=this.getCenterY(),u=c+e*Math.cos(n),h=l+e*Math.sin(n);this._context.save(),this._context.fillStyle=t,this._context.translate(u,h),this._context.font=`${o}px Arial`,this._context.rotate(i),this._context.textAlign="center",this._context.fillText(r,s,a),this._context.restore()}_initiateResponsiveListener(){setInterval(this._resizeChartToFitParentIfNecessary.bind(this),20)}_resizeChartToFitParentIfNecessary(){const{domId:t,height:e,width:n}=this._baseRadialChartOptions,i=document.getElementById(t);if(!i)return;const r=i.parentElement,{paddingTop:o,paddingBottom:s,paddingLeft:a,paddingRight:c}=getComputedStyle(r),l=e||r.clientHeight-parseFloat(o)-parseFloat(s),u=n||r.clientWidth-parseFloat(a)-parseFloat(c);this.getHeight()==l&&this.getWidth()==u||(this._height=l,this._width=u,this._resizeChart(l,u),Q.isResponsiveChart(this)&&this.onChartSizeChanged(n,e))}getRadius(){return this._radius}_resizeChart(t,e){this._canvas.setAttribute("height",`${t}`),this._canvas.setAttribute("width",`${e}`);const{centerX:n,centerY:i,radius:r}=this._chartMarginHandler.calculateRadialSpecs(this._margins,t,e);this._centerX=n,this._centerY=i,this._radius=r}getWidth(){return this._width}getHeight(){return this._height}getCenterX(){return this._centerX}getCenterY(){return this._centerY}clearContext(){this._context.clearRect(0,0,this._width,this._height)}};var Qs,ta=Js=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)()],Js);!function(t){t.Count="count",t.Sum="sum"}(Qs||(Qs={}));var ea=Qs,na=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},ia=function(t,e){return function(n,i){e(n,i,t)}};const{LABELS:ra,BASE_CHART_COLOR:oa,SLICE_NUMBER:sa}=tt.WindRoseChart;let aa=class extends ta{constructor(t){super(),this._colorRepository=t}initialize(t){t=Po(t,Wo),super.initialize(t),this._options=t,this._bucketLabels=this._generateBucketLabels(),this._bucketColors=this._colorRepository.getColorsFromScheme(bt,this._bucketLabels.length),this._drawEmptyChart(),this._setupDataListeners(),t.legend&&this._addLegend(this._bucketLabels,this._bucketColors)}_setupDataListeners(){const{dataSource:t}=this._options;t.onDataAdded(t=>{this._generateKDTree(t),this._generateWindRoseData(),this._hasData=!0,this._redrawChart()}),t.onDataFiltered(t=>{this._hasData&&(this._generateWindRoseData(),this._redrawChart())}),t.fetchData()}_generateBucketLabels(){const{buckets:t}=this._options,e=[];for(let n=1;n<t.length;n++){if(t[n]==1/0){e.push(`${t[t.length-2]}+`);break}e.push(`${t[n-1]}-${t[n]}`)}return e}_generateKDTree(t){const e=t.getData(),{latColumn:n,lonColumn:i}=this._options;this._kdTree=new br(e,e=>e[t.getIndexForColumn(n)],e=>e[t.getIndexForColumn(i)],64,Int32Array)}_generateWindRoseData(){const{directionColumn:t,valueColumn:e,countZeros:n,dataSource:i}=this._options,r=i.getDataContainer(),o=r.getCrossfilter();this._windRoseData=this._generateEmptyData();const s=this._getRecordIndices(),a=[];for(const i of s){const s=r.getRecord(i);if(o.isElementFiltered(s.key())){const r=s.get(t),o=s.get(e),c=this._getRayIndex(r);!isNaN(c)&&(o>0||n)?this._increaseBucketValue(c,o):0!==o&&a.push(i)}}a.length>0&&console.warn(`Following records dropped from WindRose because data not as expected: ${a.join(", ")}`),this._windRoseData.maxRayCount=Math.max(...this._windRoseData.rayCount)}_getRecordIndices(){if(this.hasRange()){const{minLat:t,minLon:e,maxLat:n,maxLon:i}=this._range;return this._kdTree.range(t,e,n,i)}return[...this._kdTree.points.keys()]}_getRayIndex(t){let e=Math.floor(t/(360/sa));return e===sa?0:e}_increaseBucketValue(t,e){let n=this._options.reduce==ea.Sum?e:1;const i=this._getBucketLabel(e);this._windRoseData.rays[t][i]=(this._windRoseData.rays[t][i]||0)+n,this._windRoseData.totalCount+=n,this._windRoseData.rayCount[t]+=n}_getBucketLabel(t){let e=0;for(let n=1;n<this._options.buckets.length;n++){if(t>this._options.buckets[n-1]&&t<=this._options.buckets[n])return this._bucketLabels[e];e++}}_generateEmptyData(){const t={rays:[],rayCount:new Array(sa).fill(0),maxRayCount:0,totalCount:0};for(const e in ra){const e={};this._bucketLabels.forEach(t=>e[t]=0),t.rays.push(e)}return t}_redrawChart(){this._hasData&&(this.clearContext(),this._drawChartBase(),this._drawConcentricCircles(),this._drawRays())}_drawRays(){for(let t=this._bucketLabels.length-1;t>=0;t--){const e=this._bucketColors[t];let n=Math.PI/2-Math.PI/sa;for(const i of this._windRoseData.rays){const r=n+2*Math.PI/sa,o=this._getBucketRadius(i,t);this.drawSlice(n,r,e,o,0),n=r}}}_getBucketRadius(t,e){let n=0;for(let i=0;i<this._bucketLabels.length;i++){if(n+=t[this._bucketLabels[i]]/this._windRoseData.maxRayCount*this._getChartRadius(),i==e)return Math.max(n,0)}}_drawEmptyChart(){this.clearContext(),this._drawChartBase(),this._drawConcentricCircles()}_drawChartBase(){const t=this._getChartRadius(),e=this._getTextRadius();this.drawCircle(oa,t);for(let e=0;e<sa;e++){const n=-Math.PI/2+2*e*Math.PI/sa;this.drawRay(oa,n,t)}for(const t of[0,4,8,12]){const n=-Math.PI/2+2*t*Math.PI/sa;this.drawTextAtEndOfRay(oa,e,n,0,ra[t],15,0,4)}}_drawConcentricCircles(t=4){const e=this._getChartRadius()/t;for(let n=1;n<t;n++){const t=e*n;this.drawCircle(oa,t)}}_addLegend(t,e){const n=document.createElement("div"),i=this._shouldPositionTop()?"top":"bottom",r=this._shouldPositionLeft()?"left":"right";n.classList.add("sintium-chart-wind-rose-legend",i,r),this.getHTMLElement().appendChild(n);for(let i=0;i<t.length;i++){const r=t[i],o=e[i];this._addLegendItem(n,r,o)}}_addLegendItem(t,e,n){const i=document.createElement("div");i.classList.add("sintium-chart-wind-rose-legend-item"),i.innerHTML=`\n            <div class="sintium-chart-wind-rose-legend-item-color" style="background: ${n}"></div>\n            <div class="sintium-chart-wind-rose-legend-item-label">${e}</div>\n        `,t.appendChild(i)}_shouldPositionTop(){return this._options.legendPosition==Mt.TOP_LEFT||this._options.legendPosition==Mt.TOP_RIGHT}_shouldPositionLeft(){return this._options.legendPosition==Mt.TOP_LEFT||this._options.legendPosition==Mt.BOTTOM_LEFT}setRange(t,e,n,i){this._range={minLat:t,minLon:e,maxLat:n,maxLon:i},this._hasData&&(this._generateWindRoseData(),this._redrawChart())}hasRange(){return!!this._range}_getChartRadius(){return this.getRadius()-25}_getTextRadius(){return this.getRadius()-10}getHTMLElement(){return document.getElementById(this._options.domId)}getID(){return this._options.domId}onChartSizeChanged(t,e){this._hasData?this._redrawChart():this._drawEmptyChart()}};var ca=aa=na([Object(nt.injectable)(),ia(0,Object(nt.inject)(lr.ColorRepository))],aa);var la=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},ua=function(t,e){return function(n,i){e(n,i,t)}};let ha=class extends Vs{constructor(t){super(),this._chartAxesHandler=t}initialize(t){const e=t.domId||q.generateEmptyWidgetDomId();let n=a.scatterPlot(`#${e}`);this._validateScatterPlotOptions(t),super.initialize(n,t),this._chartAxesHandler.initialize(n,t),this._initializeChart(n,t)}_initializeChart(t,e){const{dataSource:n,xAxis:i,yAxis:r,xUnits:o,yUnits:s}=e;n.onDataAdded(()=>{const e=this._chartAxesHandler.getUnitsType(o),a=this._chartAxesHandler.getUnitsType(s),c=n.get2DDimension(i,r,e,a),l=c.group();t.useCanvas(!0).dimension(c).group(l).render()},!0),n.fetchData()}_validateScatterPlotOptions(t){const{yAxis:e}=t;if(!e)throw new Error("Property 'yAxis' required for scatter plot.")}};la([Object(nt.inject)(lr.ChartAxesHandler)],ha.prototype,"_chartAxesHandler",void 0);var da=ha=la([ua(0,Object(nt.inject)(lr.ChartAxesHandler))],ha),fa=function(t,e){return function(n,i){e(n,i,t)}};let pa=class{constructor(t){this._colorRepository=t}initialize(t){this._dataSource=t.dataSource,this._column=t.keyColumn,this._dataSource.onDataAdded(()=>{t.colorScheme&&this._colorRepository.setColorSchemeForColumn(this._dataSource,this._column,t.colorScheme),this._colorRepository.setColorsForColumn(this._dataSource,this._column)})}onStyleChange(t){this._colorRepository.onChange(()=>{const e=this._colorRepository.getColumnValues(this._dataSource,this._column),n=[],i={};for(const t of e){i[t]=n.length;const e=this._colorRepository.getColorForColumnValue(this._dataSource,this._column,t);n.push(e)}t(n,i)})}};var ga=pa=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)(),fa(0,Object(nt.inject)(lr.ColorRepository))],pa);let _a=class{constructor(){this._clusterStyleCache={selected:{},normal:{}}}getStyle(){}setStyle(){}getClusterStyle(t,e,n){return(n?this._clusterStyleCache.selected:this._clusterStyleCache.normal)[this._makeKey(t,e)]}setClusterStyle(t,e,n,i){(n?this._clusterStyleCache.selected:this._clusterStyleCache.normal)[t+(e?`-${e}`:"")]=i}_makeKey(t,e){return`${t}-${e}`}};var ma=_a=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)()],_a),ya="add",va="remove",ba="length",Ca=function(t){function e(e,n){t.call(this,e),this.element=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(I),wa=function(t){function e(e,n){t.call(this);var i=n||{};if(this.unique_=!!i.unique,this.array_=e||[],this.unique_)for(var r=0,o=this.array_.length;r<o;++r)this.assertUnique_(this.array_[r],r);this.updateLength_()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},e.prototype.extend=function(t){for(var e=0,n=t.length;e<n;++e)this.push(t[e]);return this},e.prototype.forEach=function(t){for(var e=this.array_,n=0,i=e.length;n<i;++n)t(e[n],n,e)},e.prototype.getArray=function(){return this.array_},e.prototype.item=function(t){return this.array_[t]},e.prototype.getLength=function(){return this.get(ba)},e.prototype.insertAt=function(t,e){this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new Ca(ya,e))},e.prototype.pop=function(){return this.removeAt(this.getLength()-1)},e.prototype.push=function(t){this.unique_&&this.assertUnique_(t);var e=this.getLength();return this.insertAt(e,t),this.getLength()},e.prototype.remove=function(t){for(var e=this.array_,n=0,i=e.length;n<i;++n)if(e[n]===t)return this.removeAt(n)},e.prototype.removeAt=function(t){var e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new Ca(va,e)),e},e.prototype.setAt=function(t,e){var n=this.getLength();if(t<n){this.unique_&&this.assertUnique_(e,t);var i=this.array_[t];this.array_[t]=e,this.dispatchEvent(new Ca(va,i)),this.dispatchEvent(new Ca(ya,e))}else{for(var r=n;r<t;++r)this.insertAt(r,void 0);this.insertAt(t,e)}},e.prototype.updateLength_=function(){this.set(ba,this.array_.length)},e.prototype.assertUnique_=function(t,e){for(var n=0,i=this.array_.length;n<i;++n)if(this.array_[n]===t&&n!==e)throw new Pt(58)},e}(U),Ea={ARRAY_BUFFER:"arraybuffer",JSON:"json",TEXT:"text",XML:"xml"};function Ta(t,e){return function(t,e,n,i){return function(r,o,s){var a=new XMLHttpRequest;a.open("GET","function"==typeof t?t(r,o,s):t,!0),e.getType()==Ea.ARRAY_BUFFER&&(a.responseType="arraybuffer"),a.onload=function(t){if(!a.status||a.status>=200&&a.status<300){var r,o=e.getType();o==Ea.JSON||o==Ea.TEXT?r=a.responseText:o==Ea.XML?(r=a.responseXML)||(r=(new DOMParser).parseFromString(a.responseText,"application/xml")):o==Ea.ARRAY_BUFFER&&(r=a.response),r?n.call(this,e.readFeatures(r,{featureProjection:s}),e.readProjection(r),e.getLastExtent()):i.call(this)}else i.call(this)}.bind(this),a.onerror=function(){i.call(this)}.bind(this),a.send()}}(t,e,function(t,e){"function"==typeof this.addFeatures&&this.addFeatures(t)},l)}function Sa(t,e){return[[-1/0,-1/0,1/0,1/0]]}function xa(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null}var Ra=function(t){function e(e){t.call(this),this.projection_=Ge(e.projection),this.attributions_=xa(e.attributions),this.attributionsCollapsible_=void 0===e.attributionsCollapsible||e.attributionsCollapsible,this.loading=!1,this.state_=void 0!==e.state?e.state:As.READY,this.wrapX_=void 0!==e.wrapX&&e.wrapX}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getAttributions=function(){return this.attributions_},e.prototype.getAttributionsCollapsible=function(){return this.attributionsCollapsible_},e.prototype.getProjection=function(){return this.projection_},e.prototype.getResolutions=function(){return h()},e.prototype.getState=function(){return this.state_},e.prototype.getWrapX=function(){return this.wrapX_},e.prototype.refresh=function(){this.changed()},e.prototype.setAttributions=function(t){this.attributions_=xa(t),this.changed()},e.prototype.setState=function(t){this.state_=t,this.changed()},e}(U),Aa="addfeature",Oa="changefeature",Ia="clear",Ma="removefeature",Pa=n(53),La=n.n(Pa),Da=function(t){this.rbush_=La()(t,void 0),this.items_={}};Da.prototype.insert=function(t,e){var n={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(n),this.items_[f(e)]=n},Da.prototype.load=function(t,e){for(var n=new Array(e.length),i=0,r=e.length;i<r;i++){var o=t[i],s=e[i],a={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:s};n[i]=a,this.items_[f(s)]=a}this.rbush_.load(n)},Da.prototype.remove=function(t){var e=f(t),n=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(n)},Da.prototype.update=function(t,e){var n=this.items_[f(e)];ee([n.minX,n.minY,n.maxX,n.maxY],t)||(this.remove(e),this.insert(t,e))},Da.prototype.getAll=function(){return this.rbush_.all().map(function(t){return t.value})},Da.prototype.getInExtent=function(t){var e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map(function(t){return t.value})},Da.prototype.forEach=function(t,e){return this.forEach_(this.getAll(),t,e)},Da.prototype.forEachInExtent=function(t,e,n){return this.forEach_(this.getInExtent(t),e,n)},Da.prototype.forEach_=function(t,e,n){for(var i,r=0,o=t.length;r<o;r++)if(i=e.call(n,t[r]))return i;return i},Da.prototype.isEmpty=function(){return y(this.items_)},Da.prototype.clear=function(){this.rbush_.clear(),this.items_={}},Da.prototype.getExtent=function(t){var e=this.rbush_.toJSON();return Qt(e.minX,e.minY,e.maxX,e.maxY,t)},Da.prototype.concat=function(t){for(var e in this.rbush_.load(t.rbush_.all()),t.items_)this.items_[e]=t.items_[e]};var ka=Da,Fa=function(t){function e(e,n){t.call(this,e),this.feature=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(I),Na=function(t){function e(e){var n=e||{};t.call(this,{attributions:n.attributions,projection:void 0,state:As.READY,wrapX:void 0===n.wrapX||n.wrapX}),this.loader_=l,this.format_=n.format,this.overlaps_=null==n.overlaps||n.overlaps,this.url_=n.url,void 0!==n.loader?this.loader_=n.loader:void 0!==this.url_&&(Lt(this.format_,7),this.loader_=Ta(this.url_,this.format_)),this.strategy_=void 0!==n.strategy?n.strategy:Sa;var i,r,o=void 0===n.useSpatialIndex||n.useSpatialIndex;this.featuresRtree_=o?new ka:null,this.loadedExtentsRtree_=new ka,this.nullGeometryFeatures_={},this.idIndex_={},this.undefIdIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null,Array.isArray(n.features)?r=n.features:n.features&&(r=(i=n.features).getArray()),o||void 0!==i||(i=new wa(r)),void 0!==r&&this.addFeaturesInternal(r),void 0!==i&&this.bindFeaturesCollection_(i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addFeature=function(t){this.addFeatureInternal(t),this.changed()},e.prototype.addFeatureInternal=function(t){var e=f(t);if(this.addToIndex_(e,t)){this.setupChangeEvents_(e,t);var n=t.getGeometry();if(n){var i=n.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(i,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new Fa(Aa,t))}},e.prototype.setupChangeEvents_=function(t,e){this.featureChangeKeys_[t]=[E(e,L,this.handleFeatureChange_,this),E(e,g,this.handleFeatureChange_,this)]},e.prototype.addToIndex_=function(t,e){var n=!0,i=e.getId();return void 0!==i?i.toString()in this.idIndex_?n=!1:this.idIndex_[i.toString()]=e:(Lt(!(t in this.undefIdIndex_),30),this.undefIdIndex_[t]=e),n},e.prototype.addFeatures=function(t){this.addFeaturesInternal(t),this.changed()},e.prototype.addFeaturesInternal=function(t){for(var e=[],n=[],i=[],r=0,o=t.length;r<o;r++){var s=t[r],a=f(s);this.addToIndex_(a,s)&&n.push(s)}for(var c=0,l=n.length;c<l;c++){var u=n[c],h=f(u);this.setupChangeEvents_(h,u);var d=u.getGeometry();if(d){var p=d.getExtent();e.push(p),i.push(u)}else this.nullGeometryFeatures_[h]=u}this.featuresRtree_&&this.featuresRtree_.load(e,i);for(var g=0,_=n.length;g<_;g++)this.dispatchEvent(new Fa(Aa,n[g]))},e.prototype.bindFeaturesCollection_=function(t){var e=!1;E(this,Aa,function(n){e||(e=!0,t.push(n.feature),e=!1)}),E(this,Ma,function(n){e||(e=!0,t.remove(n.feature),e=!1)}),E(t,ya,function(t){e||(e=!0,this.addFeature(t.element),e=!1)},this),E(t,va,function(t){e||(e=!0,this.removeFeature(t.element),e=!1)},this),this.featuresCollection_=t},e.prototype.clear=function(t){if(t){for(var e in this.featureChangeKeys_){this.featureChangeKeys_[e].forEach(x)}this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.undefIdIndex_={})}else if(this.featuresRtree_)for(var n in this.featuresRtree_.forEach(this.removeFeatureInternal,this),this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[n]);this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.loadedExtentsRtree_.clear(),this.nullGeometryFeatures_={};var i=new Fa(Ia);this.dispatchEvent(i),this.changed()},e.prototype.forEachFeature=function(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)},e.prototype.forEachFeatureAtCoordinateDirect=function(t,e){var n=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(n,function(n){return n.getGeometry().intersectsCoordinate(t)?e(n):void 0})},e.prototype.forEachFeatureInExtent=function(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)},e.prototype.forEachFeatureIntersectingExtent=function(t,e){return this.forEachFeatureInExtent(t,function(n){if(n.getGeometry().intersectsExtent(t)){var i=e(n);if(i)return i}})},e.prototype.getFeaturesCollection=function(){return this.featuresCollection_},e.prototype.getFeatures=function(){var t;return this.featuresCollection_?t=this.featuresCollection_.getArray():this.featuresRtree_&&(t=this.featuresRtree_.getAll(),y(this.nullGeometryFeatures_)||sn(t,function(t){var e=[];for(var n in t)e.push(t[n]);return e}(this.nullGeometryFeatures_))),t},e.prototype.getFeaturesAtCoordinate=function(t){var e=[];return this.forEachFeatureAtCoordinateDirect(t,function(t){e.push(t)}),e},e.prototype.getFeaturesInExtent=function(t){return this.featuresRtree_.getInExtent(t)},e.prototype.getClosestFeatureToCoordinate=function(t,e){var n=t[0],i=t[1],r=null,o=[NaN,NaN],s=1/0,a=[-1/0,-1/0,1/0,1/0],l=e||c;return this.featuresRtree_.forEachInExtent(a,function(t){if(l(t)){var e=t.getGeometry(),c=s;if((s=e.closestPointXY(n,i,o,s))<c){r=t;var u=Math.sqrt(s);a[0]=n-u,a[1]=i-u,a[2]=n+u,a[3]=i+u}}}),r},e.prototype.getExtent=function(t){return this.featuresRtree_.getExtent(t)},e.prototype.getFeatureById=function(t){var e=this.idIndex_[t.toString()];return void 0!==e?e:null},e.prototype.getFormat=function(){return this.format_},e.prototype.getOverlaps=function(){return this.overlaps_},e.prototype.getUrl=function(){return this.url_},e.prototype.handleFeatureChange_=function(t){var e=t.target,n=f(e),i=e.getGeometry();if(i){var r=i.getExtent();n in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[n],this.featuresRtree_&&this.featuresRtree_.insert(r,e)):this.featuresRtree_&&this.featuresRtree_.update(r,e)}else n in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[n]=e);var o=e.getId();if(void 0!==o){var s=o.toString();n in this.undefIdIndex_?(delete this.undefIdIndex_[n],this.idIndex_[s]=e):this.idIndex_[s]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[s]=e)}else n in this.undefIdIndex_||(this.removeFromIdIndex_(e),this.undefIdIndex_[n]=e);this.changed(),this.dispatchEvent(new Fa(Oa,e))},e.prototype.hasFeature=function(t){var e=t.getId();return void 0!==e?e in this.idIndex_:f(t)in this.undefIdIndex_},e.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&y(this.nullGeometryFeatures_)},e.prototype.loadFeatures=function(t,e,n){var i=this,r=this.loadedExtentsRtree_,o=this.strategy_(t,e);this.loading=!1;for(var s=function(t,s){var a=o[t];r.forEachInExtent(a,function(t){return Kt(t.extent,a)})||(i.loader_.call(i,a,e,n),r.insert(a,{extent:a.slice()}),i.loading=i.loader_!==l)},a=0,c=o.length;a<c;++a)s(a)},e.prototype.removeLoadedExtent=function(t){var e,n=this.loadedExtentsRtree_;n.forEachInExtent(t,function(n){if(ee(n.extent,t))return e=n,!0}),e&&n.remove(e)},e.prototype.removeFeature=function(t){var e=f(t);e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t),this.changed()},e.prototype.removeFeatureInternal=function(t){var e=f(t);this.featureChangeKeys_[e].forEach(x),delete this.featureChangeKeys_[e];var n=t.getId();void 0!==n?delete this.idIndex_[n.toString()]:delete this.undefIdIndex_[e],this.dispatchEvent(new Fa(Ma,t))},e.prototype.removeFromIdIndex_=function(t){var e=!1;for(var n in this.idIndex_)if(this.idIndex_[n]===t){delete this.idIndex_[n],e=!0;break}return e},e.prototype.setLoader=function(t){this.loader_=t},e}(Ra),ja=n(19),Ba=n.n(ja),za=function(t,e){return function(n,i){e(n,i,t)}};let Ua=class extends Na{constructor(t){super(),this._doUpdateFeatures=!0,this._onFeatureChangeCallbacks=[],this._features={},this._clusteringHandler=t}initialize(t){this._layerContainer=t,this._layerId=t.getLayerId(),this._dataSource=t.getDataSource(),this._lonProperty=t.getLonProperty(),this._latProperty=t.getLatProperty(),this._clusterRadius=t.getClusterRadius(),this._clusterByProperty=t.getClusteredByProperty(),this._unrollClustersAtZoom=t.getUnrollClustersAtZoom(),this._shouldUpdateFeaturesInSeparateThread()?this._setupClusteringHandlerOnSeparateThread():this._setupClusteringHandlerOnMainThread(),this._dataSource.onDataFiltered(()=>{const t=this._dataSource.getFilteredKeys();this._showOnlyKeys(t)}),this._dataSource.onDataAdded(t=>{t.forEachRecord(t=>{const e=t.key();this._features[e]=this._createFeatureFromRecord(t)},!0),this._hasData=!0},!0)}_setupClusteringHandlerOnSeparateThread(){this._worker=new Ba.a,this._worker.addEventListener("message",t=>{const{type:e,clusters:n}=t.data;switch(e){case"response":this._addClusterFeatures(n)}}),this._sendDataToWorker()}_setupClusteringHandlerOnMainThread(){this._clusteringHandler.initialize(this._clusterRadius),this._dataSource.onDataAdded(t=>{const e=this._generateReducedData(t);this._clusteringHandler.addData(e),this._clusteringHandler.dataDone(),this._updateFeatures()})}_generateReducedData(t){const e=t.getAddedData().length,n=new Array(e);return t.forEachAddedRecord((t,e)=>{let[i,r]=this._getXY(t);const o=t.get(tt.DataSource.RECORD_KEY),s=t.get(this._clusterByProperty);n[e]=[i,r,o,s]}),n}_getXY(t){let e,n;if(this._layerContainer.hasLonLatProperties())e=t.get(this._lonProperty),n=t.get(this._latProperty);else{if(!t.hasGeometry())throw new Error("No geometry available. Provide lat or lon property.");{const i=t.getGeometry().getExtent();[e,n]=function(t,e){var n=Je(t,void 0!==e?e:"EPSG:3857","EPSG:4326"),i=n[0];return(i<-180||i>180)&&(n[0]=Bt(i+180,360)-180),n}(ce(i))}}return[Yi.lngToX(e),Yi.latToY(n)]}_sendDataToWorker(){const{SUB_DATA_SIZE:t}=tt.Layer;this._dataSource.onDataAdded(e=>{const n=this._generateReducedData(e),i=Math.ceil(n.length/t);for(let e=0;e<i;e++){const i=e*t,r=(e+1)*t,o=n.slice(i,r);this._sendSubDataMessage(o)}this._sendDataDoneMessage(),this._updateFeatures()})}_sendSubDataMessage(t){const e={type:"data",subData:t};this._worker.postMessage(e)}_sendDataDoneMessage(){const t={type:"done",clusterRadius:this._clusterRadius};this._worker.postMessage(t)}loadFeatures(t,e,n){if(!this._shouldUpdateFeatures(t,e))return!1;this._resolution=e,this._extent=t,this._hasData&&Q.isClusterableLayer(this._layerContainer)&&this._updateFeatures(),this._doUpdateFeatures=!1}_shouldUpdateFeatures(t,e){return!!this._doUpdateFeatures||!(Q.isLayerContainer(this._layerContainer)&&!this._layerContainer.getVisible())&&(e!==this._resolution||JSON.stringify(t)!==JSON.stringify(this._extent))}_updateFeatures(){if(!this._extent||!this._resolution)return;const t=Yi.zoomFromResolution(this._resolution),e=!!Q.isClusterableLayer(this._layerContainer)&&(this._layerContainer.isClustered()&&t<this._unrollClustersAtZoom),n=Yi.transformLonLatExtent(this._extent);this._shouldUpdateFeaturesInSeparateThread()?this._updateFeaturesInSeparateThread(n,t,e):this._updateFeaturesInMainThread(n,t,e)}_shouldUpdateFeaturesInSeparateThread(){return 1==this._layerContainer.getUseThread()}_updateFeaturesInSeparateThread(t,e,n){Sr.log("Clustering in separate thread",Cr.BigVectorLayer),this._worker.postMessage({type:"request",extent:t,zoom:e,shouldCluster:n})}_updateFeaturesInMainThread(t,e,n){Sr.log("Clustering in main thread",Cr.BigVectorLayer),this._clusteringHandler.cluster(t,e,n,t=>{this._addClusterFeatures(t)})}refresh(){this._doUpdateFeatures=!0,this.changed()}_createFeatureFromRecord(t){const e=t.key();let n;t.hasGeometry()?n=t.getGeometry():this._layerContainer.hasLonLatProperties()&&(n=this._createPointGeometryFromRecord(t));const i=t.get(this._clusterByProperty),r=new Zi;return r.setGeometry(n),r.setFeatureKey(e),r.setLayerId(this._layerId),r.setRecordKeys([e]),r.setClusterProperty(this._clusterByProperty),r.setClusterPropertyValue(i),r}_createPointGeometryFromRecord(t){const e=Xe([t.get(this._lonProperty),t.get(this._latProperty)]);return new Nn(e)}_addClusterFeatures(t){Sr.start("Create features",Cr.BigVectorLayer);let e=new Array(t.length);for(let n=0;n<t.length;n++){const i=t[n],r=i[2];e[n]=r<0?this._createClusterFeature(i):this._features[r]}Sr.stop(),this._triggerOnFeatureChange(e),Sr.start("Add features to source",Cr.BigVectorLayer),this.clear(!0),this.addFeatures(e),Sr.stop()}_createClusterFeature(t){const[e,n,i,r,o]=t,s=this._createPointGeometry(e,n),a=new Zi;return a.setGeometry(s),a.setFeatureKey(i),a.setLayerId(this._layerId),a.setClusterProperty(this._clusterByProperty),a.setClusterPropertyValue(r),a.setRecordKeys(o),a}_createPointGeometry(t,e){const n=Xe([Yi.xToLng(t),Yi.yToLat(e)]);return new Nn(n)}getFeaturesInGeometry(t){return this.getFeatures().filter(Yi.isFeatureInGeometry.bind(null,t))}getFeaturesInExtent(t){return this.getFeatures().filter(Yi.isFeatureInExtent.bind(null,t))}onFeatureChange(t){return this._onFeatureChangeCallbacks.push(t),{dispose:this._disposeFeatureChangeCallback.bind(this,t)}}_triggerOnFeatureChange(t){this._onFeatureChangeCallbacks.forEach(e=>e(t))}_showOnlyKeys(t){this._shouldUpdateFeaturesInSeparateThread()?this._worker.postMessage({type:"filter",keys:t}):this._clusteringHandler.addShowOnlyKeysFilter(t),this._doUpdateFeatures=!0,this.changed()}_disposeFeatureChangeCallback(t){this._onFeatureChangeCallbacks=this._onFeatureChangeCallbacks.filter(e=>e!=t)}};var Ha=Ua=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)(),za(0,Object(nt.inject)(lr.ClusteringHandler))],Ua),Wa=function(t,e){return function(n,i){e(n,i,t)}};let Ga=class extends Vs{constructor(t){super(),this._chartStyleHandler=t}initialize(t){t.domId=t.domId||q.generateEmptyWidgetDomId();let e=a.rowChart(`#${t.domId}`);super.initialize(e,t),this._chartStyleHandler.initialize(t),this._initializeChart(e,t)}_initializeChart(t,e){const{dataSource:n}=e;n.onDataAdded(i=>{const r=n.getDimension(e.keyColumn),o=r.group().reduceCount();e.elasticX&&t.elasticX(!0),t.dimension(r).group(o).render(),this._chartStyleHandler.onStyleChange((e,n)=>{t.ordinalColors(e),t.colorDomain(e.map((t,e)=>e)),t.colorAccessor(function(t){return n[t.key]}),t.render()}),this.initialized(!0)},!0),n.fetchData()}};var Va,Ya=Ga=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)(),Wa(0,Object(nt.inject)(lr.PieChartStyleHandler))],Ga),qa=n(27),Xa=n.n(qa),Ka=n(49),$a=n.n(Ka);let Za=Va=class{initialize(t){this._options=t,this._dropDownElement=Va.generateHTMLElement(),this._initializeDropDown(),t.maxHeight&&this._dropDownElement.setAttribute("style",`max-height: ${t.maxHeight}px`)}_initializeDropDown(){const{trigger:t}=this._options;document.body.appendChild(this._dropDownElement),t.addEventListener("click",t=>{this._dropDownElement.classList.add("visible");const e=this._dropDownElement.getBoundingClientRect(),n=t.pageX-e.width+10,i=t.pageY-10;o.select(this._dropDownElement).style("top",`${i}px`).style("left",`${n}px`)}),this._dropDownElement.addEventListener("mouseleave",()=>{this._dropDownElement.classList.remove("visible")}),document.addEventListener("click",t=>{this._dropDownElement.classList.contains("visible")||this._dropDownElement.classList.remove("visible")})}addCheckBoxItem(t,e,n=!0){const i=document.createElement("div");i.classList.add("sinitum-drop-down-checkbox-item","checkbox"),i.innerHTML=`\n            <div>\n                <label class="sintium-checkbox-container">\n                    <input type="checkbox" value=" value="${t}">\n                    <span class="checkmark"></span>\n                </label>\n            </div>\n            <div class="text">${t}</div>\n        `;const r=i.querySelector("input");return r.checked=n,r.addEventListener("change",()=>e(r.checked)),this._dropDownElement.appendChild(i),r}addRemoveItem(t,e){const n=document.createElement("div");return n.classList.add("sinitum-drop-down-checkbox-item"),n.innerHTML=`\n            <div class="text">${t}</div>\n            <div class="times">\n                <i class="fas fa-times"></i>\n            </div>\n        `,this._dropDownElement.appendChild(n),n.querySelector(".times").addEventListener("click",()=>{n.remove(),e()}),n}static generateHTMLElement(){const t=document.createElement("div");return t.classList.add("sintium-dropdown-content"),t}};var Ja=Za=Va=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)()],Za),Qa=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};let tc=class{constructor(){this._gridStack={},this._widgetGridItems={},this._lock=!1,this._filterDisposables={},this._filterDropDownItems={}}initialize(t){this._options=Po(t,Lo),$a()(),this._element=this._getGridContainerElement(this._options),this._createGridStackElement(),this._options.toolbar&&this._setupToolbar()}_setupToolbar(){const{showRemoveFilterMenu:t,showRemoveWidgetMenu:e,toolbar:n}=this._options;!1!==e&&(this._enableDropDown=new Ja,this._enableDropDown.initialize({trigger:this._element.querySelector(".enable-widget"),maxHeight:200})),!1!==t&&(this._filterDropDown=new Ja,this._filterDropDown.initialize({trigger:this._element.querySelector(".remove-filter"),maxHeight:200})),this._element.querySelector(".remove-all-filter").addEventListener("click",()=>{a.filterAll(),a.redrawAll()})}_createGridStackElement(){const t=document.createElement("div");t.classList.add("grid-stack"),this._gridStack=new Xa.a(t,{handle:".panel-heading"}),this._element.appendChild(t),$(t).on("change",this.triggerChanged.bind(this))}_getGridContainerElement(t){const e=document.getElementById(t.domId);return e.classList.add("widget-grid-container","no-select"),t.toolbar&&(e.innerHTML=`\n                <div class="widget-grid-toolbar">\n                    <div class="header">\n                        <i class="fas fa-th"></i>\n                        <div class="text">${t.title}</div>\n                    </div>\n                    <div class="toolbar-element-for-custom-html">\n                    </div>\n                    <div class="button-bar">\n                        <div class="remove-filter button">\n                            <i class="fas fa-filter"></i>\n                        </div>\n                        <div class="remove-all-filter button">\n                            <i class="fas fa-redo-alt"></i>\n                        </div>\n                        <div class="enable-widget button">\n                            <i class="fas fa-eye"></i>\n                        </div>\n                    </div>\n                </div>\n            `),!1===t.showRemoveFilterMenu&&e.querySelector(".remove-filter.button").remove(),!1===t.showRemoveWidgetMenu&&e.querySelector(".enable-widget.button").remove(),this._nightMode.getNight()&&e.classList.add("night"),this._mediator.subscribe(cr.NIGHTMODE,()=>{this._nightMode.getNight()?e.classList.add("night"):e.classList.remove("night")}),this._customHTMLElement=e.querySelector(".toolbar-element-for-custom-html"),e}addWidget(t,e={}){this._lock=!0,e.id=e.id||Y.guidGenerator();const n=cd.get(lr.WidgetGridItem);return n.initialize(this,e),Q.isWidgetContainer(n)&&n.addWidget(t),this._options.toolbar&&this._addWidgetToVisibilityMenu(n,e),this._widgetGridItems[e.id]=n,this._lock=!1,Q.isChartContainer(t)&&t.getChart().on("filtered",i=>this._updateFilterStateForChart(i,t,n,e)),this}_updateFilterStateForChart(t,e,n,i){const{showRemoveFilterMenu:r,onFilterChange:o}=this._options,s=n.getID();let a=!1;if(t.filter()&&!this._filterDisposables[s]){const t=i.title||"No title",n=()=>e.resetChart();this._filterDisposables[s]={id:s,title:t,dispose:n},!1!==r&&this._addFilterDropDownRemoveItem(e,s,t),a=!!o}else null==t.filter()&&this._filterDisposables[s]&&(delete this._filterDisposables[s],!1!==r&&(this._filterDropDownItems[s].remove(),delete this._filterDropDownItems[s]),a=!!o);if(a){o(Object.keys(this._filterDisposables).map(t=>this._filterDisposables[t]))}}_addFilterDropDownRemoveItem(t,e,n){this._filterDropDownItems[e]=this._filterDropDown.addRemoveItem(`${n} filter`,()=>{t.resetChart(),delete this._filterDropDownItems[e]})}triggerChanged(){if(!this._lock&&Q.isFunction(this._options.change)){const t=this.getState();this._options.change(t)}}_addWidgetToVisibilityMenu(t,e){if(!1!==this._options.showRemoveWidgetMenu){const{title:n}=e,i=this._enableDropDown.addCheckBoxItem(n,e=>t.setVisible(e),t.visible());t.on("visibility-change",t=>i.checked=t.visible)}}getState(){const t={};for(const e in this._widgetGridItems){const n=this._widgetGridItems[e],i=n.getOptions().id;"number"==typeof i||"string"==typeof i?t[i]=n.state():console.warn("Widget needs to have id option to be included in state")}return t}setState(t){this._lock=!0;const e=Object.keys(t);this._gridStack.setStatic(!0),e.map(e=>t[e]).sort((t,e)=>t.y!==e.y?t.y-e.y:t.x-e.x).forEach((t,e)=>{const n=this._widgetGridItems[t.id];n&&n.state(t)}),this._gridStack.setStatic(!1),this._lock=!1}addElementToToolbar(t){this._customHTMLElement.appendChild(t)}getHTMLElement(){return this._element}getID(){return this._options.domId}getGridStack(){return this._gridStack}};Qa([Object(nt.inject)(lr.NightMode)],tc.prototype,"_nightMode",void 0),Qa([Object(nt.inject)(lr.Mediator)],tc.prototype,"_mediator",void 0);var ec=tc=Qa([Object(nt.injectable)()],tc),nc="preload",ic="useInterimTilesOnError",rc=function(t){function e(e){var n=e||{},i=_({},n);delete i.preload,delete i.useInterimTilesOnError,t.call(this,i),this.setPreload(void 0!==n.preload?n.preload:0),this.setUseInterimTilesOnError(void 0===n.useInterimTilesOnError||n.useInterimTilesOnError),this.type=Ss.TILE}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getPreload=function(){return this.get(nc)},e.prototype.setPreload=function(t){this.set(nc,t)},e.prototype.getUseInterimTilesOnError=function(){return this.get(ic)},e.prototype.setUseInterimTilesOnError=function(t){this.set(ic,t)},e}(Os);rc.prototype.getSource;var oc=rc,sc=.5,ac={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4,ABORT:5},cc=function(t){function e(e,n,i){t.call(this);var r=i||{};this.tileCoord=e,this.state=n,this.interimTile=null,this.key="",this.transition_=void 0===r.transition?250:r.transition,this.transitionStarts_={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.changed=function(){this.dispatchEvent(L)},e.prototype.getKey=function(){return this.key+"/"+this.tileCoord},e.prototype.getInterimTile=function(){if(!this.interimTile)return this;var t=this.interimTile;do{if(t.getState()==ac.LOADED)return t;t=t.interimTile}while(t);return this},e.prototype.refreshInterimChain=function(){if(this.interimTile){var t=this.interimTile,e=this;do{if(t.getState()==ac.LOADED){t.interimTile=null;break}t.getState()==ac.LOADING?e=t:t.getState()==ac.IDLE?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}},e.prototype.getTileCoord=function(){return this.tileCoord},e.prototype.getState=function(){return this.state},e.prototype.setState=function(t){this.state=t,this.changed()},e.prototype.load=function(){},e.prototype.getAlpha=function(t,e){if(!this.transition_)return 1;var n=this.transitionStarts_[t];if(n){if(-1===n)return 1}else n=e,this.transitionStarts_[t]=n;var i=e-n+1e3/60;return i>=this.transition_?1:pn(i/this.transition_)},e.prototype.inTransition=function(t){return!!this.transition_&&-1!==this.transitionStarts_[t]},e.prototype.endTransition=function(t){this.transition_&&(this.transitionStarts_[t]=-1)},e}(P);function lc(){var t=H(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}var uc=function(t){function e(e,n,i,r,o,s){t.call(this,e,n,s),this.crossOrigin_=r,this.src_=i,this.image_=new Image,null!==r&&(this.image_.crossOrigin=r),this.imageListenerKeys_=null,this.tileLoadFunction_=o}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.state==ac.LOADING&&(this.unlistenImage_(),this.image_=lc()),this.interimTile&&this.interimTile.dispose(),this.state=ac.ABORT,this.changed(),t.prototype.disposeInternal.call(this)},e.prototype.getImage=function(){return this.image_},e.prototype.getKey=function(){return this.src_},e.prototype.handleImageError_=function(){this.state=ac.ERROR,this.unlistenImage_(),this.image_=lc(),this.changed()},e.prototype.handleImageLoad_=function(){var t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=ac.LOADED:this.state=ac.EMPTY,this.unlistenImage_(),this.changed()},e.prototype.load=function(){this.state==ac.ERROR&&(this.state=ac.IDLE,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==ac.IDLE&&(this.state=ac.LOADING,this.changed(),this.imageListenerKeys_=[T(this.image_,k,this.handleImageError_,this),T(this.image_,F,this.handleImageLoad_,this)],this.tileLoadFunction_(this,this.src_))},e.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(x),this.imageListenerKeys_=null},e}(cc);function hc(t,e,n,i){return void 0!==i?(i[0]=t,i[1]=e,i[2]=n,i):[t,e,n]}function dc(t,e,n){return t+"/"+e+"/"+n}function fc(t){return dc(t[0],t[1],t[2])}var pc=function(t){function e(e){t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.expireCache=function(t){for(;this.canExpireCache();){var e=this.peekLast(),n=e.tileCoord[0].toString();if(n in t&&t[n].contains(e.tileCoord))break;this.pop().dispose()}},e.prototype.pruneExceptNewestZ=function(){if(0!==this.getCount()){var t=function(t){return t.split("/").map(Number)}(this.peekFirstKey())[0];this.forEach(function(e){e.tileCoord[0]!==t&&(this.remove(fc(e.tileCoord)),e.dispose())},this)}},e}(fi);function gc(t,e,n,i){var r=Je(n,e,t),o=Ve(e,i,n),s=e.getMetersPerUnit();void 0!==s&&(o*=s);var a=t.getMetersPerUnit();void 0!==a&&(o/=a);var c=t.getExtent();if(!c||Xt(c,r)){var l=Ve(t,o,r)/o;isFinite(l)&&l>0&&(o/=l)}return o}function _c(t,e,n,i){var r=n-t,o=i-e,s=Math.sqrt(r*r+o*o);return[Math.round(n+r/s),Math.round(i+o/s)]}function mc(t,e,n,i,r,o,s,a,c,l,u){var h=H(Math.round(n*t),Math.round(n*e));if(0===c.length)return h.canvas;h.scale(n,n);var d=[1/0,1/0,-1/0,-1/0];c.forEach(function(t,e,n){var i,r;i=d,(r=t.extent)[0]<i[0]&&(i[0]=r[0]),r[2]>i[2]&&(i[2]=r[2]),r[1]<i[1]&&(i[1]=r[1]),r[3]>i[3]&&(i[3]=r[3])});var f=pe(d),p=ue(d),g=H(Math.round(n*f/i),Math.round(n*p/i)),_=n/i;c.forEach(function(t,e,n){var i=t.extent[0]-d[0],r=-(t.extent[3]-d[3]),o=pe(t.extent),s=ue(t.extent);g.drawImage(t.image,l,l,t.image.width-2*l,t.image.height-2*l,i*_,r*_,o*_,s*_)});var m=de(s);return a.getTriangles().forEach(function(t,e,r){var s=t.source,a=t.target,c=s[0][0],l=s[0][1],u=s[1][0],f=s[1][1],p=s[2][0],_=s[2][1],y=(a[0][0]-m[0])/o,v=-(a[0][1]-m[1])/o,b=(a[1][0]-m[0])/o,C=-(a[1][1]-m[1])/o,w=(a[2][0]-m[0])/o,E=-(a[2][1]-m[1])/o,T=c,S=l;c=0,l=0;var x=function(t){for(var e=t.length,n=0;n<e;n++){for(var i=n,r=Math.abs(t[n][n]),o=n+1;o<e;o++){var s=Math.abs(t[o][n]);s>r&&(r=s,i=o)}if(0===r)return null;var a=t[i];t[i]=t[n],t[n]=a;for(var c=n+1;c<e;c++)for(var l=-t[c][n]/t[n][n],u=n;u<e+1;u++)n==u?t[c][u]=0:t[c][u]+=l*t[n][u]}for(var h=new Array(e),d=e-1;d>=0;d--){h[d]=t[d][e]/t[d][d];for(var f=d-1;f>=0;f--)t[f][e]-=t[f][d]*h[d]}return h}([[u-=T,f-=S,0,0,b-y],[p-=T,_-=S,0,0,w-y],[0,0,u,f,C-v],[0,0,p,_,E-v]]);if(x){h.save(),h.beginPath();var R=(y+b+w)/3,A=(v+C+E)/3,O=_c(R,A,y,v),I=_c(R,A,b,C),M=_c(R,A,w,E);h.moveTo(I[0],I[1]),h.lineTo(O[0],O[1]),h.lineTo(M[0],M[1]),h.clip(),h.transform(x[0],x[2],x[1],x[3],y,v),h.translate(d[0]-T,d[3]-S),h.scale(i/n,-i/n),h.drawImage(g.canvas,0,0),h.restore()}}),u&&(h.save(),h.strokeStyle="black",h.lineWidth=1,a.getTriangles().forEach(function(t,e,n){var i=t.target,r=(i[0][0]-m[0])/o,s=-(i[0][1]-m[1])/o,a=(i[1][0]-m[0])/o,c=-(i[1][1]-m[1])/o,l=(i[2][0]-m[0])/o,u=-(i[2][1]-m[1])/o;h.beginPath(),h.moveTo(a,c),h.lineTo(r,s),h.lineTo(l,u),h.closePath(),h.stroke()}),h.restore()),h.canvas}var yc=function(t,e,n,i,r){this.sourceProj_=t,this.targetProj_=e;var o={},s=Ze(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){var e=t[0]+"/"+t[1];return o[e]||(o[e]=s(t)),o[e]},this.maxSourceExtent_=i,this.errorThresholdSquared_=r*r,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!i&&!!this.sourceProj_.getExtent()&&pe(i)==pe(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?pe(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?pe(this.targetProj_.getExtent()):null;var a=de(n),c=fe(n),l=ae(n),u=se(n),h=this.transformInv_(a),d=this.transformInv_(c),f=this.transformInv_(l),p=this.transformInv_(u);if(this.addQuad_(a,c,l,u,h,d,f,p,10),this.wrapsXInSource_){var g=1/0;this.triangles_.forEach(function(t,e,n){g=Math.min(g,t.source[0][0],t.source[1][0],t.source[2][0])}),this.triangles_.forEach(function(t){if(Math.max(t.source[0][0],t.source[1][0],t.source[2][0])-g>this.sourceWorldWidth_/2){var e=[[t.source[0][0],t.source[0][1]],[t.source[1][0],t.source[1][1]],[t.source[2][0],t.source[2][1]]];e[0][0]-g>this.sourceWorldWidth_/2&&(e[0][0]-=this.sourceWorldWidth_),e[1][0]-g>this.sourceWorldWidth_/2&&(e[1][0]-=this.sourceWorldWidth_),e[2][0]-g>this.sourceWorldWidth_/2&&(e[2][0]-=this.sourceWorldWidth_);var n=Math.min(e[0][0],e[1][0],e[2][0]);Math.max(e[0][0],e[1][0],e[2][0])-n<this.sourceWorldWidth_/2&&(t.source=e)}}.bind(this))}o={}};yc.prototype.addTriangle_=function(t,e,n,i,r,o){this.triangles_.push({source:[i,r,o],target:[t,e,n]})},yc.prototype.addQuad_=function(t,e,n,i,r,o,s,a,c){var l=Yt([r,o,s,a]),u=this.sourceWorldWidth_?pe(l)/this.sourceWorldWidth_:null,h=this.sourceWorldWidth_,d=this.sourceProj_.canWrapX()&&u>.5&&u<1,f=!1;if(c>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_)f=pe(Yt([t,e,n,i]))/this.targetWorldWidth_>.25||f;!d&&this.sourceProj_.isGlobal()&&u&&(f=u>.25||f)}if(f||!this.maxSourceExtent_||ge(l,this.maxSourceExtent_)){if(!(f||isFinite(r[0])&&isFinite(r[1])&&isFinite(o[0])&&isFinite(o[1])&&isFinite(s[0])&&isFinite(s[1])&&isFinite(a[0])&&isFinite(a[1]))){if(!(c>0))return;f=!0}if(c>0){if(!f){var p,g=[(t[0]+n[0])/2,(t[1]+n[1])/2],_=this.transformInv_(g);if(d)p=(Bt(r[0],h)+Bt(s[0],h))/2-Bt(_[0],h);else p=(r[0]+s[0])/2-_[0];var m=(r[1]+s[1])/2-_[1];f=p*p+m*m>this.errorThresholdSquared_}if(f){if(Math.abs(t[0]-n[0])<=Math.abs(t[1]-n[1])){var y=[(e[0]+n[0])/2,(e[1]+n[1])/2],v=this.transformInv_(y),b=[(i[0]+t[0])/2,(i[1]+t[1])/2],C=this.transformInv_(b);this.addQuad_(t,e,y,b,r,o,v,C,c-1),this.addQuad_(b,y,n,i,C,v,s,a,c-1)}else{var w=[(t[0]+e[0])/2,(t[1]+e[1])/2],E=this.transformInv_(w),T=[(n[0]+i[0])/2,(n[1]+i[1])/2],S=this.transformInv_(T);this.addQuad_(t,w,T,i,r,E,S,a,c-1),this.addQuad_(w,e,n,T,E,o,s,S,c-1)}return}}if(d){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}this.addTriangle_(t,n,i,r,s,a),this.addTriangle_(t,e,n,r,o,s)}},yc.prototype.calculateSourceExtent=function(){var t=[1/0,1/0,-1/0,-1/0];return this.triangles_.forEach(function(e,n,i){var r=e.source;ne(t,r[0]),ne(t,r[1]),ne(t,r[2])}),t},yc.prototype.getTriangles=function(){return this.triangles_};var vc=yc,bc=function(t){function e(e,n,i,r,o,s,a,c,l,u,h){t.call(this,o,ac.IDLE),this.renderEdges_=void 0!==h&&h,this.pixelRatio_=a,this.gutter_=c,this.canvas_=null,this.sourceTileGrid_=n,this.targetTileGrid_=r,this.wrappedTileCoord_=s||o,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;var d=r.getTileCoordExtent(this.wrappedTileCoord_),f=this.targetTileGrid_.getExtent(),p=this.sourceTileGrid_.getExtent(),g=f?he(d,f):d;if(0!==oe(g)){var _=e.getExtent();_&&(p=p?he(p,_):_);var m=r.getResolution(this.wrappedTileCoord_[0]),y=gc(e,i,ce(g),m);if(!isFinite(y)||y<=0)this.state=ac.EMPTY;else{var v=void 0!==u?u:sc;if(this.triangulation_=new vc(e,i,g,p,y*v),0!==this.triangulation_.getTriangles().length){this.sourceZ_=n.getZForResolution(y);var b=this.triangulation_.calculateSourceExtent();if(p&&(e.canWrapX()?(b[1]=Dt(b[1],p[1],p[3]),b[3]=Dt(b[3],p[1],p[3])):b=he(b,p)),oe(b)){for(var C=n.getTileRangeForExtentAndZ(b,this.sourceZ_),w=C.minX;w<=C.maxX;w++)for(var E=C.minY;E<=C.maxY;E++){var T=l(this.sourceZ_,w,E,a);T&&this.sourceTiles_.push(T)}0===this.sourceTiles_.length&&(this.state=ac.EMPTY)}else this.state=ac.EMPTY}else this.state=ac.EMPTY}}else this.state=ac.EMPTY}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.state==ac.LOADING&&this.unlistenSources_(),t.prototype.disposeInternal.call(this)},e.prototype.getImage=function(){return this.canvas_},e.prototype.reproject_=function(){var t=[];if(this.sourceTiles_.forEach(function(e,n,i){e&&e.getState()==ac.LOADED&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})}.bind(this)),this.sourceTiles_.length=0,0===t.length)this.state=ac.ERROR;else{var e=this.wrappedTileCoord_[0],n=this.targetTileGrid_.getTileSize(e),i="number"==typeof n?n:n[0],r="number"==typeof n?n:n[1],o=this.targetTileGrid_.getResolution(e),s=this.sourceTileGrid_.getResolution(this.sourceZ_),a=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=mc(i,r,this.pixelRatio_,s,this.sourceTileGrid_.getExtent(),o,a,this.triangulation_,t,this.gutter_,this.renderEdges_),this.state=ac.LOADED}this.changed()},e.prototype.load=function(){if(this.state==ac.IDLE){this.state=ac.LOADING,this.changed();var t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(e,n,i){var r=e.getState();if(r==ac.IDLE||r==ac.LOADING){t++;var o=E(e,L,function(n){var i=e.getState();i!=ac.LOADED&&i!=ac.ERROR&&i!=ac.EMPTY||(x(o),0===--t&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(o)}}.bind(this)),this.sourceTiles_.forEach(function(t,e,n){t.getState()==ac.IDLE&&t.load()}),0===t&&setTimeout(this.reproject_.bind(this),0)}},e.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(x),this.sourcesListenerKeys_=null},e}(cc);function Cc(t,e){var n=/\{z\}/g,i=/\{x\}/g,r=/\{y\}/g,o=/\{-y\}/g;return function(s,a,c){return s?t.replace(n,s[0].toString()).replace(i,s[1].toString()).replace(r,function(){return(-s[2]-1).toString()}).replace(o,function(){var t=s[0],n=e.getFullTileRange(t);return Lt(n,55),(n.getHeight()+s[2]).toString()}):void 0}}function wc(t,e){for(var n=t.length,i=new Array(n),r=0;r<n;++r)i[r]=Cc(t[r],e);return function(t){if(1===t.length)return t[0];return function(e,n,i){if(e){var r=Bt(function(t){return(t[1]<<t[0])+t[2]}(e),t.length);return t[r](e,n,i)}}}(i)}function Ec(t,e,n){}function Tc(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:e[0]=e[1]=t,e)}var Sc=function(t,e,n,i){this.minX=t,this.maxX=e,this.minY=n,this.maxY=i};function xc(t,e,n,i,r){return void 0!==r?(r.minX=t,r.maxX=e,r.minY=n,r.maxY=i,r):new Sc(t,e,n,i)}Sc.prototype.contains=function(t){return this.containsXY(t[1],t[2])},Sc.prototype.containsTileRange=function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY},Sc.prototype.containsXY=function(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY},Sc.prototype.equals=function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY},Sc.prototype.extend=function(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)},Sc.prototype.getHeight=function(){return this.maxY-this.minY+1},Sc.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},Sc.prototype.getWidth=function(){return this.maxX-this.minX+1},Sc.prototype.intersects=function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY};var Rc=Sc,Ac=[0,0,0],Oc=function(t){var e,n,i,r;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,Lt((e=this.resolutions_,n=!0,i=function(t,e){return e-t}||rn,e.every(function(t,r){if(0===r)return!0;var o=i(e[r-1],t);return!(o>0||n&&0===o)})),17),!t.origins)for(var o=0,s=this.resolutions_.length-1;o<s;++o)if(r){if(this.resolutions_[o]/this.resolutions_[o+1]!==r){r=void 0;break}}else r=this.resolutions_[o]/this.resolutions_[o+1];this.zoomFactor_=r,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,Lt(this.origins_.length==this.resolutions_.length,20));var a=t.extent;void 0===a||this.origin_||this.origins_||(this.origin_=de(a)),Lt(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,Lt(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:en,Lt(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==a?a:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map(function(t,e){return new Rc(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1))},this):a&&this.calculateTileRanges_(a)};Oc.prototype.forEachTileCoord=function(t,e,n){for(var i=this.getTileRangeForExtentAndZ(t,e),r=i.minX,o=i.maxX;r<=o;++r)for(var s=i.minY,a=i.maxY;s<=a;++s)n([e,r,s])},Oc.prototype.forEachTileCoordParentTileRange=function(t,e,n,i,r){var o,s,a,c=null,l=t[0]-1;for(2===this.zoomFactor_?(s=t[1],a=t[2]):c=this.getTileCoordExtent(t,r);l>=this.minZoom;){if(o=2===this.zoomFactor_?xc(s=Math.floor(s/2),s,a=Math.floor(a/2),a,i):this.getTileRangeForExtentAndZ(c,l,i),e.call(n,l,o))return!0;--l}return!1},Oc.prototype.getExtent=function(){return this.extent_},Oc.prototype.getMaxZoom=function(){return this.maxZoom},Oc.prototype.getMinZoom=function(){return this.minZoom},Oc.prototype.getOrigin=function(t){return this.origin_?this.origin_:this.origins_[t]},Oc.prototype.getResolution=function(t){return this.resolutions_[t]},Oc.prototype.getResolutions=function(){return this.resolutions_},Oc.prototype.getTileCoordChildTileRange=function(t,e,n){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){var i=2*t[1],r=2*t[2];return xc(i,i+1,r,r+1,e)}var o=this.getTileCoordExtent(t,n);return this.getTileRangeForExtentAndZ(o,t[0]+1,e)}return null},Oc.prototype.getTileRangeExtent=function(t,e,n){var i=this.getOrigin(t),r=this.getResolution(t),o=Tc(this.getTileSize(t),this.tmpSize_),s=i[0]+e.minX*o[0]*r,a=i[0]+(e.maxX+1)*o[0]*r;return Qt(s,i[1]+e.minY*o[1]*r,a,i[1]+(e.maxY+1)*o[1]*r,n)},Oc.prototype.getTileRangeForExtentAndZ=function(t,e,n){var i=Ac;this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,i);var r=i[1],o=i[2];return this.getTileCoordForXYAndZ_(t[2],t[3],e,!0,i),xc(r,i[1],o,i[2],n)},Oc.prototype.getTileCoordCenter=function(t){var e=this.getOrigin(t[0]),n=this.getResolution(t[0]),i=Tc(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*i[0]*n,e[1]+(t[2]+.5)*i[1]*n]},Oc.prototype.getTileCoordExtent=function(t,e){var n=this.getOrigin(t[0]),i=this.getResolution(t[0]),r=Tc(this.getTileSize(t[0]),this.tmpSize_),o=n[0]+t[1]*r[0]*i,s=n[1]+t[2]*r[1]*i;return Qt(o,s,o+r[0]*i,s+r[1]*i,e)},Oc.prototype.getTileCoordForCoordAndResolution=function(t,e,n){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,n)},Oc.prototype.getTileCoordForXYAndResolution_=function(t,e,n,i,r){var o=this.getZForResolution(n),s=n/this.getResolution(o),a=this.getOrigin(o),c=Tc(this.getTileSize(o),this.tmpSize_),l=i?.5:0,u=i?0:.5,h=Math.floor((t-a[0])/n+l),d=Math.floor((e-a[1])/n+u),f=s*h/c[0],p=s*d/c[1];return i?(f=Math.ceil(f)-1,p=Math.ceil(p)-1):(f=Math.floor(f),p=Math.floor(p)),hc(o,f,p,r)},Oc.prototype.getTileCoordForXYAndZ_=function(t,e,n,i,r){var o=this.getOrigin(n),s=this.getResolution(n),a=Tc(this.getTileSize(n),this.tmpSize_),c=i?.5:0,l=i?0:.5,u=Math.floor((t-o[0])/s+c),h=Math.floor((e-o[1])/s+l),d=u/a[0],f=h/a[1];return i?(d=Math.ceil(d)-1,f=Math.ceil(f)-1):(d=Math.floor(d),f=Math.floor(f)),hc(n,d,f,r)},Oc.prototype.getTileCoordForCoordAndZ=function(t,e,n){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,n)},Oc.prototype.getTileCoordResolution=function(t){return this.resolutions_[t[0]]},Oc.prototype.getTileSize=function(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]},Oc.prototype.getFullTileRange=function(t){return this.fullTileRanges_?this.fullTileRanges_[t]:null},Oc.prototype.getZForResolution=function(t,e){return Dt(on(this.resolutions_,t,e||0),this.minZoom,this.maxZoom)},Oc.prototype.calculateTileRanges_=function(t){for(var e=this.resolutions_.length,n=new Array(e),i=this.minZoom;i<e;++i)n[i]=this.getTileRangeForExtentAndZ(t,i);this.fullTileRanges_=n};var Ic=Oc;function Mc(t){var e=t.getDefaultTileGrid();return e||(e=function(t,e,n,i){return function(t,e,n,i){var r=void 0!==i?i:Gt.TOP_LEFT,o=Pc(t,e,n);return new Ic({extent:t,origin:le(t,r),resolutions:o,tileSize:n})}(Lc(t),e,n,i)}(t),t.setDefaultTileGrid(e)),e}function Pc(t,e,n){for(var i=void 0!==e?e:tn,r=ue(t),o=pe(t),s=Tc(void 0!==n?n:en),a=Math.max(o/s[0],r/s[1]),c=i+1,l=new Array(c),u=0;u<c;++u)l[u]=a/Math.pow(2,u);return l}function Lc(t){var e=(t=Ge(t)).getExtent();if(!e){var n=180*ve[be.DEGREES]/t.getMetersPerUnit();e=Qt(-n,-n,n,n)}return e}var Dc=function(t){function e(e){t.call(this,{attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX}),this.opaque_=void 0!==e.opaque&&e.opaque,this.tilePixelRatio_=void 0!==e.tilePixelRatio?e.tilePixelRatio:1,this.tileGrid=void 0!==e.tileGrid?e.tileGrid:null,this.tileCache=new pc(e.cacheSize),this.tmpSize=[0,0],this.key_=e.key||"",this.tileOptions={transition:e.transition}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},e.prototype.expireCache=function(t,e){var n=this.getTileCacheForProjection(t);n&&n.expireCache(e)},e.prototype.forEachLoadedTile=function(t,e,n,i){var r=this.getTileCacheForProjection(t);if(!r)return!1;for(var o,s,a,c=!0,l=n.minX;l<=n.maxX;++l)for(var u=n.minY;u<=n.maxY;++u)s=dc(e,l,u),a=!1,r.containsKey(s)&&(a=(o=r.get(s)).getState()===ac.LOADED)&&(a=!1!==i(o)),a||(c=!1);return c},e.prototype.getGutterForProjection=function(t){return 0},e.prototype.getKey=function(){return this.key_},e.prototype.setKey=function(t){this.key_!==t&&(this.key_=t,this.changed())},e.prototype.getOpaque=function(t){return this.opaque_},e.prototype.getResolutions=function(){return this.tileGrid.getResolutions()},e.prototype.getTile=function(t,e,n,i,r){return h()},e.prototype.getTileGrid=function(){return this.tileGrid},e.prototype.getTileGridForProjection=function(t){return this.tileGrid?this.tileGrid:Mc(t)},e.prototype.getTileCacheForProjection=function(t){var e=this.getProjection();return e&&!Ke(e,t)?null:this.tileCache},e.prototype.getTilePixelRatio=function(t){return this.tilePixelRatio_},e.prototype.getTilePixelSize=function(t,e,n){var i,r,o,s=this.getTileGridForProjection(n),a=this.getTilePixelRatio(e),c=Tc(s.getTileSize(t),this.tmpSize);return 1==a?c:(i=c,r=a,void 0===(o=this.tmpSize)&&(o=[0,0]),o[0]=i[0]*r+.5|0,o[1]=i[1]*r+.5|0,o)},e.prototype.getTileCoordForTileUrlFunction=function(t,e){var n=void 0!==e?e:this.getProjection(),i=this.getTileGridForProjection(n);return this.getWrapX()&&n.isGlobal()&&(t=function(t,e,n){var i=e[0],r=t.getTileCoordCenter(e),o=Lc(n);if(Xt(o,r))return e;var s=pe(o),a=Math.ceil((o[0]-r[0])/s);return r[0]+=s*a,t.getTileCoordForCoordAndZ(r,i)}(i,t,n)),function(t,e){var n=t[0],i=t[1],r=t[2];if(e.getMinZoom()>n||n>e.getMaxZoom())return!1;var o,s=e.getExtent();return!(o=s?e.getTileRangeForExtentAndZ(s,n):e.getFullTileRange(n))||o.containsXY(i,r)}(t,i)?t:null},e.prototype.refresh=function(){this.tileCache.clear(),this.changed()},e.prototype.useTile=function(t,e,n,i){},e}(Ra),kc=function(t){function e(e,n){t.call(this,e),this.tile=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(I),Fc="tileloadstart",Nc="tileloadend",jc="tileloaderror";function Bc(t,e){t.getImage().src=e}var zc=function(t){function e(e){var n=e||{},i=void 0!==n.projection?n.projection:"EPSG:3857",r=void 0!==n.tileGrid?n.tileGrid:function(t){var e=t||{},n=e.extent||Ge("EPSG:3857").getExtent(),i={extent:n,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:Pc(n,e.maxZoom,e.tileSize)};return new Ic(i)}({extent:Lc(i),maxZoom:n.maxZoom,minZoom:n.minZoom,tileSize:n.tileSize});t.call(this,{attributions:n.attributions,cacheSize:n.cacheSize,crossOrigin:n.crossOrigin,opaque:n.opaque,projection:i,reprojectionErrorThreshold:n.reprojectionErrorThreshold,tileGrid:r,tileLoadFunction:n.tileLoadFunction,tilePixelRatio:n.tilePixelRatio,tileUrlFunction:n.tileUrlFunction,url:n.url,urls:n.urls,wrapX:void 0===n.wrapX||n.wrapX,transition:n.transition,attributionsCollapsible:n.attributionsCollapsible})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(function(t){function e(e){t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:Bc,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,key:e.key,attributionsCollapsible:e.attributionsCollapsible}),this.crossOrigin=void 0!==e.crossOrigin?e.crossOrigin:null,this.tileClass=void 0!==e.tileClass?e.tileClass:uc,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.canExpireCache=function(){if(this.tileCache.canExpireCache())return!0;for(var t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1},e.prototype.expireCache=function(t,e){var n=this.getTileCacheForProjection(t);for(var i in this.tileCache.expireCache(this.tileCache==n?e:{}),this.tileCacheForProjection){var r=this.tileCacheForProjection[i];r.expireCache(r==n?e:{})}},e.prototype.getGutterForProjection=function(t){return this.getProjection()&&t&&!Ke(this.getProjection(),t)?0:this.getGutter()},e.prototype.getGutter=function(){return 0},e.prototype.getOpaque=function(e){return!(this.getProjection()&&e&&!Ke(this.getProjection(),e))&&t.prototype.getOpaque.call(this,e)},e.prototype.getTileGridForProjection=function(t){var e=this.getProjection();if(!this.tileGrid||e&&!Ke(e,t)){var n=f(t);return n in this.tileGridForProjection||(this.tileGridForProjection[n]=Mc(t)),this.tileGridForProjection[n]}return this.tileGrid},e.prototype.getTileCacheForProjection=function(t){var e=this.getProjection();if(!e||Ke(e,t))return this.tileCache;var n=f(t);return n in this.tileCacheForProjection||(this.tileCacheForProjection[n]=new pc(this.tileCache.highWaterMark)),this.tileCacheForProjection[n]},e.prototype.createTile_=function(t,e,n,i,r,o){var s=[t,e,n],a=this.getTileCoordForTileUrlFunction(s,r),c=a?this.tileUrlFunction(a,i,r):void 0,l=new this.tileClass(s,void 0!==c?ac.IDLE:ac.EMPTY,void 0!==c?c:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return l.key=o,E(l,L,this.handleTileChange,this),l},e.prototype.getTile=function(t,e,n,i,r){var o=this.getProjection();if(o&&r&&!Ke(o,r)){var s,a=this.getTileCacheForProjection(r),c=[t,e,n],l=fc(c);a.containsKey(l)&&(s=a.get(l));var u=this.getKey();if(s&&s.key==u)return s;var h=this.getTileGridForProjection(o),d=this.getTileGridForProjection(r),f=this.getTileCoordForTileUrlFunction(c,r),p=new bc(o,h,r,d,c,f,this.getTilePixelRatio(i),this.getGutter(),function(t,e,n,i){return this.getTileInternal(t,e,n,i,o)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_);return p.key=u,s?(p.interimTile=s,p.refreshInterimChain(),a.replace(l,p)):a.set(l,p),p}return this.getTileInternal(t,e,n,i,o||r)},e.prototype.getTileInternal=function(t,e,n,i,r){var o=null,s=dc(t,e,n),a=this.getKey();if(this.tileCache.containsKey(s)){if((o=this.tileCache.get(s)).key!=a){var c=o;o=this.createTile_(t,e,n,i,r,a),c.getState()==ac.IDLE?o.interimTile=c.interimTile:o.interimTile=c,o.refreshInterimChain(),this.tileCache.replace(s,o)}}else o=this.createTile_(t,e,n,i,r,a),this.tileCache.set(s,o);return o},e.prototype.setRenderReprojectionEdges=function(t){if(this.renderReprojectionEdges_!=t){for(var e in this.renderReprojectionEdges_=t,this.tileCacheForProjection)this.tileCacheForProjection[e].clear();this.changed()}},e.prototype.setTileGridForProjection=function(t,e){var n=Ge(t);if(n){var i=f(n);i in this.tileGridForProjection||(this.tileGridForProjection[i]=e)}},e}(function(t){function e(e){t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,key:e.key,attributionsCollapsible:e.attributionsCollapsible}),this.generateTileUrlFunction_=!e.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,this.tileUrlFunction=e.tileUrlFunction?e.tileUrlFunction.bind(this):Ec,this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),e.tileUrlFunction&&this.setTileUrlFunction(e.tileUrlFunction,this.key_),this.tileLoadingKeys_={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getTileLoadFunction=function(){return this.tileLoadFunction},e.prototype.getTileUrlFunction=function(){return this.tileUrlFunction},e.prototype.getUrls=function(){return this.urls},e.prototype.handleTileChange=function(t){var e,n=t.target,i=f(n),r=n.getState();r==ac.LOADING?(this.tileLoadingKeys_[i]=!0,e=Fc):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],e=r==ac.ERROR?jc:r==ac.LOADED||r==ac.ABORT?Nc:void 0),null!=e&&this.dispatchEvent(new kc(e,n))},e.prototype.setTileLoadFunction=function(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()},e.prototype.setTileUrlFunction=function(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()},e.prototype.setUrl=function(t){var e=this.urls=function(t){var e=[],n=/\{([a-z])-([a-z])\}/.exec(t);if(n){var i,r=n[1].charCodeAt(0),o=n[2].charCodeAt(0);for(i=r;i<=o;++i)e.push(t.replace(n[0],String.fromCharCode(i)));return e}if(n=n=/\{(\d+)-(\d+)\}/.exec(t)){for(var s=parseInt(n[2],10),a=parseInt(n[1],10);a<=s;a++)e.push(t.replace(n[0],a.toString()));return e}return e.push(t),e}(t);this.setUrls(e)},e.prototype.setUrls=function(t){this.urls=t;var e=t.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(wc(t,this.tileGrid),e):this.setKey(e)},e.prototype.useTile=function(t,e,n){var i=dc(t,e,n);this.tileCache.containsKey(i)&&this.tileCache.get(i)},e}(Dc))),Uc='&#169; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors.',Hc=function(t){function e(e){var n,i=e||{};n=void 0!==i.attributions?i.attributions:[Uc];var r=void 0!==i.crossOrigin?i.crossOrigin:"anonymous",o=void 0!==i.url?i.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png";t.call(this,{attributions:n,cacheSize:i.cacheSize,crossOrigin:r,opaque:void 0===i.opaque||i.opaque,maxZoom:void 0!==i.maxZoom?i.maxZoom:19,reprojectionErrorThreshold:i.reprojectionErrorThreshold,tileLoadFunction:i.tileLoadFunction,url:o,wrapX:i.wrapX,attributionsCollapsible:!1})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(zc),Wc=function(t,e){return function(n,i){e(n,i,t)}};let Gc=class t extends ft{constructor(t,e){super(),this._mediator=t,this._nightMode=e,this._type=J.BaseLayer}initialize(t){super.initialize(t),this.checkIfOptionsAreValid(t),this.setVisible(0!=t.visible),this._options=t,this._setupTileLayers()}checkIfOptionsAreValid(t){const{layerId:e,layer:n,darkLayer:i}=t,{LAYER:r,DARK_LAYER:o}=tt.Properties;if(n&&!Q.isOpenLayerTileLayer(n))throw lt(r,tt.Module.LAYER,e);if(i&&!Q.isOpenLayerTileLayer(i))throw lt(o,tt.Module.LAYER,e)}getType(){return this._type}setVisible(t){this.setLayersVisible(t)}_setupTileLayers(){let{layer:e,darkLayer:n}=this._options;e||(e=t.createDefaultLightBaseLayer(),n=t.createDefaultDarkBaseLayer()),this._layer=e,this.addLayer(e),n&&(this._darkLayer=n,this.addLayer(n),this._setMode(this._nightMode.getNight()),this._mediator.subscribe(cr.NIGHTMODE,t=>this._setMode(t.night)))}_setMode(t){this._darkLayer.setVisible(t),this._layer.setVisible(!t)}static createDefaultLightBaseLayer(){return new oc({source:new Hc({crossOrigin:"anonymous"})})}static createDefaultDarkBaseLayer(){return new oc({source:new zc({url:"https://{1-4}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",crossOrigin:"anonymous"})})}};var Vc=Gc=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Wc(0,Object(nt.inject)(lr.Mediator)),Wc(1,Object(nt.inject)(lr.NightMode))],Gc);class Yc{constructor(t){this.mapContainer=t}getMap(){return this.mapContainer}}class qc extends Yc{constructor(t,e){super(t),this._coordinate=e}getCoordinate(){return r.a.proj.toLonLat(this._coordinate)}}var Xc,Kc=function(t,e){return function(n,i){e(n,i,t)}};let $c=Xc=class{constructor(t,e,n,i,r){this.mediator=t,this.layerManager=e,this.selectionManager=n,this.mapUIManager=i,this.drawManager=r,this._hasVisibleBaseLayer=!1,this._ignoreClick=!1,this._mediator=t,this._layerHandler=e,this._selectionHandler=n,this._mapUIHandler=i,this._drawingHandler=r}initialize(t){this._options=Po(t,ko),this._validateMapOptions(this._options),this._instantiateMap(),this._setupEventListeners()}_instantiateMap(){const{domId:t,view:e,rotation:n}=this._options;this._map=new r.a.Map({target:t,view:e||Yi.getDefaultView(),controls:[],interactions:r.a.interaction.defaults({shiftDragZoom:!1,dragPan:!0,doubleClickZoom:!1,rotate:n,pinchRotate:n,keyboard:!1}),layers:[],keyboardEventTarget:document}),this._selectionHandler.initialize(this),this._mapUIHandler.initialize(this),this._drawingHandler.initialize(this),this._initializeMap()}_initializeMap(){const{layers:t,use:e,controls:n,domId:i,keyboardPan:o,keyboardZoom:s}=this._options;if(document.getElementById(i).classList.add("sintium-map"),this._setDefaultBaseLayerIfNecessary(t),t){const[e,n]=this._splitLayers(t);e.forEach(this.layer.bind(this)),n.forEach(this.layer.bind(this))}e&&e.forEach(this.use.bind(this)),n&&n.forEach(this.control.bind(this)),o&&this._map.addInteraction(new r.a.interaction.KeyboardPan),s&&document.addEventListener("keyup",t=>{if(t.preventDefault(),!(t.shiftKey||t.altKey||t.ctrlKey))switch(t.key){case"+":this._mapUIHandler.zoomIn();break;case"-":this._mapUIHandler.zoomOut()}})}_validateMapOptions(t){const{layers:e,use:n,controls:i,onClickEmptySpace:r,onClickCluster:o,hitTolerance:s,domId:a}=t;if(e&&!Q.arrayOf(Q.isLayerContainer,e))throw lt(tt.Properties.LAYERS,tt.Module.MAP,a);if(n&&!Q.arrayOf(Q.isMapContainerExtension,n))throw lt(tt.Properties.EXTENSIONS,tt.Module.MAP,a);if(i&&!Q.arrayOf(Q.isMapControl,i))throw lt(tt.Properties.ATTRIBUTIONS,tt.Module.MAP,a);if(r&&!Q.isFunction(r))throw lt(tt.Properties.ON_CLICK_EMPTY_SPACE,tt.Module.MAP,a);if(o&&!Q.isFunction(o))throw lt(tt.Properties.ON_CLICK_CLUSTER,tt.Module.MAP,a);if(s&&!Q.isNumber(s))throw lt(tt.Properties.HIT_TOLERANCE,tt.Module.MAP,a)}_setupEventListeners(){this._mediator.filter(t=>this._layerHandler.hasLayerContainerById(t.layerId)).subscribe(cr.LAYER_CHANGED_VISIBILITY,t=>{this._layerHandler.setLayerVisibleById(t.layerId,t.visible)}),this._map.on("click",t=>this._processClickEvent(t)),this._map.on("movestart",t=>{this._mediator.publish(cr.MAP_MOVE,{start:!0})}),this._map.on("moveend",sr.debounce(t=>{this._processChangeEvent(),this._mediator.publish(cr.MAP_MOVE,{start:!1})},250)),this._map.on("change:size",t=>{this._mediator.publish(cr.MAP_SIZE,{size:this._map.getSize()})}),this._map.getView().on("propertychange",t=>{"center"!=t.key&&"resolution"!=t.key||this._mediator.publish(cr.EXTENT_CHANGED,{extent:this._map.getView().calculateExtent(this._map.getSize())})})}_processClickEvent(t){if(this._ignoreClick)return;const e=this._map.getFeaturesAtPixel(t.pixel,{hitTolerance:this._options.hitTolerance}),n=Xc._getTopFeature(e);n?(n.isCluster()&&(this._options.zoomOnClusterClick&&this._zoomToCluster(n),this._options.onClickCluster&&this._triggerMapClickEvent(t,this._options.onClickCluster)),this._selectionHandler.onClickSingleFeature(t,n)):(this._options.onClickEmptySpace&&this._triggerMapClickEvent(t,this._options.onClickEmptySpace),this._selectionHandler.onClickEmptySpace(t))}_processChangeEvent(){this.viewPortChanged()}viewPortChanged(){let t;if(this._mapUIHandler.triggerViewPortChange(),"visible"===this._options.viewPortMode){const e=this._mapUIHandler.getViewPortExtent();t=[e.x0,e.y0,e.x1,e.y1]}else t=this.getMap().getView().calculateExtent(this.getMap().getSize());const e=r.a.proj.transformExtent(t,"EPSG:3857","EPSG:4326");this._options.onViewPortChange&&this._options.onViewPortChange(e)}_triggerMapClickEvent(t,e){e(new qc(this,t.coordinate))}_setDefaultBaseLayerIfNecessary(t){if(0==(t||[]).filter(t=>t.getType()==J.BaseLayer).length){const t=cd.get(lr.BaseLayerContainer);t.initialize({layerId:"Default Base Layer",layer:Vc.createDefaultLightBaseLayer(),darkLayer:Vc.createDefaultDarkBaseLayer()}),this.layer(t)}}layer(t){t.getType()==J.BaseLayer&&(!this._hasVisibleBaseLayer&&t.getVisible()?this._hasVisibleBaseLayer=!0:t.setVisible(!1)),this._layerHandler.addLayerContainer(t),this._map.addLayer(t.getLayerCollection())}use(t){t.initializeExtension(this)}control(t){this._mapUIHandler.addControl(t)}static _getTopFeature(t){if(!t)return;const e=t.filter(Yi.isSintiumFeature);return 0!=e.length?e[0]:void 0}zoomToFeature(t,e=12){const[n,i]=r.a.extent.getCenter(t.getGeometry().getExtent());this._mapUIHandler.setCenter([n,i],e)}zoomToCoordinates(t,e=12,n=200){t=r.a.proj.fromLonLat(t),this._mapUIHandler.setCenter(t,e,n)}_zoomToCluster(t){const e=this._layerHandler.getLayerContainerByFeature(t);if(!Q.isZoomableLayer(e))return;const n=e.getClusterExtent(t);this._ignoreClick=!0,this._map.getView().fit(n,{duration:500,size:this._map.getSize(),padding:[10,10,10,10],callback:()=>this._ignoreClick=!1})}getLayerHandler(){return this._layerHandler}getMapUIHandler(){return this._mapUIHandler}getDrawingHandler(){return this._drawingHandler}getSelectionHandler(){return this._selectionHandler}getMap(){return this._map}getDomId(){return this._options.domId}getHitTolerance(){return this._options.hitTolerance}getKeepCenter(){return!!this._options.keepCenter}_splitLayers(t){return[t.filter(t=>t.getType()==J.BaseLayer),t.filter(t=>t.getType()!=J.BaseLayer).reverse()]}};var Zc=$c=Xc=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)(),Kc(0,Object(nt.inject)(lr.Mediator)),Kc(1,Object(nt.inject)(lr.LayerManager)),Kc(2,Object(nt.inject)(lr.SelectionHandler)),Kc(3,Object(nt.inject)(lr.MapUIManager)),Kc(4,Object(nt.inject)(lr.DrawManager))],$c),Jc=function(t){function e(e){var n=e||{};t.call(this,n),this.type=Ss.IMAGE}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Os);Jc.prototype.getSource;var Qc=Jc,tl=function(t){function e(e,n,i,r){t.call(this),this.extent=e,this.pixelRatio_=i,this.resolution=n,this.state=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.changed=function(){this.dispatchEvent(L)},e.prototype.getExtent=function(){return this.extent},e.prototype.getImage=function(){return h()},e.prototype.getPixelRatio=function(){return this.pixelRatio_},e.prototype.getResolution=function(){return this.resolution},e.prototype.getState=function(){return this.state},e.prototype.load=function(){h()},e}(P),el=function(t){function e(e,n,i,r,o){var s=void 0!==o?hi.IDLE:hi.LOADED;t.call(this,e,n,i,s),this.loader_=void 0!==o?o:null,this.canvas_=r,this.error_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getError=function(){return this.error_},e.prototype.handleLoad_=function(t){t?(this.error_=t,this.state=hi.ERROR):this.state=hi.LOADED,this.changed()},e.prototype.load=function(){this.state==hi.IDLE&&(this.state=hi.LOADING,this.changed(),this.loader_(this.handleLoad_.bind(this)))},e.prototype.getImage=function(){return this.canvas_},e}(tl),nl=function(t){function e(e,n,i,r,o,s){var a=e.getExtent(),c=n.getExtent(),l=c?he(i,c):i,u=gc(e,n,ce(l),r),h=new vc(e,n,l,a,u*sc),d=s(h.calculateSourceExtent(),u,o),f=hi.LOADED;d&&(f=hi.IDLE);var p=d?d.getPixelRatio():1;t.call(this,i,r,p,f),this.targetProj_=n,this.maxSourceExtent_=a,this.triangulation_=h,this.targetResolution_=r,this.targetExtent_=i,this.sourceImage_=d,this.sourcePixelRatio_=p,this.canvas_=null,this.sourceListenerKey_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.state==hi.LOADING&&this.unlistenSource_(),t.prototype.disposeInternal.call(this)},e.prototype.getImage=function(){return this.canvas_},e.prototype.getProjection=function(){return this.targetProj_},e.prototype.reproject_=function(){var t=this.sourceImage_.getState();if(t==hi.LOADED){var e=pe(this.targetExtent_)/this.targetResolution_,n=ue(this.targetExtent_)/this.targetResolution_;this.canvas_=mc(e,n,this.sourcePixelRatio_,this.sourceImage_.getResolution(),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0)}this.state=t,this.changed()},e.prototype.load=function(){if(this.state==hi.IDLE){this.state=hi.LOADING,this.changed();var t=this.sourceImage_.getState();t==hi.LOADED||t==hi.ERROR?this.reproject_():(this.sourceListenerKey_=E(this.sourceImage_,L,function(t){var e=this.sourceImage_.getState();e!=hi.LOADED&&e!=hi.ERROR||(this.unlistenSource_(),this.reproject_())},this),this.sourceImage_.load())}},e.prototype.unlistenSource_=function(){x(this.sourceListenerKey_),this.sourceListenerKey_=null},e}(tl),il="imageloadstart",rl="imageloadend",ol="imageloaderror",sl=function(t){function e(e,n){t.call(this,e),this.image=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(I);var al=function(t){function e(e){var n=e||{};t.call(this,{attributions:n.attributions,projection:n.projection,resolutions:n.resolutions,state:n.state}),this.canvasFunction_=n.canvasFunction,this.canvas_=null,this.renderedRevision_=0,this.ratio_=void 0!==n.ratio?n.ratio:1.5}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getImageInternal=function(t,e,n,i){e=this.findNearestResolution(e);var r=this.canvas_;if(r&&this.renderedRevision_==this.getRevision()&&r.getResolution()==e&&r.getPixelRatio()==n&&Kt(r.getExtent(),t))return r;!function(t,e){var n=(t[2]-t[0])/2*(e-1),i=(t[3]-t[1])/2*(e-1);t[0]-=n,t[2]+=n,t[1]-=i,t[3]+=i}(t=t.slice(),this.ratio_);var o=[pe(t)/e*n,ue(t)/e*n],s=this.canvasFunction_.call(this,t,e,n,o,i);return s&&(r=new el(t,e,n,s)),this.canvas_=r,this.renderedRevision_=this.getRevision(),r},e}(function(t){function e(e){t.call(this,{attributions:e.attributions,projection:e.projection,state:e.state}),this.resolutions_=void 0!==e.resolutions?e.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getResolutions=function(){return this.resolutions_},e.prototype.findNearestResolution=function(t){if(this.resolutions_){var e=on(this.resolutions_,t,0);t=this.resolutions_[e]}return t},e.prototype.getImage=function(t,e,n,i){var r=this.getProjection();if(r&&i&&!Ke(r,i)){if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&Ke(this.reprojectedImage_.getProjection(),i)&&this.reprojectedImage_.getResolution()==e&&ee(this.reprojectedImage_.getExtent(),t))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new nl(r,i,t,e,n,function(t,e,n){return this.getImageInternal(t,e,n,r)}.bind(this)),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}return r&&(i=r),this.getImageInternal(t,e,n,i)},e.prototype.getImageInternal=function(t,e,n,i){return h()},e.prototype.handleImageChange=function(t){var e=t.target;switch(e.getState()){case hi.LOADING:this.loading=!0,this.dispatchEvent(new sl(il,e));break;case hi.LOADED:this.loading=!1,this.dispatchEvent(new sl(rl,e));break;case hi.ERROR:this.loading=!1,this.dispatchEvent(new sl(ol,e))}},e}(Ra));class cl{static createProgram(t,e,n){const i=cl.loadShader(t,t.VERTEX_SHADER,e),r=cl.loadShader(t,t.FRAGMENT_SHADER,n),o=t.createProgram();t.attachShader(o,i),t.attachShader(o,r),t.linkProgram(o),t.getProgramParameter(o,t.LINK_STATUS)||console.log("Unable to initialize the shader program: "+t.getProgramInfoLog(o));const s={program:o},a=t.getProgramParameter(o,t.ACTIVE_ATTRIBUTES);for(let e=0;e<a;e++){const n=t.getActiveAttrib(o,e);s[n.name]=t.getAttribLocation(o,n.name)}const c=t.getProgramParameter(o,t.ACTIVE_UNIFORMS);for(let e=0;e<c;e++){const n=t.getActiveUniform(o,e);s[n.name]=t.getUniformLocation(o,n.name)}return s}static createShader(t,e,n){const i=t.createShader(n);return t.shaderSource(i,e),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS)||console.log("Error compiling shader",t.getShaderInfoLog(i)),i}static loadShader(t,e,n){const i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS)||console.log("An error occurred compiling the shaders: "+t.getShaderInfoLog(i)),i}static createSquareBuffer(t){const e=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,e);const n=new Float32Array([-1,1,0,1,-1,-1,0,0,1,1,1,1,1,-1,1,0]);return t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW),e}static createArrayBuffer(t,e){const n=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW),n}static createTexture(t,e,n,i,r){const o=t.createTexture();return t.bindTexture(t.TEXTURE_2D,o),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,e),r instanceof Uint8Array?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n,i,0,t.RGBA,t.UNSIGNED_BYTE,r):null===r?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n,i,0,t.RGBA,t.UNSIGNED_BYTE,null):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r),t.bindTexture(t.TEXTURE_2D,null),o}static createTextureFromImage(t,e){const n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n);const i=t.RGBA,r=t.RGBA,o=t.UNSIGNED_BYTE,s=new Uint8Array([0,0,0,255]);t.texImage2D(t.TEXTURE_2D,0,i,1,1,0,r,o,s);const a=new Image;return a.onload=function(){t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,i,r,o,a),cl.isPowerOf2(a.width)&&cl.isPowerOf2(a.height)?t.generateMipmap(t.TEXTURE_2D):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR))},a.src="../"+e,n}static isPowerOf2(t){return 0==(t&t-1)}static createColorScaleTexture(t,e){const n=document.createElement("canvas");n.width=256,n.height=1;const i=n.getContext("2d");let r=i.createLinearGradient(0,0,256,0);for(let t=0,n=0;t<40;n=.025*++t)r.addColorStop(n,e(n));i.fillStyle=r,i.fillRect(0,0,256,1);const o=t.createTexture();return t.bindTexture(t.TEXTURE_2D,o),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,i.canvas),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),o}static convertToWebGLCoords(t,e,n,i){return[(i[0]-t[0])/e*2-1,(i[1]-t[3])/n*-2+1]}static initImageData(t,e){return document.createElement("canvas").getContext("2d").createImageData(t,e)}}class ll{static setCanvasSize(t,e){t.width=e[0],t.height=e[1]}static createVectorImageData(t,e,n,i,r,o,s,a){const c=ll.initImageData(t,e),l=a||null;for(let t=0;t<c.data.length;t+=4)n[t/4][i]==l?c.data[t+3]=0:(c.data[t]=Math.floor(255*(n[t/4][i]-o)/(s-o)),c.data[t+1]=Math.floor(255*(n[t/4][r]-o)/(s-o)),c.data[t+2]=0,c.data[t+3]=255);return c}static createRandomImageData(t,e){const n=ll.initImageData(t,e);for(let t=0;t<n.data.length;t+=4)n.data[t]=Math.floor(256*Math.random()),n.data[t+1]=Math.floor(256*Math.random()),n.data[t+2]=Math.floor(256*Math.random()),n.data[t+3]=Math.floor(256*Math.random());return n}static initImageData(t,e){return document.createElement("canvas").getContext("2d").createImageData(t,e)}}let ul=class extends ft{constructor(){super(...arguments),this._isInstantiated=!1}initialize(t){super.initialize(t),this._options=t,this._dataSource=t.dataSource,this._colorScale=t.colorScale?t.colorScale:rr.a.scale(["blue","cyan","lime","yellow","red"]).domain([.4,.6,.7,.8,1]),0!=t.visible&&this.setVisible(!0)}getType(){return J.WebGlLayer}setVisible(t){this._isInstantiated||(this.getDataSource().fetchData(),this._instantiateLayer()),this.setLayersVisible(t)}_instantiateLayer(){this._options.dataSource.onDataAdded(t=>{this._instantiateData(this._options.dataSource);const e=new al({canvasFunction:this._canvasFunction.bind(this),projection:"EPSG:3857",ratio:2}),n=new Qc({source:e,opacity:.65});this.addLayer(n),this._dataSource.onDataFiltered(()=>{this._refresh(t),e.changed()}),this._canvasSource=e,this._isInstantiated=!0})}getDataSource(){return this._dataSource}_instantiateData(t){const e=t.getDataContainer(),{valueProperty:n}=this._options,i=t.getDimension(n),r=e.getIndexForColumn(n);this._min=i.bottom(1)[0][r],this._max=i.top(1)[0][r],this._vertices=this._createVertices(e)}_refresh(t){this._vertices=this._createVertices(t)}_createVertices(t){const{latProperty:e,lonProperty:n,valueProperty:i}=this._options,r=[];return t.forEachRecord((t,o)=>{const s=t.get(n),a=t.get(e),c=(t.get(i)-this._min)/this._max;null==s&&null==a&&null==c||r.push(s,a,c)}),r}_initiateWebGL(t){const e=document.createElement("canvas");ll.setCanvasSize(e,t);let n=e.getContext("webgl");if(n||(n=e.getContext("experimental-webgl")),!n)throw ut();this._colorScaleTexture=cl.createColorScaleTexture(n,this._colorScale),n.clearColor(0,0,0,0),this._grayScaleProgram=cl.createProgram(n,"\n    precision highp float;\n    \n    attribute vec2 vertPosition;\n    attribute float value;\n    // varying vec4 fragColor;\n    varying float intensity;\n    uniform vec4 extent;\n    uniform vec2 delta;\n    uniform float resolution;\n    \n    const float RADIUS = 6378137.0;\n    const float PI = 3.1415926535897932384626433832795;\n    const float HALF_SIZE = PI * RADIUS;\n\n    void main(void) {\n        intensity = value;\n       \n        float x = HALF_SIZE * vertPosition.x / 180.0;\n    \n        float y = RADIUS * log(tan(PI * (vertPosition.y + 90.0) / 360.0));\n        if (y > HALF_SIZE) {\n            y = HALF_SIZE;\n        }\n        else if (y < -HALF_SIZE) {\n            y = -HALF_SIZE;\n        }\n        \n        gl_Position = vec4(\n            ((x-extent.x) / delta.x) * 2.0 - 1.0,\n            ((y-extent.w) / delta.y) * -2.0 + 1.0,\n            0.0, 1.0);\n       \n        gl_PointSize = 10.0 + (20000.0 / resolution);\n    }","\n    precision highp float;\n    \n    varying float intensity;\n    \n    void main(void) {\n        float a = 0.0;\n        vec2 cxy = 2.0 * gl_PointCoord - 1.0;\n        a = 1.0 - dot(cxy, cxy);\n        if (a <= 0.0)\n            discard;\n        a = a * mix(intensity, 0.05, 0.5);\n        \n        gl_FragColor = vec4(0.0, 0.0, 0.0, a);\n    }"),this._colorProgram=cl.createProgram(n,"\n     precision highp float;\n\n    attribute vec2 pos;\n    varying vec2 readPos;\n    \n    void main(void) {\n        // intensity = texture2D(grayScale, pos).a;\n        // color = texture2D(grayScale, vec2(pos.x * 1280.0, pos.y * 500.0));\n        // color = texture2D(colorScale, vec2(0.5, 1.0));\n        \n        readPos = pos;\n        \n        gl_Position = vec4(\n            pos * 2.0 - 1.0,\n            0.0, 1.0);\n    }","\n    precision highp float;\n    \n    uniform sampler2D colorScale;\n    uniform sampler2D grayScale;\n    // varying float intensity;\n    varying vec2 readPos;\n    \n    void main(void) {\n        \n        float intensity = texture2D(grayScale, readPos).a;\n        \n        if (intensity <= 0.0)\n            discard;\n            \n        vec4 color = texture2D(colorScale, vec2(intensity, 0.5));\n        color = color * intensity;\n        \n        gl_FragColor = color;\n    }"),this._dataBuffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this._dataBuffer),n.bufferData(n.ARRAY_BUFFER,new Float32Array(this._vertices),n.STATIC_DRAW),this._squareBuffer=cl.createSquareBuffer(n),n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),this._frameBuffer=n.createFramebuffer(),this._context=n,this._canvas=e}_canvasFunction(t,e,n,i,r){return this._size=i,this._context||this._initiateWebGL(i),this._vertices&&(this._resize(),this._updateGrayScaleTexture(this._vertices.length/3,i,t,e),this._renderColors(i)),this._canvas}_updateGrayScaleTexture(t,e,n,i){const r=this._grayScaleProgram,o=this._context;o.useProgram(r.program),o.bindFramebuffer(o.FRAMEBUFFER,this._frameBuffer),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,this._grayScaleTexture,0),o.viewport(0,0,e[0],e[1]),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT);const s=n[2]-n[0],a=n[1]-n[3];o.uniform4fv(r.extent,n),o.uniform2fv(r.delta,[s,a]),o.uniform1f(r.resolution,i),o.bindBuffer(o.ARRAY_BUFFER,this._dataBuffer),o.vertexAttribPointer(r.vertPosition,2,o.FLOAT,!1,3*Float32Array.BYTES_PER_ELEMENT,0),o.vertexAttribPointer(r.value,1,o.FLOAT,!1,3*Float32Array.BYTES_PER_ELEMENT,2*Float32Array.BYTES_PER_ELEMENT),o.enableVertexAttribArray(r.vertPosition),o.enableVertexAttribArray(r.value),o.enable(o.BLEND),o.enable(o.CULL_FACE),o.blendFunc(o.ONE,o.ONE_MINUS_SRC_ALPHA),o.drawArrays(o.POINTS,0,t)}_renderColors(t){const e=this._colorProgram,n=this._context;n.useProgram(e.program),n.bindFramebuffer(n.FRAMEBUFFER,null),n.viewport(0,0,t[0],t[1]),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),n.activeTexture(this._context.TEXTURE0),n.bindTexture(this._context.TEXTURE_2D,this._colorScaleTexture),n.activeTexture(this._context.TEXTURE0+1),n.bindTexture(this._context.TEXTURE_2D,this._grayScaleTexture),n.uniform1i(e.colorScale,0),n.uniform1i(e.grayScale,1),n.bindBuffer(n.ARRAY_BUFFER,this._squareBuffer),n.enableVertexAttribArray(e.pos),n.vertexAttribPointer(e.pos,2,n.FLOAT,!1,4*Float32Array.BYTES_PER_ELEMENT,0),n.drawArrays(n.TRIANGLE_STRIP,0,4)}_resize(){const t=this._context;ll.setCanvasSize(this._canvas,this._size),this._grayScaleTexture=cl.createTexture(t,t.NEAREST,this._size[0],this._size[1],null),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT)}};var hl=ul=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)()],ul);let dl=class{constructor(){this._mediator=cd.get(lr.Mediator),this._nightMode=cd.get(lr.NightMode)}initialize(t){t=Po(t,Go),this._validateControlOptions(t),this._position=t.position,this._flow=t.flow,this._index=t.index,this._mediator.subscribe(cr.NIGHTMODE,()=>{this._controlHTMLElement&&(this._nightMode.getNight()?this._controlHTMLElement.classList.add("night"):this._controlHTMLElement.classList.remove("night"))})}_validateControlOptions(t){const{position:e,index:n,flow:i}=t;if(!Q.isNumber(n))throw at(tt.Properties.LAYER_ID,tt.Module.LAYER);if(!Q.isInEnum(Mt,e))throw ct(tt.Properties.POSITION,tt.Module.WIDGET_CONTROL);if(!Q.isInEnum(Mo,i))throw ct(tt.Properties.POSITION,tt.Module.WIDGET_CONTROL)}addedToMap(t){this._mapContainer=t,this.onAddedToMap(t)}getHTMLElement(){return this._controlHTMLElement}setHTMLElement(t){this._controlHTMLElement=t,this._controlHTMLElement.classList.add("no-select"),this._nightMode.getNight()&&t.classList.add("night")}getIndex(){return this._index}getPosition(){return this._position}getFlow(){return this._flow}getMapUIManager(){return this._mapContainer.getMapUIHandler()}getMapContainer(){return this._mapContainer}getNightMode(){return this._nightMode}onAddedToMap(t){}};var fl,pl=dl=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)()],dl);let gl=fl=class extends pl{constructor(){super(...arguments),this._onClickListeners=[],this._onUnselectListeners=[],this._hasPopoutMenu=!1}initialize(t){super.initialize(t),this._options=Po(t,qo),fl._validateButtonControlOptions(this._options);const{normalIcon:e,activeIcon:n,solidIcons:i}=this._options,r=fl.createButtonControlHTMLElement(e,n,i);this.setHTMLElement(r),this._initializeState(),this._initializeEventListeners(),this._initializePopoutMenu()}_initializeState(){this._options.smallIcon&&this.getHTMLElement().classList.add("icon-small")}_initializePopoutMenu(){const t=this._options.popoutButtonControls;if(t)for(const e of t)this.addButtonControlToPopoutMenu(e)}_initializeEventListeners(){this.getHTMLElement().addEventListener("click",t=>{this._hasPopoutMenu&&(this._selectedPopoutButtonControl?this.setNoSelected():(this.togglePopoutMenuActive(),this.toggleActive()));for(const t of this._onClickListeners)this.getMapUIManager()&&t(this.getMapUIManager());t.stopPropagation()})}static _validateButtonControlOptions(t){const{normalIcon:e,activeIcon:n}=t;if(!Q.isString(e))throw at(tt.Properties.NORMAL_ICON,tt.Module.CONTROL);if(n&&!Q.isString(n))throw at(tt.Properties.ACTIVE_ICON,tt.Module.CONTROL)}onClick(t){this._onClickListeners.push(t)}onUnselect(t){this._onUnselectListeners.push(t)}setPopoutMenuActive(t){const e=this.getHTMLElement().querySelector(".sintium-map-button-control-popout-menu");t?e.classList.add("sintium-map-button-control-popout-menu-visible"):e.classList.remove("sintium-map-button-control-popout-menu-visible")}togglePopoutMenuActive(){this.getHTMLElement().querySelector(".sintium-map-button-control-popout-menu").classList.toggle("sintium-map-button-control-popout-menu-visible")}addButtonControlToPopoutMenu(t){this._hasPopoutMenu=!0;const e=this.getMapContainer();if(Q.isMapControl(t)&&t.addedToMap(e),t.onClick(()=>{this._options.keepSelected&&this._setAsSelected(t)}),!Q.isMapBaseControl(t))return;const n=t.getHTMLElement();this.getHTMLElement().querySelector(".sintium-map-button-control-popout-menu").appendChild(n)}addButtonControlsToPopoutMenu(...t){for(const e of t)this.addButtonControlToPopoutMenu(e)}_setAsSelected(t){let e;this._selectedPopoutButtonControl=t,Q.isMapBaseControl(t)&&(e=t.getHTMLElement().querySelector(".active-icon")),this.getHTMLElement().querySelector(".selected-icon").className=e.className.replace("active-icon","selected-icon"),this._toggleButtonState("selected"),this.setPopoutMenuActive(!1)}setNoSelected(){this._toggleButtonState("normal"),this._selectedPopoutButtonControl.unSelect(),this._selectedPopoutButtonControl=null}unSelect(){for(const t of this._onUnselectListeners)this.getMapUIManager()&&t(this.getMapUIManager())}isActive(){return this.getHTMLElement().classList.contains("active")}setActive(t){this._toggleButtonState(t?"active":"normal")}toggleActive(){this.getHTMLElement().classList.toggle("normal"),this.getHTMLElement().classList.toggle("active")}_toggleButtonState(t){this.getHTMLElement().classList.remove("normal","active","selected"),this.getHTMLElement().classList.add(t)}static createButtonControlHTMLElement(t,e,n){e=e||t;const i=document.createElement("div"),r=n?"fas":"far";return i.innerHTML=`\n                <div class="sintium-map-button-control sintium-map-control normal">\n                    <i class="${r} fa-${t} normal-icon"></i>\n                    <i class="${r} fa-${e} active-icon"></i>\n                    <i class="${r} selected-icon"></i>\n                    <div class="sintium-map-button-control-popout-menu"> </div>\n                </div>\n        `,i.firstElementChild}};var _l=gl=fl=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)()],gl);let ml=class extends _l{initialize(t){super.initialize({normalIcon:"fas fa-moon"});const e=this.getNightMode().getNight();this.setActive(e),this.onClick(()=>{this.toggleActive(),this.getNightMode().toggleNight()})}};var yl=ml=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)()],ml);let vl=class extends pl{constructor(){super(...arguments),this._controls=[]}initialize(t){super.initialize(t),this._options=Po(t,Xo);const e=q.createElement("div","sintium-map-composite-control");this.setHTMLElement(e)}addControl(t){this._controls.push(t),q.removeChildren(this.getHTMLElement()),this._controls.forEach(t=>{this.getHTMLElement().appendChild(t.getHTMLElement())})}addedToMap(t){super.addedToMap(t),this._controls.forEach(e=>{e.addedToMap(t)})}};var bl=vl=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)()],vl);class Cl{static launchIntoFullscreen(t){t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()}static exitFullscreen(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}static inFullScreen(){return!!(document.isFullScreen||document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)}static toggleFullscreen(t){Cl.inFullScreen()?Cl.exitFullscreen():Cl.launchIntoFullscreen(t)}}let wl=class extends _l{constructor(){super(...arguments),this._inFullScreen=!1}initialize(t){super.initialize(Object.assign(t,{normalIcon:"expand",activeIcon:"compress"})),this._initializeFullScreenEventListeners()}_initializeFullScreenEventListeners(){this.onClick(t=>{this.toggleActive();const e=t.getMapHTMLElement();Cl.toggleFullscreen(e)}),document.addEventListener("fullscreenchange",function(){!document.fullscreenElement&&this._inFullScreen&&(this.toggleActive(),this._inFullScreen=!1)}.bind(this))}};var El=wl=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)()],wl);let Tl=class extends _l{initialize(t){super.initialize(Object.assign(t,{normalIcon:"pen",keepSelected:!0}))}addedToMap(t){super.addedToMap(t),this._initializeDrawButtonControl("vector-square",Qi.BOX),this._initializeDrawButtonControl("draw-polygon",Qi.POLYGON)}_initializeDrawButtonControl(t,e){const n=cd.get(lr.ButtonControl);n.initialize({normalIcon:t}),n.onClick(()=>this._callStartDrawing(e)),n.onUnselect(t=>{t.getDrawingHandler().stopDrawing()}),this.addButtonControlToPopoutMenu(n)}_callStartDrawing(t){this.getMapUIManager().getDrawingHandler().startDrawing(t,e=>{e.didComplete()?(e.addToMap(),this._callStartDrawing(t)):this.setNoSelected()})}};var Sl=Tl=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)()],Tl),xl=function(t,e){return function(n,i){e(n,i,t)}};let Rl=class extends bl{constructor(t,e){super(),this._plusButtonControl=t,this._minusButtonControl=e}initialize(t){super.initialize(Object.assign({index:-5},t)),this._initializePlusControl(),this._initializeMinusControl()}_initializePlusControl(){this._plusButtonControl.initialize({normalIcon:"plus",smallIcon:!0}),this._plusButtonControl.onClick(()=>{this.getMapUIManager().zoomIn()}),Q.isMapButtonControl(this._plusButtonControl)&&this.addControl(this._plusButtonControl)}_initializeMinusControl(){this._minusButtonControl.initialize({normalIcon:"minus",smallIcon:!0}),this._minusButtonControl.onClick(()=>{this.getMapUIManager().zoomOut()}),Q.isMapButtonControl(this._minusButtonControl)&&this.addControl(this._minusButtonControl)}};var Al=Rl=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)(),xl(0,Object(nt.inject)(lr.ButtonControl)),xl(1,Object(nt.inject)(lr.ButtonControl))],Rl);class Ol extends pl{initialize(t){this._options=t=Po(t,Ko);const{width:e,height:n,customStyle:i,widget:r}=t;super.initialize(t),this._validateWidgetControlOptions(t);const o=Ol.createWidgetControlHTMLElement(e,n,i);this.setHTMLElement(o),this.addWidget(r)}_validateWidgetControlOptions(t){const{widget:e}=t;if(!e)throw st(tt.Properties.WIDGET,tt.Module.WIDGET_CONTROL);if(!Q.isSintiumWidget(e))throw at(tt.Properties.LAYER_ID,tt.Module.LAYER)}addWidget(t){this._widget=t;const e=t.getHTMLElement();this.getHTMLElement().querySelector(".sintium-map-widget-control-content").appendChild(e),t.onAddedToWidgetContainer&&(/complete|loaded/.test(document.readyState)?t.onAddedToWidgetContainer(this):document.addEventListener("DOMContentLoaded",()=>t.onAddedToWidgetContainer(this)))}getWidgets(){return[this._widget]}static createWidgetControlHTMLElement(t,e,n){t=Q.isString(t)?t:`${t}px`,e=Q.isString(e)?e:`${e}px`;const i=document.createElement("div"),r=n?"no-map-control-style":"";return i.innerHTML=`\n                <div class="sintium-map-control sintium-map-widget-control no-select ${r}" style="height: ${e}; width: ${t}">\n                    <div class="sintium-map-widget-control-content" style="height: 100%; width: 100%"></div>\n                </div>\n            `,i.firstElementChild}}var Il=n(48);let Ml=class extends _l{constructor(){super(...arguments),this._shouldSave=!1}initialize(t){super.initialize(Object.assign(t,{normalIcon:"camera"})),this._initializeEventListener()}_initializeEventListener(){this.onClick(t=>{if(this._shouldSave)return;const e=t.getMap();this._shouldSave=!0,e.renderSync()})}addedToMap(t){super.addedToMap(t),t.getMapUIHandler().getMap().on("rendercomplete",t=>{if(!this._shouldSave)return;const e=t.context.canvas;navigator.msSaveBlob?navigator.msSaveBlob(e.msToBlob(),"map.png"):e.toBlob(function(t){Object(Il.saveAs)(t,"map.png")}),this._shouldSave=!1})}};var Pl,Ll=Ml=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)()],Ml);let Dl=Pl=class{constructor(){this._widgets=[]}initialize(t){if(this._options=Po(t,$o),this._validateDrawerOptions(this._options),this._drawerHTMLElement=Pl.createDrawerHTMLElement(this._options.content,this._options.position),this._options.buttonControl&&this._initializeDrawerButton(),this._options.widgets&&this._addWidgets(this._options.widgets),this._options.domId){const t=document.getElementById(this._options.domId);this._drawerHTMLElement.appendChild(t)}}_initializeDrawerButton(){this._drawerButtonControl=this._options.buttonControl,this._drawerButtonControl.onClick(()=>{Q.isMapBaseControl(this._drawerButtonControl)&&this._mapUIHandler&&(this._drawerButtonControl.isActive()?this._mapUIHandler.hideDrawer(this):this._mapUIHandler.showDrawer(this))})}_validateDrawerOptions(t){const{position:e,buttonControl:n,widgets:i}=t;if(!Q.isInEnum(It,e))throw ct(tt.Properties.POSITION,tt.Module.DRAWER);if(n&&!Q.isMapButtonControl(n))throw ct(tt.Properties.BUTTON_CONTROL,tt.Module.DRAWER);if(i&&!Q.arrayOf(Q.isSintiumWidget,i))throw ct(tt.Properties.WIDGETS,tt.Module.DRAWER)}open(t,e){if(!this._initialized)throw new Error("Drawer was not initialized. Add it as an extension to a map.");this._nextCloseCallback=null,this._mapUIHandler.showDrawer(this),this._nextCloseCallback=e}close(){if(!this._initialized)throw new Error("Drawer was not initialized. Add it as an extension to a map.");this._mapUIHandler.hideDrawer(this),this._nextCloseCallback&&this._nextCloseCallback()}initializeExtension(t){this._drawerButtonControl&&Q.isMapButtonControl(this._drawerButtonControl)&&this._drawerButtonControl.addedToMap(t),this._mapUIHandler=t.getMapUIHandler(),this._mapUIHandler.addDrawer(this),this._initialized=!0}_addWidgets(t){for(const e of t)this.addWidget(e)}addWidget(t){this._widgets.push(t);const e=t.getHTMLElement();this._drawerHTMLElement.appendChild(e),t.onAddedToWidgetContainer&&t.onAddedToWidgetContainer(this)}getWidgets(){return this._widgets}getHTMLElement(){return this._drawerHTMLElement}moveToFront(){this._drawerButtonControl&&this._drawerButtonControl.setActive(!0),this._drawerHTMLElement.classList.add("sintium-map-drawer-content-on-top")}moveToBack(){this._drawerButtonControl&&this._drawerButtonControl.setActive(!1),this._drawerHTMLElement.classList.remove("sintium-map-drawer-content-on-top"),this._nextCloseCallback&&this._nextCloseCallback()}shouldPreview(){return!!this._options.previewSize}getPreviewSize(){return this._options.previewSize}getSize(){return this._options.size}getOpenClass(){return this._options.openClass}getButtonControl(){return this._drawerButtonControl}hasButtonControl(){return!!this._drawerButtonControl}getPosition(){return this._options.position}getDrawerHTMLElement(){return this._drawerHTMLElement}static createDrawerHTMLElement(t,e){const n=document.createElement("div");return n.innerHTML=`\n            <div class="sintium-map-drawer-content sintium-map-drawer-content-${e}">\n            </div>\n        `,n.firstElementChild}};var kl=Dl=Pl=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)()],Dl);class Fl{static setCookie(t,e,n){n||(n=31536e6);let i=new Date;i.setTime(i.getTime()+n),document.cookie=t+"="+e+"; expires="+i.toUTCString()+"; path=/"}static getCookie(t){const e=("; "+document.cookie).split("; "+t+"=");if(2==e.length)return e.pop().split(";").shift()}static deleteCookie(t){const e=new Date(0).toUTCString();document.cookie=t+"=; expires="+e+"; path=/"}}class Nl{initialize(t){t=Po(t,ns),this._width=t.width,this._title=t.title,this._buttonText=t.buttonText,this._initializeModal()}_initializeModal(){this._modal=this._renderModal(),document.body.appendChild(this._modal),this._modal.querySelector(".sintium-modal-close").addEventListener("click",()=>this.close());const t=this._modal.querySelector(".sintium-modal-content");t.setAttribute("style",`width: ${this._width}px`),this._modalContent=this.renderContent(),t.appendChild(this._modalContent),this._renderButton(t)}_renderModal(){const t=document.createElement("div");return t.classList.add("sintium-modal"),t.innerHTML=`\n            <form action="#" action="post" onsubmit="return false">\n                <div class="sintium-modal-content">\n                    <div class="sintium-modal-header">\n                        <div class="sintium-modal-title">${this._title}</div>\n                        <div class="sintium-modal-close">&times;</div>\n                    </div>\n                </div>\n            </form>\n        `,t.querySelector(".sintium-modal-close").addEventListener("click",this.closeClick.bind(this)),t}_renderButton(t){const e=document.createElement("div");e.classList.add("sintium-modal-button-container"),e.innerHTML=`<button class="sintium-modal-button" type="submit">${this._buttonText}</button>`,e.addEventListener("click",this.buttonClick.bind(this)),t.appendChild(e)}open(){this._modal.style.display="block"}close(){this._modal.style.display="none"}buttonClick(){throw new Error("buttonClick() not implemented.")}closeClick(){this.close()}renderContent(){throw new Error("renderContent() not implemented.")}}class jl extends Nl{initialize(t){t=Object.assign({title:"Logg inn"},t),super.initialize(t)}renderContent(){return this._loginContent=document.createElement("div"),this._loginContent.classList.add("sintium-login-modal-content"),this._loginContent.innerHTML='\n            <label for="username">\n                <b>Brukernavn</b>\n            </label>\n            <input type="text" placeholder="" class="username" name="username" required>\n            \n            <label for="password">\n                <b>Passord</b>\n            </label>\n            <input type="password" placeholder="" class="password" name="password" required>\n        ',this._loginContent}buttonClick(){if(!this._onAuthenticationCallback)throw new Error("No Authentication Callback");{const t=this._loginContent.querySelector("input.username").value,e=this._loginContent.querySelector("input.password").value;this._onAuthenticationCallback(t,e)}}onAuthentication(t){this._onAuthenticationCallback=t}}let Bl=class{constructor(){this._isAuthenticated=!1,this._contentType="application/x-www-form-urlencoded"}initialize(t,e){this._apiTokenUrl=t,this._token=e||Fl.getCookie(this._apiTokenUrl),e&&(this._token=e,this._isAuthenticated=!0)}contentType(t){return this._contentType=t,this}authenticate(){return new Promise((t,e)=>{const n=new jl;n.initialize(),n.open(),n.onAuthentication((n,i)=>{this._buildUsernamePasswordRequest(n,i,this._contentType).then(()=>{t()}).catch(t=>{e()})})})}_buildUsernamePasswordRequest(t,e,n){return fetch(this._apiTokenUrl,this._buildUsernamePasswordHeader(t,e,n)).then(t=>t.json()).then(t=>{const{access_token:e,expires:n}=t;return e?(this._isAuthenticated=!0,this._token=e,Fl.setCookie(this._apiTokenUrl,e,n),Promise.resolve()):Promise.reject()})}_buildUsernamePasswordHeader(t,e,n){return{method:"POST",headers:{"content-type":n},mode:"cors",cache:"no-cache",body:`grant_type=password&username=${t}&password=${e}`}}getAuthenticatedFetch(){return this._authenticatedFetch.bind(this)}getAuthenticationData(){return{headers:{Authorization:`Bearer ${this._token}`}}}_authenticatedFetch(t){const e={headers:{Authorization:`Bearer ${this._token}`}};return fetch(t,e)}isAuthenticated(){return this._isAuthenticated}clearToken(){this._isAuthenticated=!1,Fl.deleteCookie(this._apiTokenUrl)}setToken(t){this._token=t}getToken(){return this._token}};var zl=Bl=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)()],Bl),Ul=n(28),Hl=n.n(Ul);let Wl=class{constructor(){this._currentData={}}initialize(t){this._checkIfTemplateWidgetOptionsAreValid(t),t.initialData&&(this._currentData=t.initialData),t.domId?this._initializeFromDomId(t.domId):t.html&&this._initializeFromHtml(t.html),this._currentData&&this.setData(this._currentData),this._options=t}_initializeFromDomId(t){this._templateWidgetHTMLElement=document.getElementById(t);const e=this._templateWidgetHTMLElement.innerHTML;this._template=Hl.a.template(e,null,this._currentData)}_initializeFromHtml(t){const e=q.generateEmptyWidgetDomId();this._templateWidgetHTMLElement=document.getElementById(e),this._template=Hl.a.template(t,null,this._currentData)}_checkIfTemplateWidgetOptionsAreValid(t){const{domId:e,html:n}=t;if(!e&&!n)throw((t,e)=>new Error(`At least one of the properties ${t.join(", ")} is required for ${e}.`))(["domId","html"],"templateWidget");if(e&&!Q.isString(e))throw at("domId","templateWidget");if(n&&!Q.isString(n))throw at("html","templateWidget")}setData(t){this._currentData=t,this._templateWidgetHTMLElement.innerHTML=this._template(t)}setVariable(t,e){this._currentData[t]=e,this._templateWidgetHTMLElement.innerHTML=this._template(this._currentData)}getID(){return this._options.domId}getHTMLElement(){return this._templateWidgetHTMLElement}};var Gl=Wl=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)()],Wl);class Vl{constructor(){this._query={},this._query.__table__=null;const t=new Proxy(this,{get:(e,n)=>"table"===n?n=>(e._query.__table__=n,t):"query"===n?e._query:"result"===n?e._query.result:"update"===n?e._query.update:i=>(e._query[n]=i,t),set:(t,e,n)=>"result"===e?(t._query.result=n,!0):("update"===e&&(t._query.update=n),!1)});return t}}class Yl{constructor(){this._data=[]}add(t){return(t=Object.assign({},t)).__table__=null,this._data.push(t),{toTable:e=>t.__table__=e}}queryAll(t){const e=t.query;return e.result=this._data.filter(t=>this._compare(t,e)).map(this._immutable),this._addResultFunctions(e)}query(t){const e=t.query;for(const t of this._data)if(this._compare(t,e))return e.result=[this._immutable(t)],this._addResultFunctions(e)}has(t){return this.queryAll(t).result.length>0}hasSingle(t){return 1===this.queryAll(t).result.length}all(){return this._data}static get query(){return new Vl}_compare(t,e){return Object.keys(e).map(n=>e[n]===t[n]).every(t=>t)}_addResultFunctions(t){return t.update=e=>{t.result.forEach(t=>{Object.keys(e).forEach(n=>{t[n]=e[n]})})},t.remove=()=>{this._data=this._data.filter(e=>t.result.indexOf(e)>-1)},t}_immutable(t){return Object.assign({},t)}}var ql=function(t,e){return function(n,i){e(n,i,t)}};let Xl=class{constructor(t,e){this._colors=new Yl,this._colorSchemes=[],this.changeListeners=[],this._colorsDB=new Yl,this._nightMode=e,this._initializeNightModeListener(t)}_initializeNightModeListener(t){t.subscribe(cr.NIGHTMODE,this._repositoryHasChanged.bind(this))}getColorsAndIndexLookup(t,e){const n={};return{colors:this.getColorsForColumn(t,e).map((t,e)=>(n[e]=t.columnValue,t.value)),indexLookup:n}}getColorScaleForColumn(t,e){const n=o.scaleOrdinal(),i=[],r=[];return this.getColorsForColumn(t,e).forEach((t,e)=>{i.push(t.columnValue),r.push(t.value)}),n.domain(i).range(r)}setColorsForColumnCapped(t,e,n,i){const r=t.getUniqueValuesForColumn(e);r.push(n),this._setColorsForColumn(t,e,r,i)}setColorsForColumn(t,e,n){const i=t.getUniqueValuesForColumn(e);this._setColorsForColumn(t,e,i,n)}_setColorsForColumn(t,e,n,i){if(i&&i.length<n.length)throw new Error("Mismatch between ");let r;if(n=n.map(t=>t.toString()),i)r=i;else{const i=this.getColorSchemeForColumn(t,e);r=this.getColorsFromScheme(i,n.length)}const o=Yl.query.table("color-list").dataSourceId(t.getId()).column(e);this._colors.hasSingle(o)?o.update({list:r}):this._colors.add({dataSourceId:t.getId(),column:e,list:r}).toTable("color-list");let s=this._colors.queryAll(o).result.length;for(let i=0;i<n.length;i++){const o=r[i],a=n[i],c=Yl.query.dataSourceId(t.getId()).column(e).columnValue(a);this._colors.hasSingle(c)||this._colors.add({value:o,column:e,columnValue:a,dataSourceId:t.getId(),index:s++})}this._repositoryHasChanged()}clearColorsForColumn(t,e){this._colors.queryAll(Yl.query.column(e)).remove()}setColorForColumn(t,e,n){const i=t.getId();let r={value:n=n||this._findBestColor(t,e),column:e,dataSourceId:i};this._colors.add(r)}refreshColorForColumn(t,e){this.clearColorsForColumn(t,e),this.setColorsForColumn(t,e)}setColor(t,e){let n={value:e=e||"#f45b5b",dataSourceId:t.getId()};this._colors.add(n)}setColorSchemeForColumn(t,e,n){const i=t.getId();this._colorSchemes.push({dataSourceId:i,column:e,colorScheme:n})}getColorForColumnValue(t,e,n){const i=t.getId(),r=Yl.query.table("color-list").dataSourceId(i).column(e);if(this._colors.hasSingle(r)){const t=Yl.query.dataSourceId(i).column(e).columnValue(n);if(this._colors.hasSingle(t)){const e=r.result.pop().list[t.result.pop().index];return this._nightMode.getNight()?this._getNightModeColor(e):e}}}getColorsForColumn(t,e){const n=t.getId(),i=Yl.query.dataSourceId(n).column(e);return this._colors.queryAll(i).result.map(n=>this.getColorForColumnValue(t,e,n.columnValue))}getColor(t){const e=t.getId(),n=Yl.query.dataSourceId(e);if(this._colors.hasSingle(n)){const t=n.result.pop().value;return this._nightMode.getNight()?this._getNightModeColor(t):t}}getColorSchemeForColumn(t,e){const n=t.getId(),i=this._colorSchemes.filter(t=>t.dataSourceId==n&&t.column==e).pop();return i?i.colorScheme:Ct}getColorsFromScheme(t,e){const{chromaColors:n,colors:i,name:r}=t;if(n)return rr.a.scale(n).colors(e);if(i){const t=new Array(e);for(let n=0;n<e;n++)t[n]=i[n%i.length];return t.length,i.length,t}throw new Error(`Invalid colorscheme ${r}`)}getColumnValues(t,e){return this._colors.queryAll(Yl.query.dataSourceId(t.getId()).column(e)).map(t=>t.columnValue)}_repositoryHasChanged(){this.changeListeners.forEach(t=>t())}onChange(t){this.changeListeners.push(t),t()}hasColorForColumnValue(t,e,n){const i=Yl.query.dataSourceId(t.getId()).column(e).columnValue(n);return this._colors.hasSingle(i)}_findBestColor(t,e){const n=this._colors.all().map(t=>t.value),i=this._getAvailableColorsForColumn(t,e);if(0==n.length)return i[0];const r=i.map(t=>{return n.map(e=>rr.a.deltaE(t,e)).reduce((t,e)=>t*e)});return i[r.indexOf(Math.max(...r))]}_getAvailableColorsForColumn(t,e){let n=this.getColorSchemeForColumn(t,e);return(n=n&&!n.colors?n:Ct).colors}_getNightModeColor(t){const e=rr()(t);return e.luminance()>.1?e.darken(1.5):e.brighten(.5)}};var Kl=Xl=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)(),ql(0,Object(nt.inject)(lr.Mediator)),ql(1,Object(nt.inject)(lr.NightMode))],Xl),$l=function(t,e){return function(n,i){e(n,i,t)}};let Zl=class{constructor(t){this._night="on"==Fl.getCookie("night"),this._mediator=t}getNight(){return this._night}toggleNight(){const t=!this._night;this.setNight(t),this._mediator.publish(cr.NIGHTMODE,{night:t})}setNight(t){Fl.setCookie("night",t?"on":"off"),this._night=t,this._mediator.publish(cr.NIGHTMODE,{night:t})}};var Jl,Ql=Zl=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)(),$l(0,Object(nt.inject)(lr.Mediator))],Zl),tu=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};let eu=Jl=class{constructor(){this._selectedFeatures=[],this._currentLayers=[]}initialize(t){this._mapContainer=t,this._drawingHandler=t.getDrawingHandler(),this._layerHandler=t.getLayerHandler()}onClickSingleFeature(t,e){const n=e.isCluster()?"cluster":"single",i=this._layerHandler.getLayerContainerByFeature(e);if(!Q.isSelectableLayer(i))return;const r=this._createConditionStringFromEvent(t);i.featureSelection(n,r,e,this.setSelection.bind(this)),this._mediator.publish(cr.FORCE_REDRAW,{dataSourceId:"*"})}onClickEmptySpace(t){if(this._isMultiSelecting)return;const e=this._createConditionStringFromEvent(t),n=this._getAvailableMultiSelectors(e);1===n.length?this._multiSelection(t,n.pop(),e):this.clearSelection()}_getAvailableMultiSelectors(t){const e=[];for(const n of this._layerHandler.getSelectableLayerContainers(!0)){const i=n.getMultiSelector(t);i&&e.push(i)}if(e.length>1)throw new Error("Conflicting selection specifications.");return e}onViewportChange(t){this._layerHandler.getSelectableLayerContainers(!0).forEach(e=>{e.multiFeatureSelection("viewport","change",t,this.setSelection.bind(this))})}_multiSelection(t,e,n){if(this._drawingHandler.isDrawing())return;const i=Jl._getDrawTypeFromSelector(e);this._isMultiSelecting=!0,this._drawingHandler.startDrawingWithPoint(i,t.coordinate,t=>{if(!t.didComplete())return;this._currentGeometry=t.getGeometry();const i={};this._layerHandler.getSelectableLayerContainers(!0).forEach(t=>{if(Q.isDataLayer(t)){const e=t.getDataSource().getId();i[e]=!0}t.multiFeatureSelection(e,n,this._currentGeometry,this.setSelection.bind(this))}),this._mediator.publish(cr.FORCE_REDRAW,{dataSourceId:"*"}),this._isMultiSelecting=!1})}setSelection(t){this._selectedFeatures.forEach(t=>t.setSelected(!1)),Q.isArray(t)||(t=[t]),t.forEach(t=>t.setSelected(!0)),this._selectedFeatures=t}clearSelection(){this._currentGeometry=null,this._layerHandler.getSelectableLayerContainers(!0).forEach(t=>t.clearSelection()),this._selectedFeatures.forEach(t=>t.setSelected(!1)),this._selectedFeatures=[],this._mediator.publish(cr.FORCE_REDRAW,{dataSourceId:"*"})}_createConditionStringFromEvent(t){let e=this._initializeCondition(t);const n=t.pointerEvent;return n.altKey&&e.push("alt"),n.ctrlKey&&e.push("ctrl"),n.shiftKey&&e.push("shift"),e.sort().join("-")}_initializeCondition(t){switch(t.type){case"click":case"singleclick":return["click"];case"dblclick":return["dblclick"];default:throw new Error(`No handling for event of type ${t.type}`)}}static _getDrawTypeFromSelector(t){switch(t){case"box":return Qi.BOX;case"polygon":return Qi.POLYGON}}};tu([Object(nt.inject)(lr.Mediator)],eu.prototype,"_mediator",void 0);var nu,iu=eu=Jl=tu([Object(nt.injectable)()],eu),ru=function(t,e){return function(n,i){e(n,i,t)}};let ou=nu=class extends Us{constructor(t,e){super(),this._visible=!0,this._visibilityChange=[],this._nightMode=t,this._mediator=e}initialize(t,e){this._widgetGrid=t,this._options=Po(e,zo),this._initializeItemHTMLElement();const{x:n,y:i,height:r,width:o,resizable:s,movable:a,visible:c}=this._options,l=t.getGridStack();this._gridItem=l.addWidget(this._itemHTMLElement,n,i,o,r),this._syncStateWithWidget(),l.resizable(this._gridItem,0!=s),l.movable(this._gridItem,0!=a),!1===c&&this._hideWidget(),this._setupEventListeners()}_initializeItemHTMLElement(){this._itemHTMLElement=nu._createWidgetItemHTMLElement(this._options);const t=this._itemHTMLElement.querySelector(".panel");this._nightMode.getNight()&&t.classList.add("night"),this._mediator.subscribe(cr.NIGHTMODE,()=>{this._nightMode.getNight()?t.classList.add("night"):t.classList.remove("night")})}_setupEventListeners(){this._widgetGrid.getGridStack().container.on("gsresizestop",()=>{this._widget&&this._widget.onWidgetContainerSizeChange&&this._widget.onWidgetContainerSizeChange(this)}),this._itemHTMLElement.querySelector(".full-screen").addEventListener("click",()=>Cl.toggleFullscreen(this._itemHTMLElement)),0!=this._options.closable&&this._itemHTMLElement.querySelector(".configuration").addEventListener("click",()=>this._hideWidget())}addWidget(t){this._widget=t;const e=t.getHTMLElement();this._itemHTMLElement.querySelector(".grid-stack-item-content-wrapper").appendChild(e),t.onAddedToWidgetContainer&&t.onAddedToWidgetContainer(this),this._widget.availableOptions&&this._addWidgetOptions()}setVisible(t=!0){t?this._showWidget():this._hideWidget()}_hideWidget(){this._visible=!1,this._syncStateWithWidget(),o.select(this._itemHTMLElement).attr("display","none"),document.body.appendChild(this._itemHTMLElement),this._widgetGrid.getGridStack().removeWidget(this._itemHTMLElement),this.trigger("visibility-change",{visible:this._visible})}_showWidget(t){this._visible=!0;const{x:e,y:n,height:i,width:r,id:s,visible:a}=t||this.state();o.select(this._itemHTMLElement).attr("display","block"),this._widgetGrid.getGridStack().addWidget(this._itemHTMLElement,e,n,r,i),this.trigger("visibility-change",{visible:this._visible})}_addWidgetOptions(){const t=this._itemHTMLElement.querySelector(".panel-controls"),e=this._widget.availableOptions().slice().reverse();for(const n of e)this._addWidgetOption(t,n);if(this._options.widgetOptions)for(const e of this._options.widgetOptions)this._addWidgetOption(t,e)}_addWidgetOption(t,e){const n=document.createElement("li");n.innerHTML=`<a><i class="${e.icon}"></i></a>`,n.querySelector("a").onclick=t=>{e.callback(),t.preventDefault()},e.class&&n.classList.add(e.class),t.insertBefore(n,t.firstChild)}getOptions(){return this._options}getWidget(){return this._widget}state(t){if(void 0===t)return this._syncStateWithWidget(),this._state;this._hideWidget(),t.visible&&this._showWidget(t)}_syncStateWithWidget(){const t=o.select(this._gridItem[0]);this._state={x:parseFloat(t.attr("data-gs-x")),y:parseFloat(t.attr("data-gs-y")),width:parseFloat(t.attr("data-gs-width")),height:parseFloat(t.attr("data-gs-height")),visible:this._visible,id:this._options.id}}getHTMLElement(){return this._itemHTMLElement}getWidgets(){return[this._widget]}visible(){return this._visible}getID(){return this._options.id}static _createWidgetItemHTMLElement(t){const{title:e,subtitle:n,closable:i}=t,r=document.createElement("div");if(r.innerHTML=`\n            <div class="grid-stack-item-content panel panel-default">\n                <div class="panel-heading">\n                    <div class="panel-title-box">\n                        <h3>${e}</h3>\n                        <span>${n}</span>\n                    </div>\n                    <ul class="panel-controls">\n                        <li>\n                            <a class="full-screen"><i class="fas fa-compress"></i></a>\n                        </li>\n                    </ul>\n                </div>\n                <div class="grid-stack-item-content-wrapper">\n                </div>\n            </div>\n        `,0!=i){r.querySelector(".panel-controls").innerHTML+='\n                <li>\n                    <a class="configuration"><i class="fas fa-times"></i></a>\n                </li>\n            '}return r}};var su=ou=nu=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)(),ru(0,Object(nt.inject)(lr.NightMode)),ru(1,Object(nt.inject)(lr.Mediator))],ou);let au=class{initialize(t,e,n){this._dataSource=t,this._keys=n.slice(),this._features=e.slice()}popFeature(){return this._features.pop()}forEachFeature(t){this._features.forEach(t)}popRecord(){const t=this._keys.pop();return this._dataSource.getDataContainer().getRecord(t)}forEachRecord(t){this._keys.forEach(e=>{const n=this._dataSource.getDataContainer().getRecord(e);t(n)})}};var cu=au=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)()],au);const lu=Math.pow(2,-52);class uu{static from(t,e=gu,n=_u){const i=t.length,r=new Float64Array(2*i);for(let o=0;o<i;o++){const i=t[o];r[2*o]=e(i),r[2*o+1]=n(i)}return new uu(r)}constructor(t){const e=t.length>>1;if(e>0&&"number"!=typeof t[0])throw new Error("Expected coords to contain numbers.");this.coords=t;const n=2*e-5,i=this.triangles=new Uint32Array(3*n),r=this.halfedges=new Int32Array(3*n);this._hashSize=Math.ceil(Math.sqrt(e));const o=this.hullPrev=new Uint32Array(e),s=this.hullNext=new Uint32Array(e),a=this.hullTri=new Uint32Array(e),c=new Int32Array(this._hashSize).fill(-1),l=new Uint32Array(e);let u=1/0,h=1/0,d=-1/0,f=-1/0;for(let n=0;n<e;n++){const e=t[2*n],i=t[2*n+1];e<u&&(u=e),i<h&&(h=i),e>d&&(d=e),i>f&&(f=i),l[n]=n}const p=(u+d)/2,g=(h+f)/2;let _,m,y,v=1/0;for(let n=0;n<e;n++){const e=hu(p,g,t[2*n],t[2*n+1]);e<v&&(_=n,v=e)}const b=t[2*_],C=t[2*_+1];v=1/0;for(let n=0;n<e;n++){if(n===_)continue;const e=hu(b,C,t[2*n],t[2*n+1]);e<v&&e>0&&(m=n,v=e)}let w=t[2*m],E=t[2*m+1],T=1/0;for(let n=0;n<e;n++){if(n===_||n===m)continue;const e=fu(b,C,w,E,t[2*n],t[2*n+1]);e<T&&(y=n,T=e)}let S=t[2*y],x=t[2*y+1];if(T===1/0)throw new Error("No Delaunay triangulation exists for this input.");if(du(b,C,w,E,S,x)){const t=m,e=w,n=E;m=y,w=S,E=x,y=t,S=e,x=n}const R=function(t,e,n,i,r,o){const s=n-t,a=i-e,c=r-t,l=o-e,u=s*s+a*a,h=c*c+l*l,d=.5/(s*l-a*c);return{x:t+(l*u-a*h)*d,y:e+(s*h-c*u)*d}}(b,C,w,E,S,x);this._cx=R.x,this._cy=R.y;const A=new Float64Array(e);for(let n=0;n<e;n++)A[n]=hu(t[2*n],t[2*n+1],R.x,R.y);!function t(e,n,i,r){if(r-i<=20)for(let t=i+1;t<=r;t++){const r=e[t],o=n[r];let s=t-1;for(;s>=i&&n[e[s]]>o;)e[s+1]=e[s--];e[s+1]=r}else{let o=i+1,s=r;pu(e,i+r>>1,o),n[e[i]]>n[e[r]]&&pu(e,i,r),n[e[o]]>n[e[r]]&&pu(e,o,r),n[e[i]]>n[e[o]]&&pu(e,i,o);const a=e[o],c=n[a];for(;;){do{o++}while(n[e[o]]<c);do{s--}while(n[e[s]]>c);if(s<o)break;pu(e,o,s)}e[i+1]=e[s],e[s]=a,r-o+1>=s-i?(t(e,n,o,r),t(e,n,i,s-1)):(t(e,n,i,s-1),t(e,n,o,r))}}(l,A,0,e-1),this.hullStart=_;let O=3;s[_]=o[y]=m,s[m]=o[_]=y,s[y]=o[m]=_,a[_]=0,a[m]=1,a[y]=2,c[this._hashKey(b,C)]=_,c[this._hashKey(w,E)]=m,c[this._hashKey(S,x)]=y,this.trianglesLen=0,this._addTriangle(_,m,y,-1,-1,-1);for(let e,n,i=0;i<l.length;i++){const r=l[i],u=t[2*r],h=t[2*r+1];if(i>0&&Math.abs(u-e)<=lu&&Math.abs(h-n)<=lu)continue;if(e=u,n=h,r===_||r===m||r===y)continue;let d=0;for(let t=0,e=this._hashKey(u,h);t<this._hashSize&&(-1===(d=c[(e+t)%this._hashSize])||d===s[d]);t++);let f,p=d=o[d];for(;f=s[p],!du(u,h,t[2*p],t[2*p+1],t[2*f],t[2*f+1]);)if((p=f)===d){p=-1;break}if(-1===p)continue;let g=this._addTriangle(p,r,s[p],-1,-1,a[p]);a[r]=this._legalize(g+2),a[p]=g,O++;let v=s[p];for(;f=s[v],du(u,h,t[2*v],t[2*v+1],t[2*f],t[2*f+1]);)g=this._addTriangle(v,r,f,a[r],-1,a[v]),a[r]=this._legalize(g+2),s[v]=v,O--,v=f;if(p===d)for(;du(u,h,t[2*(f=o[p])],t[2*f+1],t[2*p],t[2*p+1]);)g=this._addTriangle(f,r,p,-1,a[p],a[f]),this._legalize(g+2),a[f]=g,s[p]=p,O--,p=f;this.hullStart=o[r]=p,s[p]=o[v]=r,s[r]=v,c[this._hashKey(u,h)]=r,c[this._hashKey(t[2*p],t[2*p+1])]=p}this.hull=new Uint32Array(O);for(let t=0,e=this.hullStart;t<O;t++)this.hull[t]=e,e=s[e];this.hullPrev=this.hullNext=this.hullTri=null,this.triangles=i.subarray(0,this.trianglesLen),this.halfedges=r.subarray(0,this.trianglesLen)}_hashKey(t,e){return Math.floor(function(t,e){const n=t/(Math.abs(t)+Math.abs(e));return(e>0?3-n:1+n)/4}(t-this._cx,e-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{triangles:e,coords:n,halfedges:i}=this,r=i[t],o=t-t%3,s=r-r%3,a=o+(t+1)%3,c=o+(t+2)%3,l=s+(r+2)%3;if(-1===r)return c;const u=e[c],h=e[t],d=e[a],f=e[l];if(function(t,e,n,i,r,o,s,a){const c=t-s,l=e-a,u=n-s,h=i-a,d=r-s,f=o-a,p=u*u+h*h,g=d*d+f*f;return c*(h*g-p*f)-l*(u*g-p*d)+(c*c+l*l)*(u*f-h*d)<0}(n[2*u],n[2*u+1],n[2*h],n[2*h+1],n[2*d],n[2*d+1],n[2*f],n[2*f+1])){e[t]=f,e[r]=u;const n=i[l];if(-1===n){let e=this.hullStart;do{if(this.hullTri[e]===l){this.hullTri[e]=t;break}e=this.hullNext[e]}while(e!==this.hullStart)}this._link(t,n),this._link(r,i[c]),this._link(c,l);const o=s+(r+1)%3;return this._legalize(t),this._legalize(o)}return c}_link(t,e){this.halfedges[t]=e,-1!==e&&(this.halfedges[e]=t)}_addTriangle(t,e,n,i,r,o){const s=this.trianglesLen;return this.triangles[s]=t,this.triangles[s+1]=e,this.triangles[s+2]=n,this._link(s,i),this._link(s+1,r),this._link(s+2,o),this.trianglesLen+=3,s}}function hu(t,e,n,i){const r=t-n,o=e-i;return r*r+o*o}function du(t,e,n,i,r,o){return(i-e)*(r-n)-(n-t)*(o-i)<0}function fu(t,e,n,i,r,o){const s=n-t,a=i-e,c=r-t,l=o-e,u=s*s+a*a,h=c*c+l*l,d=.5/(s*l-a*c),f=(l*u-a*h)*d,p=(s*h-c*u)*d;return f*f+p*p}function pu(t,e,n){const i=t[e];t[e]=t[n],t[n]=i}function gu(t){return t[0]}function _u(t){return t[1]}let mu=class extends ft{constructor(){super(...arguments),this._isInstantiated=!1}initialize(t){super.initialize(t),this._options=t,this._colorScale=t.colorScale?t.colorScale:rr.a.scale("Spectral").domain([1,0]),this._fillValue=t.fillValue?t.fillValue:null,0!=t.visible&&this.setVisible(!0)}getType(){return J.WebGlLayer}setVisible(t){this._isInstantiated||(this.getDataSource().fetchData(),this._instantiateLayer()),this.setLayersVisible(t)}_instantiateLayer(){this._options.dataSource.onDataAdded(t=>{this._instantiateTriangleArray(t);const e=new al({canvasFunction:this._canvasFunction.bind(this),projection:"EPSG:3857",ratio:1.65}),n=new Qc({source:e,opacity:.65});this._options.dataSource.onDataFiltered(()=>{const t=this._options.dataSource.getFilteredKeys();this._redrawFiltered(t),e.changed()}),this.addLayer(n),this._isInstantiated=!0})}getDataSource(){return this._options.dataSource}_instantiateTriangleArray(t){const e=t.getDataLength(!0),{latProperty:n,lonProperty:i,valueProperty:r,range:o}=this._options;let s=performance.now();this._points=new Array(e),this._allValues=new Array(e),t.forEachRecord((t,e)=>{const s=t.get(i),a=t.get(n),c=t.get(r);null==s&&null==a&&null==c||(this._points[e]=Xe([s,a]),c<o[0]||c>o[1]||c==this._fillValue?this._allValues[e]=this._fillValue:this._allValues[e]=(c-o[0])/(o[1]-o[0]))},!0),console.log(performance.now()-s,"ms making points and value arrays"),s=performance.now(),this._indices=uu.from(this._points).triangles,console.log(performance.now()-s,"ms delaunay"),this._vertices=this._generateVertices()}_redrawFiltered(t){this._updateVertices(t),this._buffer=this._context.createBuffer(),this._context.bindBuffer(this._context.ARRAY_BUFFER,this._buffer),this._context.bufferData(this._context.ARRAY_BUFFER,this._vertices,this._context.STATIC_DRAW)}_updateVertices(t){this._values=new Array(this._allValues.length),this._values.fill(this._fillValue);for(let e of t)this._values[e]=this._allValues[e];this._vertices=this._generateVertices()}_initiateWebGL(t){const e=document.createElement("canvas");ll.setCanvasSize(e,t);let n=e.getContext("webgl");if(n||(n=e.getContext("experimental-webgl")),!n)throw ut();this._colorScaleTexture=cl.createColorScaleTexture(n,this._colorScale),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),this._program=cl.createProgram(n,"\n    precision mediump float;\n    \n    attribute vec2 position;\n    attribute float value;\n    uniform sampler2D colorScale;\n    uniform vec4 extent;\n    uniform float fillValue;\n    uniform vec2 delta;\n    varying vec4 color;\n    varying float skip;\n    \n    void main()\n    {\n        if(value == fillValue) {\n            color = vec4(0.0, 0.0, 0.0, 0.0);\n            skip = 1.0;\n        }\n        else {\n            color = texture2D(colorScale, vec2(value, 0.5));\n            skip = 0.0;\n        }\n        \n        gl_Position = vec4(\n            ((position.x-extent.x) / delta.x) * 2.0 - 1.0,\n            ((position.y-extent.w) / delta.y) * -2.0 + 1.0,\n            0.0, 1.0);\n    }","\n    precision mediump float;\n    \n    varying vec4 color;\n    varying float skip;\n    \n    void main()\n    {\n        if (skip == 1.0)\n            discard;\n        gl_FragColor = color;\n    }"),this._buffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this._buffer),n.bufferData(n.ARRAY_BUFFER,new Float32Array(this._vertices),n.STATIC_DRAW),this._context=n,this._canvas=e}_canvasFunction(t,e,n,i,r){return this._context||this._initiateWebGL(i),this._context.viewport(0,0,i[0],i[1]),ll.setCanvasSize(this._canvas,i),this._vertices&&this._renderWebGL(this._context,this._program,this._vertices.length/3,t),this._canvas}_renderWebGL(t,e,n,i){t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.useProgram(e.program);const r=i[2]-i[0],o=i[1]-i[3];t.uniform4fv(e.extent,i),t.uniform2fv(e.delta,[r,o]),t.uniform1f(e.fillValue,this._fillValue),t.activeTexture(this._context.TEXTURE0),t.bindTexture(this._context.TEXTURE_2D,this._colorScaleTexture),t.uniform1i(e.colorScale,0),t.bindBuffer(t.ARRAY_BUFFER,this._buffer),t.vertexAttribPointer(e.position,2,t.FLOAT,!1,3*Float32Array.BYTES_PER_ELEMENT,0),t.vertexAttribPointer(e.value,1,t.FLOAT,!1,3*Float32Array.BYTES_PER_ELEMENT,2*Float32Array.BYTES_PER_ELEMENT),t.enableVertexAttribArray(e.position),t.enableVertexAttribArray(e.value),t.drawArrays(t.TRIANGLES,0,n)}_generateVertices(){Sr.start("ms generating webgl vecs for buffer",Cr.GridHeatMap);const t=this._values?this._values:this._allValues,e=this._indices,n=new Float32Array(3*e.length);for(let i=0,r=0;i<e.length;i++,r+=3)n[r]=this._points[e[i]][0],n[r+1]=this._points[e[i]][1],n[r+2]=t[e[i]];return Sr.stop(),n}};var yu=mu=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)()],mu),vu=n(47),bu=n.n(vu);const Cu="\n    precision highp float;\n\n    attribute vec2 readPos;\n    attribute vec2 writePos;\n    \n    varying vec2 pos;\n    \n    void main(void) {\n        pos = readPos;\n        \n        gl_Position = vec4(\n            writePos,\n            0.0, 1.0);\n    }";var wu=function(t,e){return function(n,i){e(n,i,t)}};let Eu=class extends ft{constructor(t){super(),this._isInstantiated=!1,this._basisVectors={},this._basisVectorsInMeters={},this._trailOpacity=.98,this._colored=!1,this._time=0,this._renderRequest=void 0,this._extent=[0,0,0,0],this._mediator=t}initialize(t){super.initialize(t),this._options=t,this._fillValue=t.fillValue?t.fillValue:null,this._currentTrailOpacity=this._trailOpacity,this._colorScale=t.colorScale?t.colorScale:rr.a.scale("Spectral").domain([1,0]),this._colored=!!t.colored,this.setParticles(t.numParticles?t.numParticles:15e4),0!=t.visible&&this.setVisible(!0)}getType(){return J.WebGlLayer}setVisible(t){this._isInstantiated||(this.getDataSource().fetchData(),this._instantiateLayer()),this.setLayersVisible(t),this._isInstantiated&&t?(this._time=performance.now(),this.startRenderLoop()):t||(this.stopRenderLoop(),this._resizeFrameTextures())}getVisibleOption(){return this._options.visible}setColored(t){this._colored=t}setParticles(t){this._particlesWidth=Math.floor(Math.sqrt(t)),this._numParticles=this._particlesWidth*this._particlesWidth}getParticles(){return this._numParticles}_instantiateLayer(){this._options.dataSource.onDataAdded(t=>{this._instantiateData(t);const e=new al({canvasFunction:this._canvasFunction.bind(this),projection:"EPSG:3857",ratio:1}),n=new Qc({source:e,opacity:0});this._mediator.subscribe(cr.EXTENT_CHANGED,t=>{this._extent=t.extent}),this._mediator.subscribe(cr.MAP_MOVE,t=>{this._currentTrailOpacity=t.start?.5:this._trailOpacity}),this._mediator.subscribe(cr.MAP_SIZE,t=>{this._size=t.size,this._resizeFrameTextures()}),this.addLayer(n),this._canvasSource=e,this._isInstantiated=!0,this._stats=new bu.a,this._stats.showPanel(0),document.body.appendChild(this._stats.dom),this._options.visible&&this.startRenderLoop()})}_instantiateData(t){const e=t.getData(),{latProperty:n,lonProperty:i,u:r,v:o}=this._options,s=t.getIndexForColumn(i),a=t.getIndexForColumn(n),c=t.getIndexForColumn(r),l=t.getIndexForColumn(o);try{this._vectorData=ll.createVectorImageData(this._options.dataResolution[0],this._options.dataResolution[1],e,c,l,this._options.range[0],this._options.range[1],this._fillValue),this._particleData=ll.createRandomImageData(this._particlesWidth,this._particlesWidth);const t=e[0],n=e[this._options.dataResolution[0]-1],i=e[this._options.dataResolution[0]*this._options.dataResolution[1]-this._options.dataResolution[0]];this._basisVectors.origo=[t[s],t[a]],this._basisVectors.x=[n[s],n[a]],this._basisVectors.y=[i[s],i[a]],this._basisVectorsInMeters.origo=Xe([t[s],t[a]]),this._basisVectorsInMeters.x=Xe([n[s],n[a]]),this._basisVectorsInMeters.y=Xe([i[s],i[a]])}catch(t){console.log(t)}this._particleIndices=new Float32Array(this._numParticles).map((t,e)=>e)}_initiateWebGl(){const t=document.getElementById(this._options.domId);t.className="animated-layer-canvas",this._size=[t.offsetWidth,t.offsetHeight],ll.setCanvasSize(t,this._size);let e=t.getContext("webgl");if(e||(e=t.getContext("experimental-webgl")),!e)throw ut();e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),this._colorScaleTexture=cl.createColorScaleTexture(e,this._colorScale),this._particleTexture0=cl.createTexture(e,e.NEAREST,this._particlesWidth,this._particlesWidth,this._particleData),this._particleTexture1=cl.createTexture(e,e.NEAREST,this._particlesWidth,this._particlesWidth,this._particleData),this._vectorTexture=cl.createTexture(e,e.LINEAR,this._options.dataResolution[0],this._options.dataResolution[1],this._vectorData),this._previousFrame=cl.createTexture(e,e.NEAREST,this._size[0],this._size[1],null),this._currentFrame=cl.createTexture(e,e.NEAREST,this._size[0],this._size[1],null),this._drawProgram=cl.createProgram(e,"\n    precision highp float;\n\n    attribute float particleIndex;\n    \n    varying vec2 pctPos;\n    \n    uniform vec4 extent;\n    uniform vec2 delta;\n    uniform float particlesRes;\n    uniform sampler2D particles;\n    uniform vec2 v0;\n    uniform vec2 v1;\n    uniform vec2 v2;\n    \n    const float RADIUS = 6378137.0;\n    const float PI = 3.1415926535897932384626433832795;\n    const float HALF_SIZE = PI * RADIUS;\n    \n    vec2 fromLonLat(const float lon, const float lat) {\n        float x = HALF_SIZE * lon / 180.0;\n\n        float y = RADIUS * log(tan(PI * (lat + 90.0) / 360.0));\n        if (y > HALF_SIZE) {\n            y = HALF_SIZE;\n        }\n        else if (y < -HALF_SIZE) {\n            y = -HALF_SIZE;\n        }\n\n        return vec2(x, y);\n    }\n    \n    void main(void) {\n        vec4 color = texture2D(particles, vec2(\n            fract(particleIndex / particlesRes),\n            floor(particleIndex / particlesRes) / particlesRes)\n        );\n        \n        pctPos = vec2(\n            color.r / 255.0 + color.b,\n            color.g / 255.0 + color.a\n        );\n    \n        vec2 particleCoords = vec2(\n            mix(v0.x, v1.x, color.r / 255.0 + color.b),\n            mix(v0.y, v2.y, color.g / 255.0 + color.a)\n        );\n            \n        vec2 posInMeters = fromLonLat(particleCoords.x, particleCoords.y);\n        \n        gl_Position = vec4(\n            ((posInMeters.x-extent.x) / delta.x) * 2.0 - 1.0,\n            ((posInMeters.y-extent.w) / delta.y) * -2.0 + 1.0,\n            0.0, 1.0);\n        gl_PointSize = 1.15;\n    }","\n    precision highp float;\n    \n    uniform vec2 dataResolution;\n    uniform vec2 range;\n    uniform sampler2D vectors;\n    uniform sampler2D colorScale;\n    uniform float colored;\n    \n    varying vec2 pctPos;\n    \n    void main(void) {\n        vec4 color;\n        vec4 vectorColor = texture2D(vectors, pctPos);\n        \n        if (vectorColor.a < 1.0)\n            discard;\n          \n        float u = mix(range.x, range.y, vectorColor.r);\n        float v = mix(range.x, range.y, vectorColor.g);\n        float speedPct = length(vec2(u, v)) / length(range);\n        \n        if (colored == 1.0)\n            color = texture2D(colorScale, vec2(speedPct, 0.5));\n        else\n            color = vec4(1.0, 1.0, 1.0, 1.0);\n        \n        // todo: find a nice generic way to calculate opacity or make it configurable somehow\n        float alpha = smoothstep(0.02, 0.30, speedPct) * 1.1;\n        \n        color.a = alpha;\n        \n        gl_FragColor = color;\n    }"),this._updateProgram=cl.createProgram(e,Cu,"\n    precision highp float;\n    \n    uniform float random;\n    uniform float deltaTime;\n    uniform vec2 dataResolution;\n    uniform vec2 range;\n    uniform vec2 v0;\n    uniform vec2 v1;\n    uniform vec2 v2;\n    uniform sampler2D vectors;\n    uniform sampler2D particles;\n    \n    varying vec2 pos;\n    \n    const float RADIUS = 6378137.0;\n    const float PI = 3.1415926535897932384626433832795;\n    const float HALF_SIZE = PI * RADIUS;\n    const float DROP_RATE = 0.005;\n    \n    // bilinear interpolation - texture2d(vectors, pctPos) can be used instead for increased performance\n    vec2 lookup_vector(const vec2 uv) {\n        vec2 px = 1.0 / vec2(dataResolution.x, dataResolution.y);\n        vec2 vc = (floor(uv * vec2(dataResolution.x, dataResolution.y))) * px;\n        vec2 f = fract(uv * vec2(dataResolution.x, dataResolution.y));\n        vec2 tl = texture2D(vectors, vc).rg;\n        vec2 tr = texture2D(vectors, vc + vec2(px.x, 0)).rg;\n        vec2 bl = texture2D(vectors, vc + vec2(0, px.y)).rg;\n        vec2 br = texture2D(vectors, vc + px).rg;\n        return mix(mix(tl, tr, f.x), mix(bl, br, f.x), f.y);\n    }\n    \n    // pseudo-random generator\n    const vec3 rand_constants = vec3(12.9898, 78.233, 4375.85453);\n    float rand(const vec2 co) {\n        float t = dot(rand_constants.xy, co);\n        return fract(sin(t) * (rand_constants.z + t));\n    }\n    \n    vec2 getRandomPos(const vec2 seed) {\n        return vec2(\n            rand(seed + 1.3),\n            rand(seed + 2.1)\n        );\n    }\n    \n    vec2 keepPosOrRandom(const vec2 pos, const vec2 seed) {\n        float should_drop = step(1.0 - DROP_RATE, rand(seed));\n        vec2 random_pos = getRandomPos(seed);\n        \n        return mix(pos, random_pos, should_drop);\n    }\n    \n    void main(void) {\n        vec4 color = texture2D(particles, pos);\n        \n        vec2 pctPos = vec2(\n            color.r / 255.0 + color.b,\n            color.g / 255.0 + color.a\n        );\n        \n        // Move to new position if no data for current position\n        if (texture2D(vectors, pctPos).a < 1.0) {\n            vec2 pos = getRandomPos(pctPos * random);\n            gl_FragColor = vec4(\n                fract(pos * 255.0),\n                floor(pos * 255.0) / 255.0\n            );\n            return;\n        }\n        \n        vec2 particlePos = vec2(\n            (v1-v0) * pctPos.x + (v2-v0) * pctPos.y\n        );\n        \n        vec2 vectorColor = lookup_vector(pctPos);\n        float speedFactor = 3600.0 * (deltaTime / 10.0);\n        float uDelta = mix(range.x, range.y, vectorColor.r) * speedFactor;\n        float vDelta = mix(range.x, range.y, vectorColor.g) * speedFactor;\n        \n        vec2 newPos = vec2(\n            particlePos.x + uDelta,\n            particlePos.y + vDelta\n        );\n        \n        // Convert to fraction of data extent\n        newPos = fract(1.0 + vec2(\n            newPos.x / distance(v0, v1),\n            newPos.y / distance(v0, v2)\n        ));\n        \n        // Decide if time to drop particle or not\n        vec2 seed = (newPos + pos) * random;\n        newPos = keepPosOrRandom(newPos, seed);\n\n        gl_FragColor = vec4(\n            fract(newPos * 255.0),\n            floor(newPos * 255.0) / 255.0\n        );\n    }"),this._trailProgram=cl.createProgram(e,Cu,"\n    precision highp float;\n\n    uniform sampler2D texture;\n    uniform float opacity;\n\n    varying vec2 pos;\n    \n    void main(void) {\n        vec4 color = texture2D(texture, pos) * opacity;\n        \n        gl_FragColor = color;\n    }"),this._particleIndexBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this._particleIndexBuffer),e.bufferData(e.ARRAY_BUFFER,this._particleIndices,e.STATIC_DRAW),this._squareBuffer=cl.createSquareBuffer(e),e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),this._frameBuffer=e.createFramebuffer(),this._context=e,this._canvas=t}_canvasFunction(t,e,n,i,r){let o=!1;return this._extent[0]==t[0]&&this._extent[1]==t[1]&&this._extent[2]==t[2]||(o=!0,this._extent=t),this._context||this._initiateWebGl(),this._isInstantiated&&o&&(this._size=[this._canvas.offsetWidth,this._canvas.offsetHeight]),null}_updateCanvas(){this._context.activeTexture(this._context.TEXTURE0),this._context.bindTexture(this._context.TEXTURE_2D,this._particleTexture0),this._context.activeTexture(this._context.TEXTURE0+1),this._context.bindTexture(this._context.TEXTURE_2D,this._vectorTexture),this._context.activeTexture(this._context.TEXTURE0+2),this._context.bindTexture(this._context.TEXTURE_2D,this._previousFrame),this._context.activeTexture(this._context.TEXTURE0+3),this._context.bindTexture(this._context.TEXTURE_2D,this._colorScaleTexture),this._draw(),this._updateParticles()}_updateParticles(){const t=this._context;t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,this._frameBuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this._particleTexture1,0),t.viewport(0,0,this._particlesWidth,this._particlesWidth);const e=this._updateProgram;t.useProgram(e.program),t.bindBuffer(t.ARRAY_BUFFER,this._squareBuffer),t.vertexAttribPointer(e.writePos,2,t.FLOAT,!1,4*Float32Array.BYTES_PER_ELEMENT,0),t.vertexAttribPointer(e.readPos,2,t.FLOAT,!1,4*Float32Array.BYTES_PER_ELEMENT,2*Float32Array.BYTES_PER_ELEMENT),t.enableVertexAttribArray(e.writePos),t.enableVertexAttribArray(e.readPos),t.uniform1i(e.particles,0),t.uniform1i(e.vectors,1),t.uniform2f(e.dataResolution,this._options.dataResolution[0],this._options.dataResolution[1]),t.uniform2f(e.range,this._options.range[0],this._options.range[1]),t.uniform2f(e.v0,this._basisVectorsInMeters.origo[0],this._basisVectorsInMeters.origo[1]),t.uniform2f(e.v1,this._basisVectorsInMeters.x[0],this._basisVectorsInMeters.x[1]),t.uniform2f(e.v2,this._basisVectorsInMeters.y[0],this._basisVectorsInMeters.y[1]),t.uniform1f(e.random,Math.random()),t.uniform1f(e.deltaTime,performance.now()-this._time),this._time=performance.now(),t.drawArrays(t.TRIANGLE_STRIP,0,4);const n=this._particleTexture1;this._particleTexture1=this._particleTexture0,this._particleTexture0=n}_draw(){const t=this._context,e=this._trailProgram,n=this._size;this._drawFadedPreviousFrame(),this._drawParticles(),t.bindFramebuffer(t.FRAMEBUFFER,null),t.useProgram(e.program),ll.setCanvasSize(this._canvas,n),t.bindBuffer(t.ARRAY_BUFFER,this._squareBuffer),t.vertexAttribPointer(e.writePos,2,t.FLOAT,!1,4*Float32Array.BYTES_PER_ELEMENT,0),t.vertexAttribPointer(e.readPos,2,t.FLOAT,!1,4*Float32Array.BYTES_PER_ELEMENT,2*Float32Array.BYTES_PER_ELEMENT),t.enableVertexAttribArray(e.writePos),t.enableVertexAttribArray(e.readPos),t.uniform1i(e.texture,2),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),t.drawArrays(t.TRIANGLE_STRIP,0,4),t.disable(t.BLEND)}_drawFadedPreviousFrame(){const t=this._context,e=this._trailProgram;t.useProgram(e.program),t.bindFramebuffer(t.FRAMEBUFFER,this._frameBuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this._currentFrame,0),t.viewport(0,0,this._size[0],this._size[1]),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.bindBuffer(t.ARRAY_BUFFER,this._squareBuffer),t.vertexAttribPointer(e.writePos,2,t.FLOAT,!1,4*Float32Array.BYTES_PER_ELEMENT,0),t.vertexAttribPointer(e.readPos,2,t.FLOAT,!1,4*Float32Array.BYTES_PER_ELEMENT,2*Float32Array.BYTES_PER_ELEMENT),t.enableVertexAttribArray(e.writePos),t.enableVertexAttribArray(e.readPos),t.uniform1i(e.texture,2),t.uniform1f(e.opacity,this._currentTrailOpacity),t.drawArrays(t.TRIANGLE_STRIP,0,4);const n=this._previousFrame;this._previousFrame=this._currentFrame,this._currentFrame=n}_drawParticles(){const t=this._context,e=this._drawProgram,n=this._extent;t.useProgram(e.program),t.bindBuffer(t.ARRAY_BUFFER,this._particleIndexBuffer),t.enableVertexAttribArray(e.particleIndex),t.vertexAttribPointer(e.particleIndex,1,t.FLOAT,!1,0,0),t.uniform1i(e.vectors,1),t.uniform1i(e.particles,0),t.uniform1f(e.opacity,1);const i=n[2]-n[0],r=n[1]-n[3];t.uniform4fv(e.extent,n),t.uniform2fv(e.delta,[i,r]),t.uniform1f(e.particlesRes,this._particlesWidth),t.uniform1f(e.colored,this._colored?1:0),t.uniform2f(e.dataResolution,this._options.dataResolution[0],this._options.dataResolution[1]),t.uniform2f(e.range,this._options.range[0],this._options.range[1]),t.uniform2f(e.v0,this._basisVectors.origo[0],this._basisVectors.origo[1]),t.uniform2f(e.v1,this._basisVectors.x[0],this._basisVectors.x[1]),t.uniform2f(e.v2,this._basisVectors.y[0],this._basisVectors.y[1]),this._context.uniform1i(e.colorScale,3),t.drawArrays(t.POINTS,0,this._numParticles)}_resizeFrameTextures(){const t=this._context;t.bindFramebuffer(t.FRAMEBUFFER,this._frameBuffer),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this._previousFrame=cl.createTexture(t,t.NEAREST,this._size[0],this._size[1],null),this._currentFrame=cl.createTexture(t,t.NEAREST,this._size[0],this._size[1],null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT)}renderLoop(){this._renderRequest=void 0,this._stats.begin(),this._updateCanvas(),this._stats.end(),this.startRenderLoop()}startRenderLoop(){null==this._renderRequest&&(this._renderRequest=window.requestAnimationFrame(()=>this.renderLoop()))}stopRenderLoop(){null!=this._renderRequest&&(window.cancelAnimationFrame(this._renderRequest),this._renderRequest=void 0)}getDataSource(){return this._options.dataSource}getAvailableUserConfigurations(){const t=[],e={callback:t=>this.setColored(t),getCurrentConfiguration:()=>this._colored,type:"toggle",name:"Colored"};return t.push(e),t}};var Tu=Eu=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)(),wu(0,Object(nt.inject)(lr.Mediator))],Eu);class Su{constructor(t){let e=t.prefix?t.prefix:"";if(t.toggleAction){e=`<input id="${"checkbox-"+sr.getId()}" type="checkbox" />`}let n=t.suffix?t.suffix:'<i class="fas fa-chevron-right"></i>';n=t.isLayerWithSettings?'<i class="fas fa-cog"></i>':n;const i=q.createElement("div","collapsible-container");i.innerHTML=Su.createCollapsibleBaseHTML(t.title,e,n,t.className,t.isRadioContainer),this._setupInteraction(i,t),this._isRadioContainer=!!t.isRadioContainer,this._htmlElement=i}_setupInteraction(t,e){const n=t.querySelector(".collapsible-header > .collapsible-title");if(t.querySelector(".collapsible-header > .collapsible-suffix").onclick=()=>this.toggle(),e.isLayerWithSettings){const e=t.querySelector(".collapsible-header > .collapsible-prefix > input").id;n.innerHTML=`<label for="${e}">${n.innerHTML}</label>`}else n.onclick=()=>this.toggle();if(e.toggleAction&&e.toggleChecked){const n=t.querySelector(".collapsible-prefix"),i=t.querySelector("input");i.checked=e.toggleChecked,i.onchange=()=>e.toggleAction(i.checked),n.onclick=()=>e.toggleAction(i.checked)}}getHTMLElement(){return this._htmlElement}getID(){return this._htmlElement.id}addedToWidgetContainer(t,e){}onWidgetContainerChange(){}addChild(t){this._isRadioContainer?this._htmlElement.querySelector(".collapsible-body form").appendChild(t):this._htmlElement.querySelector(".collapsible-body").appendChild(t)}toggle(){const t=this._htmlElement.querySelector(".collapsible-body");this._htmlElement.classList.toggle("active-collapsible"),"unset"==t.style.height?t.style.height="0px":t.style.height="unset"}static createCollapsibleBaseHTML(t,e,n,i,r){return`\n            <div class="collapsible-header collapsible-entry ${i||""}">\n                ${Su.createCollapsibleEntryBaseHTML(t,e,n)}\n            </div>\n            <div class="collapsible-body">\n                ${r?"<form></form>":""}\n            </div>\n        `}static createCollapsibleEntryBaseHTML(t,e,n){return`\n            <div class="collapsible-prefix">${e}</div>\n            <div class="collapsible-title">${t}</div> \n            <div class="collapsible-suffix">${n}</div>\n        `}static createToggleEntry(t,e,n,i){const r=q.createElement("div","collapsible-entry "+i),o="checkbox-"+sr.getId(),s=`<input id="${o}" type="checkbox" />`,a=`<label for="${o}">${t}</label>`;r.innerHTML=Su.createCollapsibleEntryBaseHTML(a,s,"");const c=r.querySelector("input");return c.checked=n,c.onchange=()=>e(c.checked),r}static createRadioEntry(t,e,n,i,r){const o=q.createElement("div","collapsible-entry "+r),s="checkbox-"+sr.getId(),a=`<input id="${s}" name="${e}" type="radio" />`,c=`<label for="${s}">${t}</label>`;o.innerHTML=Su.createCollapsibleEntryBaseHTML(c,a,"");const l=o.querySelector("input");return l.checked=i,l.onclick=()=>n(l.checked),o}}var xu,Ru=function(t,e){return function(n,i){e(n,i,t)}};let Au=xu=class extends kl{constructor(t){super(),this._switcherControl=t}initialize(t){t=Po(t,Zo),this._switcherControl.initialize({normalIcon:"layer-group",position:t.controlPosition,index:t.controlIndex,flow:t.controlFlow}),super.initialize({buttonControl:this._switcherControl,position:t.position}),this._sidebarLayerSwitcherOptions=t,this._redraw=this._draw.bind(this)}initializeExtension(t){super.initializeExtension(t),this._layerHandler=t.getLayerHandler(),document.addEventListener("DOMContentLoaded",()=>{this._draw()}),this.getButtonControl().onClick(()=>{this._draw()})}_setLayerVisibility(t,e){this._layerHandler.setLayerVisible(t,e)}_draw(){const t=this.getDrawerHTMLElement();q.removeChildren(t);const e=this._layerHandler.getDataLayerContainers(),n=this._layerHandler.getBaseLayerContainers(),{dataLayerLabel:i,baseLayerLabel:r}=this._sidebarLayerSwitcherOptions,o=new Su({title:i||"Data Layers"}),s=new Su({title:r||"Base Layers",isRadioContainer:!0});this._addLayersToCollapsible(o,e.reverse()),this._addLayersToCollapsible(s,n),t.appendChild(o.getHTMLElement()),t.appendChild(s.getHTMLElement())}_addLayersToCollapsible(t,e){e.forEach(e=>{let n=null;if(Q.isConfigurableLayer(e)&&(n=e.getAvailableUserConfigurations()),Q.isLayerGroup(e)){const n=new Su({title:e.getId()});this._addLayersToCollapsible(n,e.getLayerContainersInGroup()),t.addChild(n.getHTMLElement())}else{const i=xu._createToggleableLayerEntry(e.getId(),this._setLayerVisibility.bind(this,e),e.getVisible(),n);t.addChild(i)}})}static _createToggleableLayerEntry(t,e,n,i){if(!i||i.length<1)return Su.createToggleEntry(t,e,n,"layer-entry");const r=new Su({title:t,toggleAction:e,toggleChecked:n,isLayerWithSettings:!0,className:"layer-entry"});return i.forEach(t=>{const e=xu._createSettingEntry(t);r.addChild(e)}),r.getHTMLElement()}static _createSettingEntry(t){switch(t.type){case"toggle":return Su.createToggleEntry(t.name,t.callback,t.getCurrentConfiguration(),"setting-entry")}}};var Ou,Iu=Au=xu=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)(),Ru(0,Object(nt.inject)(lr.ButtonControl))],Au),Mu=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};let Pu=Ou=class{initialize(t){this._addPointToGeometries=t.getAddPointToGeometries(),this._layerContainer=t,this._mediator.subscribe(cr.NIGHTMODE,()=>{Q.isLayerContainer(t)&&t.getLayers().forEach(t=>t.changed())});const e=t.getDataSource(),n=t.getClusteredByProperty();if(n){const{colors:i,colorScheme:r}=t.getStyle();r&&this._colorRepository.setColorSchemeForColumn(e,n,r),this._colorRepository.setColorsForColumn(e,n,i),this._generateAllStyles()}else this._colorRepository.setColor(e),this._generateStyles(n)}_generateAllStyles(){const t=this._layerContainer.getClusteredByProperty();this._layerContainer.getDataSource().getUniqueValuesForColumn(t).forEach(this._generateStyles.bind(this,t))}_generateStyles(t,e){const n=this._layerContainer.getDataSource();let i=this._layerContainer.getStyle().single;i=this._evaluateColors(n,t,e,i);let r=this._layerContainer.getStyle().cluster;r=this._evaluateColors(n,t,e,r),this._styleCache.initialize(i,r,e);const o=this._evaluateColors(n,t,e,i,.2),s=this._evaluateColors(n,t,e,r,.2);this._notSelectedStyleCache.initialize(o,s,e);let a=this._layerContainer.getSelectedStyle().single;a=this._evaluateColors(n,t,e,a);let c=this._layerContainer.getSelectedStyle().single;c=this._evaluateColors(n,t,e,c),this._selectedStyleCache.initialize(a,c,e)}_getStyleCache(t){return t.getFilteredOut()?this._notSelectedStyleCache:t.getSelected()?this._selectedStyleCache:this._styleCache}styleFunction(t,e){const n=this._getStyleCache(t);let i;if(t.isCluster())i=n.getCluster(t);else{const e=Yi.getSingleFeatureType(t),r=t.getClusterPropertyValue(),o=this._getText(n,t);if("point"===e)i=this._getPointStyleWithCorrectGeometry(n,t,o,r);else if(i=n.getGeometry(r),this._addPointToGeometries){i=[i,this._getPointStyleWithCorrectGeometry(n,t,o,r)]}}return i}_getText(t,e){if(t.hasText()){const n=e.getFeatureKey(),i=this._layerContainer.getDataSource().getDataContainer().getRecord(n);return t.getTextFromRecord(i)}}_getPointStyleWithCorrectGeometry(t,e,n,i){const r=t.getPoint(i),o=e.getGeometry().getFirstCoordinate();return r.getGeometry().setCoordinates(o),n&&r.getText().setText(n),r}_evaluateColors(t,e,n,i,r=1){(i=Object.assign({},i)).fillColor=i.fillColor||this._getColor(t,e,n);const o=rr()(i.fillColor);return o.alpha(r),i.strokeColor=i.strokeColor||o.brighten(1),i.textColor=i.textColor||Ou.getContrastTextColor(o),i}_getColor(t,e,n){return n?this._colorRepository.getColorForColumnValue(t,e,n):this._colorRepository.getColor(t)}static getContrastTextColor(t){return t.luminance()>.4?rr()("#000"):rr()("#fff")}};Mu([Object(nt.inject)(lr.Mediator)],Pu.prototype,"_mediator",void 0),Mu([Object(nt.inject)(lr.ColorRepository)],Pu.prototype,"_colorRepository",void 0),Mu([Object(nt.inject)(lr.StyleCache)],Pu.prototype,"_styleCache",void 0),Mu([Object(nt.inject)(lr.StyleCache)],Pu.prototype,"_selectedStyleCache",void 0),Mu([Object(nt.inject)(lr.StyleCache)],Pu.prototype,"_notSelectedStyleCache",void 0);var Lu=Pu=Ou=Mu([Object(nt.injectable)()],Pu),Du=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},ku=function(t,e){return function(n,i){e(n,i,t)}};Object(nt.decorate)(Object(nt.injectable)(),Na);let Fu=class extends Na{constructor(t){super(),this._features={},this._onFeatureChangeCallbacks=[],this._initialized=!1}initialize(t){const{clusterable:e,useThread:n,clusterRadius:i}=this._options=t;this._clustered=e,e&&(n?(this._clusteringHandlerWorker=new Ba.a,this._clusteringHandlerWorker.addEventListener("message",t=>{const{type:e,clusters:n}=t.data;switch(e){case"response":this._updateSourceWithClusters(n)}})):(this._clusteringHandler=cd.get(lr.ClusteringHandler),this._clusteringHandler.initialize(i)),this._initialized=!0)}addFeaturesToSource(t){if(this._options&&this._options.clusterable){const e=new Array(t.length);t.forEach((t,n)=>{const i=t.getFeatureKey();this._features[i]=t,e[n]=this._createReducedDataFromFeature(t)}),this._addDataToClusteringHandler(e)}else this._updateSourceWithFeatures(t)}loadFeatures(t,e,n){this._ignoreLoadFeaturesEvent?this._ignoreLoadFeaturesEvent=!1:this._options.clusterable&&this._cluster(t,e)}_cluster(t,e){const n=Yi.zoomFromResolution(e);t=this._normalizeExtent(t);const i=this._clustered&&n<this._options.unrollClustersAtZoom;this._options.useThread?(Sr.log("Clustering in separate thread",Cr.BigVectorLayer),this._clusteringHandlerWorker.postMessage({type:"request",extent:t,zoom:n,shouldCluster:i})):(Sr.log("Clustering in main thread",Cr.BigVectorLayer),this._clusteringHandler.cluster(t,n,i,this._updateSourceWithClusters.bind(this)))}_updateSourceWithClusters(t){Sr.start("Creating / Looking up Features",Cr.BigVectorLayer);const e=new Array(t.length);for(let n=0;n<t.length;n++){const i=t[n],r=i[2];e[n]=r<0?this._createClusterFeature(i):this._features[r]}Sr.stop(),this._updateSourceWithFeatures(e,!0)}_createClusterFeature(t){const[e,n,i,r,o]=t,s=this._createPointGeometry(e,n),a=new Zi;return a.setGeometry(s),a.setFeatureKey(i),a.setLayerId(this._options.layerId),a.setClusterProperty(this._options.clusteredByProperty),a.setClusterPropertyValue(r),a.setRecordKeys(o),a}_createPointGeometry(t,e){return new Nn([20026376.39*t,20048966.1*e])}_updateSourceWithFeatures(t,e=!1){Sr.start("Updating Features",Cr.BigVectorLayer),e&&(this._ignoreLoadFeaturesEvent=!0,this.clear(!0)),this.addFeatures(t),this._triggerOnFeatureChange(t),Sr.stop()}_createFeatureFromRecord(t){const e=t.key(),n=this._options.clusteredByProperty,i=t.get(n);let r;t.hasGeometry()?r=t.getGeometry():this._options.latProperty&&this._options.lonProperty&&(r=this._createPointGeometryFromRecord(t));const o=new Zi;return o.setGeometry(r),o.setFeatureKey(e),o.setLayerId(this._options.layerId),o.setRecordKeys([e]),o.setClusterProperty(n),o.setClusterPropertyValue(i),o}_createPointGeometryFromRecord(t){const{lonProperty:e,latProperty:n}=this._options,i=Xe([t.get(e),t.get(n)]);return new Nn(i)}_createReducedDataFromFeature(t){const[e,n]=this._normalizeCoordinatesOfFeature(t);return[e,n,t.getFeatureKey(),t.getClusterPropertyValue()]}_addDataToClusteringHandler(t){this._options.useThread?this._sendDataToClusteringHandlerWorker(t):(this._clusteringHandler.addData(t),this._clusteringHandler.dataDone())}_sendDataToClusteringHandlerWorker(t){const{SUB_DATA_SIZE:e}=tt.Layer,n=Math.ceil(t.length/e);for(let i=0;i<n;i++){const n=i*e,r=(i+1)*e,o=t.slice(n,r);this._sendDataSegment(o)}this._sendDataDoneMessage()}_sendDataSegment(t){const e={type:"data",subData:t};this._clusteringHandlerWorker.postMessage(e)}_sendDataDoneMessage(){const t={type:"done",clusterRadius:this._options.clusterRadius};this._clusteringHandlerWorker.postMessage(t)}addShowOnlyFilter(t){this._initialized&&(this._options.useThread?this._clusteringHandlerWorker.postMessage({type:"filter",keys:t}):this._clusteringHandler.addShowOnlyKeysFilter(t),this.refresh({force:!0}))}setClustered(t){this._clustered=t}_normalizeCoordinatesOfFeature(t){const e=ce(t.getGeometry().getExtent());return this._normalizeCoordinates(e)}_normalizeCoordinates(t){const[e,n]=t;return[e/20026376.39,n/20048966.1]}_normalizeExtent(t){const[e,n,i,r]=t;return[e/20026376.39,n/20048966.1,i/20026376.39,r/20048966.1]}_disposeFeatureChangeCallback(t){this._onFeatureChangeCallbacks=this._onFeatureChangeCallbacks.filter(e=>e!=t)}onFeatureChange(t){return this._onFeatureChangeCallbacks.push(t),{dispose:this._disposeFeatureChangeCallback.bind(this,t)}}_triggerOnFeatureChange(t){this._onFeatureChangeCallbacks.forEach(e=>e(t))}getFeatureByKey(t){return this._features[t]}};var Nu=Fu=Du([Object(nt.injectable)(),ku(0,Object(nt.inject)(lr.Mediator))],Fu),ju=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},Bu=function(t,e){return function(n,i){e(n,i,t)}};let zu=class extends ft{constructor(t,e){super(),this._active=!1,this._selections=[],this._instantiated=!1,this._vectorSource=t,this._vectorLayerStyleHandler=e}initialize(t){super.initialize(t),this._options=Po(t,Fo);const{visible:e,lazyLoad:n}=this._options;0!=e&&this.setVisible(!0),0==n&&this._activateLayerContainer()}_activateLayerContainer(){if(this._active)return;this._active=!0;const t=this.getDataSource();t.onDataAdded(this._onDataAddedCallback.bind(this)),t.onDataFiltered(this._onDataFilteredCallback.bind(this)),t.fetchData()}_onDataAddedCallback(t){this._instantiated||this._instantiateLayer();const e=new Array(t.getAddedDataCount());Sr.start("Creating feature from record",Cr.BigVectorLayer);const n="function"==typeof this._options.createFeature?this._options.createFeature:this._createFeatureFromRecord.bind(this);t.forEachAddedRecord((t,i)=>{e[i]=n(t)}),this._vectorSource.addFeaturesToSource(e),Sr.stop()}_onDataFilteredCallback(t){const e=t.getData().map(t=>t[0]);this._vectorSource.addShowOnlyFilter(e)}_instantiateLayer(){const t=this._getStyleFunction();this._vectorLayerStyleHandler.initialize(this),this._initializeSource(),this._layer=new r.a.layer.Vector({source:this._vectorSource,style:t}),this.addLayer(this._layer)}_initializeSource(){const{useThread:t,clusterRadius:e,clusteredByProperty:n,layerId:i,latProperty:r,lonProperty:o,dataSource:s,unrollClustersAtZoom:a}=this._options;this._vectorSource.initialize({dataSource:s,clusterable:!this.getStatic(),useThread:t,clusterRadius:e,layerId:i,clusteredByProperty:n,latProperty:r,lonProperty:o,unrollClustersAtZoom:a})}_getStyleFunction(){return this._options.styleFunction?this._options.styleFunction:this._vectorLayerStyleHandler.styleFunction.bind(this._vectorLayerStyleHandler)}_createFeatureFromRecord(t){const{wktColumn:e}=this._options,n=t.key(),i=this.getClusteredByProperty(),r=t.get(i);let o;t.hasGeometry()?o=t.getGeometry():this.hasLonLatProperties()&&(o=this._createPointGeometryFromRecord(t));const s=new Zi;return s.setGeometry(o),s.setFeatureKey(n),s.setLayerId(this._layerId),s.setRecordKeys([n]),s.setClusterProperty(i),s.setClusterPropertyValue(r),s}_createPointGeometryFromRecord(t){const e=this.getLonProperty(),n=t.get(e),i=this.getLatProperty(),o=t.get(i),s=r.a.proj.fromLonLat([n,o]);return new r.a.geom.Point(s)}getType(){return J.VectorLayer}getDataSource(){return this._options.dataSource}getClusteredByProperty(){return this._options.clusteredByProperty}getLatProperty(){return this._options.latProperty}getLonProperty(){return this._options.lonProperty}getUseThread(){return this._options.useThread}getClusterRadius(){return this._options.clusterRadius}getLayerId(){return this._options.layerId}hasLonLatProperties(){return!!this._options.lonProperty&&!!this._options.latProperty}getStyle(){return this._options.style}getSelectedStyle(){return this._options.selectedStyle}getUnrollClustersAtZoom(){return this._options.unrollClustersAtZoom}getAddPointToGeometries(){return this._options.addPointToGeometries}getFeatureSource(){return this._vectorSource}getStatic(){return!this._options.clusteredByProperty&&!this._options.clustered}setVisible(t){this._active||1!=t||this._activateLayerContainer(),this.setLayersVisible(t)}getClusterExtent(t){const e=t.getRecordKeys();let n=[];return e.forEach(t=>{const e=this.getDataSource().getDataContainer().getRecord(t),i=this._getCoordinatesFromRecordContainer(e);Q.isArray(i[0])?n=n.concat(i):n.push(i)}),r.a.extent.boundingExtent(n)}_getCoordinatesFromRecordContainer(t){if(this.hasLonLatProperties()){const e=[t.get(this._options.lonProperty),t.get(this._options.latProperty)];return r.a.proj.fromLonLat(e)}if(t.hasGeometry()){return t.getGeometry().getCoordinates()}}addSelection(t){t.condition=t.condition.split(" ").sort().join("-"),this._selections.push(t)}getSelections(){return this._selections}setSingleSelection(t,e,n){this._getSelection(t,e)&&(this._selectionLookup={[n]:!0})}setGeometricSelection(t,e,n){if(!this._getSelection(t,e))return;const i=this._getSelectionKeysFromGeometry(n);this._selectionLookup={};for(const t in i)this._selectionLookup[t]=!0}_getSelectionKeysFromGeometry(t){const e=this._vectorSource.getFeatures().filter(Yi.isFeatureInGeometry.bind(null,t)).map(t=>t.getRecordKeys());return[].concat(...e)}_getSelection(t,e){return this._selections.filter(n=>t==n.selector&&e==n.condition).pop()}clearSelection2(){this._selectionLookup={}}featureSelection(t,e,n,i){const r=this._getMatchingSelections(e,t);if(0===r.length)return;const o=[n];this._processSelection(i,o,r)}getMultiSelector(t){const e=this._getMatchingSelections(t).filter(this._isMultiSelection);if(e.length>1)throw new Error("Conflicting selection specifications.");if(0!==e.length)return e[0].selector}_isMultiSelection(t){const{selector:e}=t;return"cluster"!=e&&"single"!=e}multiFeatureSelection(t,e,n,i){const r=this._getMatchingSelections(e,t);if(0===r.length)return;const o=this._vectorSource.getFeatures().filter(Yi.isFeatureInGeometry.bind(null,n));this._processSelection(i,o,r)}_processSelection(t,e,n){this._featureListener&&this._featureListener.dispose();const i=this._createRecordKeysLookup(e),r=Object.keys(i),o=cd.get(lr.SelectionEvent);o.initialize(this.getDataSource(),e,r),n.filter(t=>!!t.callback).forEach(t=>t.callback(o)),t(e),this._featureListener=this._vectorSource.onFeatureChange(e=>{const n=e.filter(t=>this._featureContainsValidRecordKeys(i,t));n.length>0&&t(n)}),this._filterIfRequired(n,i)}_filterIfRequired(t,e){const{dataSource:n,layerId:i}=this._options;t.filter(t=>t.filter).length>0&&(n.applyKeyFilter(i,t=>e[t]),this._mediator.publish(cr.FORCE_REDRAW,{dataSourceId:this._options.dataSource.getId()}))}_featureContainsValidRecordKeys(t,e){for(const n of e.getRecordKeys())if(t[n])return!0;return!1}_createRecordKeysLookup(t){const e={};for(const n of t)n.getRecordKeys().forEach(t=>e[t]=!0);return e}_getMatchingSelections(t,e){return this._selections.filter(n=>(!e||n.selector===e)&&n.condition===t)}clearSelection(){const{dataSource:t,layerId:e}=this._options;this._filter=!1,t.removeKeyFilter(e),this._featureListener&&this._featureListener.dispose()}filterByExtent(t){const{dataSource:e}=this._options;this._extentFilterDimension||(this._extentFilterDimension=e.getDimension(tt.DataSource.RECORD_KEY)),this._extentFilterDimension.filter(e=>r.a.extent.containsCoordinate(t,this._getCoordinates(e))),this._mediator.publish(cr.FORCE_REDRAW,{dataSourceId:this._options.dataSource.getId()}),this._vectorSource.changed()}_getCoordinates(t){const e=this._options.dataSource.getDataContainer().getRecord(t),{latProperty:n,lonProperty:i}=this._options;return e.hasGeometry()?r.a.proj.toLonLat(e.getCoordinatesFromGeometry()):[e.get(i),e.get(n)]}};ju([Object(nt.inject)(lr.Mediator)],zu.prototype,"_mediator",void 0);var Uu,Hu=zu=ju([Object(nt.injectable)(),Bu(0,Object(nt.inject)(lr.VectorSource)),Bu(1,Object(nt.inject)(lr.VectorLayerStyleHandler))],zu);let Wu=Uu=class{constructor(){this._fill={},this._stroke={},this._point={},this._geometry={},this._cluster={},this._selected=!1,this._clusterZIndex=0}initialize(t,e,n){const{fillColor:i,strokeColor:r,strokeSize:o,shape:s,size:a,textFromProperty:c}=this._styleOptions=t;this._setFill(i,n),this._setStroke(r,o,n),this._setPoint(s,a,n),this._setGeometry(n),this._setClusterStyle(e,n),this._textFromProperty=c}getPoint(t){return this._point[t]}getGeometry(t){return this._geometry[t]}getCluster(t){const e=t.getRecordKeys().length,n=Y.nFormatter(e),i=t.getClusterPropertyValue(),r=this._cluster[i];return r.getText().setText(n),r}_getFill(t){return this._fill[t]}_getStroke(t){return this._stroke[t]}hasText(){return!!this._textFromProperty}getTextFromRecord(t){return t.get(this._textFromProperty)}setSelected(){this._selected=!0}_setFill(t,e){this._fill[e]=new Ai({color:t})}_setStroke(t,e,n){this._stroke[n]=new Ii({color:t,width:e})}_setPoint(t,e,n){const i=this._getFill(n),r=this._getStroke(n),o=this._selected?Number.MAX_SAFE_INTEGER:1,s=Uu.getPointStyle(t,i,r,e,o,!0);if(this.hasText()){const{textColor:t,textOffset:e}=this._styleOptions,n=new Vi({text:"",font:"bold 13px sans-serif",offsetY:e,fill:new Ai({color:t})});s.setText(n)}this._point[n]=s}_setGeometry(t){const e=this._getFill(t),n=this._getStroke(t),i=this._selected?Number.MAX_SAFE_INTEGER:1;this._geometry[t]=Uu.generateOtherStyle(e,n,i)}_setClusterStyle(t,e){const{shape:n,fillColor:i,strokeColor:r,strokeSize:o,size:s,textColor:a}=t,c=new Ai({color:i}),l=new Ii({color:r,width:o}),u=Uu.getPointStyle(n,c,l,s,this._clusterZIndex++),h=new Vi({text:"",fill:new Ai({color:a})});u.setText(h),this._cluster[e]=u}static getPointStyle(t,e,n,i,r,o=!1){let s;switch(t){case ar.TRIANGLE:s=Uu.generateTriangleShapePointStyle(e,n,i,r);case ar.CIRCLE:s=Uu.generateCircleShapePointStyle(e,n,i,r);case ar.ROMBUS:default:s=Uu.generateRombusShapePointStyle(e,n,i,r)}return o&&s.setGeometry(new Nn([0,0])),s}static generateCircleShapePointStyle(t,e,n,i){return new ki({image:new xi({radius:Math.ceil(n),fill:t,stroke:e}),zIndex:i})}static generateRombusShapePointStyle(t,e,n,i){return new ki({image:new Si({fill:t,stroke:e,points:4,radius:Math.ceil(n)}),zIndex:i})}static generateTriangleShapePointStyle(t,e,n,i){return new ki({image:new Si({fill:t,stroke:e,points:3,rotation:Math.PI,radius:Math.ceil(n)}),zIndex:i})}static generateOtherStyle(t,e,n){return new ki({fill:t,stroke:e,zIndex:n})}};var Gu=Wu=Uu=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)()],Wu);function Vu(t){for(;t.firstChild;)t.removeChild(t.firstChild)}var Yu=n(46),qu=n.n(Yu);function Xu(t){return`"${t}"`}function Ku(t,e,n,i,r){let o=function(t,e,n,i){i&&(t=t.map(t=>t.map((t,n)=>i(e[n],t))));let r=n?n.map(t=>Xu(e[t])).join(",")+"\r\n":e.map(Xu).join(",")+"\r\n";return r+=n?t.map(t=>n.map(e=>Xu(t[e])).join(",")).join("\r\n"):t.map(t=>t.map(Xu).join(",")).join("\r\n")}(e,n,i,r);qu()(new Blob([o]),t,"text/csv")}var $u=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};let Zu=class{constructor(){this._offset=0,this._initialized=!1,this._clickCount=0,this._isOrderAscending=!0}initialize(t){this._options=Po(t,Do),this._columnNameFunction=this._options.columnName,this._columns=this._options.columns,this._instantiateCharts(),this._initializeCharts()}_instantiateCharts(){const{domId:t,searchable:e}=this._options;this._htmlElement=this._generateHTMLElement();const n=this._htmlElement.querySelector(".sintium-data-table-container table");if(this._dataTable=a.dataTable(n),e){const t=this._htmlElement.querySelector(".sintium-data-table-search");this._searchChart=a.textFilterWidget(t)}document.getElementById(t).appendChild(this._htmlElement)}_initializeCharts(){const{dataSource:t,columns:e,searchableColumns:n,sortColumn:i,searchable:r}=this._options;this._columns=e||this._getColumns(),t.onDataFiltered(this._updatePagination.bind(this)),t.onDataAdded(t=>{if(!this._initialized)try{const n=this._getDimension(t);this._dataTable.size(1/0).dimension(n).columns(this._generateColumnFunctions()).showSections(!1).order(o.ascending).on("preRender",this._updateOffset.bind(this)).on("preRedraw",this._updateOffset.bind(this)).on("pretransition",this._updatePagination.bind(this)).render(),this._updatePagination(),this._htmlElement.addEventListener("click",this._clickHTMLElementCallback.bind(this)),this._updateColumns(),this._sortByColumn(i||e[0]),r&&this._searchChart.dimension(n).render(),this._initializeColumnVisibilityMenu(),this._mediator.subscribe(cr.FORCE_REDRAW,()=>this._dataTable.redraw()),this._initialized=!0}catch(t){console.log(t)}}),t.fetchData()}_getDimension(t){const{searchable:e,searchableColumns:n}=this._options;return e&&n?t.getCrossfilter().dimension(e=>n.map(n=>{const i=t.getIndexForColumn(n);return e[i]}).join(" ")):t.getCrossfilter().dimension(t=>t[0])}_clickHTMLElementCallback(t){const{dataSource:e,onSelectRow:n,onDoubleClickRow:i}=this._options,{clientX:r,clientY:o}=t,s=document.elementFromPoint(r,o);if("TD"==s.tagName&&(this._clickCount+=1,1===this._clickCount)){const r=s.parentElement,o=r.__data__[0],a=e.getDataContainer().getRecord(o);setTimeout(()=>{this._clickCount>1?i&&i(a,t):n&&n(a,t),this._clickCount=0},250),this._setSelectedRow(r,a)}}_setSelectedRow(t,e){this._clearSelectedRow(),this._selectedRecord=e,t.classList.add("sintium-data-table-selected-row")}_clearSelectedRow(){this._selectedRecord=null;const t=this._htmlElement.querySelector(".sintium-data-table-selected-row");t&&t.classList.remove("sintium-data-table-selected-row")}_orderBy(t){this._isOrderAscending=t;const e=t?o.ascending:o.descending;this._dataTable.order(e).render()}_addSortByOption(t,e){const{sortColumn:n}=this._options,i=document.createElement("option");return i.innerText=e,i.value=e,t.appendChild(i),n===e&&i.setAttribute("selected","true"),i}_generateColumnFunctions(){const t=this._options.dataSource.getDataContainer(),e=this.getVisibleColumns().map(e=>n=>{return n[t.getIndexForColumn(e)]});return[t=>t[0]].concat(e)}_forward(){const t=this._offset+1;this._setOffset(t)}_backward(){const t=this._offset-1;this._setOffset(t)}_setOffset(t){this._offset=t,this._updateOffset(),this._dataTable.redraw()}_updateOffset(){const{lineCount:t,dataSource:e}=this._options,n=e.getDataContainer().getDataLength(),i=Math.floor(n/t);this._offset=Math.max(Math.min(this._offset,i),0);const r=this._offset*t;this._dataTable.beginSlice(r),this._dataTable.endSlice(r+t),this._clearSelectedRow()}_updatePagination(){this._updatePaginationText();const t=this._getPaginationRange(),e=this._htmlElement.querySelector(".sintium-data-table-pages");Vu(e),t.forEach(t=>{const n=document.createElement("div");n.classList.add("sintium-data-table-pagination-button"),n.innerText=`${t}`,t===this._offset+1?n.classList.add("active"):n.onclick=()=>this._setOffset(t-1),e.appendChild(n)})}_getPaginationRange(){const{dataSource:t,lineCount:e,paginationCount:n}=this._options,i=t.getDataContainer().getDataLength(),r=Math.floor(i/e);let o=Math.max(this._offset-Math.ceil(n/2-1),0);return o+n-1>r&&(o=r-n+1),Array.from(Array(n)).map((t,e)=>o+e+1).filter(t=>t>0)}_updatePaginationText(){const{lineCount:t,dataSource:e}=this._options,n=e.getDataContainer().getDataLength(),i=e.getDataContainer().getDataLength(!0),r=this._offset*t,o=Math.min(r+t,n),s=this._htmlElement.querySelector(".sintium-data-table-pagination-text");s.querySelector(".begin").innerHTML=`${0===o?r:r+1} `,s.querySelector(".end").innerHTML=`${o}`,s.querySelector(".size").innerHTML=`${n}`,s.querySelector(".total-size").innerHTML=n!==i?`(Total ${i})`:""}getSelectedRecord(){return this._selectedRecord}_initializeColumnVisibilityMenu(){const t=this._htmlElement.querySelector(".column-visibility-menu-trigger");this._dropDownMenu=new Ja,this._dropDownMenu.initialize({trigger:t,maxHeight:200});for(const t of this._getColumns())this._dropDownMenu.addCheckBoxItem(t,e=>this._setColumnVisible(t,e),this._columns.indexOf(t)>=0)}getVisibleColumns(){const t=this._options.dataSource.getDataContainer(),e=this._getColumns();return this._columns.filter(t=>e.indexOf(t)>=0).sort((e,n)=>t.getIndexForColumn(e)-t.getIndexForColumn(n))}_getColumns(){const{dataSource:t}=this._options;return t.getDataContainer().getLabels(!0)}_setColumnVisible(t,e=!0){const n=this._columns.indexOf(t);if(e&&n<0)this._columns.push(t);else{if(e||!(n>=0))return;this._columns.splice(n,1)}const i=this._generateColumnFunctions();this._dataTable.columns(i).render(),this._updateColumns()}_updateColumns(){const t=this._htmlElement.querySelector("thead tr");Vu(t),this.getVisibleColumns().forEach(e=>{let n=sr.capitalizeFirstLetter(e);Q.isFunction(this._columnNameFunction)&&(n=this._columnNameFunction(n));const i=document.createElement("th"),r=e.replace(" ","-");i.innerHTML=`\n                    <div id="${r}" class="sintium-data-table-column-header">\n                        <div>${n}</div>\n                        <i class="fas fa-caret-up sort-up"></i>\n                        <i class="fas fa-caret-down sort-down"></i>\n                    </div>\n                `,e===this._sortColumn&&i.querySelector(`#${e}`).classList.add("sort-column"),i.addEventListener("click",this._sortByColumn.bind(this,e)),t.appendChild(i)})}_sortByColumn(t){if(t==this._sortColumn)this._orderBy(!this._isOrderAscending);else{const e=this._options.dataSource.getDataContainer().getIndexForColumn(t);this._dataTable.sortBy(t=>t[e]).render()}this._updateSortColumnStyle(t),this._sortColumn=t}_updateSortColumnStyle(t){if(this._sortColumn&&t!==this._sortColumn){this._htmlElement.querySelector(".sort-column").classList.remove("sort-column")}const e=t.replace(" ","-"),n=this._htmlElement.querySelector(`thead #${e}`);n.classList.add("sort-column"),this._isOrderAscending?n.classList.add("ascending"):n.classList.remove("ascending")}_generateHTMLElement(){const t=document.createElement("div");t.innerHTML='\n            <div class="sintium-data-table">\n                <div class="sintium-data-table-controls">\n                    <div id="search" class="sintium-data-table-search"></div>\n                    <div class="sintium-data-table-icon column-visibility-menu-trigger">\n                        <i class="fas fa-table"></i>\n                    </div>\n                </div>\n                <div class="sintium-data-table-container">\n                    <table class="table table-striped dc-data-grid">\n                      <thead>\n                        <tr class="header">\n                        </tr>\n                      </thead>\n                    </table>\n                </div>\n                <div class="sintium-data-table-pagination-container">\n                    <div class="sintium-data-table-pagination-text">\n                        Showing&nbsp;<span class="begin"></span>-<span class="end"></span>&nbsp;of&nbsp;<span class="size"></span>&nbsp;<span class="total-size"></span>\n                    </div>  \n                    <div class="sintium-data-table-pagination">\n                        <div class="sintium-data-table-pagination-button backward">   \n                            <i class="fas fa-backward"></i>\n                        </div>\n                        <div class="sintium-data-table-pages"></div>\n                        <div class="sintium-data-table-pagination-button forward">\n                            <i class="fas fa-forward"></i>\n                        </div>\n                    </div>              \n                </div>\n            </div>\n        ';const e=t.firstElementChild;return e.querySelector(".backward").addEventListener("click",this._backward.bind(this)),e.querySelector(".forward").addEventListener("click",this._forward.bind(this)),e}_downloadCsv(){const t=this._options.dataSource.getDataContainer();Ku("data.csv",t.getData(),t.getLabels(),this.getVisibleColumns().map(e=>t.getIndexForColumn(e)))}getHTMLElement(){return this._htmlElement}getID(){return this._options.domId}availableOptions(){return[{icon:"fas fa-file-csv",callback:this._downloadCsv.bind(this)}]}};$u([Object(nt.inject)(lr.Mediator)],Zu.prototype,"_mediator",void 0);var Ju=Zu=$u([Object(nt.injectable)()],Zu),Qu=function(t,e){return function(n,i){e(n,i,t)}};let th=class{constructor(t){this._columnValueCounts=[],this._checkedColumnValues={},this._onSelectionChangeCallback=[],this._initialized=!1,this._mediator=t}initialize(t){this._options=Po(t,Uo),this._initializeSelect()}_initializeSelect(){const{dataSource:t,domId:e,hasSearch:n,hasHeader:i,values:r,checkedValues:o,dimension:s,column:a,dimensionFunc:c}=this._options,l=!(!t||!a&&!c&&!s);this._htmlElement=this._generateHTMLElement(l),document.getElementById(e).appendChild(this._htmlElement),i&&this._setupSelectHeader(),n&&this._setupSearch(),l?(t.fetchData(()=>this._updateTable()),t.onDataAdded(()=>this._updateTable()),t.onDataFiltered(()=>this._updateTable())):!l&&r&&(o.forEach(t=>this._checkedColumnValues[t]=!0),this._columnValueCounts=r.map(t=>({key:`${t}`}))),this._updateTable()}_setupSelectHeader(){const{column:t,dataSource:e}=this._options,n=this._htmlElement.querySelector("thead tr"),i=sr.capitalizeFirstLetter(t);n.innerHTML=`\n            <th></th>\n            <th>${i}</th>\n        `,e&&(n.innerHTML="<th>#</th>")}_setupSearch(){const t=this._htmlElement.querySelector("input.search");t.addEventListener("input",()=>{this._searchTerm=t.value,this._updateTable()})}getSelectedValues(){return Object.keys(this._checkedColumnValues).filter(t=>this._checkedColumnValues[t])}setValues(t){this._columnValueCounts=t.map(t=>({key:`${t}`}));for(const e of Object.keys(this._checkedColumnValues))this._checkedColumnValues[e]=t.indexOf(e)>-1&&this._checkedColumnValues[e];this._updateTable()}onSelectionChange(t){this._onSelectionChangeCallback.push(t)}_triggerOnSelectionChangeCallback(){this._onSelectionChangeCallback.forEach(t=>{const e=[];for(const t of Object.keys(this._checkedColumnValues))this._checkedColumnValues[t]&&e.push(t);t(e)})}_initializeGroupAndDimension(){const{dataSource:t,column:e,dimensionFunc:n,dimensionFuncReturnsArray:i,dimension:r}=this._options,o=t.getDataContainer();e?this._dimension=t.getDimension(e):n?this._dimension=o.getCrossfilter().dimension(t=>n(o.wrapRecord(t)),!!i):r&&(this._dimension=r),this._group=this._dimension.group(),this._initialized=!0}_updateTable(){const t=!!this._options.dataSource;!this._initialized&&t&&this._initializeGroupAndDimension(),t&&(this._columnValueCounts=this._group.reduceCount().top(1/0));const e=this._htmlElement.querySelector("tbody");for(;e.lastChild;)e.removeChild(e.lastChild);this._columnValueCounts.filter(this._tableSearchFilterFunction.bind(this)).forEach(t=>{const{value:n,key:i}=t,r=this._generateRowElement(i,n);e.appendChild(r)})}_tableSearchFilterFunction(t){const e=`${t.key}`;return!this._searchTerm||e.includes(this._searchTerm)}_generateRowElement(t,e){const n=document.createElement("tr"),i=this._generateCheckboxHTML(t);n.innerHTML=`\n                <td>${i}</td>\n                <td>${t}</td>\n                <td>${e||0}</td>\n        `;const r=n.querySelector("input");return r.addEventListener("change",this._checkBoxChangeCallBack.bind(this,t,r)),n}_generateCheckboxHTML(t){return`\n            <label class="sintium-checkbox-container" style="margin-top: -3px">\n                <input type="checkbox" ${this._checkedColumnValues[t]?" checked":" "}>\n                <span class="checkmark"></span>\n            </label>\n        `}_checkBoxChangeCallBack(t,e){this._checkedColumnValues[t]=e.checked,this._options.dataSource&&(this._hasCheckedValues()?this._dimension.filter(t=>this._checkedColumnValues[t]):this._dimension.filter()),this._options.dataSource&&this._mediator.publish(cr.FORCE_REDRAW,{dataSourceId:this._options.dataSource.getId()}),this._triggerOnSelectionChangeCallback()}_hasCheckedValues(){for(const t in this._checkedColumnValues)if(this._checkedColumnValues[t])return!0;return!1}_generateHTMLElement(t=!1){const{hasSearch:e}=this._options,n=document.createElement("div");return n.classList.add("sintium-select"),e&&(n.innerHTML+='\n                <div class="sintium-select-search">\n                    <input class="search" />\n                </div>\n            '),n.innerHTML+=`\n            <div class="sintium-select-container">\n                <table class="table table-striped sintium-select-table dc-data-grid${t?"":" value-select"}">\n                    <thead>\n                        <tr class="header">\n                        </tr>\n                    </thead>\n                    <tbody>\n                    </tbody>\n                </table>\n            </div>\n        `,n}_resetSelectCallback(){const{dataSource:t,column:e,values:n}=this._options;this._checkedColumnValues={},t&&this._dimension.filterAll(),n&&this._updateTable(),this._triggerOnSelectionChangeCallback(),this._mediator.publish(cr.FORCE_REDRAW,{})}getHTMLElement(){return this._htmlElement}getID(){return this._options.domId}availableOptions(){return[{icon:"fas fa-redo",callback:this._resetSelectCallback.bind(this)}]}};var eh=th=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)(),Qu(0,Object(nt.inject)(lr.Mediator))],th),nh=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};let ih=class extends ft{constructor(){super(...arguments),this._filteredData={},this._features={},this._reducedData={},this._instantiated=!1,this._selections=[]}initialize(t){super.initialize(t),this._options=t,this._dataSource=t.dataSource;const{visible:e,groupByProperty:n,lazyLoad:i}=this._options;n&&this._createReduceGroupByProperty(),0!=e&&this.setVisible(!0),0!=i||this._instantiated||this._instantiateLayer()}_instantiateLayer(){this._instantiated=!0;const{styleFunction:t,dataSource:e}=this._options;this._source=new Na({features:[]}),this._layer=new Ls({source:this._source}),t&&this._layer.setStyle(this._styleFunction.bind(this)),this.addLayer(this._layer),e.onDataAdded(t=>{this._updateData(t),this._updateExtentFilter()}),e.onDataFiltered(this._updateData.bind(this)),e.fetchData()}_styleFunction(t){const{styleFunction:e}=this._options,n=t.get(tt.Feature.KEY);return e(t,n)}_createReduceGroupByProperty(){const{dataSource:t,groupByProperty:e}=this._options,n=t.getDataContainer();this._dimension=t.getDimension(e);const i=this._options.sum||[];this._group=this._dimension.group().reduce((t,e)=>{const r=n.wrapRecord(e);return i.forEach(e=>t.sum[e]=(t.sum[e]||0)+r.get(e)),t.count+=1,t.records.push(e),t.recordsAll.indexOf(e)<0&&t.recordsAll.push(e),t},(t,e)=>{const r=n.wrapRecord(e);i.forEach(e=>t.sum[e]=(t.sum[e]||0)-r.get(e)),t.count-=1;const o=t.records.indexOf(e);return o>=0&&t.records.splice(o,1),t},()=>({sum:{},count:0,records:[],recordsAll:[]}))}_updateData(t,e=!1){e&&(this._layer.getSource().clear(),this._features={}),this._data={},this._group.all().forEach(({key:t,value:e})=>this._data[t]=e),this._mapDataToFeatures(this._data),this._triggerOnDataChange(this._data),this._layer.changed()}_mapDataToFeatures(t){const{map:e,layerId:n}=this._options;Object.keys(t).forEach(i=>{if(!this._features[i]){const r=t[i],o=e(new Zi,i,r);if(!o)return;o.setFeatureKey(i),o.setLayerId(n),this._source.addFeature(o),this._features[i]=o}})}_triggerOnDataChange(t){const{onDataChange:e}=this._options;e(t)}setVisible(t){this._instantiated||this._instantiateLayer(),this.setLayersVisible(t)}getType(){return J.VectorLayer}getDataSource(){return this._options.dataSource}getDimension(){return this._dimension}addSelection(t){t.condition=t.condition.split(" ").sort().join("-"),this._selections.push(t)}getSelections(){return this._selections}setSingleSelection(t,e,n){this._getSelection(t,e)&&(this._selectionLookup={[n]:!0})}setGeometricSelection(t,e,n){if(!this._getSelection(t,e))return;const i=this._getSelectionKeysFromGeometry(n);this._selectionLookup={};for(const t of i)this._selectionLookup[t]=!0}_getSelectionKeysFromGeometry(t){return this._features.filter(Yi.isFeatureInGeometry.bind(null,t)).map(t=>t.getFeatureKey())}_getSelection(t,e){return this._selections.filter(n=>t==n.selector&&e==n.condition).pop()}featureSelection(t,e,n,i){const r=this._getMatchingSelections(e,t);if(0===r.length)return;const o=[n];this._processSelection(i,o,r)}getMultiSelector(t){const e=this._getMatchingSelections(t).filter(this._isMultiSelection);if(e.length>1)throw new Error("Conflicting selection specifications.");if(0!==e.length)return e[0].selector}_isMultiSelection(t){const{selector:e}=t;return"cluster"!=e&&"single"!=e}multiFeatureSelection(t,e,n,i){const r=this._getMatchingSelections(e,t);if(0===r.length)return;const o=Object.keys(this._features).map(t=>this._features[t]).filter(Yi.isFeatureInGeometry.bind(null,n));this._processSelection(i,o,r)}_processSelection(t,e,n){this._featureListener&&this._featureListener.dispose();const i=this._createRecordKeysLookup(e),r=Object.keys(i),o=cd.get(lr.SelectionEvent);o.initialize(this.getDataSource(),e,r),n.filter(t=>!!t.callback).forEach(t=>t.callback(o)),t(e),this._filterIfRequired(n,i)}_filterIfRequired(t,e){t.filter(t=>t.filter).length>0&&(this._options.dataSource.applyKeyFilter(this._options.layerId,t=>e[t]),a.redrawAll())}_createRecordKeysLookup(t){const e=this._options.dataSource.getDataContainer(),n={};for(const i of t){const t=i.getFeatureKey();this._data[t].recordsAll.forEach(t=>{const i=e.wrapRecord(t).key();n[i]=!0})}return n}_getMatchingSelections(t,e){return this._selections.filter(n=>(!e||n.selector===e)&&n.condition===t)}clearSelection(){const{dataSource:t,layerId:e}=this._options;this._filter=!1,t.removeKeyFilter(e),Object(s.redrawAll)()}filterByExtent(t){const{dataSource:e,groupByProperty:n}=this._options;this._extentFilterDimension||(this._extentFilterDimension=e.getDimension(n)),this._filterExtent=t,this._updateExtentFilter()}_updateExtentFilter(){if(!this._filterExtent)return;const t={};Object.keys(this._features).map(t=>this._features[t]).filter(this._featureIntersectsExtent.bind(this)).forEach(e=>t[e.getFeatureKey()]=!0),this._extentFilterDimension.filter(e=>t[e]),this._mediator.publish(cr.FORCE_REDRAW,{dataSourceId:this._options.dataSource.getId()})}_featureIntersectsExtent(t){if(!t.getGeometry())return!1;const e=Qe(t.getGeometry().getExtent(),"EPSG:3857","EPSG:4326");return ge(this._filterExtent,e)}};nh([Object(nt.inject)(lr.Mediator)],ih.prototype,"_mediator",void 0);var rh=ih=nh([Object(nt.injectable)()],ih);var oh=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};let sh=class{constructor(){this._selectedLegendItems={}}set(t){const{domId:e,dataSource:n,dimension:i,column:r,legendLabelFunction:o}=t;this._domId=e,this._dataSource=n,this._dimension=i,this._column=r,this._legendLabelFunction=o,this._colorRepository.onChange(this.updateLegend.bind(this))}clearLegendSelection(){this._selectedLegendItems={},this._updateFilter(),this.updateLegend()}updateLegend(){const t=document.getElementById(this._domId).querySelector(".sintium-chart-legend");if(t){for(;t.firstChild;)t.removeChild(t.firstChild);this._colorRepository.getColorsForColumn(this._dataSource,this._column).forEach(e=>{const{columnValue:n,value:i}=e,r=document.createElement("div");r.classList.add("sintium-chart-legend-item"),this._selectedLegendItems[n]&&r.classList.add("selected");const o=this._legendLabelFunction?this._legendLabelFunction(n):n;r.innerHTML=`\n                    <div class="sintium-chart-legend-item-color" style="background-color: ${i};"></div>\n                    <div class="sintium-chart-legend-item-text">${o}</div>\n                `,r.onclick=this._onLegendItemClick.bind(this,n),t.appendChild(r)})}}_sortColors(t,e){return t.columnValue.toString().localeCompare(e.columnValue.toString())}_onLegendItemClick(t){this._selectedLegendItems[t]=!this._selectedLegendItems[t],this._updateFilter(),this.updateLegend()}_updateFilter(){this._hasCheckedValues()?this._dimension.filter(t=>this._selectedLegendItems[t]):this._dimension.filter(),this._mediator.publish(cr.FORCE_REDRAW,{dataSourceId:this._dataSource.getId()})}_getUniqueValues(t){return t.group().top(1/0).map(t=>t.key)}_hasCheckedValues(){for(const t in this._selectedLegendItems)if(this._selectedLegendItems[t])return!0;return!1}setDimension(t){this._dimension=t}};oh([Object(nt.inject)(lr.ColorRepository)],sh.prototype,"_colorRepository",void 0),oh([Object(nt.inject)(lr.Mediator)],sh.prototype,"_mediator",void 0);var ah=sh=oh([Object(nt.injectable)()],sh);let ch=class{getMargins(t){let{margins:e,marginTop:n,marginRight:i,marginBottom:r,marginLeft:o}=t,s={top:0,right:0,bottom:0,left:0};if(this._isValidMarginsArray(e)){const[t,n,i,r]=e;s={top:t,right:n,bottom:i,left:r}}else this._isValidMarginsObject(e)&&(s=Object.assign(s,e));return n&&(s.top=n),i&&(s.right=i),r&&(s.bottom=r),o&&(s.left=o),s}calculateRadialSpecs(t,e,n){const{top:i,right:r,bottom:o,left:s}=t;return{centerX:(s+n-r)/2,centerY:(i+e-o)/2,radius:Math.min((n-r-s)/2,(e-o-i)/2)}}_isValidMarginsArray(t){return!!t&&(t.constructor==[].constructor&&(4==t.length&&!!Q.arrayOf(Q.isNumber,t)))}_isValidMarginsObject(t){if(!t)return!1;if(t.constructor!={}.constructor)return!1;return!(Object.keys(t).filter(t=>!tt.Chart.MARGIN_TYPES.has(t)).length>0)}};var lh=ch=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)()],ch);var uh=()=>{const t=document.createElement("div");return t.classList.add("sintium-play-widget","no-select"),t.innerHTML='\n        <div class="sintium-play-widget-content">\n            <div class="sintium-play-widget-dial-container">\n                <div class="sintium-play-widget-button">\n                    <i class="fas fa-play play"></i>\n                    <i class="fas fa-pause pause"></i>\n                    <i class="fas fa-stop stop"></i>\n                </div>\n                <div class=\'sintium-play-widget-dial\'>\n                    <div class="playback-speed-slider"></div>\n                </div>\n            </div>\n            <div class="sintium-play-widget-range-container">\n                <div class="sintium-play-widget-speed">1x</div>\n                <input type="range" min="0" max="0" value="0" step="1" class="sintium-play-widget-range">\n            </div>\n        </div>\n    ',t},hh=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};let dh=class extends Us{constructor(){super(...arguments),this._lastDegree=0,this._currentSpeedValue=1,this._currentPlaybackSpeed=1,this._time=0,this._index=0,this._isPlaying=!1,this._isIgnoringFilter=!1,this._isChangingSliderManually=!1}initialize(t){this._options=t,this._htmlElement=uh()}_initializeRangeEventListener(){const{dataSource:t}=this._options;t&&this._initializeDataSourceRangeEventListener()}_initializeDataSourceRangeEventListener(){const{dataSource:t}=this._options;t.onDataAdded(()=>{this._isPlaying&&this._stop(),this._updateRange()}),t.onDataFiltered(this._updateRangeOnFilter.bind(this))}_initializeButtonElements(){this._htmlElement.querySelector(".play").addEventListener("click",this._play.bind(this)),this._htmlElement.querySelector(".pause").addEventListener("click",this._pause.bind(this)),this._htmlElement.querySelector(".stop").addEventListener("click",this._stop.bind(this))}_initializeSliderRangeElement(){this._sliderRange=this._htmlElement.querySelector("input"),this._sliderRange.addEventListener("mousedown",()=>{this._isChangingSliderManually=!0,this._sliderRange.classList.add("active")}),this._sliderRange.addEventListener("mouseup",()=>{this._sliderRange.classList.remove("active"),this._time=0,this._isChangingSliderManually=!1}),this._sliderRange.addEventListener("change",()=>{this._time=0,this._isChangingSliderManually=!1;const t=parseFloat(this._sliderRange.value);this._setRangeIndex(t)})}_initializeSliderThumbElement(){const t=this._htmlElement.querySelector(".sintium-play-widget-dial");this._speedSliderThumbElement=t.querySelector(".playback-speed-slider");const e=this._updateSpeedSliderThumb.bind(this,t);this._speedSliderThumbElement.addEventListener("mousedown",()=>{t.classList.add("active"),document.addEventListener("mousemove",e)}),document.addEventListener("mouseup",()=>{t.classList.remove("active"),document.removeEventListener("mousemove",e)}),this._setSpeedSliderThumbPosition(t,180)}_getCenterPosition(t){const{top:e,left:n}=t.getBoundingClientRect();return{x:n+t.offsetWidth/2,y:e+t.offsetHeight/2}}_updateSpeedSliderThumb(t,e){const{x:n,y:i}=this._getCenterPosition(t),{clientX:r,clientY:o}=e;let s=-Math.atan2(n-r,i-o)/(Math.PI/180)+180;s=Math.abs(s-90*Math.round(s/90))<=5?90*Math.round(s/90):s,this._setSpeedSliderValue(s),this._setSpeedSliderThumbPosition(t,s)}_setSpeedSliderValue(t){let e=t-this._lastDegree;Math.abs(e)>200&&(e=e>0?t-360:t),this._currentSpeedValue+=e/12,this._currentSpeedValue=Math.min(Math.max(this._currentSpeedValue,-30),30),this._currentPlaybackSpeed=Math.abs(this._currentSpeedValue)<1?Math.sign(this._currentSpeedValue)||1:this._currentSpeedValue,this._currentPlaybackSpeed=Math.round(this._currentPlaybackSpeed),this._htmlElement.querySelector(".sintium-play-widget-speed").innerHTML=`${this._currentPlaybackSpeed}x`}_setSpeedSliderThumbPosition(t,e){const n=setInterval(()=>{if(0===t.offsetWidth)return;const i=t.offsetWidth/2-10,r=t.offsetHeight/2-10,o=i+this._speedSliderThumbElement.offsetWidth/2-.5,s=-Math.round(o*Math.sin(e*Math.PI/180))+i,a=-Math.round(o*-Math.cos(e*Math.PI/180))+r;this._speedSliderThumbElement.setAttribute("style",`top: ${a}px; left: ${s}px`),this._lastDegree=e,clearInterval(n)},30)}_play(){const{dataSource:t}=this._options;if(this._options.dataSource.getDataContainer().getData().length>0)if(this._time=0,document.body.classList.add("sintium-play-widget-playing"),this._htmlElement.classList.add("playing"),this._isPaused)this._isPaused=!1;else{const{keyColumn:e}=this._options;this._updateRange(),this._isPlaying=!0,this._sliderRange.removeAttribute("disabled"),this._dimension=t.getDimension(e),this.trigger("start-play"),this._setRangeIndex(0),this._interval=setInterval(this._incrementRangeIndex.bind(this),20)}}_incrementRangeIndex(){this._isPaused||this._isChangingSliderManually||(this._time+=20,this._time>=this._getTimePerIteration()/Math.abs(this._currentPlaybackSpeed)&&(this._index+=Math.sign(this._currentPlaybackSpeed),this._setRangeIndex(),this._sliderRange.value=`${this._index}`,this._time-=this._getTimePerIteration()/Math.abs(this._currentPlaybackSpeed)))}_getTimePerIteration(){return Q.isNumber(this._options.timePerIteration)?this._options.timePerIteration:3e3}_setRangeIndex(t){t=void 0===t?this._index:t;let e=this._range[t];e||(t=t>=this._range.length?0:this._range.length-1,e=this._range[t]),this._isIgnoringFilter=!0,this.trigger("playing",{currentValue:e}),this._dimension.filter(e),this._isIgnoringFilter=!1,this._index=t,this._mediator.publish(cr.FORCE_REDRAW,{dataSourceId:this._options.dataSource.getId()})}_pause(){this._isPlaying&&(this.trigger("pause-play"),this._isPaused=!0,this._htmlElement.classList.remove("playing"),document.body.classList.remove("sintium-play-widget-playing"))}_stop(){this.trigger("stop-play"),this._isPlaying&&(clearInterval(this._interval),this._isPlaying=!1,this._isPaused=!1,this._dimension&&(this._dimension.filterAll(),this._dimension.dispose(),a.redrawAll()),this._index=0,this._sliderRange.value="0",this._sliderRange.setAttribute("disabled","true"),document.body.classList.remove("sintium-play-widget-playing"),this._htmlElement.classList.remove("playing"))}_updateRangeOnFilter(t){if(this._isPaused&&!this._isIgnoringFilter){const e=this._range[this._index];if(this._isIgnoringFilter=!0,this._dimension.filterAll(),this._isIgnoringFilter=!1,this._range=this._generateRange(t),this._range.length>0){let t=this._range.indexOf(e);t=t<0?0:t,this._setRangeIndex(t),this._sliderRange.value=`${t}`,this._sliderRange.setAttribute("max",`${this._range.length-1}`)}else this._stop()}}_updateRange(){const t=this._options.dataSource.getDataContainer();this._range=this._generateRange(t),this._sliderRange.setAttribute("value",`${this._index}`),this._sliderRange.setAttribute("max",`${this._range.length-1}`)}_generateRange(t){const{keyColumn:e,dateIsText:n}=this._options,i=[],r={};return t.forEachRecord(t=>{const n=t.get(e);r[n]||(i.push(n),r[n]=!0)}),n?i.sort((t,e)=>{return new Date(t)-new Date(e)}):i.sort((t,e)=>t-e),i}getMaxForColumns(t,e){const n=this._options.dataSource.getDataContainer();if(e){const i=this._dimension.group().reduce((i,r)=>{const o=e.map(t=>n.wrapRecord(r).get(t)).join("-");return i[o]=(i[o]||0)+n.wrapRecord(r).get(t),i},(i,r)=>{const o=e.map(t=>n.wrapRecord(r).get(t)).join("-");return i[o]=(i[o]||0)-n.wrapRecord(r).get(t),i},()=>new Object).all();return Math.max(...i.map(({value:t})=>Math.max(...Object.keys(t).map(e=>t[e]))))}{const e=this._dimension.group().reduceSum(e=>n.wrapRecord(e).get(t)).all();return Math.max(...e.map(({value:t})=>t))}}getHTMLElement(){return this._htmlElement}getID(){return this._options.domId}onAddedToWidgetContainer(){this._initializeButtonElements(),this._initializeSliderRangeElement(),this._initializeSliderThumbElement(),this._initializeRangeEventListener()}};hh([Object(nt.inject)(lr.Mediator)],dh.prototype,"_mediator",void 0);var fh=dh=hh([Object(nt.injectable)()],dh);let ph=class{constructor(){this._initialized=!1}initialize(t){this._options=t,this._element=document.getElementById(t.domId),this._dataTable=a.tableview(this._element),this._initializeEventListeners()}_initializeEventListeners(){const{dataSource:t}=this._options;t.onDataAdded(t=>{this._initialized||this._initializeDataTable(t)})}_initializeDataTable(t){const{dataSource:e,columns:n}=this._options,i=e.getDataContainer().getCrossfilter().dimension(function(t){return+t.Expt}),r=i.group();this._dataTable.dimension(i).columns(this._getColumns()).group(r),this._dataTable.render()}_getColumns(){const t=this._options.dataSource.getDataContainer();return(this._options.columns||t.getLabels(!0)).map(e=>({title:e,data:t.getIndexForColumn(e)}))}getHTMLElement(){return this._element}getID(){return this._options.domId}onWidgetContainerSizeChange(){}};var gh=ph=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)()],ph);var _h=window.dc_graph,mh=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};let yh=class{constructor(){this._animateOnFilter=!1,this._autoZoomOnFilter=!1,this._brushing=!1,this._initialized=!1}initialize(t){this._options=Po(t,Qo);const{layoutEngine:e,layoutEngineOptions:n}=this._options;this._graph=new _h.diagram(`#${t.domId}`),this._updateD3(),this._initializeHTMLElement(),this._initializeLayoutEngine(e,n),this._initializeEventListeners()}_updateD3(){o.functor=function(t){return"function"==typeof t?t:function(){return t}}}_initializeHTMLElement(){const{domId:t}=this._options;this._htmlElement=document.getElementById(t),this._htmlElement.classList.add("sintium-graph")}_initializeEventListeners(){const{source:t}=this._options;t.onDataAdded((t,e,n,i)=>{this._initialized||this._initializeGraph(t,e,n,i),this._refreshColors()}),this._graph.on("brushstart",()=>this._brushing=!0),this._graph.on("brushend",()=>this._brushing=!1),t.fetchData()}_initializeGraph(t,e,n,i){if(this._initialized)return;const{source:r,brushOn:o,fitStrategy:s,crossfilterUpdateRate:a,induceNodes:c,nodeTitle:l,toolTip:u,engineSelect:h,highlightNeighbours:d}=this._options;this._graph.width("auto").height("auto").nodeDimension(t).nodeGroup(e).edgeDimension(n).edgeGroup(i).edgeTarget(t=>r.getEdgeTarget(t)).edgeSource(t=>r.getEdgeSource(t)).nodeKey(t=>r.getNodeKey(t)).nodeLabel(t=>r.getNodeLabel(t)).induceNodes(c),this._setupAutoZoom(),this._initializeStyle(),this._setupFixedNodes(),this._initializeNodeLabels(),this._initializeMargins(),o&&this._initializeBrush(),s&&this._graph.fitStrategy(s),Q.isNumber(a)&&this._graph.crossfilterUpdateRate(a),Q.isFunction(l)&&this._initializeNodeTitle(),u&&this._initializeToolTip(),h&&this._intitializeEngineSelect(),d&&this._initializeHighlightNeighbours(),this._graph.render().redraw(),this._initialized=!0,r.nodeSource().onDataAdded(this._nodeSourceUpdated.bind(this)),r.nodeSource().onDataFiltered(this._nodeSourceUpdated.bind(this,!0)),r.edgeSource().onDataAdded(this._edgeSourceUpdate.bind(this)),r.edgeSource().onDataFiltered(this._edgeSourceUpdate.bind(this,!0)),this._graph.on("start",()=>{this._callFilter()})}_intitializeEngineSelect(){const t=document.createElement("select");t.classList.add("sintium-graph-engine-select"),this._htmlElement.appendChild(t),this.getAvailableEngines().forEach(e=>{const n=document.createElement("option");n.innerText=e,n.setAttribute("value",e),t.appendChild(n)}),t.onchange=()=>{const e=es[t.value]||{};this._initializeLayoutEngine(t.value,e),this._graph.relayout(),this._graph.redraw(),this._graph.zoomToFit(!0)},t.value=this._layoutEngine}_initializeMargins(){const{engineSelect:t}=this._options,e=this._chartMarginHandler.getMargins(this._options);e.top=t?50:e.top,this._graph.margins(e)}_initializeHighlightNeighbours(){}_initializeToolTip(){this._graph.nodeTitle(null);const{source:t,toolTip:e}=this._options,n=t.nodeSource().getDataContainer(),i=t.edgeSource().getDataContainer(),r=_h.tip();let o;!0===e?o=_h.tip.html_or_json_table().json(function(t){return(t.source?i:n).wrapRecord(t.orig.value).toJSONStringify()}):Q.isFunction(e)&&(o=(t,r)=>{const o=(t.source?i:n).wrapRecord(t.orig.value),s=e(o);s&&r(s.outerHTML)}),r.content(o),this._graph.child("tip",r)}_nodeSourceUpdated(t=!1){this._mediator.publish(cr.FORCE_REDRAW,{dataSourceId:this._options.source.nodeSource().getId()}),this._updateGraph(),t&&this._callFilter()}_edgeSourceUpdate(t=!1){this._mediator.publish(cr.FORCE_REDRAW,{dataSourceId:this._options.source.edgeSource().getId()}),this._updateGraph(),t&&this._callFilter()}_updateGraph(){this._graph.redraw()}_initializeBrush(){const t=_h.select_nodes({nodeOpacity:1}).noneIsAll(!0).autoCropSelection(!1);this._graph.child("select-nodes",t).child("filter-selection-nodes",_h.filter_selection("select-nodes-group","select-nodes")).nodeOpacity(.25);const e=_h.select_edges({edgeStrokeWidth:2,edgeOpacity:1}).noneIsAll(!0).autoCropSelection(!1),n=_h.filter_selection("select-edges-group","select-edges").dimensionAccessor(function(t){return t.edgeDimension()});this._graph.child("select-edges",e).child("filter-selection-edges",n).edgeOpacity(.25)}_initializeLayoutEngine(t,e={}){this._layoutEngine=t,this._engine=_h.spawn_engine(t),e&&this._setupLayoutEngine(this._engine,e),this._graph.layoutEngine(this._engine)}_setupLayoutEngine(t,e){for(const n of t.optionNames()){const i=e[n];i&&t[n](i)}}_setupFixedNodes(){const{source:t}=this._options;t.hasNodeCoordinates()&&this._graph.nodeFixed(t.getNodeCoordinates.bind(t))}_setupAutoZoom(){let{autoZoom:t}=this._options,e=null;if(1==t?e=ts:Q.isObject(t)&&(e=Po(t,ts)),e){let t=e.animate&&e.skipFirstAnimation?"once":"once-noanim";"filter"===e.type&&(this._autoZoomOnFilter=!0,this._animateOnFilter=e.animate),this._graph.autoZoom(t)}}_initializeStyle(){const{nodeColorScheme:t,nodeColorByColumn:e,edgeColorScheme:n,edgeColorByColumn:i,source:r}=this._options;t&&e&&this._colorRepository.setColorSchemeForColumn(r.nodeSource(),e,t),n&&i&&this._colorRepository.setColorSchemeForColumn(r.edgeSource(),i,n),this._refreshColors(),this._initializeNodeColors(),this._initializeNodeStroke(),this._initializeNodeShape(),this._initializeNodeRadius(),this._initializeEdgeColors(),this._initializeEdgeSymbols()}_initializeNodeColors(){const{source:t,nodeColorByColumn:e,nodeColor:n}=this._options,i=this._createColorFunction(t.nodeSource(),e,n);this._graph.nodeFill(i)}_initializeNodeStroke(){const{source:t,nodeColorByColumn:e,nodeStrokeColor:n,nodeStrokeWidth:i}=this._options,r=this._graph.nodeFill(),o=t.nodeSource().getDataContainer();let s;e||!n?s=t=>rr()(r(t)).brighten(1):Q.isFunction(n)?s=t=>{const e=o.wrapRecord(t.value);return n(e)}:Q.isString(n)&&(s=()=>n),this._graph.nodeStroke(s);const a=this._createStrokeFunction(t.nodeSource(),i);this._graph.nodeStrokeWidth(a)}_initializeNodeShape(){const{source:t,nodeShape:e,nodeShapeFromColumn:n,nodeShapeByColumn:i}=this._options,r=t.nodeSource().getDataContainer();let o;if(Q.isString(e))o={shape:e};else if(Q.isFunction(e))o=t=>{const n=r.wrapRecord(t.value);return e(n)};else if(Q.isString(n))o=t=>r.wrapRecord(t.value).get(n);else if(Q.isString(i)){const t={available:this.getNodeShapes(),lookup:{}};o=e=>{const n=r.wrapRecord(e.value).get(i);let o=t.lookup[n];return o||(o=t.lookup[n]=t.available.shift()),{shape:o}}}o&&this._graph.nodeShape(o)}_initializeNodeRadius(){const{source:t,nodeRadius:e,nodeRadiusFromColumn:n}=this._options,i=t.nodeSource().getDataContainer();let r;Q.isNumber(e)?r=e:Q.isFunction(e)?r=t=>{const n=i.wrapRecord(t.value);return e(n)}:Q.isString(n)&&(r=t=>i.wrapRecord(t.value).get(n)),r&&this._graph.nodeRadius(r)}_initializeNodeTitle(){const{source:t,nodeTitle:e}=this._options,n=t.nodeSource().getDataContainer();this._graph.nodeTitle(t=>{const i=n.wrapRecord(t.value);return e(i)})}_initializeEdgeColors(){const{source:t,edgeColorByColumn:e,edgeColor:n,edgeStrokeWidth:i}=this._options,r=this._createColorFunction(t.edgeSource(),e,n);this._graph.edgeStroke(r);const o=this._createStrokeFunction(t.nodeSource(),i);this._graph.edgeStrokeWidth(o)}_initializeEdgeSymbols(){const{source:t,arrowHeadFromColumn:e,arrowHead:n,arrowTailFromColumn:i,arrowTail:r,arrowSize:o}=this._options,s=this._createSymbolFunction(t.edgeSource(),e,n);s&&this._graph.edgeArrowhead(s);const a=this._createSymbolFunction(t.edgeSource(),i,r);a&&this._graph.edgeArrowtail(a),this._graph.edgeArrowSize(o)}_createSymbolFunction(t,e,n){const i=t.getDataContainer();if(e)return t=>{return i.wrapRecord(t.value).get(e)};if(n){if(Q.isFunction(n))return t=>{const e=i.wrapRecord(t.value);return n(e)};if(Q.isNumber(n))return()=>n}}_createStrokeFunction(t,e){const n=t.getDataContainer();return Q.isFunction(e)?t=>{const i=n.wrapRecord(t.value);return e(i)}:Q.isNumber(e)?()=>e:void 0}_createColorFunction(t,e,n){const i=t.getDataContainer();return e?t=>{const n=i.wrapRecord(t.value).get(e);return this._nodeColorScale(n)}:Q.isFunction(n)?t=>{const e=i.wrapRecord(t.value);return n(e)}:()=>n}_initializeNodeLabels(){const{source:t,nodeLabel:e,nodeLabelFromColumn:n}=this._options,i=t.nodeSource().getDataContainer();let r;r=null===e?()=>"":Q.isFunction(e)?t=>{const n=i.wrapRecord(t.value);return e(n)}:n?t=>i.wrapRecord(t.value).get(n):t.getNodeKey.bind(t),this._graph.nodeLabel(r),this._graph.nodeLabelFill(t=>{const e=this._graph.nodeFill()(t);return rr()(e).luminance()>.4?"#000":"#fff"})}_refreshColors(){const{nodeColorByColumn:t,edgeColorByColumn:e,source:n}=this._options;t&&(this._colorRepository.refreshColorForColumn(n.nodeSource(),t),this._nodeColorScale=this._colorRepository.getColorScaleForColumn(n.nodeSource(),t)),e&&(this._colorRepository.refreshColorForColumn(n.edgeSource(),e),this._edgeColorScale=this._colorRepository.getColorScaleForColumn(n.edgeSource(),e))}getEngine(){return this._engine}getAvailableEngines(){return["dagre","d3v4force"]}getNodeShapes(){return["ellipse","egg","triangle","rectangle","diamond","trapezium","parallelogram","pentagon","hexagon","septagon","octagon","invtriangle","invtrapezium","square"].slice()}getHTMLElement(){return document.getElementById(this._options.domId)}getID(){return this._options.domId}onWidgetContainerSizeChange(){this._autoZoomOnFilter&&this._graph.zoomToFit(this._animateOnFilter)}_callFilter(){this._autoZoomOnFilter&&!this._brushing&&this._graph.zoomToFit(this._animateOnFilter)}};mh([Object(nt.inject)(lr.Mediator)],yh.prototype,"_mediator",void 0),mh([Object(nt.inject)(lr.ColorRepository)],yh.prototype,"_colorRepository",void 0),mh([Object(nt.inject)(lr.ChartMarginHandler)],yh.prototype,"_chartMarginHandler",void 0);var vh=yh=mh([Object(nt.injectable)()],yh),bh=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};let Ch=class{constructor(){this._hasAddedDimensionsAndGroups=!1,this._fetchDataCallbacks=[],this._onDataAddedCallbacks=[],this._nodesLookup={}}initialize(t){this._options=t,this._nodeIdColumn=this._options.columns.nodeId,this._sourceIdColumn=this._options.columns.sourceId,this._targetIdColumn=this._options.columns.targetId,this._initializeDataSource(),this._initializeEventListeners()}_initializeDataSource(){this._nodeSource.initialize({useCrossfilter:!0}),this._nodeSource.onDataAdded(this._updateNodesLookup.bind(this)),this._edgeSource.initialize({useCrossfilter:!0})}_initializeEventListeners(){const t=this._edgeSource.getDataContainer(),e=t.getCrossfilter();this._edgeNodesDimension=e.dimension(e=>{const n=t.wrapRecord(e);return`${this._nodesLookup[n.get(this._sourceIdColumn)]}-${this._nodesLookup[n.get(this._targetIdColumn)]}`});const n=this._nodeSource.getDataContainer().getCrossfilter();this._nodeSource.onDataFiltered(t=>{this._edgeNodesDimension.filter(t=>{const[e,i]=t.split("-");return n.isElementFiltered(e)&&n.isElementFiltered(i)})})}addData(t){const{keys:e}=this._options,n=t[e.nodes],i=t[e.edges];n&&this._nodeSource.addData(n),i&&this._edgeSource.addData(i),this._hasAddedDimensionsAndGroups||this._addDimensionsAndGroups(this._nodeSource,this._edgeSource),this._hasData=!0,this._triggerOnDataAddedCallbacks()}onDataAdded(t){this._onDataAddedCallbacks.push(t),this._hasData&&t(this._nodeDimension,this._nodeGroup,this._edgeDimension,this._edgeGroup)}_triggerOnDataAddedCallbacks(){this._onDataAddedCallbacks.forEach(t=>{t(this._nodeDimension,this._nodeGroup,this._edgeDimension,this._edgeGroup)})}fetchData(t){this._options.url&&(t&&this._fetchDataCallbacks.push(t),this._loadingData&&this._hasData||fetch(this._options.url).then(t=>{try{return t.json()}catch(t){return Promise.reject()}}).then(t=>{this.addData(t),this._triggerFetchDataCallbacks()}).catch(t=>{console.log(t)}))}_triggerFetchDataCallbacks(){this._fetchDataCallbacks.forEach(t=>{t(this._nodeDimension,this._nodeGroup,this._edgeDimension,this._edgeGroup)})}_addDimensionsAndGroups(t,e){const n=t.getDataContainer().getCrossfilter(),i=_h.flat_group.make(n,this._getNodeId.bind(this));this._nodeDimension=i.dimension,this._nodeGroup=i.group;const r=e.getDataContainer().getCrossfilter(),o=_h.flat_group.make(r,this._getEdgeId.bind(this));this._edgeDimension=o.dimension,this._edgeGroup=o.group,this._hasAddedDimensionsAndGroups=!0}nodeSource(){return this._nodeSource}edgeSource(){return this._edgeSource}_getNodeId(t){return this._nodeSource.getDataContainer().wrapRecord(t).get(this._nodeIdColumn)}_getEdgeId(t){const e=this._edgeSource.getDataContainer().wrapRecord(t);return`${e.get(this._sourceIdColumn)}-${e.get(this._targetIdColumn)}`}getEdgeSource(t){return this._edgeSource.getDataContainer().wrapRecord(t.value).get(this._sourceIdColumn)}getEdgeTarget(t){return this._edgeSource.getDataContainer().wrapRecord(t.value).get(this._targetIdColumn)}getNodeKey(t){return t.value?this._nodeSource.getDataContainer().wrapRecord(t.value).get(this._nodeIdColumn):null}getNodeLabel(t){return this._nodeLabelColumn?this._nodeSource.getDataContainer().wrapRecord(t.value).get(this._nodeLabelColumn):this.getNodeKey(t)}getNodeIdColumn(){return this._nodeIdColumn}getSourceIdColumn(){return this._sourceIdColumn}getTargetIdColumn(){return this._targetIdColumn}hasNodeCoordinates(){return!!this._nodeXColumn&&!!this._nodeYColumn}getNodeCoordinates(t){const e=this._nodeSource.getDataContainer().wrapRecord(t.value),n=e.get(this._nodeXColumn),i=e.get(this._nodeYColumn);return n&&i?{x:n,y:i}:null}_updateNodesLookup(t){const{nodeId:e}=this._options.columns;if(e)for(const n of t.getAddedData()){const i=t.wrapRecord(n);this._nodesLookup[i.get(e)]=i.key()}}getNodeById(t){return this.nodeSource().getDataContainer().getRecord(this._nodesLookup[t])}};bh([Object(nt.inject)(lr.DataSource)],Ch.prototype,"_nodeSource",void 0),bh([Object(nt.inject)(lr.DataSource)],Ch.prototype,"_edgeSource",void 0);var wh,Eh=Ch=bh([Object(nt.injectable)()],Ch),Th=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};let Sh=wh=class{constructor(){this._initialized=!1,this._stackValues=[]}initialize(t,e,n){this._chart=t,this._dimension=e;const{dataSource:i,stackColumn:r}=this._options=n;this._stackDimension=i.getDimension(r);const o=i.getUniqueValuesFromDimension(this._stackDimension);this._stackGroup=this._getStackedChartGroup(),this._initialized=!0,this.updateStack(o),i.onDataAdded(()=>{})}updateStack(t){if(this._initialized){const{dataSource:e}=this._options;(t=t||e.getUniqueValuesFromDimension(this._stackDimension).sort()).forEach(t=>{this._stackValues.indexOf(t)<0&&(0===this._stackValues.length?this._chart.group(this._stackGroup,t,e=>e.value[t]):this._chart.stack(this._stackGroup,t,e=>e.value[t]),this._stackValues.push(t))}),this._chart.render()}}_setupStackedChartColors(){const{dataSource:t,stackColumn:e,colorScheme:n}=this._options;n&&this._colorRepository.setColorSchemeForColumn(t,e,n),this._colorRepository.onChange(()=>{const n=this._colorRepository.getColorsForColumn(t,e).map(t=>t.value),i=n.map((t,e)=>e);this._chart.ordinalColors(n).colorDomain(i)}),this._refreshStackColors()}_refreshStackColors(){const{dataSource:t,stackColumn:e}=this._options;this._colorRepository.refreshColorForColumn(t,e)}_getStackedChartGroup(){const{dataSource:t,yAxis:e,stackColumn:n}=this._options,i=t.getDataContainer(),r=i.getIndexForColumn(e),o=i.getIndexForColumn(n);return this._dimension.group().reduce(wh.reduceAdd.bind(null,r,o),wh.reduceMin.bind(null,r,o),wh.reduceInitialValue.bind(this))}static reduceAdd(t,e,n,i){const r=i[e];return n[r]=(n[r]||0)+i[t],n}static reduceMin(t,e,n,i){const r=i[e];return n[r]=(n[r]||0)-i[t],n}static reduceInitialValue(){return{}}getStackDimension(){return this._stackDimension}getStackGroup(){return this._stackGroup}};Th([Object(nt.inject)(lr.ColorRepository)],Sh.prototype,"_colorRepository",void 0);var xh=Sh=wh=Th([Object(nt.injectable)()],Sh);var Rh=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};let Ah=class extends Vs{initialize(t){this._options=Po(t,os);const e=this._options.domId||q.generateEmptyWidgetDomId();this._chart=a.boxPlot(`#${e}`),super.initialize(this._chart,this._options),this._chartAxesHandler.initialize(this._chart,this._options),this._initializeEventListeners()}_initializeEventListeners(){const{dataSource:t}=this._options;t.onDataAdded(this._initializeChart.bind(this)),t.fetchData(this._initializeChart.bind(this))}_initializeChart(t){if(this.initialized())return;const{xAxisTickFormat:e,xAxis:n,xUnits:i,dataSource:r,dataOpacity:o,boxSpacing:s,dataWidth:a,showData:c,boxWidth:l,brushOn:u,dimension:h}=this._options,d="distinct"===i;this._dimension=h||r.getDimension(n);let f=this._dimension.group().reduce(this._createAddFunction(t,this._options),this._createRemoveFunction(t,this._options),this._initial);d&&(f=this._ordinal_to_linear_group(f),this._setupChartForLinearToOrdinal(this._chart,f,u)),e&&this._setXAxisTickFormat(this._chart,f,d),this._setOutliers(this._chart,this._options),this._chart.dataOpacity(o).boxPadding(s).boxWidth(l).dataWidthPortion(a).renderDataPoints(!!c).dimension(this._dimension).group(f).render(),this.initialized(!0)}_setOutliers(t,e){const{outliers:n}=e;let i=!0,r=!1;switch(n){case"bold":r=!0;break;case"none":i=!1}t.boldOutlier(r).showOutliers(i)}_createAddFunction(t,e){const{yAxis:n}=e;return(e,i)=>{const r=t.wrapRecord(i).get(n);return e.splice(o.bisectLeft(e,r),0,r),e}}_createRemoveFunction(t,e){const{yAxis:n}=e;return(e,i)=>{const r=t.wrapRecord(i).get(n);return e.splice(o.bisectLeft(e,r),1),e}}_initial(){return[]}_ordinal_to_linear_group(t){let e,n;return{all:function(){const i=t.all();return e={},n=[],i.forEach(function(t,i){e[t.key]=i,n[i]=t.key}),i},ord2int:function(t){return e||this.all(),e[t]},int2ord:function(t){return n||this.all(),n[t]}}}_setupChartForLinearToOrdinal(t,e,n){this._chart.keyAccessor(t=>e.ord2int(t.key)),t.xAxis().tickFormat(t=>e.int2ord(t)),n&&t.filterHandler(function(t,n){if(!n||!n.length)return t.filter(null),n;console.assert(1===n.length),console.assert("RangedFilter"===n[0].filterType);const i=e.all().filter(function(t){const i=e.ord2int(t.key);return n[0][0]<=i&&i<n[0][1]}).map(function(t){return t.key});return t.filterFunction(t=>i.includes(t)),n})}_setXAxisTickFormat(t,e,n){const{xAxisTickFormat:i,dataSource:r}=this._options;n&&r.onDataAdded(()=>{const n=e.all().length;t.xAxis().tickValues([...Array(n).keys()])}),t.xAxis().tickFormat(t=>(t=n?e.int2ord(t):t,i(t)))}};Rh([Object(nt.inject)(lr.ChartAxesHandler)],Ah.prototype,"_chartAxesHandler",void 0);var Oh=Ah=Rh([Object(nt.injectable)()],Ah);const Ih="\n    precision highp float;\n\n    attribute float nodeIndex;\n\n    uniform sampler2D nodePositions;\n    uniform float nodePositionsWidth;\n    uniform float forceSize;\n\n    void main() {\n        float w = nodePositionsWidth;\n        float halfTexel = (0.5 / w);\n\n        vec2 texelPos = vec2(\n            fract(nodeIndex / w) + halfTexel,\n            (floor(nodeIndex / w) / w) + halfTexel\n        );\n\n        vec4 positionColor = texture2D(nodePositions, texelPos);\n\n        vec2 pos = vec2(\n            positionColor.r / 255.0 + positionColor.b,\n            positionColor.g / 255.0 + positionColor.a\n        );\n\n        gl_Position= vec4(\n            pos * 2.0 - 1.0,\n            0.0, 1.0\n        );\n\n        gl_PointSize = forceSize;\n    }\n",Mh="\n    precision highp float;\n\n    varying float skip;\n\n    float smooth(float x) {\n        return pow(1.0 - x, 3.0);    \n    }\n\n    void main(void) {\n\n        vec2 pos = vec2(\n            gl_PointCoord.x * 2.0 - 1.0,\n            gl_PointCoord.y * -2.0 + 1.0\n        );\n\n        float intencity = smooth(length(pos));\n\n        gl_FragColor = vec4(\n            max(0.0, pos.y),\n            max(0.0, pos.x),\n            max(0.0, -pos.y),\n            max(0.0, -pos.x)\n        ) * intencity;\n    }\n",Ph="\n    precision highp float;\n\n    attribute float fromIndex;\n    attribute float toIndex;\n\n    uniform sampler2D nodePositions;\n    uniform float nodesWidth;\n    uniform float from;\n    uniform float k;\n    uniform float minEdgeLength;\n\n    varying vec4 color;\n\n    vec2 getTexelPos(float index) {\n        float halfTexel = (0.5 / nodesWidth);\n        return vec2(\n            fract(index / nodesWidth) + halfTexel,\n            (floor(index / nodesWidth) / nodesWidth) + halfTexel\n        );\n    }\n\n    vec2 colorToCoord(vec4 color) {\n        return vec2(\n            color.r / 255.0 + color.b,\n            color.g / 255.0 + color.a\n        );\n    }\n\n    float attraction(float d) {\n        return (d*d) / k;\n    }\n\n    void main() {\n\n        vec2 fromTexelPos = getTexelPos(fromIndex);\n        vec2 toTexelPos = getTexelPos(toIndex);\n\n        vec4 fromColor = texture2D(nodePositions, fromTexelPos);\n        vec4 toColor = texture2D(nodePositions, toTexelPos);\n\n        vec2 fromPos = colorToCoord(fromColor);\n        vec2 toPos = colorToCoord(toColor);\n\n        vec2 d = fromPos - toPos;\n        float sd = sqrt(d.x*d.x + d.y*d.y);\n        float force = attraction(sd);\n        vec2 delta = d * force;\n\n        // if (length(d) < minEdgeLength) {\n        //     delta *= -1.0;\n        // }\n\n        if(from == 1.0)\n            delta *= -1.0;\n\n        color = vec4(\n            max(0.0, delta.y),\n            max(0.0, delta.x),\n            max(0.0, -delta.y),\n            max(0.0, -delta.x)\n        );\n\n        vec2 pos;\n        if(from == 1.0)\n            pos = fromTexelPos;\n        else\n            pos = toTexelPos;\n\n        gl_Position = vec4(\n            pos * 2.0 - 1.0,\n            0.0, 1.0\n        );\n        gl_PointSize = 1.0;\n    }\n",Lh="\n    precision highp float;\n\n    varying vec4 color;\n\n    void main(void) {\n        gl_FragColor = color;\n    }\n",Dh="\n    precision highp float;\n\n    attribute vec2 readPos;\n    attribute vec2 writePos;\n\n    varying vec2 texelPos;\n\n    void main() {\n        texelPos = readPos;\n\n        gl_Position = vec4(\n            writePos,\n            0.0, 1.0\n        );\n    }\n",kh="\n    precision highp float;\n\n    uniform sampler2D nodePositions;\n    uniform sampler2D vectorField;\n    uniform sampler2D edgeForces;\n\n    uniform float maxDisplacement;\n    uniform float temperature;\n\n    varying vec2 texelPos;\n\n    const float speed = 0.1;\n\n    void main(void) {\n\n        vec4 oldPosColor = texture2D(nodePositions, texelPos);\n        vec2 oldPos = vec2(\n            oldPosColor.r / 255.0 + oldPosColor.b,\n            oldPosColor.g / 255.0 + oldPosColor.a\n        );\n\n        vec4 repulsiveForcesColor = texture2D(vectorField, oldPos);\n        vec4 attractiveForcesColor = texture2D(edgeForces, texelPos);\n\n        vec2 repulsiveForces = vec2(\n            repulsiveForcesColor.g - repulsiveForcesColor.a,\n            repulsiveForcesColor.r - repulsiveForcesColor.b\n        );\n\n        vec2 attractiveForces = vec2(\n            (attractiveForcesColor.g - attractiveForcesColor.a),\n            (attractiveForcesColor.r - attractiveForcesColor.b)\n        ) * 0.9;\n\n        vec2 gravity = normalize(vec2(0.5, 0.5) - oldPos) * 0.0005;\n\n        vec2 combinedForces = vec2(\n            repulsiveForces.x + gravity.x + attractiveForces.x,\n            repulsiveForces.y + gravity.y + attractiveForces.y\n        ) * speed;\n        \n        vec2 displacement = vec2(\n            clamp(combinedForces.x, -maxDisplacement, maxDisplacement),\n            clamp(combinedForces.y, -maxDisplacement, maxDisplacement)\n        ) * temperature;\n\n        vec2 newPos = oldPos + displacement;\n\n        vec4 newPosColor = vec4(\n            fract(newPos * 255.0),\n            floor(newPos * 255.0) / 255.0\n        );\n\n\n        gl_FragColor = newPosColor;\n    }\n";class Fh{constructor(t){this.programs={},this.textures={},this.buffers={},this.temperature=1;const{canvas:e,gl:n,framebuffer:i,buffers:r,nNodes:o,nEdges:s,render:a}=this.options=Po(t,as);this.canvas=e,this.gl=n,this.frameBuffer=i,this.buffers=r,this.nNodes=o,this.nEdges=s,this.render=a,this.nodesDim=Math.ceil(Math.sqrt(this.nNodes)),this.k=Math.sqrt(1/this.nNodes),this.webGLSetup(this.canvas,this.gl)}getNodePositions(){return this.textures.nodePositions0}onFiltered(t,e,n){this.buffers=t,this.nNodes=e,this.nEdges=n,this.temperature=1,this.startRenderLoop()}webGLSetup(t,e){this.setFramebufferSize(t.getBoundingClientRect()),e.viewport(0,0,t.width,t.height),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),this.programs.vectorField=cl.createProgram(e,Ih,Mh),this.programs.edgeForces=cl.createProgram(e,Ph,Lh),this.programs.newPositions=cl.createProgram(e,Dh,kh),this.textures.nodePositions0=this.createNodePositionsTexture(e,this.nodesDim),this.textures.nodePositions1=cl.createTexture(e,e.NEAREST,this.nodesDim,this.nodesDim,null),this.textures.edgeForces=cl.createTexture(e,e.NEAREST,this.nodesDim,this.nodesDim,null),this.textures.vectorField=cl.createTexture(e,e.NEAREST,this.framebufferSize,this.framebufferSize,null)}setFramebufferSize(t){this.framebufferSize=2*Math.max(t.height,t.width),this.maxDisplacement=this.options.forceSize/this.framebufferSize*.15,this.minEdgeLength=this.options.forceSize/this.framebufferSize*.15}createNodePositionsTexture(t,e){const n=cl.initImageData(e,e),i=n.data.length/4;let r=0;for(let t=0;t<i;t++){const e=t*(1/i),o=t*Fh.initialAngle,s=e*Math.cos(o)+.5,a=e*Math.sin(o)+.5;n.data[r]=255*(255*s-Math.floor(255*s)),n.data[r+1]=Math.round(255*(255*a-Math.floor(255*a))),n.data[r+2]=Math.floor(255*s),n.data[r+3]=Math.floor(255*a),r+=4}return cl.createTexture(t,t.NEAREST,e,e,n)}bindTextures(){const t=this.gl;t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.textures.nodePositions0),t.activeTexture(t.TEXTURE0+1),t.bindTexture(t.TEXTURE_2D,this.textures.vectorField),t.activeTexture(t.TEXTURE0+2),t.bindTexture(t.TEXTURE_2D,this.textures.edgeForces)}drawVectorField(t,e){t.useProgram(e.program),t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),t.viewport(0,0,this.framebufferSize,this.framebufferSize),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.textures.vectorField,0),t.clear(t.COLOR_BUFFER_BIT),t.bindBuffer(t.ARRAY_BUFFER,this.buffers.nodeIndices),t.enableVertexAttribArray(e.nodeIndex),t.vertexAttribPointer(e.nodeIndex,1,t.FLOAT,!1,2*Float32Array.BYTES_PER_ELEMENT,0),t.uniform1f(e.nodePositionsWidth,this.nodesDim),t.uniform1i(e.nodePositions,0),t.uniform1f(e.forceSize,this.options.forceSize),t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE),t.drawArrays(t.POINTS,0,this.nNodes),t.disable(t.BLEND)}updateEdgeForces(t,e,n=0){t.useProgram(e.program),t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),t.viewport(0,0,this.nodesDim,this.nodesDim),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.textures.edgeForces,0),0==n&&t.clear(t.COLOR_BUFFER_BIT),t.uniform1i(e.nodePositions,0),t.uniform1f(e.nodesWidth,this.nodesDim),t.uniform1f(e.from,n),t.uniform1f(e.k,this.k),t.uniform1f(e.minEdgeLength,this.minEdgeLength),t.bindBuffer(t.ARRAY_BUFFER,this.buffers.edges),t.enableVertexAttribArray(e.fromIndex),t.enableVertexAttribArray(e.toIndex),t.vertexAttribPointer(e.fromIndex,1,t.FLOAT,!1,2*Float32Array.BYTES_PER_ELEMENT,0),t.vertexAttribPointer(e.toIndex,1,t.FLOAT,!1,2*Float32Array.BYTES_PER_ELEMENT,Float32Array.BYTES_PER_ELEMENT),t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE),t.drawArrays(t.POINTS,0,this.nEdges),t.disable(t.BLEND),0==n&&this.updateEdgeForces(t,e,1)}updatePositions(t,e){t.useProgram(e.program),t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.textures.nodePositions1,0),t.viewport(0,0,this.nodesDim,this.nodesDim),t.clear(t.COLOR_BUFFER_BIT),t.uniform1i(e.nodePositions,0),t.uniform1i(e.vectorField,1),t.uniform1i(e.edgeForces,2),t.uniform1f(e.maxDisplacement,this.maxDisplacement),t.uniform1f(e.temperature,this.temperature),t.bindBuffer(t.ARRAY_BUFFER,this.buffers.square),t.vertexAttribPointer(e.writePos,2,t.FLOAT,!1,4*Float32Array.BYTES_PER_ELEMENT,0),t.vertexAttribPointer(e.readPos,2,t.FLOAT,!1,4*Float32Array.BYTES_PER_ELEMENT,2*Float32Array.BYTES_PER_ELEMENT),t.enableVertexAttribArray(e.writePos),t.enableVertexAttribArray(e.readPos),t.drawArrays(t.TRIANGLE_STRIP,0,4),[this.textures.nodePositions1,this.textures.nodePositions0]=[this.textures.nodePositions0,this.textures.nodePositions1]}step(t=this.options.stepSize){for(let e=0;e<t;e++)this.bindTextures(),this.drawVectorField(this.gl,this.programs.vectorField),this.updateEdgeForces(this.gl,this.programs.edgeForces),this.updatePositions(this.gl,this.programs.newPositions);this.temperature*=.95,this.render()}toggle(){void 0===this.renderRequest?this.startRenderLoop():this.stopRenderLoop()}loop(){this.renderRequest=void 0,this.step(),this.temperature>this.options.temperatureThreshold?this.startRenderLoop():(this.stopRenderLoop(),this.temperature=1,this.render(!0))}startRenderLoop(){null==this.renderRequest&&(this.renderRequest=window.requestAnimationFrame(()=>this.loop()))}stopRenderLoop(){window.cancelAnimationFrame(this.renderRequest),this.renderRequest=void 0}}Fh.initialAngle=Math.PI*(3-Math.sqrt(5));var Nh=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};let jh=class extends Us{constructor(){super(...arguments),this.programs={},this.textures={},this.buffers={},this.scale=1,this.translation=new Float32Array([0,0]),this.resolution=new Float32Array([0,0]),this._initialized=!1}initialize(t){const{domId:e,source:n,tooltip:i,nodeSize:r,fixedNodeSize:o,tooltipMessage:s}=this._options=Po(t,ss);this.parent=document.getElementById(e),this._graphSource=n,this.nodeSize=r,this.fixedNodeSize=o,this._nodeSource=this._graphSource.nodeSource(),i&&this._initializeTooltip(s),this._graphSource.onDataAdded(t=>{this._initialized||this._init()}),n.nodeSource().onDataFiltered(this.onFiltered.bind(this,!0)),n.edgeSource().onDataFiltered(this.onFiltered.bind(this,!0)),this._graphSource.fetchData()}_initializeTooltip(t){this._tooltipElement=document.createElement("div"),this._tooltipElement.id="graph-tooltip",this.parent.appendChild(this._tooltipElement),this.on("hover-node",e=>{const{record:n,x:i,y:r}=e;let o=n.key().toString();t&&(o=t.map(t=>n.get(t)).join(" | ")),this._showTooltip(o,i,r)}),this.on("hover-empty",t=>{this._tooltipElement.style.opacity="0"})}_initializeColors(){const{nodeColorScheme:t,nodeColorByColumn:e,nodeColor:n,source:i}=this._options;t&&e&&this._colorRepository.setColorSchemeForColumn(this._nodeSource,e,t),this._colorFunction=this._createColorFunction(i.nodeSource(),e,n)}_refreshColors(){const{nodeColorByColumn:t,source:e}=this._options;t&&(this._colorRepository.refreshColorForColumn(e.nodeSource(),t),this._nodeColorScale=this._colorRepository.getColorScaleForColumn(e.nodeSource(),t))}_createColorFunction(t,e,n){const i=t.getDataContainer();if(this._colorLookup={},e)return t=>{if(!this._colorLookup[t]){const n=i.getRecord(t).get(e),r=this._nodeColorScale(n);return this._colorLookup[t]=this._convertColorToNumber(r)}return this._colorLookup[t]};if(Q.isFunction(n))return t=>{if(!this._colorLookup[t]){const e=i.getRecord(t),r=n(e);return this._colorLookup[t]=this._convertColorToNumber(r)}return this._colorLookup[t]};{const t=this._convertColorToNumber(n);return()=>t}}_convertColorToNumber(t){const e=rr()(t).rgb();return 65535*e[0]+255*e[1]+e[2]}_init(){const t=this._graphSource.nodeSource().getDataContainer().getData(),e=this._graphSource.edgeSource().getDataContainer().getData();t[0].target instanceof Number||(this.nodeIndexLookup=this.createNodeIndexLookup(t)),this.nNodes=t.length,this.nEdges=e.length,this.nodesDim=Math.ceil(Math.sqrt(t.length)),this._refreshColors(),this._initializeColors(),this.webGLSetup(this.parent,t),this._mouseEventsSetup(),this.resolution[0]=this.parent.scrollWidth,this.resolution[1]=this.parent.scrollHeight,this._options.hasLayout?this.render(!0):this._layoutEngine.startRenderLoop(),this._refreshColors(),this._initialized=!0}onFiltered(){if(!this._initialized)return;const t=this.createNodeIndicesArray(this._graphSource.nodeSource().getDataContainer(),this._colorFunction);this.buffers.nodeIndices=cl.createArrayBuffer(this.gl,t),this.nNodes=t.length/2;const e=this.createEdgesArray(this._graphSource.edgeSource().getDataContainer());this.buffers.edges=cl.createArrayBuffer(this.gl,e),this.nEdges=e.length/2,this._options.hasLayout||this._layoutEngine.onFiltered(this.buffers,this.nNodes,this.nEdges),this.render(!0)}render(t=!1){this.textures.nodePositions=this.getNodePositions(),this.bindTextures(),this.drawEdges(this.gl,this.programs.edges),this.drawNodes(this.gl,this.programs.nodes),t&&this.drawNodeIndices(this.gl,this.programs.nodeIndices)}webGLSetup(t,e){const n=document.createElement("canvas");t.appendChild(n),t.style.width="100%",t.style.height="100%",this.fitCanvasToParent(n,t),this.canvasBound=n.getBoundingClientRect();const i=n.getContext("webgl");i.viewport(0,0,n.width,n.height),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT),this.programs.nodes=cl.createProgram(i,"\n    precision highp float;\n\n    attribute float nodeIndex;\n    attribute float nodeColor;\n\n    uniform sampler2D nodePositions;\n    uniform float nodePositionsWidth;\n    uniform float nodeSize;\n    uniform float scale;\n    uniform vec2 translation;\n    uniform vec2 resolution;\n    \n    varying vec4 color;\n    \n    vec4 getColor(float value) {\n        float r = floor(value / 65536.0);\n        float g = floor((value - (r * 65536.0)) / 256.0);\n        float b = value - (r * 65536.0) - (g * 256.0);\n        return vec4(r / 255.0, g / 255.0, b / 255.0, 1.0);\n    }\n\n    void main() {\n        float w = nodePositionsWidth;\n        float halfTexel = (0.5 / w);\n\n        vec2 texelPos = vec2(\n            fract(nodeIndex / w) + halfTexel,\n            (floor(nodeIndex / w) / w) + halfTexel\n        );\n\n        vec4 positionColor = texture2D(nodePositions, texelPos);\n\n        vec2 translation = (2.0 * translation) / resolution;\n\n        vec2 pos = vec2(\n            positionColor.r / 255.0 + positionColor.b,\n            positionColor.g / 255.0 + positionColor.a\n        ) * 2.0 - 1.0;\n        \n        float aspect = resolution.y / resolution.x;\n        pos.x *= aspect;\n        \n        color = getColor(nodeColor);\n\n        gl_Position= vec4(\n            pos * scale + translation,\n            0.0, 1.0\n        );\n\n        gl_PointSize = nodeSize;\n    }\n","\n    precision highp float;\n    \n    varying vec4 color;\n\n    void main(void) {\n\n        vec2 cxy = 2.0 * gl_PointCoord - 1.0;\n        float a = 1.0 - dot(cxy, cxy);\n        if (a <= 0.0)\n            discard;\n\n        if (a <= 0.2) {\n            gl_FragColor = vec4(\n                0.0, 0.0, 0.0, 1.0\n            );\n        } else {\n            gl_FragColor = color;\n        }\n    }\n"),this.programs.edges=cl.createProgram(i,"\n    precision highp float;\n\n    attribute float nodeIndex;\n\n    uniform sampler2D nodePositions;\n    uniform float nodePositionsWidth;\n    uniform float scale;\n    uniform vec2 translation;\n    uniform vec2 resolution;\n\n    vec2 getTexelPos(float index, float width) {\n        float halfTexel = (0.5 / width);\n        return vec2(\n            fract(index / width) + halfTexel,\n            (floor(index / width) / width) + halfTexel\n        );\n    }\n\n    void main() {\n        vec4 posColor = texture2D(nodePositions, getTexelPos(nodeIndex, nodePositionsWidth));\n\n        vec2 translation = (2.0 * translation) / resolution;\n\n        vec2 pos = vec2(\n            posColor.r / 255.0 + posColor.b,\n            posColor.g / 255.0 + posColor.a\n        ) * 2.0 - 1.0;\n        \n        float aspect = resolution.y / resolution.x;\n        pos.x *= aspect;\n\n        gl_Position = vec4(\n            pos * scale  + translation,\n            0.0, 1.0\n        );\n        gl_PointSize = 2.0;\n    }\n","\n    precision highp float;\n\n    void main(void) {\n        gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n    }\n"),this.programs.nodeIndices=cl.createProgram(i,"\n    precision highp float;\n\n    attribute float nodeIndex;\n\n    uniform sampler2D nodePositions;\n    uniform float nodePositionsWidth;\n    uniform float nodeSize;\n    uniform float scale;\n    uniform vec2 translation;\n    uniform vec2 resolution;\n\n    varying vec4 color;\n\n    vec4 getColor(float value)\n    {\n        float r = floor(value / 16777216.0);\n        float g = floor((value - r * 16777216.0) / 65536.0);\n        float b = floor((value - (r * 16777216.0) - (g * 65536.0)) / 256.0);\n        float a = value - (r * 16777216.0) - (g * 65536.0) - (b * 256.0);\n        return vec4(r / 255.0, g / 255.0, b / 255.0, a / 255.0);\n    }\n\n    void main() {\n        float w = nodePositionsWidth;\n        float halfTexel = (0.5 / w);\n\n        vec2 texelPos = vec2(\n            fract(nodeIndex / w) + halfTexel,\n            (floor(nodeIndex / w) / w) + halfTexel\n        );\n\n        vec4 positionColor = texture2D(nodePositions, texelPos);\n\n        vec2 translation = (2.0 * translation) / resolution;\n\n        color = getColor(nodeIndex + 1.0);\n\n        vec2 pos = vec2(\n            positionColor.r / 255.0 + positionColor.b,\n            positionColor.g / 255.0 + positionColor.a\n        ) * 2.0 - 1.0;\n        \n        float aspect = resolution.y / resolution.x;\n        pos.x *= aspect;\n\n        gl_Position= vec4(\n            pos * scale + translation,\n            0.0, 1.0\n        );\n\n        gl_PointSize = nodeSize;\n    }\n","\n    precision highp float;\n\n    varying vec4 color;\n\n    void main(void) {\n\n        vec2 cxy = 2.0 * gl_PointCoord - 1.0;\n        float a = 1.0 - dot(cxy, cxy);\n        if (a <= 0.0)\n            discard;\n        \n        gl_FragColor = color;\n    }\n"),this.textures.lookup=cl.createTexture(i,i.NEAREST,n.width,n.height,null);const r=this.createNodeIndicesArray(this._graphSource.nodeSource().getDataContainer(),this._colorFunction),o=this.createEdgesArray(this._graphSource.edgeSource().getDataContainer());this.buffers.nodeIndices=cl.createArrayBuffer(i,r),this.buffers.edges=cl.createArrayBuffer(i,o),this.buffers.square=cl.createSquareBuffer(i),this.canvas=n,this.gl=i,this.framebuffer=i.createFramebuffer(),this._options.hasLayout?this.setupStaticLayout(e):this.setupLayoutEngine()}setupLayoutEngine(){const{forceSize:t,stepSize:e,temperatureThreshold:n}=Po(this._options,as),i={canvas:this.canvas,gl:this.gl,framebuffer:this.framebuffer,buffers:this.buffers,nNodes:this.nNodes,nEdges:this.nEdges,forceSize:t,stepSize:e,temperatureThreshold:n,render:this.render.bind(this)};this._layoutEngine=new Fh(i)}setupStaticLayout(t){let e=[1/0,-1/0],n=[1/0,-1/0];t.forEach(t=>{e[0]=t[4].x<e[0]?t[4].x:e[0],e[1]=t[4].x>e[1]?t[4].x:e[1],n[0]=t[4].y<n[0]?t[4].y:e[0],n[1]=t[4].y>n[1]?t[4].y:e[1]}),this.textures.nodePositions=this.createNodesTexture(this.gl,this.nodesDim,t,e,n)}getNodePositions(){return this._options.hasLayout?this.textures.nodePositions:this._layoutEngine.getNodePositions()}createNodeIndexLookup(t){const e=this._nodeSource.getDataContainer(),n=this._graphSource.getNodeIdColumn(),i=performance.now(),r=new Map;t.forEach((t,i)=>{const o=e.wrapRecord(t);r.set(o.get(n),o.key())});const o=performance.now();return console.log("creating node index lookup took:",o-i),r}createNodeIndicesArray(t,e){const n=t.getDataLength(),i=new Float32Array(2*n);let r=0;return t.forEachRecord(t=>{const n=t.key();i[r]=n,i[r+1]=e(n),r+=2}),i}createEdgesArray(t){const e=t.getDataLength(),n=this._graphSource.getSourceIdColumn(),i=this._graphSource.getTargetIdColumn(),r=new Float32Array(2*e);let o=0;return t.forEachRecord(t=>{void 0!==this.nodeIndexLookup?(r[o]=this.nodeIndexLookup.get(t.get(n)),r[o+1]=this.nodeIndexLookup.get(t.get(i))):(r[o]=t.get(n),r[o+1]=t.get(i)),o+=2}),r}fitCanvasToParent(t,e){t.width=e.clientWidth,t.height=e.clientHeight}createNodesTexture(t,e,n,i,r){const o=performance.now(),s=ll.initImageData(e,e),a=i[1]-i[0],c=r[1]-r[0];for(let t=0,e=0;t<n.length;t++,e+=4){const n=this._nodeSource.getDataContainer().getRecord(t),o=(n.get("coord").x-i[0])/a,l=(n.get("coord").y-r[0])/c;s.data[e]=255*(255*o-Math.floor(255*o)),s.data[e+1]=Math.round(255*(255*l-Math.floor(255*l))),s.data[e+2]=Math.floor(255*o),s.data[e+3]=Math.floor(255*l)}const l=performance.now();return console.log("making nodes texture took:",l-o),cl.createTexture(t,t.NEAREST,e,e,s)}bindTextures(){const t=this.gl;t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.textures.nodePositions)}drawEdges(t,e){t.useProgram(e.program),t.bindFramebuffer(t.FRAMEBUFFER,null),t.viewport(0,0,this.canvas.width,this.canvas.height),t.clear(t.COLOR_BUFFER_BIT),t.uniform1i(e.nodePositions,0),t.bindBuffer(t.ARRAY_BUFFER,this.buffers.edges),t.enableVertexAttribArray(e.nodeIndex),t.vertexAttribPointer(e.nodeIndex,1,t.FLOAT,!1,0,0),t.uniform1f(e.nodePositionsWidth,this.nodesDim),t.uniform1f(e.scale,this.scale),t.uniform2fv(e.translation,this.translation),t.uniform2fv(e.resolution,this.resolution),t.lineWidth(1),t.drawArrays(t.LINES,0,2*this.nEdges)}drawNodes(t,e){t.useProgram(e.program),t.uniform1i(e.nodePositions,0),t.bindBuffer(t.ARRAY_BUFFER,this.buffers.nodeIndices),t.enableVertexAttribArray(e.nodeIndex),t.vertexAttribPointer(e.nodeIndex,1,t.FLOAT,!1,2*Float32Array.BYTES_PER_ELEMENT,0),t.enableVertexAttribArray(e.nodeColor),t.vertexAttribPointer(e.nodeColor,1,t.FLOAT,!1,2*Float32Array.BYTES_PER_ELEMENT,Float32Array.BYTES_PER_ELEMENT),t.uniform1f(e.nodePositionsWidth,this.nodesDim),t.uniform1f(e.scale,this.scale),t.uniform2fv(e.translation,this.translation),t.uniform2fv(e.resolution,this.resolution),t.uniform1f(e.nodeSize,this.nodeSize),t.drawArrays(t.POINTS,0,this.nNodes)}drawNodeIndices(t,e){t.useProgram(e.program),t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer),t.viewport(0,0,this.canvas.width,this.canvas.height),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.textures.lookup,0),t.clear(t.COLOR_BUFFER_BIT),t.bindBuffer(t.ARRAY_BUFFER,this.buffers.nodeIndices),t.enableVertexAttribArray(e.nodeIndex),t.vertexAttribPointer(e.nodeIndex,1,t.FLOAT,!1,2*Float32Array.BYTES_PER_ELEMENT,0),t.uniform1f(e.nodePositionsWidth,this.nodesDim),t.uniform1i(e.nodePositions,0),t.uniform1f(e.scale,this.scale),t.uniform2fv(e.translation,this.translation),t.uniform2fv(e.resolution,this.resolution),t.uniform1f(e.nodeSize,this.nodeSize),t.drawArrays(t.POINTS,0,this.nNodes),t.bindFramebuffer(t.FRAMEBUFFER,null)}getHoveredNodeIndex(t,e){const n=this.gl,i=new Uint8Array(4);return n.bindFramebuffer(n.FRAMEBUFFER,this.framebuffer),n.readPixels(t,e,1,1,n.RGBA,n.UNSIGNED_BYTE,i),n.bindFramebuffer(n.FRAMEBUFFER,null),16777215*i[0]+65535*i[1]+255*i[2]+i[3]-1}_showTooltip(t,e,n){this._tooltipElement.style.top=`${n}px`,this._tooltipElement.style.left=`${e}px`,this._tooltipElement.innerHTML=t,this._tooltipElement.style.opacity="1"}_zoomed(t){this._tooltipElement.style.opacity="0",this.scale=t.k,this.translation[0]=t.x,this.translation[1]=-t.y,this.fixedNodeSize||(this.nodeSize=this._options.nodeSize*this.scale),this.render(!1)}_mouseEventsSetup(){this.canvas.addEventListener("mousemove",t=>{const e=t.clientX-this.canvasBound.left-this.canvas.clientLeft,n=t.clientY-this.canvasBound.top-this.canvas.clientTop;if(this._hoverIndex=this.getHoveredNodeIndex(e,this.canvas.height-n),this._hoverIndex>=0){const t=this._nodeSource.getDataContainer().getRecord(this._hoverIndex);this.trigger("hover-node",{record:t,x:e,y:n})}else this.trigger("hover-empty",{})});const t=o.zoom().on("end",t=>this.render(!0)).on("zoom",t=>this._zoomed(o.event.transform));o.select(this.canvas).call(t)}getHTMLElement(){return this.parent}getID(){return this.parent.id}onWidgetContainerSizeChange(){this.fitCanvasToParent(this.canvas,this.parent),this.canvasBound=this.canvas.getBoundingClientRect(),this.resolution[0]=this.parent.scrollWidth,this.resolution[1]=this.parent.scrollHeight,this.textures.lookup=cl.createTexture(this.gl,this.gl.NEAREST,this.canvas.width,this.canvas.height,null),this.render(!0)}};Nh([Object(nt.inject)(lr.Mediator)],jh.prototype,"_mediator",void 0),Nh([Object(nt.inject)(lr.ColorRepository)],jh.prototype,"_colorRepository",void 0),jh=Nh([Object(nt.injectable)()],jh);var Bh=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};const{RECORD_KEY:zh,GEOMETRY:Uh}=tt.DataSource;let Hh=class{parse(t){const{data:e,labels:n,compact:i,delimiter:r,csvHasHeader:o}=t,s=this._tryToParseDataAsJSON(e);if(s)return this._isValidGeoJSON(s)?this._recordsFromGeoJSON(s):this._recordsFromJSON(s,n,i);const a=this._tryToParseDataAsCSV(e,r);if(a)return this._recordsFromCSV(a,n,o);throw it()}_tryToParseDataAsJSON(t){if(this._isValidJSON(t))return t;try{return JSON.parse(t)}catch(t){return null}}_tryToParseDataAsCSV(t,e){const n=ys.parse(t,{delimiter:e,dynamicTyping:!0,skipEmptyLines:"greedy"});if(0==n.errors.length)return n}_recordsFromGeoJSON(t){if(0===(t.features||[]).length)return{records:[],labels:[]};const e=t.features[0],n=Object.keys(e.properties);return{records:t.features.map((t,e)=>{const i=new Array(n.length+2);return i[0]=e,i[1]=t.geometry,n.forEach((e,n)=>{i[n+2]=t.properties[e]}),i}),labels:[zh,Uh].concat(n)}}_recordsFromJSON(t,e,n){const i=t[0];let r;if(Q.isArray(i)){if(!e)throw rt();r=t.map((t,n)=>{const i=new Array(e.length+1);return i[0]=n,t.forEach((t,e)=>i[e+1]=t),i})}else Q.isObject(i)&&(e=e||Object.keys(i),n?r=t.map((t,n)=>{const i=new Array(e.length+1);return i[0]=n,e.forEach((e,n)=>i[n+1]=t[e]),i}):(t.forEach((t,e)=>{t[zh]=e}),r=t));return{records:r,labels:[zh].concat(e)}}_recordsFromCSV(t,e,n){const i=t.data;let r=n?i.shift():e;if(!r)throw rt();return{records:i.map((t,e)=>{const n=new Array(this._columnCount(i)+1);return n[0]=e,t.forEach((t,e)=>n[e+1]=t),n}),labels:r=[zh].concat(r)}}_isValidGeoJSON(t){return t[tt.GeoJSON.TYPE]==tt.GeoJSON.FEATURE_COLLECTION&&t[tt.GeoJSON.FEATURES]instanceof Array}_isValidJSON(t){return Q.isArray(t)||Q.isObject(t)}_columnCount(t){return t[0].length}};var Wh=Hh=Bh([Object(nt.injectable)()],Hh),Gh=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};class Vh extends Vs{constructor(){super(...arguments),this._subCharts={}}initialize(t){this._options=Po(t,rs),this._chart=a.compositeChart(`#${this._options.domId}`),this._initializeEventListener(t),super.initialize(this._chart,t),this._chartAxesHandler.initialize(this._chart,t),t.colorScheme&&this._colorRepository.setColorSchemeForColumn(t.dataSource,t.groupColumn,t.colorScheme)}_initializeEventListener(t){const{dataSource:e}=t;e.fetchData(this._initializeChart.bind(this,t)),e.onDataAdded(this._initializeChart.bind(this,t))}_initializeChart(t,e){const{groupColumn:n,dataSource:i}=t;if(!this.initialized()){const{xUnits:n,xAxis:r,xAxisReturnsArray:o,dimension:s,yAxis:a}=t,c=this._chartAxesHandler.getUnitsType(n);this._dimension=s||i.getDimension(r,c,o),this._group=this._createGroup(e),this._chart.dimension(this._dimension),this.initialized(!0)}const r=this._getNewGroupValues();r.length>0&&(this._colorRepository.setColorsForColumn(i,n),r.forEach(this._generateSubChart.bind(this)),this._chart.compose(this._getSubChartArray()).render())}_getNewGroupValues(){if(0===this._group.all().length)return[];return Object.keys(this._group.all()[0].value).filter(t=>!this._subCharts[t])}_generateSubChart(t){const e=a.lineChart(this._chart).dimension(this._dimension).group(this._group,t).colors(this._getColor(t)).valueAccessor(e=>e.value[t]);this._subCharts[t]=e}shouldHideLegend(t){const e=this._subCharts[t].data().pop().values;for(const t of e)if(0!==t.y)return!1;return!0}_getColor(t){const{colorFunction:e,dataSource:n,groupColumn:i}=this._options;return Q.isFunction(e)?e(t):this._colorRepository.getColorForColumnValue(n,i,t)}_getSubChartArray(){return Object.keys(this._subCharts).map(t=>this._subCharts[t])}_createGroup(t){const{yAxis:e,groupColumn:n}=this._options,i=t.getIndexForColumn(n),r=t.getIndexForColumn(e);return this._dimension.group().reduce((t,e)=>{const n=e[i];return t[n]=(t[n]||0)+ +e[r],t},(t,e)=>{const n=e[i];return t[n]=(t[n]||0)-+e[r],t},()=>({}))}}Gh([Object(nt.inject)(lr.ChartAxesHandler)],Vh.prototype,"_chartAxesHandler",void 0),Gh([Object(nt.inject)(lr.ColorRepository)],Vh.prototype,"_colorRepository",void 0);var Yh,qh=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};let Xh=Yh=class{initialize(t){this._options=Po(t,Bo),this._domId=t.domId||q.generateEmptyWidgetDomId(),this._title=t.title||this.getTitle(),this._initializeElements(this._options),this._initializeEventListener(),this._options.initOnStart&&this.init()}_initializeElements(t){const{step:e}=t;this._element=Yh.createThresholdFilterElement(this._domId,this._title,e),this._sliderElement=this._element.querySelector(".sintium-filter-widget-threshold-slider"),this._sliderElement.addEventListener("input",this._updateSliderValue.bind(this)),this._sliderElement.addEventListener("change",this._updateSliderValue.bind(this)),this._sliderValueElement=this._element.querySelector(".sintium-filter-widget-threshold-slider-value")}init(){if(this._initialized)return;const{dataSource:t,value:e,dimension:n}=this._options,i=t.getDataContainer();if(Q.isString(e))this._dimension=t.getDimension(e,"number");else if(Q.isFunction(e))this._dimension=i.getCrossfilter().dimension(t=>e(i.wrapRecord(t)));else{if(!n)throw new Error("");this._dimension=n}this._group=this._dimension.group(),this._initialized=!0,this._updateSlider()}dispose(){if(this._initialized){this._dimension.dispose(),this._initialized=!1;const t=this._options.dataSource.getId();this._mediator.publish(cr.FORCE_REDRAW,{dataSourceId:t})}}_initializeEventListener(){const{dataSource:t}=this._options;t.fetchData(this._updateSlider.bind(this)),t.onDataAdded(this._updateSlider.bind(this))}_updateSlider(){if(this._initialized){const t=this._group.all().map(t=>t.key),{max:e}=sr.minMax(t);this._sliderElement.setAttribute("min","0"),this._sliderElement.setAttribute("max",`${e}`),this._sliderValueElement.value=this._sliderElement.value}}_updateSliderValue(){const{filter:t}=this._options,e=parseFloat(this._sliderElement.value);if(this._sliderValueElement.value=this._sliderElement.value,this._initialized){const n="greater"===this._options.mode?n=>{return t?t(n,n>=e):n}:n=>{return t?t(n,n<=e):n};this._dimension.filter(n);const i=this._options.dataSource.getId();this._mediator.publish(cr.FORCE_REDRAW,{dataSourceId:i})}}getTitle(){const{title:t,mode:e}=this._options;return t||("greater"===e?"Filter values greater than":"Filter values less than")}getHTMLElement(){return this._element}getID(){return this._domId}static createThresholdFilterElement(t,e,n){const i=document.getElementById(t);return i.classList.add("sintium-filter-widget"),i.innerHTML=`\n            <div class="sintium-filter-widget-header">\n                    <div class="sintium-filter-widget-title">\n                        ${e}\n                    </div>\n                    <input class="sintium-filter-widget-threshold-slider-value"/>\n                </div>\n                <div class="sintium-filter-widget-threshold-slider-container">\n                    <input class="sintium-filter-widget-threshold-slider" step="${n}" type="range" value="0" min="0" max="0"/>\n                </div>\n            </div>\n        `,i}};qh([Object(nt.inject)(lr.Mediator)],Xh.prototype,"_mediator",void 0);var Kh,$h=Xh=Yh=qh([Object(nt.injectable)()],Xh);let Zh=Kh=class{constructor(){this._filters=[]}initialize(t){this._options=Po(t,Bo),this._domId=t.domId||q.generateEmptyWidgetDomId(),this._title=t.title||this._getTitle(this._options),this._initializeElements(),this._setupDropDownMenu()}_initializeElements(){this._element=Kh.createOptionalFiltersElement(this._domId,this._title),this._disabledElements=this._element.querySelector(".sintium-optional-filters-disabled-filters"),this._activeElements=this._element.querySelector(".sintium-optional-filters-active-filters")}_setupDropDownMenu(){const t=this._element.querySelector(".sintium-optional-filters-header-icon");this._dropDownMenu=new Ja,this._dropDownMenu.initialize({trigger:t,maxHeight:200})}addFilter(t,e=!0){this._filters.push(t);const n=t.getHTMLElement();return e?this._activeElements.appendChild(n):this._disabledElements.appendChild(n),n.classList.add("optional"),this._dropDownMenu.addCheckBoxItem(t.getTitle(),e=>this._setFilterState(t,e),e),this}_setFilterState(t,e){const n=t.getHTMLElement();e?this._activeElements.appendChild(n):this._disabledElements.appendChild(n),e?t.init():t.dispose()}_getTitle(t){return t.title||"Optional Filters"}getHTMLElement(){return this._element}getID(){return this._domId}static createOptionalFiltersElement(t,e){const n=document.getElementById(t);return n.classList.add("sintium-optional-filters"),n.innerHTML=`\n            <div class="sintium-optional-filters-header">\n                <div class="sintium-optional-filters-header-title">\n                    ${e}\n                </div>\n                <div class="sintium-optional-filters-header-icon">\n                    <i class="fas fa-filter"></i>\n                </div>\n            </div>\n            <div class="sintium-optional-filters-disabled-filters"></div>\n            <div class="sintium-optional-filters-active-filters">\n            </div>\n        `,n}};var Jh=Zh=Kh=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)()],Zh);let Qh=class{constructor(){this._rendered=!1}element(){return this._element}render(t){this._rendered||(this._diagram=t,this._options=t.options(),this._setupTicksAndGrid(),this._renderChart(),this._renderTriangle(),this._renderGrid(),this._renderTicks(),this._renderLabels(),this._rendered=!0)}_setupTicksAndGrid(){const{aMax:t,bMax:e,cMax:n}=this._options;let i=Q.isNumber(this._options.ticks)?Math.min(this._options.ticks,5):5;this._ticksA=o.range(0,t,t/i).concat(t),this._ticksB=o.range(0,e,e/i).concat(e),this._ticksC=o.range(0,n,n/i).concat(n),this._gridA=o.range(0,1,10/t),this._gridB=o.range(0,1,10/e),this._gridC=o.range(0,1,10/n)}_renderChart(){const{domId:t}=this._options;this._element=document.getElementById(t),this._updateChartModel();const{width:e,height:n}=this._model;o.select(this._element).style("width","100%").style("height","100%"),this._svg=o.select(this._element).append("svg"),this._svg.attr("width",e).attr("height",n),this._chart=this._svg.append("g").attr("transform",`translate(${e/2} ${n/2})`).attr("font-family","sans-serif"),this._resizeObserver=new At.ResizeObserver(this._redrawBase.bind(this)),this._resizeObserver.observe(this._element)}_renderTriangle(){this._triangle=this._chart.append("path"),this._triangle.attr("d",this._getPath()).attr("fill","#ececec").attr("stroke","none").attr("class","triangle")}_renderGrid(){const{a:t,b:e,c:n}=this._model;this._chart.append("g").selectAll(".grid").data([this._gridA.map(n=>[t(n),e(1-n)]),this._gridB.map(t=>[e(t),n(1-t)]),this._gridC.map(e=>[n(e),t(1-e)])]).enter().append("g").attr("class","grid").selectAll(".gridlines").data(t=>t).enter().append("line").attr("class","gridlines").attr("x1",t=>t[0][0]).attr("y1",t=>t[0][1]).attr("x2",t=>t[1][0]).attr("y2",t=>t[1][1]).attr("stroke","#fff").attr("stroke-width",(t,e)=>1&e?1:2)}_renderTicks(){const{a:t,b:e,c:n}=this._model,{aMax:i,bMax:r,cMax:o}=this._options;this._chart.append("g").attr("font-size",10).selectAll(".axis").data([this._ticksA.map(e=>({tick:e,pos:t(e/i),rot:60,anchor:"end",dx:-5,dy:2})),this._ticksB.map(t=>({tick:t,pos:e(t/r),rot:-60,anchor:"end",dx:-5,dy:2})),this._ticksC.map(t=>({tick:t,pos:n(t/o),rot:0,anchor:"start",dx:5,dy:2}))]).enter().append("g").attr("class","axis").selectAll(".ticks").data(t=>t).enter().append("text").attr("transform",t=>`translate(${t.pos}) rotate(${t.rot})`).attr("text-anchor",t=>t.anchor).attr("dx",t=>t.dx).attr("dy",t=>t.dy).attr("class","ticks").text(t=>`${t.tick}%`)}_renderLabels(){const{ALabel:t,BLabel:e,CLabel:n}=this._model,i=this._diagram.axisLabels();this._chart.append("g").attr("font-size",16).selectAll(".labels").data([{label:i.a,pos:t,rot:0,anchor:"middle"},{label:i.b,pos:e,rot:0,anchor:"start"},{label:i.c,pos:n,rot:0,anchor:"end"}]).enter().append("text").attr("class","labels").attr("transform",t=>`translate(${t.pos}) rotate(${t.rot})`).attr("text-anchor","middle").attr("dominant-baseline","middle").text(t=>t.label)}redraw(t){this._data=t||this._data,this._updateChartModel(),this._redrawMarkers(this._data),this._options.legend&&this._redrawLegend(this._data)}_redrawBase(){this._updateChartModel(),this._redrawChart(),this._redrawTriangle(),this._redrawGrid(),this._redrawTicks(),this._redrawLabels(),this._data&&(this._redrawMarkers(this._data),this._redrawLegend(this._data))}_redrawChart(){const{left:t,top:e}=this._diagram.margins(),{width:n,height:i}=this._model;this._svg.attr("width",n).attr("height",i),this._chart.attr("transform",`translate(${t+n/2} ${e+i/2})`)}_redrawTriangle(){this._triangle.attr("d",this._getPath())}_redrawGrid(){const{a:t,b:e,c:n}=this._model;this._chart.selectAll(".grid").data([this._gridA.map(n=>[t(n),e(1-n)]),this._gridB.map(t=>[e(t),n(1-t)]),this._gridC.map(e=>[n(e),t(1-e)])]).selectAll(".gridlines").data(t=>t).attr("x1",t=>t[0][0]).attr("y1",t=>t[0][1]).attr("x2",t=>t[1][0]).attr("y2",t=>t[1][1])}_redrawTicks(){const{a:t,b:e,c:n}=this._model,{aMax:i,bMax:r,cMax:o}=this._options;this._chart.selectAll(".axis").data([this._ticksA.map(e=>({tick:e,pos:t(e/i),rot:60,anchor:"end",dx:-5,dy:2})),this._ticksB.map(t=>({tick:t,pos:e(t/r),rot:-60,anchor:"end",dx:-5,dy:2})),this._ticksC.map(t=>({tick:t,pos:n(t/o),rot:0,anchor:"start",dx:5,dy:2}))]).selectAll(".ticks").data(t=>t).attr("transform",t=>`translate(${t.pos}) rotate(${t.rot})`).attr("dx",t=>t.dx).attr("dy",t=>t.dy)}_redrawLabels(){const{ALabel:t,BLabel:e,CLabel:n}=this._model,i=this._diagram.axisLabels();this._chart.selectAll(".labels").data([{label:i.a,pos:t,rot:0,anchor:"middle"},{label:i.b,pos:e,rot:0,anchor:"start"},{label:i.c,pos:n,rot:0,anchor:"end"}]).attr("transform",t=>`translate(${t.pos}) rotate(${t.rot})`).attr("text-anchor","middle")}_redrawLegend(t){if(!t||0===t.length)return;t=t.filter(t=>!isNaN(t.a)&&!isNaN(t.b)&&!isNaN(t.c));const{transitionDuration:e}=this._options,{width:n,height:i}=this._element.getBoundingClientRect(),r=this._chart.selectAll(".legend-item-rect").data(t),o=this._chart.selectAll(".legend-item-text").data(t);r.exit().remove(),o.exit().remove(),r.transition().duration(e).attr("x",3-n/2).attr("y",(t,e)=>3-i/2+17*e).style("fill",t=>t.color),o.text(t=>t.label||t.index.toString()).transition().duration(e).attr("x",3-n/2+12+5).attr("y",(t,e)=>3-i/2+17*e+6+4),r.enter().append("rect").attr("class","legend-item-rect").attr("x",3-n/2).attr("y",(t,e)=>3-i/2+17*e).attr("width",12).attr("height",12).style("fill",t=>t.color),o.enter().append("text").attr("class","legend-item-text").attr("x",3-n/2+12*1.2).attr("y",(t,e)=>3-i/2+17*e+6+4).style("fill","black").text(t=>t.label||t.index.toString()).attr("text-anchor","left").style("alignment-baseline","middle").attr("font-size",10)}_redrawMarkers(t){if(!t||0===t.length)return;t=t.filter(t=>!isNaN(t.a)&&!isNaN(t.b)&&!isNaN(t.c));const{transitionDuration:e,aMax:n,bMax:i,cMax:r}=this._options,{A:o,B:s,C:a}=this._model,c=t.map(t=>({label:t.label,color:t.color,cx:o[0]*t.a/n+s[0]*t.b/i+a[0]*t.c/r,cy:o[1]*t.a/n+s[1]*t.b/i+a[1]*t.c/r})),l=this._chart.selectAll(".marker").data(c);l.exit().remove(),l.transition().duration(e).attr("r",5).attr("cx",t=>t.cx).attr("cy",t=>t.cy).attr("fill",t=>t.color).attr("name",t=>t.label).attr("stroke","#ddd"),l.enter().append("circle").attr("class","marker").attr("name",t=>t.label).transition().duration(e).attr("r",5).attr("cx",t=>t.cx).attr("cy",t=>t.cy).attr("fill",t=>t.color).attr("stroke","#ddd")}_updateChartModel(){const{top:t,right:e,bottom:n,left:i}=this._diagram.margins();let{width:r,height:o}=this._element.getBoundingClientRect();r=r-e-i,o=o-t-n;const s=Math.min(r,o-40)/2,a=(s-Math.sin(30*Math.PI/180)*s)/2,[c,l,u]=[-90,150,30].map(t=>[Math.cos(t*Math.PI/180)*s,Math.sin(t*Math.PI/180)*s+a]),h=this._line(l,c),d=this._line(u,l),f=this._line(c,u),[p,g,_]=[-90,150,30].map((t,e)=>[Math.cos(t*Math.PI/180)*s,Math.sin(t*Math.PI/180)*s+a+35*(e?1:-1)]);this._model={width:r,height:o,A:c,B:l,C:u,a:h,b:d,c:f,ALabel:p,BLabel:g,CLabel:_}}_line(t,e){return function(n){return[t[0]+n*(e[0]-t[0]),t[1]+n*(e[1]-t[1])]}}_getPath(){const{A:t,B:e,C:n}=this._model;return`M${t}L${e}L${n}Z`}_getColor(t){}};var td,ed=Qh=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)()],Qh),nd=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};let id=td=class{initialize(t){this._options=Po(t,jo),this._options.domId=t.domId||q.generateEmptyWidgetDomId(),this._margins=this._chartMarginHandler.getMargins(this._options),t.renderer&&(this._renderer=t.renderer),t.colorScheme&&t.colorColumn&&this._colorRepository.setColorSchemeForColumn(t.dataSource,t.colorColumn,t.colorScheme),this._colorFunction=t.colorFunction||td._createColorFunction(),this._renderer.render(this),this._initializeData()}_initializeData(){const{aAxis:t,bAxis:e,cAxis:n,dataSource:i}=this._options;this._accessors=[t,e,n].map(t=>{if(Q.isString(t))return e=>e.get(t);if(Q.isFunction(t))return t;throw new Error("Missing one or more of the following properties: aAxis, bAxis, cAxis")}),i.fetchData(this._updateDataAndRedraw.bind(this)),i.onDataAdded(this._updateDataAndRedraw.bind(this)),i.onDataFiltered(this._redraw.bind(this))}axisLabels(){const{aAxis:t,bAxis:e,cAxis:n,aLabel:i,bLabel:r,cLabel:o}=this._options;return{a:i||(Q.isFunction(t)?"no label":t),b:r||(Q.isFunction(e)?"no label":e),c:o||(Q.isFunction(n)?"no label":n)}}options(){return Object.assign({},this._options)}margins(){return this._margins}color(){return this._colorFunction}getHTMLElement(){return this._renderer.element()}getID(){return this._options.domId}_updateDataAndRedraw(){this._data=this._transformData(),this._redraw()}_redraw(){if(this._data){const t=this._options.dataSource.getDataContainer(),e=this._data.filter(e=>t.isRecordFiltered(e.index));this._renderer.redraw(e)}}_transformData(){return this._options.dataSource.getDataContainer().mapRecords(t=>{const[e,n,i]=this._accessors.map(e=>e(t)),r=e+n+i;return{a:100*e/r,b:100*n/r,c:100*i/r,index:t.key(),label:this._getLabel(t),color:this._getColor(t)}},!0).filter(t=>isNaN(t.a)||!isNaN(t.b)||!isNaN(t.c))}static _createColorFunction(){return()=>"black"}_getColor(t){const{colorFunction:e,dataSource:n,colorColumn:i}=this._options;if(Q.isFunction(e))return e(t);if(i){const e=t.get(i);return this._colorRepository.hasColorForColumnValue(n,i,e)||this._colorRepository.setColorsForColumn(n,i),this._colorRepository.getColorForColumnValue(n,i,e)}}_getLabel(t){const{labelFunction:e,labelColumn:n}=this._options;return Q.isFunction(e)?e(t):Q.isString(n)?t.get(n):void 0}};nd([Object(nt.inject)(lr.TernaryDiagramRenderer)],id.prototype,"_renderer",void 0),nd([Object(nt.inject)(lr.ChartMarginHandler)],id.prototype,"_chartMarginHandler",void 0),nd([Object(nt.inject)(lr.ColorRepository)],id.prototype,"_colorRepository",void 0);var rd=id=td=nd([Object(nt.injectable)()],id);let od=class extends _l{constructor(){super(...arguments),this._inFullScreen=!1}initialize(t){super.initialize(Object.assign(t,{normalIcon:"crosshairs",solidIcons:!0})),this._zoom=t.zoom}onAddedToMap(t){const e=this.getMapContainer().getMap().getView();this._geoLocation=new r.a.Geolocation({trackingOptions:{enableHighAccuracy:!0},projection:e.getProjection()}),this.onClick(e=>{const n=this._geoLocation.getPosition();if(n){const e=r.a.proj.toLonLat(n);t.zoomToCoordinates(e,this._zoom,500)}}),this._geoLocation.setTracking(!0)}};var sd=od=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Object(nt.injectable)()],od);const ad=new nt.Container;ad.bind(lr.DataContainer).to(Ar),ad.bind(lr.DataSource).to(ps),ad.bind(lr.RecordContainer).to(ms),ad.bind(lr.DataFetcherHandler).to(Ts).inSingletonScope(),ad.bind(lr.DataParser).to(Wh).inSingletonScope(),ad.bind(lr.OAuthAuthenticator).to(zl),ad.bind(lr.ChartAxesHandler).to(js),ad.bind(lr.ChartLegendHandler).to(ah),ad.bind(lr.ChartMarginHandler).to(lh),ad.bind(lr.BarChartContainer).to($s),ad.bind(lr.LineChartContainer).to(class extends Xs{initialize(t){this._options=t,this.initializeStackable(a.lineChart,t)}onDataAdded(t,e){const{renderArea:n}=this._options;t.renderArea(!0)}_setAreaChart(t){document.getElementById(this._options.domId).querySelector(".sintium-chart-container").classList.add("area"),t.renderArea(!0)}availableOptions(){return[{icon:"fas fa-redo",callback:()=>{this.resetChart()}}]}}),ad.bind(lr.MultiLineChartContainer).to(Vh),ad.bind(lr.PieChartContainer).to(Zs),ad.bind(lr.PieChartStyleHandler).to(ga),ad.bind(lr.WindRoseChartContainer).to(ca),ad.bind(lr.SunburstChartContainer).to(class extends Vs{initialize(t){t.domId=t.domId||q.generateEmptyWidgetDomId();let e=a.sunburstChart(`#${t.domId}`);super.initialize(e,t),this._initializeChart(e,t)}_initializeChart(t,e){const{dataSource:n}=e;n.onDataAdded(()=>{const i=n.get2DDimension(e.keyColumns[0],e.keyColumns[1]),r=i.group().reduceCount();t.dimension(i).group(r).render(),this.initialized(!0)},!0),n.fetchData()}}),ad.bind(lr.ScatterPlotContainer).to(da),ad.bind(lr.RowChartContainer).to(Ya),ad.bind(lr.DataTableContainer).to(Ju),ad.bind(lr.ChartStackHandler).to(xh),ad.bind(lr.BoxPlotContainer).to(Oh),ad.bind(lr.TernaryDiagram).to(rd),ad.bind(lr.TernaryDiagramRenderer).to(ed),ad.bind(lr.ButtonControl).to(_l),ad.bind(lr.NightModeControl).to(yl),ad.bind(lr.CompositeControl).to(bl),ad.bind(lr.FullScreenControl).to(El),ad.bind(lr.DrawControl).to(Sl),ad.bind(lr.ZoomControl).to(Al),ad.bind(lr.WidgetControl).to(Ol),ad.bind(lr.MapExportControl).to(Ll),ad.bind(lr.LegendControl).to(class extends pl{initialize(t){this._options=Po(t,Vo),super.initialize(this._options),this._min=this._options.min,this._max=this._options.max;const e=this._createHTMLElement();this.setHTMLElement(e),this._updateNumbers()}setRange(t,e){this._min=t,this._max=e,this._updateNumbers()}setMin(t){this._min=t,this._updateNumbers()}setMax(t){this._max=t,this._updateNumbers()}_updateNumbers(){const t=Math.floor((this._max+this._min)/2);this.getHTMLElement().querySelector(".sintium-map-legend-control-number-max").innerHTML=sr.nFormatter(this._max,0),this.getHTMLElement().querySelector(".sintium-map-legend-control-number-middle").innerHTML=sr.nFormatter(t,0),this.getHTMLElement().querySelector(".sintium-map-legend-control-number-min").innerHTML=sr.nFormatter(this._min,0)}_createHTMLElement(){const t=this._getLinearGradient(),e=this._getSizeStyle(),n=document.createElement("div");return n.innerHTML=`\n                <div class="sintium-map-control sintium-map-legend-control-${this._options.flow}" style="${e}">\n                    <div class="sintium-map-legend-control-scale" style="background-image: ${t};"></div>\n                    <div class="sintium-map-legend-control-number">\n                        <span class="sintium-map-legend-control-number-max"></span>\n                        <span class="sintium-map-legend-control-number-middle"></span>\n                        <span class="sintium-map-legend-control-number-min"></span>\n                    </div>\n                </div>\n        `,n.firstElementChild}_getSizeStyle(){const{flow:t,size:e}=this._options;return t===Mo.HORIZONTAL?`width: ${e}px`:`height: ${e}px`}_getLinearGradient(){const{flow:t,colorScheme:e}=this._options,n=e.chromaColors.join(",");return t===Mo.HORIZONTAL?`linear-gradient(to right, ${n})`:`linear-gradient(to top, ${n})`}}),ad.bind(lr.DownloadControl).to(class extends _l{initialize(t){super.initialize(Object.assign({normalIcon:"fas fa-file-download"},t)),this.onClick(()=>{const e=t.dataSource.getDataContainer();Ku("data.csv",e.getData().map(t=>t.slice(1)),e.getLabels().slice(1),null,t.mapValue)})}}),ad.bind(lr.ExternalDownloadControl).to(class extends _l{initialize(t){super.initialize(Object.assign({normalIcon:"fas fa-file-download"},t)),this.downloadUrlFetcherCallback=t.downloadUrlFetcherCallback,this.downloadCallback=t.downloadCallback,this.onClick(()=>{const t=this.downloadUrlFetcherCallback();this.downloadCallback(t)})}}),ad.bind(lr.LocationControl).to(sd),ad.bind(lr.HTMLControl).to(class extends pl{initialize(t){this._options=Po(t,Yo),super.initialize(this._options);let e=this._options.html;if(Q.isString(e)){const t=document.createElement("div");t.innerHTML=e,e=t.firstChild}this.setHTMLElement(e)}}),ad.bind(lr.BaseLayerContainer).to(Vc),ad.bind(lr.HeatmapLayerContainer).to(hl),ad.bind(lr.GridHeatmapLayerContainer).to(yu),ad.bind(lr.AnimatedLayerContainer).to(Tu),ad.bind(lr.BigVectorLayerContainer).to(Fs),ad.bind(lr.BigVectorLayerStyleHandler).to(fr).inSingletonScope(),ad.bind(lr.BigVectorSource).to(Ha),ad.bind(lr.StyleCacheHandler).to(ma),ad.bind(lr.ClusteringHandler).to(Er),ad.bind(lr.SelectionEvent).to(cu),ad.bind(lr.WMSLayerContainer).to(class extends ft{constructor(){super(...arguments),this._instantiated=!1}initialize(t){super.initialize(t),this._options=t,0==this._options.lazyLoad&&this._initializeLayer(),0!=this._options.visible&&this.setVisible(!0)}_initializeLayer(){const{url:t,params:e}=this._options;this._source=new r.a.source.TileWMS({url:t,params:e}),this._layer=new r.a.layer.Tile({source:this._source}),this.addLayer(this._layer)}getType(){return J.WMSLayer}getId(){return this._options.layerId}setVisible(t){this._instantiated||1!=t||this._initializeLayer(),this.setLayersVisible(t)}}),ad.bind(lr.VectorLayerContainer).to(Hu),ad.bind(lr.VectorLayerStyleHandler).to(Lu),ad.bind(lr.VectorSource).to(Nu),ad.bind(lr.StyleCache).to(Gu),ad.bind(lr.MapReduceLayer).to(rh),ad.bind(lr.MapContainer).to(Zc),ad.bind(lr.LayerManager).to(Rt),ad.bind(lr.SelectionHandler).to(iu),ad.bind(lr.MapUIManager).to(Xi),ad.bind(lr.DrawManager).to(nr),ad.bind(lr.Drawer).to(kl),ad.bind(lr.SidebarLayerSwitcher).to(Iu),ad.bind(lr.ColorRepository).to(Kl).inSingletonScope(),ad.bind(lr.Mediator).to(Tt).inSingletonScope(),ad.bind(lr.NightMode).to(Ql).inSingletonScope(),ad.bind(lr.WidgetGrid).to(ec),ad.bind(lr.WidgetGridItem).to(su),ad.bind(lr.TemplateWidget).to(Gl),ad.bind(lr.SelectWidget).to(eh),ad.bind(lr.PlayWidget).to(fh),ad.bind(lr.BetterDataTableContainer).to(gh),ad.bind(lr.ThresholdFilterWidget).to($h),ad.bind(lr.OptionalFiltersWidget).to(Jh),ad.bind(lr.GraphContainer).to(vh),ad.bind(lr.GraphSource).to(Eh),ad.bind(lr.Graph).to(jh);var cd=ad;class ld{initialize(){this._composite=a.compositeChart("#test")}setCharts(t){t=t.map(t=>t.getChart()),this._interval=setInterval(this._buildIfReady.bind(this,t),50)}_buildIfReady(t){t.map(t=>!!t.group()).every(t=>t)&&(this._composite.width(200).height(200).elasticX(!0).elasticY(!0).x(a.d3.scaleLinear().domain([0,20])).legend(a.legend().x(80).y(20).itemHeight(13).gap(5)).renderHorizontalGridLines(!0).brushOn(!0).compose(t).render(),clearInterval(this._interval))}getChart(){return this._composite}}n.d(e,"default",function(){return ud});class ud{static initialize(){this._mediator=cd.get(lr.Mediator),this._nightMode=cd.get(lr.NightMode)}static toggleNightMode(){this._nightMode.toggleNight()}static dataSource(t){const e=cd.get(lr.DataSource);return e.initialize(t),e}static OAuthAuthenticator(t,e){const n=cd.get(lr.OAuthAuthenticator);return n.initialize(t,e),n}static map(t){const e=cd.get(lr.MapContainer);return e.initialize(t),this._mapContainerLookup[t.domId]=e}static selection(t,e){return new vt(t,e)}static legendControl(t={}){const e=cd.get(lr.LegendControl);return e.initialize(t),e}static fullScreenControl(t={}){const e=cd.get(lr.FullScreenControl);return e.initialize(t),e}static zoomControl(t={}){const e=cd.get(lr.ZoomControl);return e.initialize(t),e}static locationControl(t={}){const e=cd.get(lr.LocationControl);return e.initialize(t),e}static mapExportControl(t={}){const e=cd.get(lr.MapExportControl);return e.initialize(t),e}static buttonControl(t={}){const e=cd.get(lr.ButtonControl);return e.initialize(t),e}static downloadControl(t={}){const e=cd.get(lr.DownloadControl);return e.initialize(t),e}static ExternalDownloadControl(t={}){const e=cd.get(lr.ExternalDownloadControl);return e.initialize(t),e}static htmlControl(t={}){const e=cd.get(lr.HTMLControl);return e.initialize(t),e}static widgetControl(t={}){const e=cd.get(lr.WidgetControl);return e.initialize(t),e}static drawControl(t={}){const e=cd.get(lr.DrawControl);return e.initialize(t),e}static nightModeControl(t={}){const e=cd.get(lr.NightModeControl);return e.initialize(t),e}static setLayerAuthenticatorToken(t){this._layerContainers[t]}static setLayerVisibility(t,e){const n=this._layerContainers[t];n&&n.setVisible(e)}static baseLayer(t){const e=cd.get(lr.BaseLayerContainer);return e.initialize(t),e}static vectorLayer(t){const e=cd.get(lr.BigVectorLayerContainer);return this._layerContainers[t.layerId]=e,e.initialize(t),e}static vectorLayer2(t){const e=cd.get(lr.VectorLayerContainer);return this._layerContainers[t.layerId]=e,e.initialize(t),e}static heatmapLayer(t){const e=cd.get(lr.HeatmapLayerContainer);return e.initialize(t),e}static mapReduceLayer(t){const e=cd.get(lr.MapReduceLayer);return e.initialize(t),e}static gridHeatmapLayer(t){const e=cd.get(lr.GridHeatmapLayerContainer);return e.initialize(t),e}static animatedLayer(t){const e=cd.get(lr.AnimatedLayerContainer);return e.initialize(t),e}static wmsLayer(t){const e=cd.get(lr.WMSLayerContainer);return e.initialize(t),e}static layerGroup(t,...e){return new pt(t,e)}static getDefaultLightTileLayer(){return new r.a.layer.Tile({source:new r.a.source.OSM})}static getDefaultDarkTileLayer(){return new r.a.layer.Tile({source:new r.a.source.XYZ({url:"https://{1-4}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",crossOrigin:"anonymous"})})}static createXYZLayerFromSource(t){return new r.a.layer.Tile({source:new r.a.source.XYZ({url:t,crossOrigin:"anonymous"})})}static createWMSLayer(t,e){return new r.a.layer.Tile({source:new r.a.source.TileWMS({url:t,params:e})})}static generatePointFeatureFunction(t,e){return function(t,e,n){return new r.a.Feature({geometry:new r.a.geom.Point(r.a.proj.fromLonLat([n(t),n(e)]))})}.bind(null,t,e)}static generatePoint(t,e){return new r.a.Feature({geometry:new r.a.geom.Point(r.a.proj.fromLonLat([t,e]))})}static controlLayerSwitcher(){return new X.Builder}static sidebarLayerSwitcher(t){const e=cd.get(lr.SidebarLayerSwitcher);return e.initialize(t),e}static mapLocation(t,e,n){const i=r.a.proj.fromLonLat(e);return new Z(t,i,n)}static selectLocationSwitcher(t){return new K(t)}static drawer(t={}){const e=cd.get(lr.Drawer);return e.initialize(t),e}static templateWidget(t={}){const e=cd.get(lr.TemplateWidget);return e.initialize(t),e}static thresholdWidget(t){const e=cd.get(lr.ThresholdFilterWidget);return e.initialize(t),e}static optionalFiltersWidget(t={}){const e=cd.get(lr.OptionalFiltersWidget);return e.initialize(t),e}static widgetGrid(t){const e=cd.get(lr.WidgetGrid);return e.initialize(t),e}static getWidgetById(t){return this._widgets[t]}static select(t){const e=cd.get(lr.SelectWidget);return e.initialize(t),Q.isWidget(e)&&(this._widgets[t.domId]=e),e}static ternaryDiagram(t){const e=cd.get(lr.TernaryDiagram);return e.initialize(t),Q.isWidget(e)&&(this._widgets[t.domId]=e),e}static barChart(t){const e=cd.get(lr.BarChartContainer);return e.initialize(t),Q.isWidget(e)&&(this._widgets[t.domId]=e),e}static boxPlot(t){const e=cd.get(lr.BoxPlotContainer);return e.initialize(t),Q.isWidget(e)&&(this._widgets[t.domId]=e),e}static dataTable(t){const e=cd.get(lr.DataTableContainer);return e.initialize(t),Q.isWidget(e)&&(this._widgets[t.domId]=e),e}static tableView(t){const e=cd.get(lr.BetterDataTableContainer);return e.initialize(t),Q.isWidget(e)&&(this._widgets[t.domId]=e),e}static playWidget(t){const e=cd.get(lr.PlayWidget);return e.initialize(t),Q.isWidget(e)&&(this._widgets[t.domId]=e),e}static rowChart(t){const e=cd.get(lr.RowChartContainer);return e.initialize(t),Q.isWidget(e)&&(this._widgets[t.domId]=e),e}static sunburstChart(t){const e=cd.get(lr.SunburstChartContainer);return e.initialize(t),Q.isWidget(e)&&(this._widgets[t.domId]=e),e}static lineChart(t){const e=cd.get(lr.LineChartContainer);return e.initialize(t),Q.isWidget(e)&&(this._widgets[t.domId]=e),e}static multiLineChart(t){const e=cd.get(lr.MultiLineChartContainer);return e.initialize(t),Q.isWidget(e)&&(this._widgets[t.domId]=e),e}static pieChart(t){const e=cd.get(lr.PieChartContainer);return e.initialize(t),Q.isWidget(e)&&(this._widgets[t.domId]=e),e}static scatterPlot(t){const e=cd.get(lr.ScatterPlotContainer);return e.initialize(t),Q.isWidget(e)&&(this._widgets[t.domId]=e),e}static windRose(t){const e=cd.get(lr.WindRoseChartContainer);return e.initialize(t),Q.isWidget(e)&&(this._widgets[t.domId]=e),e}static stackedChart(t){const e=cd.get(lr.StackedAreaChart);return e.initialize(t),Q.isWidget(e)&&(this._widgets[t.domId]=e),e}static test(){const t=new ld;return t.initialize(),t}static graphSource(t){const e=cd.get(lr.GraphSource);return e.initialize(t),e}static graph(t){const e=cd.get(lr.GraphContainer);return e.initialize(t),Q.isWidget(e)&&(this._widgets[t.domId]=e),e}static glGraph(t){const e=cd.get(lr.Graph);return e.initialize(t),Q.isWidget(e)&&(this._widgets[t.domId]=e),e}static setDebug(t){this.debug=t}static getDc(){return a}static resetAll(){this._mediator.publish(cr.FORCE_RESET,{})}static isMobile(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}}ud.debug=!1,ud._mapContainerLookup={},ud._layerContainers={},ud._widgets={},ud.colorScheme={HIGHCHART_DEFAULTS:Ct,SPECTRAL:bt,BASIC:{name:"Basic",colors:["#e6194b","#3cb44b","#ffe119","#4363d8","#f58231","#911eb4","#46f0f0","#f032e6","#bcf60c","#008080","#e6beff","#9a6324","#fffac8","#800000","#aaffc3","#808000","#000075","#808080","#313131"]}}},function(t,e,n){var i,r,o;
/*!
 * jQuery UI Resizable 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */r=[n(4),n(17),n(35),n(22),n(5),n(13)],void 0===(o="function"==typeof(i=function(t){return t.widget("ui.resizable",t.ui.mouse,{version:"1.12.1",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,classes:{"ui-resizable-se":"ui-icon ui-icon-gripsmall-diagonal-se"},containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(t){return parseFloat(t)||0},_isNumber:function(t){return!isNaN(parseFloat(t))},_hasScroll:function(e,n){if("hidden"===t(e).css("overflow"))return!1;var i,r=n&&"left"===n?"scrollLeft":"scrollTop";return e[r]>0||(e[r]=1,i=e[r]>0,e[r]=0,i)},_create:function(){var e,n=this.options,i=this;this._addClass("ui-resizable"),t.extend(this,{_aspectRatio:!!n.aspectRatio,aspectRatio:n.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:n.helper||n.ghost||n.animate?n.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap(t("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,e={marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom"),marginLeft:this.originalElement.css("marginLeft")},this.element.css(e),this.originalElement.css("margin",0),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css(e),this._proportionallyResize()),this._setupHandles(),n.autoHide&&t(this.element).on("mouseenter",function(){n.disabled||(i._removeClass("ui-resizable-autohide"),i._handles.show())}).on("mouseleave",function(){n.disabled||i.resizing||(i._addClass("ui-resizable-autohide"),i._handles.hide())}),this._mouseInit()},_destroy:function(){this._mouseDestroy();var e,n=function(e){t(e).removeData("resizable").removeData("ui-resizable").off(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(n(this.element),e=this.element,this.originalElement.css({position:e.css("position"),width:e.outerWidth(),height:e.outerHeight(),top:e.css("top"),left:e.css("left")}).insertAfter(e),e.remove()),this.originalElement.css("resize",this.originalResizeStyle),n(this.originalElement),this},_setOption:function(t,e){switch(this._super(t,e),t){case"handles":this._removeHandles(),this._setupHandles()}},_setupHandles:function(){var e,n,i,r,o,s=this.options,a=this;if(this.handles=s.handles||(t(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this._handles=t(),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),i=this.handles.split(","),this.handles={},n=0;n<i.length;n++)r="ui-resizable-"+(e=t.trim(i[n])),o=t("<div>"),this._addClass(o,"ui-resizable-handle "+r),o.css({zIndex:s.zIndex}),this.handles[e]=".ui-resizable-"+e,this.element.append(o);this._renderAxis=function(e){var n,i,r,o;for(n in e=e||this.element,this.handles)this.handles[n].constructor===String?this.handles[n]=this.element.children(this.handles[n]).first().show():(this.handles[n].jquery||this.handles[n].nodeType)&&(this.handles[n]=t(this.handles[n]),this._on(this.handles[n],{mousedown:a._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(i=t(this.handles[n],this.element),o=/sw|ne|nw|se|n|s/.test(n)?i.outerHeight():i.outerWidth(),r=["padding",/ne|nw|n/.test(n)?"Top":/se|sw|s/.test(n)?"Bottom":/^e$/.test(n)?"Right":"Left"].join(""),e.css(r,o),this._proportionallyResize()),this._handles=this._handles.add(this.handles[n])},this._renderAxis(this.element),this._handles=this._handles.add(this.element.find(".ui-resizable-handle")),this._handles.disableSelection(),this._handles.on("mouseover",function(){a.resizing||(this.className&&(o=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),a.axis=o&&o[1]?o[1]:"se")}),s.autoHide&&(this._handles.hide(),this._addClass("ui-resizable-autohide"))},_removeHandles:function(){this._handles.remove()},_mouseCapture:function(e){var n,i,r=!1;for(n in this.handles)((i=t(this.handles[n])[0])===e.target||t.contains(i,e.target))&&(r=!0);return!this.options.disabled&&r},_mouseStart:function(e){var n,i,r,o=this.options,s=this.element;return this.resizing=!0,this._renderProxy(),n=this._num(this.helper.css("left")),i=this._num(this.helper.css("top")),o.containment&&(n+=t(o.containment).scrollLeft()||0,i+=t(o.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:n,top:i},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:s.width(),height:s.height()},this.originalSize=this._helper?{width:s.outerWidth(),height:s.outerHeight()}:{width:s.width(),height:s.height()},this.sizeDiff={width:s.outerWidth()-s.width(),height:s.outerHeight()-s.height()},this.originalPosition={left:n,top:i},this.originalMousePosition={left:e.pageX,top:e.pageY},this.aspectRatio="number"==typeof o.aspectRatio?o.aspectRatio:this.originalSize.width/this.originalSize.height||1,r=t(".ui-resizable-"+this.axis).css("cursor"),t("body").css("cursor","auto"===r?this.axis+"-resize":r),this._addClass("ui-resizable-resizing"),this._propagate("start",e),!0},_mouseDrag:function(e){var n,i,r=this.originalMousePosition,o=this.axis,s=e.pageX-r.left||0,a=e.pageY-r.top||0,c=this._change[o];return this._updatePrevProperties(),!!c&&(n=c.apply(this,[e,s,a]),this._updateVirtualBoundaries(e.shiftKey),(this._aspectRatio||e.shiftKey)&&(n=this._updateRatio(n,e)),n=this._respectSize(n,e),this._updateCache(n),this._propagate("resize",e),i=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),t.isEmptyObject(i)||(this._updatePrevProperties(),this._trigger("resize",e,this.ui()),this._applyChanges()),!1)},_mouseStop:function(e){this.resizing=!1;var n,i,r,o,s,a,c,l=this.options;return this._helper&&(r=(i=(n=this._proportionallyResizeElements).length&&/textarea/i.test(n[0].nodeName))&&this._hasScroll(n[0],"left")?0:this.sizeDiff.height,o=i?0:this.sizeDiff.width,s={width:this.helper.width()-o,height:this.helper.height()-r},a=parseFloat(this.element.css("left"))+(this.position.left-this.originalPosition.left)||null,c=parseFloat(this.element.css("top"))+(this.position.top-this.originalPosition.top)||null,l.animate||this.element.css(t.extend(s,{top:c,left:a})),this.helper.height(this.size.height),this.helper.width(this.size.width),this._helper&&!l.animate&&this._proportionallyResize()),t("body").css("cursor","auto"),this._removeClass("ui-resizable-resizing"),this._propagate("stop",e),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var t={};return this.position.top!==this.prevPosition.top&&(t.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(t.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(t.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(t.height=this.size.height+"px"),this.helper.css(t),t},_updateVirtualBoundaries:function(t){var e,n,i,r,o,s=this.options;o={minWidth:this._isNumber(s.minWidth)?s.minWidth:0,maxWidth:this._isNumber(s.maxWidth)?s.maxWidth:1/0,minHeight:this._isNumber(s.minHeight)?s.minHeight:0,maxHeight:this._isNumber(s.maxHeight)?s.maxHeight:1/0},(this._aspectRatio||t)&&(e=o.minHeight*this.aspectRatio,i=o.minWidth/this.aspectRatio,n=o.maxHeight*this.aspectRatio,r=o.maxWidth/this.aspectRatio,e>o.minWidth&&(o.minWidth=e),i>o.minHeight&&(o.minHeight=i),n<o.maxWidth&&(o.maxWidth=n),r<o.maxHeight&&(o.maxHeight=r)),this._vBoundaries=o},_updateCache:function(t){this.offset=this.helper.offset(),this._isNumber(t.left)&&(this.position.left=t.left),this._isNumber(t.top)&&(this.position.top=t.top),this._isNumber(t.height)&&(this.size.height=t.height),this._isNumber(t.width)&&(this.size.width=t.width)},_updateRatio:function(t){var e=this.position,n=this.size,i=this.axis;return this._isNumber(t.height)?t.width=t.height*this.aspectRatio:this._isNumber(t.width)&&(t.height=t.width/this.aspectRatio),"sw"===i&&(t.left=e.left+(n.width-t.width),t.top=null),"nw"===i&&(t.top=e.top+(n.height-t.height),t.left=e.left+(n.width-t.width)),t},_respectSize:function(t){var e=this._vBoundaries,n=this.axis,i=this._isNumber(t.width)&&e.maxWidth&&e.maxWidth<t.width,r=this._isNumber(t.height)&&e.maxHeight&&e.maxHeight<t.height,o=this._isNumber(t.width)&&e.minWidth&&e.minWidth>t.width,s=this._isNumber(t.height)&&e.minHeight&&e.minHeight>t.height,a=this.originalPosition.left+this.originalSize.width,c=this.originalPosition.top+this.originalSize.height,l=/sw|nw|w/.test(n),u=/nw|ne|n/.test(n);return o&&(t.width=e.minWidth),s&&(t.height=e.minHeight),i&&(t.width=e.maxWidth),r&&(t.height=e.maxHeight),o&&l&&(t.left=a-e.minWidth),i&&l&&(t.left=a-e.maxWidth),s&&u&&(t.top=c-e.minHeight),r&&u&&(t.top=c-e.maxHeight),t.width||t.height||t.left||!t.top?t.width||t.height||t.top||!t.left||(t.left=null):t.top=null,t},_getPaddingPlusBorderDimensions:function(t){for(var e=0,n=[],i=[t.css("borderTopWidth"),t.css("borderRightWidth"),t.css("borderBottomWidth"),t.css("borderLeftWidth")],r=[t.css("paddingTop"),t.css("paddingRight"),t.css("paddingBottom"),t.css("paddingLeft")];e<4;e++)n[e]=parseFloat(i[e])||0,n[e]+=parseFloat(r[e])||0;return{height:n[0]+n[2],width:n[1]+n[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var t,e=0,n=this.helper||this.element;e<this._proportionallyResizeElements.length;e++)t=this._proportionallyResizeElements[e],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(t)),t.css({height:n.height()-this.outerDimensions.height||0,width:n.width()-this.outerDimensions.width||0})},_renderProxy:function(){var e=this.element,n=this.options;this.elementOffset=e.offset(),this._helper?(this.helper=this.helper||t("<div style='overflow:hidden;'></div>"),this._addClass(this.helper,this._helper),this.helper.css({width:this.element.outerWidth(),height:this.element.outerHeight(),position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++n.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(t,e){return{width:this.originalSize.width+e}},w:function(t,e){var n=this.originalSize;return{left:this.originalPosition.left+e,width:n.width-e}},n:function(t,e,n){var i=this.originalSize;return{top:this.originalPosition.top+n,height:i.height-n}},s:function(t,e,n){return{height:this.originalSize.height+n}},se:function(e,n,i){return t.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[e,n,i]))},sw:function(e,n,i){return t.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[e,n,i]))},ne:function(e,n,i){return t.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[e,n,i]))},nw:function(e,n,i){return t.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[e,n,i]))}},_propagate:function(e,n){t.ui.plugin.call(this,e,[n,this.ui()]),"resize"!==e&&this._trigger(e,n,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),t.ui.plugin.add("resizable","animate",{stop:function(e){var n=t(this).resizable("instance"),i=n.options,r=n._proportionallyResizeElements,o=r.length&&/textarea/i.test(r[0].nodeName),s=o&&n._hasScroll(r[0],"left")?0:n.sizeDiff.height,a=o?0:n.sizeDiff.width,c={width:n.size.width-a,height:n.size.height-s},l=parseFloat(n.element.css("left"))+(n.position.left-n.originalPosition.left)||null,u=parseFloat(n.element.css("top"))+(n.position.top-n.originalPosition.top)||null;n.element.animate(t.extend(c,u&&l?{top:u,left:l}:{}),{duration:i.animateDuration,easing:i.animateEasing,step:function(){var i={width:parseFloat(n.element.css("width")),height:parseFloat(n.element.css("height")),top:parseFloat(n.element.css("top")),left:parseFloat(n.element.css("left"))};r&&r.length&&t(r[0]).css({width:i.width,height:i.height}),n._updateCache(i),n._propagate("resize",e)}})}}),t.ui.plugin.add("resizable","containment",{start:function(){var e,n,i,r,o,s,a,c=t(this).resizable("instance"),l=c.options,u=c.element,h=l.containment,d=h instanceof t?h.get(0):/parent/.test(h)?u.parent().get(0):h;d&&(c.containerElement=t(d),/document/.test(h)||h===document?(c.containerOffset={left:0,top:0},c.containerPosition={left:0,top:0},c.parentData={element:t(document),left:0,top:0,width:t(document).width(),height:t(document).height()||document.body.parentNode.scrollHeight}):(e=t(d),n=[],t(["Top","Right","Left","Bottom"]).each(function(t,i){n[t]=c._num(e.css("padding"+i))}),c.containerOffset=e.offset(),c.containerPosition=e.position(),c.containerSize={height:e.innerHeight()-n[3],width:e.innerWidth()-n[1]},i=c.containerOffset,r=c.containerSize.height,o=c.containerSize.width,s=c._hasScroll(d,"left")?d.scrollWidth:o,a=c._hasScroll(d)?d.scrollHeight:r,c.parentData={element:d,left:i.left,top:i.top,width:s,height:a}))},resize:function(e){var n,i,r,o,s=t(this).resizable("instance"),a=s.options,c=s.containerOffset,l=s.position,u=s._aspectRatio||e.shiftKey,h={top:0,left:0},d=s.containerElement,f=!0;d[0]!==document&&/static/.test(d.css("position"))&&(h=c),l.left<(s._helper?c.left:0)&&(s.size.width=s.size.width+(s._helper?s.position.left-c.left:s.position.left-h.left),u&&(s.size.height=s.size.width/s.aspectRatio,f=!1),s.position.left=a.helper?c.left:0),l.top<(s._helper?c.top:0)&&(s.size.height=s.size.height+(s._helper?s.position.top-c.top:s.position.top),u&&(s.size.width=s.size.height*s.aspectRatio,f=!1),s.position.top=s._helper?c.top:0),r=s.containerElement.get(0)===s.element.parent().get(0),o=/relative|absolute/.test(s.containerElement.css("position")),r&&o?(s.offset.left=s.parentData.left+s.position.left,s.offset.top=s.parentData.top+s.position.top):(s.offset.left=s.element.offset().left,s.offset.top=s.element.offset().top),n=Math.abs(s.sizeDiff.width+(s._helper?s.offset.left-h.left:s.offset.left-c.left)),i=Math.abs(s.sizeDiff.height+(s._helper?s.offset.top-h.top:s.offset.top-c.top)),n+s.size.width>=s.parentData.width&&(s.size.width=s.parentData.width-n,u&&(s.size.height=s.size.width/s.aspectRatio,f=!1)),i+s.size.height>=s.parentData.height&&(s.size.height=s.parentData.height-i,u&&(s.size.width=s.size.height*s.aspectRatio,f=!1)),f||(s.position.left=s.prevPosition.left,s.position.top=s.prevPosition.top,s.size.width=s.prevSize.width,s.size.height=s.prevSize.height)},stop:function(){var e=t(this).resizable("instance"),n=e.options,i=e.containerOffset,r=e.containerPosition,o=e.containerElement,s=t(e.helper),a=s.offset(),c=s.outerWidth()-e.sizeDiff.width,l=s.outerHeight()-e.sizeDiff.height;e._helper&&!n.animate&&/relative/.test(o.css("position"))&&t(this).css({left:a.left-r.left-i.left,width:c,height:l}),e._helper&&!n.animate&&/static/.test(o.css("position"))&&t(this).css({left:a.left-r.left-i.left,width:c,height:l})}}),t.ui.plugin.add("resizable","alsoResize",{start:function(){var e=t(this).resizable("instance").options;t(e.alsoResize).each(function(){var e=t(this);e.data("ui-resizable-alsoresize",{width:parseFloat(e.width()),height:parseFloat(e.height()),left:parseFloat(e.css("left")),top:parseFloat(e.css("top"))})})},resize:function(e,n){var i=t(this).resizable("instance"),r=i.options,o=i.originalSize,s=i.originalPosition,a={height:i.size.height-o.height||0,width:i.size.width-o.width||0,top:i.position.top-s.top||0,left:i.position.left-s.left||0};t(r.alsoResize).each(function(){var e=t(this),i=t(this).data("ui-resizable-alsoresize"),r={},o=e.parents(n.originalElement[0]).length?["width","height"]:["width","height","top","left"];t.each(o,function(t,e){var n=(i[e]||0)+(a[e]||0);n&&n>=0&&(r[e]=n||null)}),e.css(r)})},stop:function(){t(this).removeData("ui-resizable-alsoresize")}}),t.ui.plugin.add("resizable","ghost",{start:function(){var e=t(this).resizable("instance"),n=e.size;e.ghost=e.originalElement.clone(),e.ghost.css({opacity:.25,display:"block",position:"relative",height:n.height,width:n.width,margin:0,left:0,top:0}),e._addClass(e.ghost,"ui-resizable-ghost"),!1!==t.uiBackCompat&&"string"==typeof e.options.ghost&&e.ghost.addClass(this.options.ghost),e.ghost.appendTo(e.helper)},resize:function(){var e=t(this).resizable("instance");e.ghost&&e.ghost.css({position:"relative",height:e.size.height,width:e.size.width})},stop:function(){var e=t(this).resizable("instance");e.ghost&&e.helper&&e.helper.get(0).removeChild(e.ghost.get(0))}}),t.ui.plugin.add("resizable","grid",{resize:function(){var e,n=t(this).resizable("instance"),i=n.options,r=n.size,o=n.originalSize,s=n.originalPosition,a=n.axis,c="number"==typeof i.grid?[i.grid,i.grid]:i.grid,l=c[0]||1,u=c[1]||1,h=Math.round((r.width-o.width)/l)*l,d=Math.round((r.height-o.height)/u)*u,f=o.width+h,p=o.height+d,g=i.maxWidth&&i.maxWidth<f,_=i.maxHeight&&i.maxHeight<p,m=i.minWidth&&i.minWidth>f,y=i.minHeight&&i.minHeight>p;i.grid=c,m&&(f+=l),y&&(p+=u),g&&(f-=l),_&&(p-=u),/^(se|s|e)$/.test(a)?(n.size.width=f,n.size.height=p):/^(ne)$/.test(a)?(n.size.width=f,n.size.height=p,n.position.top=s.top-d):/^(sw)$/.test(a)?(n.size.width=f,n.size.height=p,n.position.left=s.left-h):((p-u<=0||f-l<=0)&&(e=n._getPaddingPlusBorderDimensions(this)),p-u>0?(n.size.height=p,n.position.top=s.top-d):(p=u-e.height,n.size.height=p,n.position.top=s.top+o.height-p),f-l>0?(n.size.width=f,n.position.left=s.left-h):(f=l-e.width,n.size.width=f,n.position.left=s.left+o.width-f))}}),t.ui.resizable})?i.apply(e,r):i)||(t.exports=o)},function(t,e,n){var i,r,o;
/*!
 * jQuery UI Droppable 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */r=[n(4),n(29),n(17),n(5),n(13)],void 0===(o="function"==typeof(i=function(t){t.widget("ui.droppable",{version:"1.12.1",widgetEventPrefix:"drop",options:{accept:"*",addClasses:!0,greedy:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e,n=this.options,i=n.accept;this.isover=!1,this.isout=!0,this.accept=t.isFunction(i)?i:function(t){return t.is(i)},this.proportions=function(){if(!arguments.length)return e||(e={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight});e=arguments[0]},this._addToManager(n.scope),n.addClasses&&this._addClass("ui-droppable")},_addToManager:function(e){t.ui.ddmanager.droppables[e]=t.ui.ddmanager.droppables[e]||[],t.ui.ddmanager.droppables[e].push(this)},_splice:function(t){for(var e=0;e<t.length;e++)t[e]===this&&t.splice(e,1)},_destroy:function(){var e=t.ui.ddmanager.droppables[this.options.scope];this._splice(e)},_setOption:function(e,n){if("accept"===e)this.accept=t.isFunction(n)?n:function(t){return t.is(n)};else if("scope"===e){var i=t.ui.ddmanager.droppables[this.options.scope];this._splice(i),this._addToManager(n)}this._super(e,n)},_activate:function(e){var n=t.ui.ddmanager.current;this._addActiveClass(),n&&this._trigger("activate",e,this.ui(n))},_deactivate:function(e){var n=t.ui.ddmanager.current;this._removeActiveClass(),n&&this._trigger("deactivate",e,this.ui(n))},_over:function(e){var n=t.ui.ddmanager.current;n&&(n.currentItem||n.element)[0]!==this.element[0]&&this.accept.call(this.element[0],n.currentItem||n.element)&&(this._addHoverClass(),this._trigger("over",e,this.ui(n)))},_out:function(e){var n=t.ui.ddmanager.current;n&&(n.currentItem||n.element)[0]!==this.element[0]&&this.accept.call(this.element[0],n.currentItem||n.element)&&(this._removeHoverClass(),this._trigger("out",e,this.ui(n)))},_drop:function(n,i){var r=i||t.ui.ddmanager.current,o=!1;return!(!r||(r.currentItem||r.element)[0]===this.element[0])&&(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var i=t(this).droppable("instance");if(i.options.greedy&&!i.options.disabled&&i.options.scope===r.options.scope&&i.accept.call(i.element[0],r.currentItem||r.element)&&e(r,t.extend(i,{offset:i.element.offset()}),i.options.tolerance,n))return o=!0,!1}),!o&&!!this.accept.call(this.element[0],r.currentItem||r.element)&&(this._removeActiveClass(),this._removeHoverClass(),this._trigger("drop",n,this.ui(r)),this.element))},ui:function(t){return{draggable:t.currentItem||t.element,helper:t.helper,position:t.position,offset:t.positionAbs}},_addHoverClass:function(){this._addClass("ui-droppable-hover")},_removeHoverClass:function(){this._removeClass("ui-droppable-hover")},_addActiveClass:function(){this._addClass("ui-droppable-active")},_removeActiveClass:function(){this._removeClass("ui-droppable-active")}});var e=t.ui.intersect=function(){function t(t,e,n){return t>=e&&t<e+n}return function(e,n,i,r){if(!n.offset)return!1;var o=(e.positionAbs||e.position.absolute).left+e.margins.left,s=(e.positionAbs||e.position.absolute).top+e.margins.top,a=o+e.helperProportions.width,c=s+e.helperProportions.height,l=n.offset.left,u=n.offset.top,h=l+n.proportions().width,d=u+n.proportions().height;switch(i){case"fit":return l<=o&&a<=h&&u<=s&&c<=d;case"intersect":return l<o+e.helperProportions.width/2&&a-e.helperProportions.width/2<h&&u<s+e.helperProportions.height/2&&c-e.helperProportions.height/2<d;case"pointer":return t(r.pageY,u,n.proportions().height)&&t(r.pageX,l,n.proportions().width);case"touch":return(s>=u&&s<=d||c>=u&&c<=d||s<u&&c>d)&&(o>=l&&o<=h||a>=l&&a<=h||o<l&&a>h);default:return!1}}}();return t.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(e,n){var i,r,o=t.ui.ddmanager.droppables[e.options.scope]||[],s=n?n.type:null,a=(e.currentItem||e.element).find(":data(ui-droppable)").addBack();t:for(i=0;i<o.length;i++)if(!(o[i].options.disabled||e&&!o[i].accept.call(o[i].element[0],e.currentItem||e.element))){for(r=0;r<a.length;r++)if(a[r]===o[i].element[0]){o[i].proportions().height=0;continue t}o[i].visible="none"!==o[i].element.css("display"),o[i].visible&&("mousedown"===s&&o[i]._activate.call(o[i],n),o[i].offset=o[i].element.offset(),o[i].proportions({width:o[i].element[0].offsetWidth,height:o[i].element[0].offsetHeight}))}},drop:function(n,i){var r=!1;return t.each((t.ui.ddmanager.droppables[n.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&e(n,this,this.options.tolerance,i)&&(r=this._drop.call(this,i)||r),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],n.currentItem||n.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,i)))}),r},dragStart:function(e,n){e.element.parentsUntil("body").on("scroll.droppable",function(){e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,n)})},drag:function(n,i){n.options.refreshPositions&&t.ui.ddmanager.prepareOffsets(n,i),t.each(t.ui.ddmanager.droppables[n.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var r,o,s,a=e(n,this,this.options.tolerance,i),c=!a&&this.isover?"isout":a&&!this.isover?"isover":null;c&&(this.options.greedy&&(o=this.options.scope,(s=this.element.parents(":data(ui-droppable)").filter(function(){return t(this).droppable("instance").options.scope===o})).length&&((r=t(s[0]).droppable("instance")).greedyChild="isover"===c)),r&&"isover"===c&&(r.isover=!1,r.isout=!0,r._out.call(r,i)),this[c]=!0,this["isout"===c?"isover":"isout"]=!1,this["isover"===c?"_over":"_out"].call(this,i),r&&"isout"===c&&(r.isout=!1,r.isover=!0,r._over.call(r,i)))}})},dragStop:function(e,n){e.element.parentsUntil("body").off("scroll.droppable"),e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,n)}},!1!==t.uiBackCompat&&t.widget("ui.droppable",t.ui.droppable,{options:{hoverClass:!1,activeClass:!1},_addActiveClass:function(){this._super(),this.options.activeClass&&this.element.addClass(this.options.activeClass)},_removeActiveClass:function(){this._super(),this.options.activeClass&&this.element.removeClass(this.options.activeClass)},_addHoverClass:function(){this._super(),this.options.hoverClass&&this.element.addClass(this.options.hoverClass)},_removeHoverClass:function(){this._super(),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass)}}),t.ui.droppable})?i.apply(e,r):i)||(t.exports=o)},function(t,e,n){var i,r,o;
/*!
 * jQuery UI Unique ID 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */r=[n(4),n(5)],void 0===(o="function"==typeof(i=function(t){return t.fn.extend({uniqueId:(e=0,function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})}),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&t(this).removeAttr("id")})}});var e})?i.apply(e,r):i)||(t.exports=o)},function(t,e,n){var i,r,o;
/*!
 * jQuery UI Tabbable 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */r=[n(4),n(5),n(34)],void 0===(o="function"==typeof(i=function(t){return t.extend(t.expr[":"],{tabbable:function(e){var n=t.attr(e,"tabindex"),i=null!=n;return(!i||n>=0)&&t.ui.focusable(e,i)}})})?i.apply(e,r):i)||(t.exports=o)},function(t,e,n){var i,r,o;
/*!
 * jQuery UI Support for jQuery core 1.7.x 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 */r=[n(4),n(5)],void 0===(o="function"==typeof(i=function(t){"1.7"===t.fn.jquery.substring(0,3)&&(t.each(["Width","Height"],function(e,n){var i="Width"===n?["Left","Right"]:["Top","Bottom"],r=n.toLowerCase(),o={innerWidth:t.fn.innerWidth,innerHeight:t.fn.innerHeight,outerWidth:t.fn.outerWidth,outerHeight:t.fn.outerHeight};function s(e,n,r,o){return t.each(i,function(){n-=parseFloat(t.css(e,"padding"+this))||0,r&&(n-=parseFloat(t.css(e,"border"+this+"Width"))||0),o&&(n-=parseFloat(t.css(e,"margin"+this))||0)}),n}t.fn["inner"+n]=function(e){return void 0===e?o["inner"+n].call(this):this.each(function(){t(this).css(r,s(this,e)+"px")})},t.fn["outer"+n]=function(e,i){return"number"!=typeof e?o["outer"+n].call(this,e):this.each(function(){t(this).css(r,s(this,e,!0,i)+"px")})}}),t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))})})?i.apply(e,r):i)||(t.exports=o)},function(t,e,n){var i,r,o;r=[n(4),n(5)],void 0===(o="function"==typeof(i=function(t){return t.ui.escapeSelector=(e=/([!"#$%&'()*+,./:;<=>?@[\]^`{|}~])/g,function(t){return t.replace(e,"\\$1")});var e})?i.apply(e,r):i)||(t.exports=o)},function(t,e,n){var i,r,o;
/*!
 * jQuery UI Labels 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */r=[n(4),n(5),n(60)],void 0===(o="function"==typeof(i=function(t){return t.fn.labels=function(){var e,n,i,r,o;return this[0].labels&&this[0].labels.length?this.pushStack(this[0].labels):(r=this.eq(0).parents("label"),(i=this.attr("id"))&&(o=(e=this.eq(0).parents().last()).add(e.length?e.siblings():this.siblings()),n="label[for='"+t.ui.escapeSelector(i)+"']",r=r.add(o.find(n).addBack(n))),this.pushStack(r))}})?i.apply(e,r):i)||(t.exports=o)},function(t,e,n){var i,r,o;
/*!
 * jQuery UI Keycode 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */r=[n(4),n(5)],void 0===(o="function"==typeof(i=function(t){return t.ui.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}})?i.apply(e,r):i)||(t.exports=o)},function(t,e,n){var i,r,o;r=[n(4),n(5)],void 0===(o="function"==typeof(i=function(t){return t.fn.form=function(){return"string"==typeof this[0].form?this.closest("form"):t(this[0].form)}})?i.apply(e,r):i)||(t.exports=o)},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){(function(t,i){var r;
/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(){var o,s=200,a="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",c="Expected a function",l="__lodash_hash_undefined__",u=500,h="__lodash_placeholder__",d=1,f=2,p=4,g=1,_=2,m=1,y=2,v=4,b=8,C=16,w=32,E=64,T=128,S=256,x=512,R=30,A="...",O=800,I=16,M=1,P=2,L=1/0,D=9007199254740991,k=17976931348623157e292,F=NaN,N=4294967295,j=N-1,B=N>>>1,z=[["ary",T],["bind",m],["bindKey",y],["curry",b],["curryRight",C],["flip",x],["partial",w],["partialRight",E],["rearg",S]],U="[object Arguments]",H="[object Array]",W="[object AsyncFunction]",G="[object Boolean]",V="[object Date]",Y="[object DOMException]",q="[object Error]",X="[object Function]",K="[object GeneratorFunction]",$="[object Map]",Z="[object Number]",J="[object Null]",Q="[object Object]",tt="[object Proxy]",et="[object RegExp]",nt="[object Set]",it="[object String]",rt="[object Symbol]",ot="[object Undefined]",st="[object WeakMap]",at="[object WeakSet]",ct="[object ArrayBuffer]",lt="[object DataView]",ut="[object Float32Array]",ht="[object Float64Array]",dt="[object Int8Array]",ft="[object Int16Array]",pt="[object Int32Array]",gt="[object Uint8Array]",_t="[object Uint8ClampedArray]",mt="[object Uint16Array]",yt="[object Uint32Array]",vt=/\b__p \+= '';/g,bt=/\b(__p \+=) '' \+/g,Ct=/(__e\(.*?\)|\b__t\)) \+\n'';/g,wt=/&(?:amp|lt|gt|quot|#39);/g,Et=/[&<>"']/g,Tt=RegExp(wt.source),St=RegExp(Et.source),xt=/<%-([\s\S]+?)%>/g,Rt=/<%([\s\S]+?)%>/g,At=/<%=([\s\S]+?)%>/g,Ot=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,It=/^\w*$/,Mt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Pt=/[\\^$.*+?()[\]{}|]/g,Lt=RegExp(Pt.source),Dt=/^\s+|\s+$/g,kt=/^\s+/,Ft=/\s+$/,Nt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,jt=/\{\n\/\* \[wrapped with (.+)\] \*/,Bt=/,? & /,zt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ut=/\\(\\)?/g,Ht=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Wt=/\w*$/,Gt=/^[-+]0x[0-9a-f]+$/i,Vt=/^0b[01]+$/i,Yt=/^\[object .+?Constructor\]$/,qt=/^0o[0-7]+$/i,Xt=/^(?:0|[1-9]\d*)$/,Kt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,$t=/($^)/,Zt=/['\n\r\u2028\u2029\\]/g,Jt="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Qt="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",te="[\\ud800-\\udfff]",ee="["+Qt+"]",ne="["+Jt+"]",ie="\\d+",re="[\\u2700-\\u27bf]",oe="[a-z\\xdf-\\xf6\\xf8-\\xff]",se="[^\\ud800-\\udfff"+Qt+ie+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",ae="\\ud83c[\\udffb-\\udfff]",ce="[^\\ud800-\\udfff]",le="(?:\\ud83c[\\udde6-\\uddff]){2}",ue="[\\ud800-\\udbff][\\udc00-\\udfff]",he="[A-Z\\xc0-\\xd6\\xd8-\\xde]",de="(?:"+oe+"|"+se+")",fe="(?:"+he+"|"+se+")",pe="(?:"+ne+"|"+ae+")"+"?",ge="[\\ufe0e\\ufe0f]?"+pe+("(?:\\u200d(?:"+[ce,le,ue].join("|")+")[\\ufe0e\\ufe0f]?"+pe+")*"),_e="(?:"+[re,le,ue].join("|")+")"+ge,me="(?:"+[ce+ne+"?",ne,le,ue,te].join("|")+")",ye=RegExp("['’]","g"),ve=RegExp(ne,"g"),be=RegExp(ae+"(?="+ae+")|"+me+ge,"g"),Ce=RegExp([he+"?"+oe+"+(?:['’](?:d|ll|m|re|s|t|ve))?(?="+[ee,he,"$"].join("|")+")",fe+"+(?:['’](?:D|LL|M|RE|S|T|VE))?(?="+[ee,he+de,"$"].join("|")+")",he+"?"+de+"+(?:['’](?:d|ll|m|re|s|t|ve))?",he+"+(?:['’](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ie,_e].join("|"),"g"),we=RegExp("[\\u200d\\ud800-\\udfff"+Jt+"\\ufe0e\\ufe0f]"),Ee=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Te=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Se=-1,xe={};xe[ut]=xe[ht]=xe[dt]=xe[ft]=xe[pt]=xe[gt]=xe[_t]=xe[mt]=xe[yt]=!0,xe[U]=xe[H]=xe[ct]=xe[G]=xe[lt]=xe[V]=xe[q]=xe[X]=xe[$]=xe[Z]=xe[Q]=xe[et]=xe[nt]=xe[it]=xe[st]=!1;var Re={};Re[U]=Re[H]=Re[ct]=Re[lt]=Re[G]=Re[V]=Re[ut]=Re[ht]=Re[dt]=Re[ft]=Re[pt]=Re[$]=Re[Z]=Re[Q]=Re[et]=Re[nt]=Re[it]=Re[rt]=Re[gt]=Re[_t]=Re[mt]=Re[yt]=!0,Re[q]=Re[X]=Re[st]=!1;var Ae={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Oe=parseFloat,Ie=parseInt,Me="object"==typeof t&&t&&t.Object===Object&&t,Pe="object"==typeof self&&self&&self.Object===Object&&self,Le=Me||Pe||Function("return this")(),De="object"==typeof e&&e&&!e.nodeType&&e,ke=De&&"object"==typeof i&&i&&!i.nodeType&&i,Fe=ke&&ke.exports===De,Ne=Fe&&Me.process,je=function(){try{var t=ke&&ke.require&&ke.require("util").types;return t||Ne&&Ne.binding&&Ne.binding("util")}catch(t){}}(),Be=je&&je.isArrayBuffer,ze=je&&je.isDate,Ue=je&&je.isMap,He=je&&je.isRegExp,We=je&&je.isSet,Ge=je&&je.isTypedArray;function Ve(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function Ye(t,e,n,i){for(var r=-1,o=null==t?0:t.length;++r<o;){var s=t[r];e(i,s,n(s),t)}return i}function qe(t,e){for(var n=-1,i=null==t?0:t.length;++n<i&&!1!==e(t[n],n,t););return t}function Xe(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}function Ke(t,e){for(var n=-1,i=null==t?0:t.length;++n<i;)if(!e(t[n],n,t))return!1;return!0}function $e(t,e){for(var n=-1,i=null==t?0:t.length,r=0,o=[];++n<i;){var s=t[n];e(s,n,t)&&(o[r++]=s)}return o}function Ze(t,e){return!!(null==t?0:t.length)&&cn(t,e,0)>-1}function Je(t,e,n){for(var i=-1,r=null==t?0:t.length;++i<r;)if(n(e,t[i]))return!0;return!1}function Qe(t,e){for(var n=-1,i=null==t?0:t.length,r=Array(i);++n<i;)r[n]=e(t[n],n,t);return r}function tn(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t}function en(t,e,n,i){var r=-1,o=null==t?0:t.length;for(i&&o&&(n=t[++r]);++r<o;)n=e(n,t[r],r,t);return n}function nn(t,e,n,i){var r=null==t?0:t.length;for(i&&r&&(n=t[--r]);r--;)n=e(n,t[r],r,t);return n}function rn(t,e){for(var n=-1,i=null==t?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1}var on=dn("length");function sn(t,e,n){var i;return n(t,function(t,n,r){if(e(t,n,r))return i=n,!1}),i}function an(t,e,n,i){for(var r=t.length,o=n+(i?1:-1);i?o--:++o<r;)if(e(t[o],o,t))return o;return-1}function cn(t,e,n){return e==e?function(t,e,n){var i=n-1,r=t.length;for(;++i<r;)if(t[i]===e)return i;return-1}(t,e,n):an(t,un,n)}function ln(t,e,n,i){for(var r=n-1,o=t.length;++r<o;)if(i(t[r],e))return r;return-1}function un(t){return t!=t}function hn(t,e){var n=null==t?0:t.length;return n?gn(t,e)/n:F}function dn(t){return function(e){return null==e?o:e[t]}}function fn(t){return function(e){return null==t?o:t[e]}}function pn(t,e,n,i,r){return r(t,function(t,r,o){n=i?(i=!1,t):e(n,t,r,o)}),n}function gn(t,e){for(var n,i=-1,r=t.length;++i<r;){var s=e(t[i]);s!==o&&(n=n===o?s:n+s)}return n}function _n(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}function mn(t){return function(e){return t(e)}}function yn(t,e){return Qe(e,function(e){return t[e]})}function vn(t,e){return t.has(e)}function bn(t,e){for(var n=-1,i=t.length;++n<i&&cn(e,t[n],0)>-1;);return n}function Cn(t,e){for(var n=t.length;n--&&cn(e,t[n],0)>-1;);return n}var wn=fn({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),En=fn({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Tn(t){return"\\"+Ae[t]}function Sn(t){return we.test(t)}function xn(t){var e=-1,n=Array(t.size);return t.forEach(function(t,i){n[++e]=[i,t]}),n}function Rn(t,e){return function(n){return t(e(n))}}function An(t,e){for(var n=-1,i=t.length,r=0,o=[];++n<i;){var s=t[n];s!==e&&s!==h||(t[n]=h,o[r++]=n)}return o}function On(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}function In(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=[t,t]}),n}function Mn(t){return Sn(t)?function(t){var e=be.lastIndex=0;for(;be.test(t);)++e;return e}(t):on(t)}function Pn(t){return Sn(t)?function(t){return t.match(be)||[]}(t):function(t){return t.split("")}(t)}var Ln=fn({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var Dn=function t(e){var n,i=(e=null==e?Le:Dn.defaults(Le.Object(),e,Dn.pick(Le,Te))).Array,r=e.Date,Jt=e.Error,Qt=e.Function,te=e.Math,ee=e.Object,ne=e.RegExp,ie=e.String,re=e.TypeError,oe=i.prototype,se=Qt.prototype,ae=ee.prototype,ce=e["__core-js_shared__"],le=se.toString,ue=ae.hasOwnProperty,he=0,de=(n=/[^.]+$/.exec(ce&&ce.keys&&ce.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",fe=ae.toString,pe=le.call(ee),ge=Le._,_e=ne("^"+le.call(ue).replace(Pt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),me=Fe?e.Buffer:o,be=e.Symbol,we=e.Uint8Array,Ae=me?me.allocUnsafe:o,Me=Rn(ee.getPrototypeOf,ee),Pe=ee.create,De=ae.propertyIsEnumerable,ke=oe.splice,Ne=be?be.isConcatSpreadable:o,je=be?be.iterator:o,on=be?be.toStringTag:o,fn=function(){try{var t=Bo(ee,"defineProperty");return t({},"",{}),t}catch(t){}}(),kn=e.clearTimeout!==Le.clearTimeout&&e.clearTimeout,Fn=r&&r.now!==Le.Date.now&&r.now,Nn=e.setTimeout!==Le.setTimeout&&e.setTimeout,jn=te.ceil,Bn=te.floor,zn=ee.getOwnPropertySymbols,Un=me?me.isBuffer:o,Hn=e.isFinite,Wn=oe.join,Gn=Rn(ee.keys,ee),Vn=te.max,Yn=te.min,qn=r.now,Xn=e.parseInt,Kn=te.random,$n=oe.reverse,Zn=Bo(e,"DataView"),Jn=Bo(e,"Map"),Qn=Bo(e,"Promise"),ti=Bo(e,"Set"),ei=Bo(e,"WeakMap"),ni=Bo(ee,"create"),ii=ei&&new ei,ri={},oi=hs(Zn),si=hs(Jn),ai=hs(Qn),ci=hs(ti),li=hs(ei),ui=be?be.prototype:o,hi=ui?ui.valueOf:o,di=ui?ui.toString:o;function fi(t){if(Aa(t)&&!ma(t)&&!(t instanceof mi)){if(t instanceof _i)return t;if(ue.call(t,"__wrapped__"))return ds(t)}return new _i(t)}var pi=function(){function t(){}return function(e){if(!Ra(e))return{};if(Pe)return Pe(e);t.prototype=e;var n=new t;return t.prototype=o,n}}();function gi(){}function _i(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=o}function mi(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=N,this.__views__=[]}function yi(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function vi(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function bi(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function Ci(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new bi;++e<n;)this.add(t[e])}function wi(t){var e=this.__data__=new vi(t);this.size=e.size}function Ei(t,e){var n=ma(t),i=!n&&_a(t),r=!n&&!i&&Ca(t),o=!n&&!i&&!r&&Fa(t),s=n||i||r||o,a=s?_n(t.length,ie):[],c=a.length;for(var l in t)!e&&!ue.call(t,l)||s&&("length"==l||r&&("offset"==l||"parent"==l)||o&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||Yo(l,c))||a.push(l);return a}function Ti(t){var e=t.length;return e?t[Cr(0,e-1)]:o}function Si(t,e){return cs(no(t),Di(e,0,t.length))}function xi(t){return cs(no(t))}function Ri(t,e,n){(n===o||fa(t[e],n))&&(n!==o||e in t)||Pi(t,e,n)}function Ai(t,e,n){var i=t[e];ue.call(t,e)&&fa(i,n)&&(n!==o||e in t)||Pi(t,e,n)}function Oi(t,e){for(var n=t.length;n--;)if(fa(t[n][0],e))return n;return-1}function Ii(t,e,n,i){return Bi(t,function(t,r,o){e(i,t,n(t),o)}),i}function Mi(t,e){return t&&io(e,rc(e),t)}function Pi(t,e,n){"__proto__"==e&&fn?fn(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function Li(t,e){for(var n=-1,r=e.length,s=i(r),a=null==t;++n<r;)s[n]=a?o:Qa(t,e[n]);return s}function Di(t,e,n){return t==t&&(n!==o&&(t=t<=n?t:n),e!==o&&(t=t>=e?t:e)),t}function ki(t,e,n,i,r,s){var a,c=e&d,l=e&f,u=e&p;if(n&&(a=r?n(t,i,r,s):n(t)),a!==o)return a;if(!Ra(t))return t;var h=ma(t);if(h){if(a=function(t){var e=t.length,n=new t.constructor(e);e&&"string"==typeof t[0]&&ue.call(t,"index")&&(n.index=t.index,n.input=t.input);return n}(t),!c)return no(t,a)}else{var g=Ho(t),_=g==X||g==K;if(Ca(t))return $r(t,c);if(g==Q||g==U||_&&!r){if(a=l||_?{}:Go(t),!c)return l?function(t,e){return io(t,Uo(t),e)}(t,function(t,e){return t&&io(e,oc(e),t)}(a,t)):function(t,e){return io(t,zo(t),e)}(t,Mi(a,t))}else{if(!Re[g])return r?t:{};a=function(t,e,n){var i=t.constructor;switch(e){case ct:return Zr(t);case G:case V:return new i(+t);case lt:return function(t,e){var n=e?Zr(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case ut:case ht:case dt:case ft:case pt:case gt:case _t:case mt:case yt:return Jr(t,n);case $:return new i;case Z:case it:return new i(t);case et:return function(t){var e=new t.constructor(t.source,Wt.exec(t));return e.lastIndex=t.lastIndex,e}(t);case nt:return new i;case rt:return r=t,hi?ee(hi.call(r)):{}}var r}(t,g,c)}}s||(s=new wi);var m=s.get(t);if(m)return m;s.set(t,a),La(t)?t.forEach(function(i){a.add(ki(i,e,n,i,t,s))}):Oa(t)&&t.forEach(function(i,r){a.set(r,ki(i,e,n,r,t,s))});var y=h?o:(u?l?Po:Mo:l?oc:rc)(t);return qe(y||t,function(i,r){y&&(i=t[r=i]),Ai(a,r,ki(i,e,n,r,t,s))}),a}function Fi(t,e,n){var i=n.length;if(null==t)return!i;for(t=ee(t);i--;){var r=n[i],s=e[r],a=t[r];if(a===o&&!(r in t)||!s(a))return!1}return!0}function Ni(t,e,n){if("function"!=typeof t)throw new re(c);return rs(function(){t.apply(o,n)},e)}function ji(t,e,n,i){var r=-1,o=Ze,a=!0,c=t.length,l=[],u=e.length;if(!c)return l;n&&(e=Qe(e,mn(n))),i?(o=Je,a=!1):e.length>=s&&(o=vn,a=!1,e=new Ci(e));t:for(;++r<c;){var h=t[r],d=null==n?h:n(h);if(h=i||0!==h?h:0,a&&d==d){for(var f=u;f--;)if(e[f]===d)continue t;l.push(h)}else o(e,d,i)||l.push(h)}return l}fi.templateSettings={escape:xt,evaluate:Rt,interpolate:At,variable:"",imports:{_:fi}},fi.prototype=gi.prototype,fi.prototype.constructor=fi,_i.prototype=pi(gi.prototype),_i.prototype.constructor=_i,mi.prototype=pi(gi.prototype),mi.prototype.constructor=mi,yi.prototype.clear=function(){this.__data__=ni?ni(null):{},this.size=0},yi.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},yi.prototype.get=function(t){var e=this.__data__;if(ni){var n=e[t];return n===l?o:n}return ue.call(e,t)?e[t]:o},yi.prototype.has=function(t){var e=this.__data__;return ni?e[t]!==o:ue.call(e,t)},yi.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=ni&&e===o?l:e,this},vi.prototype.clear=function(){this.__data__=[],this.size=0},vi.prototype.delete=function(t){var e=this.__data__,n=Oi(e,t);return!(n<0)&&(n==e.length-1?e.pop():ke.call(e,n,1),--this.size,!0)},vi.prototype.get=function(t){var e=this.__data__,n=Oi(e,t);return n<0?o:e[n][1]},vi.prototype.has=function(t){return Oi(this.__data__,t)>-1},vi.prototype.set=function(t,e){var n=this.__data__,i=Oi(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this},bi.prototype.clear=function(){this.size=0,this.__data__={hash:new yi,map:new(Jn||vi),string:new yi}},bi.prototype.delete=function(t){var e=No(this,t).delete(t);return this.size-=e?1:0,e},bi.prototype.get=function(t){return No(this,t).get(t)},bi.prototype.has=function(t){return No(this,t).has(t)},bi.prototype.set=function(t,e){var n=No(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this},Ci.prototype.add=Ci.prototype.push=function(t){return this.__data__.set(t,l),this},Ci.prototype.has=function(t){return this.__data__.has(t)},wi.prototype.clear=function(){this.__data__=new vi,this.size=0},wi.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},wi.prototype.get=function(t){return this.__data__.get(t)},wi.prototype.has=function(t){return this.__data__.has(t)},wi.prototype.set=function(t,e){var n=this.__data__;if(n instanceof vi){var i=n.__data__;if(!Jn||i.length<s-1)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new bi(i)}return n.set(t,e),this.size=n.size,this};var Bi=so(qi),zi=so(Xi,!0);function Ui(t,e){var n=!0;return Bi(t,function(t,i,r){return n=!!e(t,i,r)}),n}function Hi(t,e,n){for(var i=-1,r=t.length;++i<r;){var s=t[i],a=e(s);if(null!=a&&(c===o?a==a&&!ka(a):n(a,c)))var c=a,l=s}return l}function Wi(t,e){var n=[];return Bi(t,function(t,i,r){e(t,i,r)&&n.push(t)}),n}function Gi(t,e,n,i,r){var o=-1,s=t.length;for(n||(n=Vo),r||(r=[]);++o<s;){var a=t[o];e>0&&n(a)?e>1?Gi(a,e-1,n,i,r):tn(r,a):i||(r[r.length]=a)}return r}var Vi=ao(),Yi=ao(!0);function qi(t,e){return t&&Vi(t,e,rc)}function Xi(t,e){return t&&Yi(t,e,rc)}function Ki(t,e){return $e(e,function(e){return Ta(t[e])})}function $i(t,e){for(var n=0,i=(e=Yr(e,t)).length;null!=t&&n<i;)t=t[us(e[n++])];return n&&n==i?t:o}function Zi(t,e,n){var i=e(t);return ma(t)?i:tn(i,n(t))}function Ji(t){return null==t?t===o?ot:J:on&&on in ee(t)?function(t){var e=ue.call(t,on),n=t[on];try{t[on]=o;var i=!0}catch(t){}var r=fe.call(t);i&&(e?t[on]=n:delete t[on]);return r}(t):function(t){return fe.call(t)}(t)}function Qi(t,e){return t>e}function tr(t,e){return null!=t&&ue.call(t,e)}function er(t,e){return null!=t&&e in ee(t)}function nr(t,e,n){for(var r=n?Je:Ze,s=t[0].length,a=t.length,c=a,l=i(a),u=1/0,h=[];c--;){var d=t[c];c&&e&&(d=Qe(d,mn(e))),u=Yn(d.length,u),l[c]=!n&&(e||s>=120&&d.length>=120)?new Ci(c&&d):o}d=t[0];var f=-1,p=l[0];t:for(;++f<s&&h.length<u;){var g=d[f],_=e?e(g):g;if(g=n||0!==g?g:0,!(p?vn(p,_):r(h,_,n))){for(c=a;--c;){var m=l[c];if(!(m?vn(m,_):r(t[c],_,n)))continue t}p&&p.push(_),h.push(g)}}return h}function ir(t,e,n){var i=null==(t=es(t,e=Yr(e,t)))?t:t[us(Es(e))];return null==i?o:Ve(i,t,n)}function rr(t){return Aa(t)&&Ji(t)==U}function or(t,e,n,i,r){return t===e||(null==t||null==e||!Aa(t)&&!Aa(e)?t!=t&&e!=e:function(t,e,n,i,r,s){var a=ma(t),c=ma(e),l=a?H:Ho(t),u=c?H:Ho(e),h=(l=l==U?Q:l)==Q,d=(u=u==U?Q:u)==Q,f=l==u;if(f&&Ca(t)){if(!Ca(e))return!1;a=!0,h=!1}if(f&&!h)return s||(s=new wi),a||Fa(t)?Oo(t,e,n,i,r,s):function(t,e,n,i,r,o,s){switch(n){case lt:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case ct:return!(t.byteLength!=e.byteLength||!o(new we(t),new we(e)));case G:case V:case Z:return fa(+t,+e);case q:return t.name==e.name&&t.message==e.message;case et:case it:return t==e+"";case $:var a=xn;case nt:var c=i&g;if(a||(a=On),t.size!=e.size&&!c)return!1;var l=s.get(t);if(l)return l==e;i|=_,s.set(t,e);var u=Oo(a(t),a(e),i,r,o,s);return s.delete(t),u;case rt:if(hi)return hi.call(t)==hi.call(e)}return!1}(t,e,l,n,i,r,s);if(!(n&g)){var p=h&&ue.call(t,"__wrapped__"),m=d&&ue.call(e,"__wrapped__");if(p||m){var y=p?t.value():t,v=m?e.value():e;return s||(s=new wi),r(y,v,n,i,s)}}if(!f)return!1;return s||(s=new wi),function(t,e,n,i,r,s){var a=n&g,c=Mo(t),l=c.length,u=Mo(e).length;if(l!=u&&!a)return!1;var h=l;for(;h--;){var d=c[h];if(!(a?d in e:ue.call(e,d)))return!1}var f=s.get(t);if(f&&s.get(e))return f==e;var p=!0;s.set(t,e),s.set(e,t);var _=a;for(;++h<l;){d=c[h];var m=t[d],y=e[d];if(i)var v=a?i(y,m,d,e,t,s):i(m,y,d,t,e,s);if(!(v===o?m===y||r(m,y,n,i,s):v)){p=!1;break}_||(_="constructor"==d)}if(p&&!_){var b=t.constructor,C=e.constructor;b!=C&&"constructor"in t&&"constructor"in e&&!("function"==typeof b&&b instanceof b&&"function"==typeof C&&C instanceof C)&&(p=!1)}return s.delete(t),s.delete(e),p}(t,e,n,i,r,s)}(t,e,n,i,or,r))}function sr(t,e,n,i){var r=n.length,s=r,a=!i;if(null==t)return!s;for(t=ee(t);r--;){var c=n[r];if(a&&c[2]?c[1]!==t[c[0]]:!(c[0]in t))return!1}for(;++r<s;){var l=(c=n[r])[0],u=t[l],h=c[1];if(a&&c[2]){if(u===o&&!(l in t))return!1}else{var d=new wi;if(i)var f=i(u,h,l,t,e,d);if(!(f===o?or(h,u,g|_,i,d):f))return!1}}return!0}function ar(t){return!(!Ra(t)||(e=t,de&&de in e))&&(Ta(t)?_e:Yt).test(hs(t));var e}function cr(t){return"function"==typeof t?t:null==t?Ic:"object"==typeof t?ma(t)?pr(t[0],t[1]):fr(t):Bc(t)}function lr(t){if(!Zo(t))return Gn(t);var e=[];for(var n in ee(t))ue.call(t,n)&&"constructor"!=n&&e.push(n);return e}function ur(t){if(!Ra(t))return function(t){var e=[];if(null!=t)for(var n in ee(t))e.push(n);return e}(t);var e=Zo(t),n=[];for(var i in t)("constructor"!=i||!e&&ue.call(t,i))&&n.push(i);return n}function hr(t,e){return t<e}function dr(t,e){var n=-1,r=va(t)?i(t.length):[];return Bi(t,function(t,i,o){r[++n]=e(t,i,o)}),r}function fr(t){var e=jo(t);return 1==e.length&&e[0][2]?Qo(e[0][0],e[0][1]):function(n){return n===t||sr(n,t,e)}}function pr(t,e){return Xo(t)&&Jo(e)?Qo(us(t),e):function(n){var i=Qa(n,t);return i===o&&i===e?tc(n,t):or(e,i,g|_)}}function gr(t,e,n,i,r){t!==e&&Vi(e,function(s,a){if(r||(r=new wi),Ra(s))!function(t,e,n,i,r,s,a){var c=ns(t,n),l=ns(e,n),u=a.get(l);if(u)return void Ri(t,n,u);var h=s?s(c,l,n+"",t,e,a):o,d=h===o;if(d){var f=ma(l),p=!f&&Ca(l),g=!f&&!p&&Fa(l);h=l,f||p||g?ma(c)?h=c:ba(c)?h=no(c):p?(d=!1,h=$r(l,!0)):g?(d=!1,h=Jr(l,!0)):h=[]:Ma(l)||_a(l)?(h=c,_a(c)?h=Ga(c):Ra(c)&&!Ta(c)||(h=Go(l))):d=!1}d&&(a.set(l,h),r(h,l,i,s,a),a.delete(l));Ri(t,n,h)}(t,e,a,n,gr,i,r);else{var c=i?i(ns(t,a),s,a+"",t,e,r):o;c===o&&(c=s),Ri(t,a,c)}},oc)}function _r(t,e){var n=t.length;if(n)return Yo(e+=e<0?n:0,n)?t[e]:o}function mr(t,e,n){var i=-1;return e=Qe(e.length?e:[Ic],mn(Fo())),function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}(dr(t,function(t,n,r){return{criteria:Qe(e,function(e){return e(t)}),index:++i,value:t}}),function(t,e){return function(t,e,n){var i=-1,r=t.criteria,o=e.criteria,s=r.length,a=n.length;for(;++i<s;){var c=Qr(r[i],o[i]);if(c){if(i>=a)return c;var l=n[i];return c*("desc"==l?-1:1)}}return t.index-e.index}(t,e,n)})}function yr(t,e,n){for(var i=-1,r=e.length,o={};++i<r;){var s=e[i],a=$i(t,s);n(a,s)&&xr(o,Yr(s,t),a)}return o}function vr(t,e,n,i){var r=i?ln:cn,o=-1,s=e.length,a=t;for(t===e&&(e=no(e)),n&&(a=Qe(t,mn(n)));++o<s;)for(var c=0,l=e[o],u=n?n(l):l;(c=r(a,u,c,i))>-1;)a!==t&&ke.call(a,c,1),ke.call(t,c,1);return t}function br(t,e){for(var n=t?e.length:0,i=n-1;n--;){var r=e[n];if(n==i||r!==o){var o=r;Yo(r)?ke.call(t,r,1):jr(t,r)}}return t}function Cr(t,e){return t+Bn(Kn()*(e-t+1))}function wr(t,e){var n="";if(!t||e<1||e>D)return n;do{e%2&&(n+=t),(e=Bn(e/2))&&(t+=t)}while(e);return n}function Er(t,e){return os(ts(t,e,Ic),t+"")}function Tr(t){return Ti(fc(t))}function Sr(t,e){var n=fc(t);return cs(n,Di(e,0,n.length))}function xr(t,e,n,i){if(!Ra(t))return t;for(var r=-1,s=(e=Yr(e,t)).length,a=s-1,c=t;null!=c&&++r<s;){var l=us(e[r]),u=n;if(r!=a){var h=c[l];(u=i?i(h,l,c):o)===o&&(u=Ra(h)?h:Yo(e[r+1])?[]:{})}Ai(c,l,u),c=c[l]}return t}var Rr=ii?function(t,e){return ii.set(t,e),t}:Ic,Ar=fn?function(t,e){return fn(t,"toString",{configurable:!0,enumerable:!1,value:Rc(e),writable:!0})}:Ic;function Or(t){return cs(fc(t))}function Ir(t,e,n){var r=-1,o=t.length;e<0&&(e=-e>o?0:o+e),(n=n>o?o:n)<0&&(n+=o),o=e>n?0:n-e>>>0,e>>>=0;for(var s=i(o);++r<o;)s[r]=t[r+e];return s}function Mr(t,e){var n;return Bi(t,function(t,i,r){return!(n=e(t,i,r))}),!!n}function Pr(t,e,n){var i=0,r=null==t?i:t.length;if("number"==typeof e&&e==e&&r<=B){for(;i<r;){var o=i+r>>>1,s=t[o];null!==s&&!ka(s)&&(n?s<=e:s<e)?i=o+1:r=o}return r}return Lr(t,e,Ic,n)}function Lr(t,e,n,i){e=n(e);for(var r=0,s=null==t?0:t.length,a=e!=e,c=null===e,l=ka(e),u=e===o;r<s;){var h=Bn((r+s)/2),d=n(t[h]),f=d!==o,p=null===d,g=d==d,_=ka(d);if(a)var m=i||g;else m=u?g&&(i||f):c?g&&f&&(i||!p):l?g&&f&&!p&&(i||!_):!p&&!_&&(i?d<=e:d<e);m?r=h+1:s=h}return Yn(s,j)}function Dr(t,e){for(var n=-1,i=t.length,r=0,o=[];++n<i;){var s=t[n],a=e?e(s):s;if(!n||!fa(a,c)){var c=a;o[r++]=0===s?0:s}}return o}function kr(t){return"number"==typeof t?t:ka(t)?F:+t}function Fr(t){if("string"==typeof t)return t;if(ma(t))return Qe(t,Fr)+"";if(ka(t))return di?di.call(t):"";var e=t+"";return"0"==e&&1/t==-L?"-0":e}function Nr(t,e,n){var i=-1,r=Ze,o=t.length,a=!0,c=[],l=c;if(n)a=!1,r=Je;else if(o>=s){var u=e?null:Eo(t);if(u)return On(u);a=!1,r=vn,l=new Ci}else l=e?[]:c;t:for(;++i<o;){var h=t[i],d=e?e(h):h;if(h=n||0!==h?h:0,a&&d==d){for(var f=l.length;f--;)if(l[f]===d)continue t;e&&l.push(d),c.push(h)}else r(l,d,n)||(l!==c&&l.push(d),c.push(h))}return c}function jr(t,e){return null==(t=es(t,e=Yr(e,t)))||delete t[us(Es(e))]}function Br(t,e,n,i){return xr(t,e,n($i(t,e)),i)}function zr(t,e,n,i){for(var r=t.length,o=i?r:-1;(i?o--:++o<r)&&e(t[o],o,t););return n?Ir(t,i?0:o,i?o+1:r):Ir(t,i?o+1:0,i?r:o)}function Ur(t,e){var n=t;return n instanceof mi&&(n=n.value()),en(e,function(t,e){return e.func.apply(e.thisArg,tn([t],e.args))},n)}function Hr(t,e,n){var r=t.length;if(r<2)return r?Nr(t[0]):[];for(var o=-1,s=i(r);++o<r;)for(var a=t[o],c=-1;++c<r;)c!=o&&(s[o]=ji(s[o]||a,t[c],e,n));return Nr(Gi(s,1),e,n)}function Wr(t,e,n){for(var i=-1,r=t.length,s=e.length,a={};++i<r;){var c=i<s?e[i]:o;n(a,t[i],c)}return a}function Gr(t){return ba(t)?t:[]}function Vr(t){return"function"==typeof t?t:Ic}function Yr(t,e){return ma(t)?t:Xo(t,e)?[t]:ls(Va(t))}var qr=Er;function Xr(t,e,n){var i=t.length;return n=n===o?i:n,!e&&n>=i?t:Ir(t,e,n)}var Kr=kn||function(t){return Le.clearTimeout(t)};function $r(t,e){if(e)return t.slice();var n=t.length,i=Ae?Ae(n):new t.constructor(n);return t.copy(i),i}function Zr(t){var e=new t.constructor(t.byteLength);return new we(e).set(new we(t)),e}function Jr(t,e){var n=e?Zr(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function Qr(t,e){if(t!==e){var n=t!==o,i=null===t,r=t==t,s=ka(t),a=e!==o,c=null===e,l=e==e,u=ka(e);if(!c&&!u&&!s&&t>e||s&&a&&l&&!c&&!u||i&&a&&l||!n&&l||!r)return 1;if(!i&&!s&&!u&&t<e||u&&n&&r&&!i&&!s||c&&n&&r||!a&&r||!l)return-1}return 0}function to(t,e,n,r){for(var o=-1,s=t.length,a=n.length,c=-1,l=e.length,u=Vn(s-a,0),h=i(l+u),d=!r;++c<l;)h[c]=e[c];for(;++o<a;)(d||o<s)&&(h[n[o]]=t[o]);for(;u--;)h[c++]=t[o++];return h}function eo(t,e,n,r){for(var o=-1,s=t.length,a=-1,c=n.length,l=-1,u=e.length,h=Vn(s-c,0),d=i(h+u),f=!r;++o<h;)d[o]=t[o];for(var p=o;++l<u;)d[p+l]=e[l];for(;++a<c;)(f||o<s)&&(d[p+n[a]]=t[o++]);return d}function no(t,e){var n=-1,r=t.length;for(e||(e=i(r));++n<r;)e[n]=t[n];return e}function io(t,e,n,i){var r=!n;n||(n={});for(var s=-1,a=e.length;++s<a;){var c=e[s],l=i?i(n[c],t[c],c,n,t):o;l===o&&(l=t[c]),r?Pi(n,c,l):Ai(n,c,l)}return n}function ro(t,e){return function(n,i){var r=ma(n)?Ye:Ii,o=e?e():{};return r(n,t,Fo(i,2),o)}}function oo(t){return Er(function(e,n){var i=-1,r=n.length,s=r>1?n[r-1]:o,a=r>2?n[2]:o;for(s=t.length>3&&"function"==typeof s?(r--,s):o,a&&qo(n[0],n[1],a)&&(s=r<3?o:s,r=1),e=ee(e);++i<r;){var c=n[i];c&&t(e,c,i,s)}return e})}function so(t,e){return function(n,i){if(null==n)return n;if(!va(n))return t(n,i);for(var r=n.length,o=e?r:-1,s=ee(n);(e?o--:++o<r)&&!1!==i(s[o],o,s););return n}}function ao(t){return function(e,n,i){for(var r=-1,o=ee(e),s=i(e),a=s.length;a--;){var c=s[t?a:++r];if(!1===n(o[c],c,o))break}return e}}function co(t){return function(e){var n=Sn(e=Va(e))?Pn(e):o,i=n?n[0]:e.charAt(0),r=n?Xr(n,1).join(""):e.slice(1);return i[t]()+r}}function lo(t){return function(e){return en(Tc(_c(e).replace(ye,"")),t,"")}}function uo(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=pi(t.prototype),i=t.apply(n,e);return Ra(i)?i:n}}function ho(t){return function(e,n,i){var r=ee(e);if(!va(e)){var s=Fo(n,3);e=rc(e),n=function(t){return s(r[t],t,r)}}var a=t(e,n,i);return a>-1?r[s?e[a]:a]:o}}function fo(t){return Io(function(e){var n=e.length,i=n,r=_i.prototype.thru;for(t&&e.reverse();i--;){var s=e[i];if("function"!=typeof s)throw new re(c);if(r&&!a&&"wrapper"==Do(s))var a=new _i([],!0)}for(i=a?i:n;++i<n;){var l=Do(s=e[i]),u="wrapper"==l?Lo(s):o;a=u&&Ko(u[0])&&u[1]==(T|b|w|S)&&!u[4].length&&1==u[9]?a[Do(u[0])].apply(a,u[3]):1==s.length&&Ko(s)?a[l]():a.thru(s)}return function(){var t=arguments,i=t[0];if(a&&1==t.length&&ma(i))return a.plant(i).value();for(var r=0,o=n?e[r].apply(this,t):i;++r<n;)o=e[r].call(this,o);return o}})}function po(t,e,n,r,s,a,c,l,u,h){var d=e&T,f=e&m,p=e&y,g=e&(b|C),_=e&x,v=p?o:uo(t);return function m(){for(var y=arguments.length,b=i(y),C=y;C--;)b[C]=arguments[C];if(g)var w=ko(m),E=function(t,e){for(var n=t.length,i=0;n--;)t[n]===e&&++i;return i}(b,w);if(r&&(b=to(b,r,s,g)),a&&(b=eo(b,a,c,g)),y-=E,g&&y<h){var T=An(b,w);return Co(t,e,po,m.placeholder,n,b,T,l,u,h-y)}var S=f?n:this,x=p?S[t]:t;return y=b.length,l?b=function(t,e){var n=t.length,i=Yn(e.length,n),r=no(t);for(;i--;){var s=e[i];t[i]=Yo(s,n)?r[s]:o}return t}(b,l):_&&y>1&&b.reverse(),d&&u<y&&(b.length=u),this&&this!==Le&&this instanceof m&&(x=v||uo(x)),x.apply(S,b)}}function go(t,e){return function(n,i){return function(t,e,n,i){return qi(t,function(t,r,o){e(i,n(t),r,o)}),i}(n,t,e(i),{})}}function _o(t,e){return function(n,i){var r;if(n===o&&i===o)return e;if(n!==o&&(r=n),i!==o){if(r===o)return i;"string"==typeof n||"string"==typeof i?(n=Fr(n),i=Fr(i)):(n=kr(n),i=kr(i)),r=t(n,i)}return r}}function mo(t){return Io(function(e){return e=Qe(e,mn(Fo())),Er(function(n){var i=this;return t(e,function(t){return Ve(t,i,n)})})})}function yo(t,e){var n=(e=e===o?" ":Fr(e)).length;if(n<2)return n?wr(e,t):e;var i=wr(e,jn(t/Mn(e)));return Sn(e)?Xr(Pn(i),0,t).join(""):i.slice(0,t)}function vo(t){return function(e,n,r){return r&&"number"!=typeof r&&qo(e,n,r)&&(n=r=o),e=za(e),n===o?(n=e,e=0):n=za(n),function(t,e,n,r){for(var o=-1,s=Vn(jn((e-t)/(n||1)),0),a=i(s);s--;)a[r?s:++o]=t,t+=n;return a}(e,n,r=r===o?e<n?1:-1:za(r),t)}}function bo(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=Wa(e),n=Wa(n)),t(e,n)}}function Co(t,e,n,i,r,s,a,c,l,u){var h=e&b;e|=h?w:E,(e&=~(h?E:w))&v||(e&=~(m|y));var d=[t,e,r,h?s:o,h?a:o,h?o:s,h?o:a,c,l,u],f=n.apply(o,d);return Ko(t)&&is(f,d),f.placeholder=i,ss(f,t,e)}function wo(t){var e=te[t];return function(t,n){if(t=Wa(t),(n=null==n?0:Yn(Ua(n),292))&&Hn(t)){var i=(Va(t)+"e").split("e");return+((i=(Va(e(i[0]+"e"+(+i[1]+n)))+"e").split("e"))[0]+"e"+(+i[1]-n))}return e(t)}}var Eo=ti&&1/On(new ti([,-0]))[1]==L?function(t){return new ti(t)}:kc;function To(t){return function(e){var n=Ho(e);return n==$?xn(e):n==nt?In(e):function(t,e){return Qe(e,function(e){return[e,t[e]]})}(e,t(e))}}function So(t,e,n,r,s,a,l,u){var d=e&y;if(!d&&"function"!=typeof t)throw new re(c);var f=r?r.length:0;if(f||(e&=~(w|E),r=s=o),l=l===o?l:Vn(Ua(l),0),u=u===o?u:Ua(u),f-=s?s.length:0,e&E){var p=r,g=s;r=s=o}var _=d?o:Lo(t),x=[t,e,n,r,s,p,g,a,l,u];if(_&&function(t,e){var n=t[1],i=e[1],r=n|i,o=r<(m|y|T),s=i==T&&n==b||i==T&&n==S&&t[7].length<=e[8]||i==(T|S)&&e[7].length<=e[8]&&n==b;if(!o&&!s)return t;i&m&&(t[2]=e[2],r|=n&m?0:v);var a=e[3];if(a){var c=t[3];t[3]=c?to(c,a,e[4]):a,t[4]=c?An(t[3],h):e[4]}(a=e[5])&&(c=t[5],t[5]=c?eo(c,a,e[6]):a,t[6]=c?An(t[5],h):e[6]);(a=e[7])&&(t[7]=a);i&T&&(t[8]=null==t[8]?e[8]:Yn(t[8],e[8]));null==t[9]&&(t[9]=e[9]);t[0]=e[0],t[1]=r}(x,_),t=x[0],e=x[1],n=x[2],r=x[3],s=x[4],!(u=x[9]=x[9]===o?d?0:t.length:Vn(x[9]-f,0))&&e&(b|C)&&(e&=~(b|C)),e&&e!=m)R=e==b||e==C?function(t,e,n){var r=uo(t);return function s(){for(var a=arguments.length,c=i(a),l=a,u=ko(s);l--;)c[l]=arguments[l];var h=a<3&&c[0]!==u&&c[a-1]!==u?[]:An(c,u);return(a-=h.length)<n?Co(t,e,po,s.placeholder,o,c,h,o,o,n-a):Ve(this&&this!==Le&&this instanceof s?r:t,this,c)}}(t,e,u):e!=w&&e!=(m|w)||s.length?po.apply(o,x):function(t,e,n,r){var o=e&m,s=uo(t);return function e(){for(var a=-1,c=arguments.length,l=-1,u=r.length,h=i(u+c),d=this&&this!==Le&&this instanceof e?s:t;++l<u;)h[l]=r[l];for(;c--;)h[l++]=arguments[++a];return Ve(d,o?n:this,h)}}(t,e,n,r);else var R=function(t,e,n){var i=e&m,r=uo(t);return function e(){return(this&&this!==Le&&this instanceof e?r:t).apply(i?n:this,arguments)}}(t,e,n);return ss((_?Rr:is)(R,x),t,e)}function xo(t,e,n,i){return t===o||fa(t,ae[n])&&!ue.call(i,n)?e:t}function Ro(t,e,n,i,r,s){return Ra(t)&&Ra(e)&&(s.set(e,t),gr(t,e,o,Ro,s),s.delete(e)),t}function Ao(t){return Ma(t)?o:t}function Oo(t,e,n,i,r,s){var a=n&g,c=t.length,l=e.length;if(c!=l&&!(a&&l>c))return!1;var u=s.get(t);if(u&&s.get(e))return u==e;var h=-1,d=!0,f=n&_?new Ci:o;for(s.set(t,e),s.set(e,t);++h<c;){var p=t[h],m=e[h];if(i)var y=a?i(m,p,h,e,t,s):i(p,m,h,t,e,s);if(y!==o){if(y)continue;d=!1;break}if(f){if(!rn(e,function(t,e){if(!vn(f,e)&&(p===t||r(p,t,n,i,s)))return f.push(e)})){d=!1;break}}else if(p!==m&&!r(p,m,n,i,s)){d=!1;break}}return s.delete(t),s.delete(e),d}function Io(t){return os(ts(t,o,ys),t+"")}function Mo(t){return Zi(t,rc,zo)}function Po(t){return Zi(t,oc,Uo)}var Lo=ii?function(t){return ii.get(t)}:kc;function Do(t){for(var e=t.name+"",n=ri[e],i=ue.call(ri,e)?n.length:0;i--;){var r=n[i],o=r.func;if(null==o||o==t)return r.name}return e}function ko(t){return(ue.call(fi,"placeholder")?fi:t).placeholder}function Fo(){var t=fi.iteratee||Mc;return t=t===Mc?cr:t,arguments.length?t(arguments[0],arguments[1]):t}function No(t,e){var n,i,r=t.__data__;return("string"==(i=typeof(n=e))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?r["string"==typeof e?"string":"hash"]:r.map}function jo(t){for(var e=rc(t),n=e.length;n--;){var i=e[n],r=t[i];e[n]=[i,r,Jo(r)]}return e}function Bo(t,e){var n=function(t,e){return null==t?o:t[e]}(t,e);return ar(n)?n:o}var zo=zn?function(t){return null==t?[]:(t=ee(t),$e(zn(t),function(e){return De.call(t,e)}))}:Hc,Uo=zn?function(t){for(var e=[];t;)tn(e,zo(t)),t=Me(t);return e}:Hc,Ho=Ji;function Wo(t,e,n){for(var i=-1,r=(e=Yr(e,t)).length,o=!1;++i<r;){var s=us(e[i]);if(!(o=null!=t&&n(t,s)))break;t=t[s]}return o||++i!=r?o:!!(r=null==t?0:t.length)&&xa(r)&&Yo(s,r)&&(ma(t)||_a(t))}function Go(t){return"function"!=typeof t.constructor||Zo(t)?{}:pi(Me(t))}function Vo(t){return ma(t)||_a(t)||!!(Ne&&t&&t[Ne])}function Yo(t,e){var n=typeof t;return!!(e=null==e?D:e)&&("number"==n||"symbol"!=n&&Xt.test(t))&&t>-1&&t%1==0&&t<e}function qo(t,e,n){if(!Ra(n))return!1;var i=typeof e;return!!("number"==i?va(n)&&Yo(e,n.length):"string"==i&&e in n)&&fa(n[e],t)}function Xo(t,e){if(ma(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!ka(t))||(It.test(t)||!Ot.test(t)||null!=e&&t in ee(e))}function Ko(t){var e=Do(t),n=fi[e];if("function"!=typeof n||!(e in mi.prototype))return!1;if(t===n)return!0;var i=Lo(n);return!!i&&t===i[0]}(Zn&&Ho(new Zn(new ArrayBuffer(1)))!=lt||Jn&&Ho(new Jn)!=$||Qn&&"[object Promise]"!=Ho(Qn.resolve())||ti&&Ho(new ti)!=nt||ei&&Ho(new ei)!=st)&&(Ho=function(t){var e=Ji(t),n=e==Q?t.constructor:o,i=n?hs(n):"";if(i)switch(i){case oi:return lt;case si:return $;case ai:return"[object Promise]";case ci:return nt;case li:return st}return e});var $o=ce?Ta:Wc;function Zo(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||ae)}function Jo(t){return t==t&&!Ra(t)}function Qo(t,e){return function(n){return null!=n&&(n[t]===e&&(e!==o||t in ee(n)))}}function ts(t,e,n){return e=Vn(e===o?t.length-1:e,0),function(){for(var r=arguments,o=-1,s=Vn(r.length-e,0),a=i(s);++o<s;)a[o]=r[e+o];o=-1;for(var c=i(e+1);++o<e;)c[o]=r[o];return c[e]=n(a),Ve(t,this,c)}}function es(t,e){return e.length<2?t:$i(t,Ir(e,0,-1))}function ns(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var is=as(Rr),rs=Nn||function(t,e){return Le.setTimeout(t,e)},os=as(Ar);function ss(t,e,n){var i=e+"";return os(t,function(t,e){var n=e.length;if(!n)return t;var i=n-1;return e[i]=(n>1?"& ":"")+e[i],e=e.join(n>2?", ":" "),t.replace(Nt,"{\n/* [wrapped with "+e+"] */\n")}(i,function(t,e){return qe(z,function(n){var i="_."+n[0];e&n[1]&&!Ze(t,i)&&t.push(i)}),t.sort()}(function(t){var e=t.match(jt);return e?e[1].split(Bt):[]}(i),n)))}function as(t){var e=0,n=0;return function(){var i=qn(),r=I-(i-n);if(n=i,r>0){if(++e>=O)return arguments[0]}else e=0;return t.apply(o,arguments)}}function cs(t,e){var n=-1,i=t.length,r=i-1;for(e=e===o?i:e;++n<e;){var s=Cr(n,r),a=t[s];t[s]=t[n],t[n]=a}return t.length=e,t}var ls=function(t){var e=aa(t,function(t){return n.size===u&&n.clear(),t}),n=e.cache;return e}(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(Mt,function(t,n,i,r){e.push(i?r.replace(Ut,"$1"):n||t)}),e});function us(t){if("string"==typeof t||ka(t))return t;var e=t+"";return"0"==e&&1/t==-L?"-0":e}function hs(t){if(null!=t){try{return le.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function ds(t){if(t instanceof mi)return t.clone();var e=new _i(t.__wrapped__,t.__chain__);return e.__actions__=no(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var fs=Er(function(t,e){return ba(t)?ji(t,Gi(e,1,ba,!0)):[]}),ps=Er(function(t,e){var n=Es(e);return ba(n)&&(n=o),ba(t)?ji(t,Gi(e,1,ba,!0),Fo(n,2)):[]}),gs=Er(function(t,e){var n=Es(e);return ba(n)&&(n=o),ba(t)?ji(t,Gi(e,1,ba,!0),o,n):[]});function _s(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var r=null==n?0:Ua(n);return r<0&&(r=Vn(i+r,0)),an(t,Fo(e,3),r)}function ms(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var r=i-1;return n!==o&&(r=Ua(n),r=n<0?Vn(i+r,0):Yn(r,i-1)),an(t,Fo(e,3),r,!0)}function ys(t){return(null==t?0:t.length)?Gi(t,1):[]}function vs(t){return t&&t.length?t[0]:o}var bs=Er(function(t){var e=Qe(t,Gr);return e.length&&e[0]===t[0]?nr(e):[]}),Cs=Er(function(t){var e=Es(t),n=Qe(t,Gr);return e===Es(n)?e=o:n.pop(),n.length&&n[0]===t[0]?nr(n,Fo(e,2)):[]}),ws=Er(function(t){var e=Es(t),n=Qe(t,Gr);return(e="function"==typeof e?e:o)&&n.pop(),n.length&&n[0]===t[0]?nr(n,o,e):[]});function Es(t){var e=null==t?0:t.length;return e?t[e-1]:o}var Ts=Er(Ss);function Ss(t,e){return t&&t.length&&e&&e.length?vr(t,e):t}var xs=Io(function(t,e){var n=null==t?0:t.length,i=Li(t,e);return br(t,Qe(e,function(t){return Yo(t,n)?+t:t}).sort(Qr)),i});function Rs(t){return null==t?t:$n.call(t)}var As=Er(function(t){return Nr(Gi(t,1,ba,!0))}),Os=Er(function(t){var e=Es(t);return ba(e)&&(e=o),Nr(Gi(t,1,ba,!0),Fo(e,2))}),Is=Er(function(t){var e=Es(t);return e="function"==typeof e?e:o,Nr(Gi(t,1,ba,!0),o,e)});function Ms(t){if(!t||!t.length)return[];var e=0;return t=$e(t,function(t){if(ba(t))return e=Vn(t.length,e),!0}),_n(e,function(e){return Qe(t,dn(e))})}function Ps(t,e){if(!t||!t.length)return[];var n=Ms(t);return null==e?n:Qe(n,function(t){return Ve(e,o,t)})}var Ls=Er(function(t,e){return ba(t)?ji(t,e):[]}),Ds=Er(function(t){return Hr($e(t,ba))}),ks=Er(function(t){var e=Es(t);return ba(e)&&(e=o),Hr($e(t,ba),Fo(e,2))}),Fs=Er(function(t){var e=Es(t);return e="function"==typeof e?e:o,Hr($e(t,ba),o,e)}),Ns=Er(Ms);var js=Er(function(t){var e=t.length,n=e>1?t[e-1]:o;return n="function"==typeof n?(t.pop(),n):o,Ps(t,n)});function Bs(t){var e=fi(t);return e.__chain__=!0,e}function zs(t,e){return e(t)}var Us=Io(function(t){var e=t.length,n=e?t[0]:0,i=this.__wrapped__,r=function(e){return Li(e,t)};return!(e>1||this.__actions__.length)&&i instanceof mi&&Yo(n)?((i=i.slice(n,+n+(e?1:0))).__actions__.push({func:zs,args:[r],thisArg:o}),new _i(i,this.__chain__).thru(function(t){return e&&!t.length&&t.push(o),t})):this.thru(r)});var Hs=ro(function(t,e,n){ue.call(t,n)?++t[n]:Pi(t,n,1)});var Ws=ho(_s),Gs=ho(ms);function Vs(t,e){return(ma(t)?qe:Bi)(t,Fo(e,3))}function Ys(t,e){return(ma(t)?Xe:zi)(t,Fo(e,3))}var qs=ro(function(t,e,n){ue.call(t,n)?t[n].push(e):Pi(t,n,[e])});var Xs=Er(function(t,e,n){var r=-1,o="function"==typeof e,s=va(t)?i(t.length):[];return Bi(t,function(t){s[++r]=o?Ve(e,t,n):ir(t,e,n)}),s}),Ks=ro(function(t,e,n){Pi(t,n,e)});function $s(t,e){return(ma(t)?Qe:dr)(t,Fo(e,3))}var Zs=ro(function(t,e,n){t[n?0:1].push(e)},function(){return[[],[]]});var Js=Er(function(t,e){if(null==t)return[];var n=e.length;return n>1&&qo(t,e[0],e[1])?e=[]:n>2&&qo(e[0],e[1],e[2])&&(e=[e[0]]),mr(t,Gi(e,1),[])}),Qs=Fn||function(){return Le.Date.now()};function ta(t,e,n){return e=n?o:e,e=t&&null==e?t.length:e,So(t,T,o,o,o,o,e)}function ea(t,e){var n;if("function"!=typeof e)throw new re(c);return t=Ua(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=o),n}}var na=Er(function(t,e,n){var i=m;if(n.length){var r=An(n,ko(na));i|=w}return So(t,i,e,n,r)}),ia=Er(function(t,e,n){var i=m|y;if(n.length){var r=An(n,ko(ia));i|=w}return So(e,i,t,n,r)});function ra(t,e,n){var i,r,s,a,l,u,h=0,d=!1,f=!1,p=!0;if("function"!=typeof t)throw new re(c);function g(e){var n=i,s=r;return i=r=o,h=e,a=t.apply(s,n)}function _(t){var n=t-u;return u===o||n>=e||n<0||f&&t-h>=s}function m(){var t=Qs();if(_(t))return y(t);l=rs(m,function(t){var n=e-(t-u);return f?Yn(n,s-(t-h)):n}(t))}function y(t){return l=o,p&&i?g(t):(i=r=o,a)}function v(){var t=Qs(),n=_(t);if(i=arguments,r=this,u=t,n){if(l===o)return function(t){return h=t,l=rs(m,e),d?g(t):a}(u);if(f)return Kr(l),l=rs(m,e),g(u)}return l===o&&(l=rs(m,e)),a}return e=Wa(e)||0,Ra(n)&&(d=!!n.leading,s=(f="maxWait"in n)?Vn(Wa(n.maxWait)||0,e):s,p="trailing"in n?!!n.trailing:p),v.cancel=function(){l!==o&&Kr(l),h=0,i=u=r=l=o},v.flush=function(){return l===o?a:y(Qs())},v}var oa=Er(function(t,e){return Ni(t,1,e)}),sa=Er(function(t,e,n){return Ni(t,Wa(e)||0,n)});function aa(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new re(c);var n=function(){var i=arguments,r=e?e.apply(this,i):i[0],o=n.cache;if(o.has(r))return o.get(r);var s=t.apply(this,i);return n.cache=o.set(r,s)||o,s};return n.cache=new(aa.Cache||bi),n}function ca(t){if("function"!=typeof t)throw new re(c);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}aa.Cache=bi;var la=qr(function(t,e){var n=(e=1==e.length&&ma(e[0])?Qe(e[0],mn(Fo())):Qe(Gi(e,1),mn(Fo()))).length;return Er(function(i){for(var r=-1,o=Yn(i.length,n);++r<o;)i[r]=e[r].call(this,i[r]);return Ve(t,this,i)})}),ua=Er(function(t,e){var n=An(e,ko(ua));return So(t,w,o,e,n)}),ha=Er(function(t,e){var n=An(e,ko(ha));return So(t,E,o,e,n)}),da=Io(function(t,e){return So(t,S,o,o,o,e)});function fa(t,e){return t===e||t!=t&&e!=e}var pa=bo(Qi),ga=bo(function(t,e){return t>=e}),_a=rr(function(){return arguments}())?rr:function(t){return Aa(t)&&ue.call(t,"callee")&&!De.call(t,"callee")},ma=i.isArray,ya=Be?mn(Be):function(t){return Aa(t)&&Ji(t)==ct};function va(t){return null!=t&&xa(t.length)&&!Ta(t)}function ba(t){return Aa(t)&&va(t)}var Ca=Un||Wc,wa=ze?mn(ze):function(t){return Aa(t)&&Ji(t)==V};function Ea(t){if(!Aa(t))return!1;var e=Ji(t);return e==q||e==Y||"string"==typeof t.message&&"string"==typeof t.name&&!Ma(t)}function Ta(t){if(!Ra(t))return!1;var e=Ji(t);return e==X||e==K||e==W||e==tt}function Sa(t){return"number"==typeof t&&t==Ua(t)}function xa(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=D}function Ra(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function Aa(t){return null!=t&&"object"==typeof t}var Oa=Ue?mn(Ue):function(t){return Aa(t)&&Ho(t)==$};function Ia(t){return"number"==typeof t||Aa(t)&&Ji(t)==Z}function Ma(t){if(!Aa(t)||Ji(t)!=Q)return!1;var e=Me(t);if(null===e)return!0;var n=ue.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&le.call(n)==pe}var Pa=He?mn(He):function(t){return Aa(t)&&Ji(t)==et};var La=We?mn(We):function(t){return Aa(t)&&Ho(t)==nt};function Da(t){return"string"==typeof t||!ma(t)&&Aa(t)&&Ji(t)==it}function ka(t){return"symbol"==typeof t||Aa(t)&&Ji(t)==rt}var Fa=Ge?mn(Ge):function(t){return Aa(t)&&xa(t.length)&&!!xe[Ji(t)]};var Na=bo(hr),ja=bo(function(t,e){return t<=e});function Ba(t){if(!t)return[];if(va(t))return Da(t)?Pn(t):no(t);if(je&&t[je])return function(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}(t[je]());var e=Ho(t);return(e==$?xn:e==nt?On:fc)(t)}function za(t){return t?(t=Wa(t))===L||t===-L?(t<0?-1:1)*k:t==t?t:0:0===t?t:0}function Ua(t){var e=za(t),n=e%1;return e==e?n?e-n:e:0}function Ha(t){return t?Di(Ua(t),0,N):0}function Wa(t){if("number"==typeof t)return t;if(ka(t))return F;if(Ra(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Ra(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(Dt,"");var n=Vt.test(t);return n||qt.test(t)?Ie(t.slice(2),n?2:8):Gt.test(t)?F:+t}function Ga(t){return io(t,oc(t))}function Va(t){return null==t?"":Fr(t)}var Ya=oo(function(t,e){if(Zo(e)||va(e))io(e,rc(e),t);else for(var n in e)ue.call(e,n)&&Ai(t,n,e[n])}),qa=oo(function(t,e){io(e,oc(e),t)}),Xa=oo(function(t,e,n,i){io(e,oc(e),t,i)}),Ka=oo(function(t,e,n,i){io(e,rc(e),t,i)}),$a=Io(Li);var Za=Er(function(t,e){t=ee(t);var n=-1,i=e.length,r=i>2?e[2]:o;for(r&&qo(e[0],e[1],r)&&(i=1);++n<i;)for(var s=e[n],a=oc(s),c=-1,l=a.length;++c<l;){var u=a[c],h=t[u];(h===o||fa(h,ae[u])&&!ue.call(t,u))&&(t[u]=s[u])}return t}),Ja=Er(function(t){return t.push(o,Ro),Ve(ac,o,t)});function Qa(t,e,n){var i=null==t?o:$i(t,e);return i===o?n:i}function tc(t,e){return null!=t&&Wo(t,e,er)}var ec=go(function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=fe.call(e)),t[e]=n},Rc(Ic)),nc=go(function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=fe.call(e)),ue.call(t,e)?t[e].push(n):t[e]=[n]},Fo),ic=Er(ir);function rc(t){return va(t)?Ei(t):lr(t)}function oc(t){return va(t)?Ei(t,!0):ur(t)}var sc=oo(function(t,e,n){gr(t,e,n)}),ac=oo(function(t,e,n,i){gr(t,e,n,i)}),cc=Io(function(t,e){var n={};if(null==t)return n;var i=!1;e=Qe(e,function(e){return e=Yr(e,t),i||(i=e.length>1),e}),io(t,Po(t),n),i&&(n=ki(n,d|f|p,Ao));for(var r=e.length;r--;)jr(n,e[r]);return n});var lc=Io(function(t,e){return null==t?{}:function(t,e){return yr(t,e,function(e,n){return tc(t,n)})}(t,e)});function uc(t,e){if(null==t)return{};var n=Qe(Po(t),function(t){return[t]});return e=Fo(e),yr(t,n,function(t,n){return e(t,n[0])})}var hc=To(rc),dc=To(oc);function fc(t){return null==t?[]:yn(t,rc(t))}var pc=lo(function(t,e,n){return e=e.toLowerCase(),t+(n?gc(e):e)});function gc(t){return Ec(Va(t).toLowerCase())}function _c(t){return(t=Va(t))&&t.replace(Kt,wn).replace(ve,"")}var mc=lo(function(t,e,n){return t+(n?"-":"")+e.toLowerCase()}),yc=lo(function(t,e,n){return t+(n?" ":"")+e.toLowerCase()}),vc=co("toLowerCase");var bc=lo(function(t,e,n){return t+(n?"_":"")+e.toLowerCase()});var Cc=lo(function(t,e,n){return t+(n?" ":"")+Ec(e)});var wc=lo(function(t,e,n){return t+(n?" ":"")+e.toUpperCase()}),Ec=co("toUpperCase");function Tc(t,e,n){return t=Va(t),(e=n?o:e)===o?function(t){return Ee.test(t)}(t)?function(t){return t.match(Ce)||[]}(t):function(t){return t.match(zt)||[]}(t):t.match(e)||[]}var Sc=Er(function(t,e){try{return Ve(t,o,e)}catch(t){return Ea(t)?t:new Jt(t)}}),xc=Io(function(t,e){return qe(e,function(e){e=us(e),Pi(t,e,na(t[e],t))}),t});function Rc(t){return function(){return t}}var Ac=fo(),Oc=fo(!0);function Ic(t){return t}function Mc(t){return cr("function"==typeof t?t:ki(t,d))}var Pc=Er(function(t,e){return function(n){return ir(n,t,e)}}),Lc=Er(function(t,e){return function(n){return ir(t,n,e)}});function Dc(t,e,n){var i=rc(e),r=Ki(e,i);null!=n||Ra(e)&&(r.length||!i.length)||(n=e,e=t,t=this,r=Ki(e,rc(e)));var o=!(Ra(n)&&"chain"in n&&!n.chain),s=Ta(t);return qe(r,function(n){var i=e[n];t[n]=i,s&&(t.prototype[n]=function(){var e=this.__chain__;if(o||e){var n=t(this.__wrapped__),r=n.__actions__=no(this.__actions__);return r.push({func:i,args:arguments,thisArg:t}),n.__chain__=e,n}return i.apply(t,tn([this.value()],arguments))})}),t}function kc(){}var Fc=mo(Qe),Nc=mo(Ke),jc=mo(rn);function Bc(t){return Xo(t)?dn(us(t)):function(t){return function(e){return $i(e,t)}}(t)}var zc=vo(),Uc=vo(!0);function Hc(){return[]}function Wc(){return!1}var Gc=_o(function(t,e){return t+e},0),Vc=wo("ceil"),Yc=_o(function(t,e){return t/e},1),qc=wo("floor");var Xc,Kc=_o(function(t,e){return t*e},1),$c=wo("round"),Zc=_o(function(t,e){return t-e},0);return fi.after=function(t,e){if("function"!=typeof e)throw new re(c);return t=Ua(t),function(){if(--t<1)return e.apply(this,arguments)}},fi.ary=ta,fi.assign=Ya,fi.assignIn=qa,fi.assignInWith=Xa,fi.assignWith=Ka,fi.at=$a,fi.before=ea,fi.bind=na,fi.bindAll=xc,fi.bindKey=ia,fi.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return ma(t)?t:[t]},fi.chain=Bs,fi.chunk=function(t,e,n){e=(n?qo(t,e,n):e===o)?1:Vn(Ua(e),0);var r=null==t?0:t.length;if(!r||e<1)return[];for(var s=0,a=0,c=i(jn(r/e));s<r;)c[a++]=Ir(t,s,s+=e);return c},fi.compact=function(t){for(var e=-1,n=null==t?0:t.length,i=0,r=[];++e<n;){var o=t[e];o&&(r[i++]=o)}return r},fi.concat=function(){var t=arguments.length;if(!t)return[];for(var e=i(t-1),n=arguments[0],r=t;r--;)e[r-1]=arguments[r];return tn(ma(n)?no(n):[n],Gi(e,1))},fi.cond=function(t){var e=null==t?0:t.length,n=Fo();return t=e?Qe(t,function(t){if("function"!=typeof t[1])throw new re(c);return[n(t[0]),t[1]]}):[],Er(function(n){for(var i=-1;++i<e;){var r=t[i];if(Ve(r[0],this,n))return Ve(r[1],this,n)}})},fi.conforms=function(t){return function(t){var e=rc(t);return function(n){return Fi(n,t,e)}}(ki(t,d))},fi.constant=Rc,fi.countBy=Hs,fi.create=function(t,e){var n=pi(t);return null==e?n:Mi(n,e)},fi.curry=function t(e,n,i){var r=So(e,b,o,o,o,o,o,n=i?o:n);return r.placeholder=t.placeholder,r},fi.curryRight=function t(e,n,i){var r=So(e,C,o,o,o,o,o,n=i?o:n);return r.placeholder=t.placeholder,r},fi.debounce=ra,fi.defaults=Za,fi.defaultsDeep=Ja,fi.defer=oa,fi.delay=sa,fi.difference=fs,fi.differenceBy=ps,fi.differenceWith=gs,fi.drop=function(t,e,n){var i=null==t?0:t.length;return i?Ir(t,(e=n||e===o?1:Ua(e))<0?0:e,i):[]},fi.dropRight=function(t,e,n){var i=null==t?0:t.length;return i?Ir(t,0,(e=i-(e=n||e===o?1:Ua(e)))<0?0:e):[]},fi.dropRightWhile=function(t,e){return t&&t.length?zr(t,Fo(e,3),!0,!0):[]},fi.dropWhile=function(t,e){return t&&t.length?zr(t,Fo(e,3),!0):[]},fi.fill=function(t,e,n,i){var r=null==t?0:t.length;return r?(n&&"number"!=typeof n&&qo(t,e,n)&&(n=0,i=r),function(t,e,n,i){var r=t.length;for((n=Ua(n))<0&&(n=-n>r?0:r+n),(i=i===o||i>r?r:Ua(i))<0&&(i+=r),i=n>i?0:Ha(i);n<i;)t[n++]=e;return t}(t,e,n,i)):[]},fi.filter=function(t,e){return(ma(t)?$e:Wi)(t,Fo(e,3))},fi.flatMap=function(t,e){return Gi($s(t,e),1)},fi.flatMapDeep=function(t,e){return Gi($s(t,e),L)},fi.flatMapDepth=function(t,e,n){return n=n===o?1:Ua(n),Gi($s(t,e),n)},fi.flatten=ys,fi.flattenDeep=function(t){return(null==t?0:t.length)?Gi(t,L):[]},fi.flattenDepth=function(t,e){return(null==t?0:t.length)?Gi(t,e=e===o?1:Ua(e)):[]},fi.flip=function(t){return So(t,x)},fi.flow=Ac,fi.flowRight=Oc,fi.fromPairs=function(t){for(var e=-1,n=null==t?0:t.length,i={};++e<n;){var r=t[e];i[r[0]]=r[1]}return i},fi.functions=function(t){return null==t?[]:Ki(t,rc(t))},fi.functionsIn=function(t){return null==t?[]:Ki(t,oc(t))},fi.groupBy=qs,fi.initial=function(t){return(null==t?0:t.length)?Ir(t,0,-1):[]},fi.intersection=bs,fi.intersectionBy=Cs,fi.intersectionWith=ws,fi.invert=ec,fi.invertBy=nc,fi.invokeMap=Xs,fi.iteratee=Mc,fi.keyBy=Ks,fi.keys=rc,fi.keysIn=oc,fi.map=$s,fi.mapKeys=function(t,e){var n={};return e=Fo(e,3),qi(t,function(t,i,r){Pi(n,e(t,i,r),t)}),n},fi.mapValues=function(t,e){var n={};return e=Fo(e,3),qi(t,function(t,i,r){Pi(n,i,e(t,i,r))}),n},fi.matches=function(t){return fr(ki(t,d))},fi.matchesProperty=function(t,e){return pr(t,ki(e,d))},fi.memoize=aa,fi.merge=sc,fi.mergeWith=ac,fi.method=Pc,fi.methodOf=Lc,fi.mixin=Dc,fi.negate=ca,fi.nthArg=function(t){return t=Ua(t),Er(function(e){return _r(e,t)})},fi.omit=cc,fi.omitBy=function(t,e){return uc(t,ca(Fo(e)))},fi.once=function(t){return ea(2,t)},fi.orderBy=function(t,e,n,i){return null==t?[]:(ma(e)||(e=null==e?[]:[e]),ma(n=i?o:n)||(n=null==n?[]:[n]),mr(t,e,n))},fi.over=Fc,fi.overArgs=la,fi.overEvery=Nc,fi.overSome=jc,fi.partial=ua,fi.partialRight=ha,fi.partition=Zs,fi.pick=lc,fi.pickBy=uc,fi.property=Bc,fi.propertyOf=function(t){return function(e){return null==t?o:$i(t,e)}},fi.pull=Ts,fi.pullAll=Ss,fi.pullAllBy=function(t,e,n){return t&&t.length&&e&&e.length?vr(t,e,Fo(n,2)):t},fi.pullAllWith=function(t,e,n){return t&&t.length&&e&&e.length?vr(t,e,o,n):t},fi.pullAt=xs,fi.range=zc,fi.rangeRight=Uc,fi.rearg=da,fi.reject=function(t,e){return(ma(t)?$e:Wi)(t,ca(Fo(e,3)))},fi.remove=function(t,e){var n=[];if(!t||!t.length)return n;var i=-1,r=[],o=t.length;for(e=Fo(e,3);++i<o;){var s=t[i];e(s,i,t)&&(n.push(s),r.push(i))}return br(t,r),n},fi.rest=function(t,e){if("function"!=typeof t)throw new re(c);return Er(t,e=e===o?e:Ua(e))},fi.reverse=Rs,fi.sampleSize=function(t,e,n){return e=(n?qo(t,e,n):e===o)?1:Ua(e),(ma(t)?Si:Sr)(t,e)},fi.set=function(t,e,n){return null==t?t:xr(t,e,n)},fi.setWith=function(t,e,n,i){return i="function"==typeof i?i:o,null==t?t:xr(t,e,n,i)},fi.shuffle=function(t){return(ma(t)?xi:Or)(t)},fi.slice=function(t,e,n){var i=null==t?0:t.length;return i?(n&&"number"!=typeof n&&qo(t,e,n)?(e=0,n=i):(e=null==e?0:Ua(e),n=n===o?i:Ua(n)),Ir(t,e,n)):[]},fi.sortBy=Js,fi.sortedUniq=function(t){return t&&t.length?Dr(t):[]},fi.sortedUniqBy=function(t,e){return t&&t.length?Dr(t,Fo(e,2)):[]},fi.split=function(t,e,n){return n&&"number"!=typeof n&&qo(t,e,n)&&(e=n=o),(n=n===o?N:n>>>0)?(t=Va(t))&&("string"==typeof e||null!=e&&!Pa(e))&&!(e=Fr(e))&&Sn(t)?Xr(Pn(t),0,n):t.split(e,n):[]},fi.spread=function(t,e){if("function"!=typeof t)throw new re(c);return e=null==e?0:Vn(Ua(e),0),Er(function(n){var i=n[e],r=Xr(n,0,e);return i&&tn(r,i),Ve(t,this,r)})},fi.tail=function(t){var e=null==t?0:t.length;return e?Ir(t,1,e):[]},fi.take=function(t,e,n){return t&&t.length?Ir(t,0,(e=n||e===o?1:Ua(e))<0?0:e):[]},fi.takeRight=function(t,e,n){var i=null==t?0:t.length;return i?Ir(t,(e=i-(e=n||e===o?1:Ua(e)))<0?0:e,i):[]},fi.takeRightWhile=function(t,e){return t&&t.length?zr(t,Fo(e,3),!1,!0):[]},fi.takeWhile=function(t,e){return t&&t.length?zr(t,Fo(e,3)):[]},fi.tap=function(t,e){return e(t),t},fi.throttle=function(t,e,n){var i=!0,r=!0;if("function"!=typeof t)throw new re(c);return Ra(n)&&(i="leading"in n?!!n.leading:i,r="trailing"in n?!!n.trailing:r),ra(t,e,{leading:i,maxWait:e,trailing:r})},fi.thru=zs,fi.toArray=Ba,fi.toPairs=hc,fi.toPairsIn=dc,fi.toPath=function(t){return ma(t)?Qe(t,us):ka(t)?[t]:no(ls(Va(t)))},fi.toPlainObject=Ga,fi.transform=function(t,e,n){var i=ma(t),r=i||Ca(t)||Fa(t);if(e=Fo(e,4),null==n){var o=t&&t.constructor;n=r?i?new o:[]:Ra(t)&&Ta(o)?pi(Me(t)):{}}return(r?qe:qi)(t,function(t,i,r){return e(n,t,i,r)}),n},fi.unary=function(t){return ta(t,1)},fi.union=As,fi.unionBy=Os,fi.unionWith=Is,fi.uniq=function(t){return t&&t.length?Nr(t):[]},fi.uniqBy=function(t,e){return t&&t.length?Nr(t,Fo(e,2)):[]},fi.uniqWith=function(t,e){return e="function"==typeof e?e:o,t&&t.length?Nr(t,o,e):[]},fi.unset=function(t,e){return null==t||jr(t,e)},fi.unzip=Ms,fi.unzipWith=Ps,fi.update=function(t,e,n){return null==t?t:Br(t,e,Vr(n))},fi.updateWith=function(t,e,n,i){return i="function"==typeof i?i:o,null==t?t:Br(t,e,Vr(n),i)},fi.values=fc,fi.valuesIn=function(t){return null==t?[]:yn(t,oc(t))},fi.without=Ls,fi.words=Tc,fi.wrap=function(t,e){return ua(Vr(e),t)},fi.xor=Ds,fi.xorBy=ks,fi.xorWith=Fs,fi.zip=Ns,fi.zipObject=function(t,e){return Wr(t||[],e||[],Ai)},fi.zipObjectDeep=function(t,e){return Wr(t||[],e||[],xr)},fi.zipWith=js,fi.entries=hc,fi.entriesIn=dc,fi.extend=qa,fi.extendWith=Xa,Dc(fi,fi),fi.add=Gc,fi.attempt=Sc,fi.camelCase=pc,fi.capitalize=gc,fi.ceil=Vc,fi.clamp=function(t,e,n){return n===o&&(n=e,e=o),n!==o&&(n=(n=Wa(n))==n?n:0),e!==o&&(e=(e=Wa(e))==e?e:0),Di(Wa(t),e,n)},fi.clone=function(t){return ki(t,p)},fi.cloneDeep=function(t){return ki(t,d|p)},fi.cloneDeepWith=function(t,e){return ki(t,d|p,e="function"==typeof e?e:o)},fi.cloneWith=function(t,e){return ki(t,p,e="function"==typeof e?e:o)},fi.conformsTo=function(t,e){return null==e||Fi(t,e,rc(e))},fi.deburr=_c,fi.defaultTo=function(t,e){return null==t||t!=t?e:t},fi.divide=Yc,fi.endsWith=function(t,e,n){t=Va(t),e=Fr(e);var i=t.length,r=n=n===o?i:Di(Ua(n),0,i);return(n-=e.length)>=0&&t.slice(n,r)==e},fi.eq=fa,fi.escape=function(t){return(t=Va(t))&&St.test(t)?t.replace(Et,En):t},fi.escapeRegExp=function(t){return(t=Va(t))&&Lt.test(t)?t.replace(Pt,"\\$&"):t},fi.every=function(t,e,n){var i=ma(t)?Ke:Ui;return n&&qo(t,e,n)&&(e=o),i(t,Fo(e,3))},fi.find=Ws,fi.findIndex=_s,fi.findKey=function(t,e){return sn(t,Fo(e,3),qi)},fi.findLast=Gs,fi.findLastIndex=ms,fi.findLastKey=function(t,e){return sn(t,Fo(e,3),Xi)},fi.floor=qc,fi.forEach=Vs,fi.forEachRight=Ys,fi.forIn=function(t,e){return null==t?t:Vi(t,Fo(e,3),oc)},fi.forInRight=function(t,e){return null==t?t:Yi(t,Fo(e,3),oc)},fi.forOwn=function(t,e){return t&&qi(t,Fo(e,3))},fi.forOwnRight=function(t,e){return t&&Xi(t,Fo(e,3))},fi.get=Qa,fi.gt=pa,fi.gte=ga,fi.has=function(t,e){return null!=t&&Wo(t,e,tr)},fi.hasIn=tc,fi.head=vs,fi.identity=Ic,fi.includes=function(t,e,n,i){t=va(t)?t:fc(t),n=n&&!i?Ua(n):0;var r=t.length;return n<0&&(n=Vn(r+n,0)),Da(t)?n<=r&&t.indexOf(e,n)>-1:!!r&&cn(t,e,n)>-1},fi.indexOf=function(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var r=null==n?0:Ua(n);return r<0&&(r=Vn(i+r,0)),cn(t,e,r)},fi.inRange=function(t,e,n){return e=za(e),n===o?(n=e,e=0):n=za(n),function(t,e,n){return t>=Yn(e,n)&&t<Vn(e,n)}(t=Wa(t),e,n)},fi.invoke=ic,fi.isArguments=_a,fi.isArray=ma,fi.isArrayBuffer=ya,fi.isArrayLike=va,fi.isArrayLikeObject=ba,fi.isBoolean=function(t){return!0===t||!1===t||Aa(t)&&Ji(t)==G},fi.isBuffer=Ca,fi.isDate=wa,fi.isElement=function(t){return Aa(t)&&1===t.nodeType&&!Ma(t)},fi.isEmpty=function(t){if(null==t)return!0;if(va(t)&&(ma(t)||"string"==typeof t||"function"==typeof t.splice||Ca(t)||Fa(t)||_a(t)))return!t.length;var e=Ho(t);if(e==$||e==nt)return!t.size;if(Zo(t))return!lr(t).length;for(var n in t)if(ue.call(t,n))return!1;return!0},fi.isEqual=function(t,e){return or(t,e)},fi.isEqualWith=function(t,e,n){var i=(n="function"==typeof n?n:o)?n(t,e):o;return i===o?or(t,e,o,n):!!i},fi.isError=Ea,fi.isFinite=function(t){return"number"==typeof t&&Hn(t)},fi.isFunction=Ta,fi.isInteger=Sa,fi.isLength=xa,fi.isMap=Oa,fi.isMatch=function(t,e){return t===e||sr(t,e,jo(e))},fi.isMatchWith=function(t,e,n){return n="function"==typeof n?n:o,sr(t,e,jo(e),n)},fi.isNaN=function(t){return Ia(t)&&t!=+t},fi.isNative=function(t){if($o(t))throw new Jt(a);return ar(t)},fi.isNil=function(t){return null==t},fi.isNull=function(t){return null===t},fi.isNumber=Ia,fi.isObject=Ra,fi.isObjectLike=Aa,fi.isPlainObject=Ma,fi.isRegExp=Pa,fi.isSafeInteger=function(t){return Sa(t)&&t>=-D&&t<=D},fi.isSet=La,fi.isString=Da,fi.isSymbol=ka,fi.isTypedArray=Fa,fi.isUndefined=function(t){return t===o},fi.isWeakMap=function(t){return Aa(t)&&Ho(t)==st},fi.isWeakSet=function(t){return Aa(t)&&Ji(t)==at},fi.join=function(t,e){return null==t?"":Wn.call(t,e)},fi.kebabCase=mc,fi.last=Es,fi.lastIndexOf=function(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var r=i;return n!==o&&(r=(r=Ua(n))<0?Vn(i+r,0):Yn(r,i-1)),e==e?function(t,e,n){for(var i=n+1;i--;)if(t[i]===e)return i;return i}(t,e,r):an(t,un,r,!0)},fi.lowerCase=yc,fi.lowerFirst=vc,fi.lt=Na,fi.lte=ja,fi.max=function(t){return t&&t.length?Hi(t,Ic,Qi):o},fi.maxBy=function(t,e){return t&&t.length?Hi(t,Fo(e,2),Qi):o},fi.mean=function(t){return hn(t,Ic)},fi.meanBy=function(t,e){return hn(t,Fo(e,2))},fi.min=function(t){return t&&t.length?Hi(t,Ic,hr):o},fi.minBy=function(t,e){return t&&t.length?Hi(t,Fo(e,2),hr):o},fi.stubArray=Hc,fi.stubFalse=Wc,fi.stubObject=function(){return{}},fi.stubString=function(){return""},fi.stubTrue=function(){return!0},fi.multiply=Kc,fi.nth=function(t,e){return t&&t.length?_r(t,Ua(e)):o},fi.noConflict=function(){return Le._===this&&(Le._=ge),this},fi.noop=kc,fi.now=Qs,fi.pad=function(t,e,n){t=Va(t);var i=(e=Ua(e))?Mn(t):0;if(!e||i>=e)return t;var r=(e-i)/2;return yo(Bn(r),n)+t+yo(jn(r),n)},fi.padEnd=function(t,e,n){t=Va(t);var i=(e=Ua(e))?Mn(t):0;return e&&i<e?t+yo(e-i,n):t},fi.padStart=function(t,e,n){t=Va(t);var i=(e=Ua(e))?Mn(t):0;return e&&i<e?yo(e-i,n)+t:t},fi.parseInt=function(t,e,n){return n||null==e?e=0:e&&(e=+e),Xn(Va(t).replace(kt,""),e||0)},fi.random=function(t,e,n){if(n&&"boolean"!=typeof n&&qo(t,e,n)&&(e=n=o),n===o&&("boolean"==typeof e?(n=e,e=o):"boolean"==typeof t&&(n=t,t=o)),t===o&&e===o?(t=0,e=1):(t=za(t),e===o?(e=t,t=0):e=za(e)),t>e){var i=t;t=e,e=i}if(n||t%1||e%1){var r=Kn();return Yn(t+r*(e-t+Oe("1e-"+((r+"").length-1))),e)}return Cr(t,e)},fi.reduce=function(t,e,n){var i=ma(t)?en:pn,r=arguments.length<3;return i(t,Fo(e,4),n,r,Bi)},fi.reduceRight=function(t,e,n){var i=ma(t)?nn:pn,r=arguments.length<3;return i(t,Fo(e,4),n,r,zi)},fi.repeat=function(t,e,n){return e=(n?qo(t,e,n):e===o)?1:Ua(e),wr(Va(t),e)},fi.replace=function(){var t=arguments,e=Va(t[0]);return t.length<3?e:e.replace(t[1],t[2])},fi.result=function(t,e,n){var i=-1,r=(e=Yr(e,t)).length;for(r||(r=1,t=o);++i<r;){var s=null==t?o:t[us(e[i])];s===o&&(i=r,s=n),t=Ta(s)?s.call(t):s}return t},fi.round=$c,fi.runInContext=t,fi.sample=function(t){return(ma(t)?Ti:Tr)(t)},fi.size=function(t){if(null==t)return 0;if(va(t))return Da(t)?Mn(t):t.length;var e=Ho(t);return e==$||e==nt?t.size:lr(t).length},fi.snakeCase=bc,fi.some=function(t,e,n){var i=ma(t)?rn:Mr;return n&&qo(t,e,n)&&(e=o),i(t,Fo(e,3))},fi.sortedIndex=function(t,e){return Pr(t,e)},fi.sortedIndexBy=function(t,e,n){return Lr(t,e,Fo(n,2))},fi.sortedIndexOf=function(t,e){var n=null==t?0:t.length;if(n){var i=Pr(t,e);if(i<n&&fa(t[i],e))return i}return-1},fi.sortedLastIndex=function(t,e){return Pr(t,e,!0)},fi.sortedLastIndexBy=function(t,e,n){return Lr(t,e,Fo(n,2),!0)},fi.sortedLastIndexOf=function(t,e){if(null==t?0:t.length){var n=Pr(t,e,!0)-1;if(fa(t[n],e))return n}return-1},fi.startCase=Cc,fi.startsWith=function(t,e,n){return t=Va(t),n=null==n?0:Di(Ua(n),0,t.length),e=Fr(e),t.slice(n,n+e.length)==e},fi.subtract=Zc,fi.sum=function(t){return t&&t.length?gn(t,Ic):0},fi.sumBy=function(t,e){return t&&t.length?gn(t,Fo(e,2)):0},fi.template=function(t,e,n){var i=fi.templateSettings;n&&qo(t,e,n)&&(e=o),t=Va(t),e=Xa({},e,i,xo);var r,s,a=Xa({},e.imports,i.imports,xo),c=rc(a),l=yn(a,c),u=0,h=e.interpolate||$t,d="__p += '",f=ne((e.escape||$t).source+"|"+h.source+"|"+(h===At?Ht:$t).source+"|"+(e.evaluate||$t).source+"|$","g"),p="//# sourceURL="+(ue.call(e,"sourceURL")?(e.sourceURL+"").replace(/[\r\n]/g," "):"lodash.templateSources["+ ++Se+"]")+"\n";t.replace(f,function(e,n,i,o,a,c){return i||(i=o),d+=t.slice(u,c).replace(Zt,Tn),n&&(r=!0,d+="' +\n__e("+n+") +\n'"),a&&(s=!0,d+="';\n"+a+";\n__p += '"),i&&(d+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),u=c+e.length,e}),d+="';\n";var g=ue.call(e,"variable")&&e.variable;g||(d="with (obj) {\n"+d+"\n}\n"),d=(s?d.replace(vt,""):d).replace(bt,"$1").replace(Ct,"$1;"),d="function("+(g||"obj")+") {\n"+(g?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(r?", __e = _.escape":"")+(s?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var _=Sc(function(){return Qt(c,p+"return "+d).apply(o,l)});if(_.source=d,Ea(_))throw _;return _},fi.times=function(t,e){if((t=Ua(t))<1||t>D)return[];var n=N,i=Yn(t,N);e=Fo(e),t-=N;for(var r=_n(i,e);++n<t;)e(n);return r},fi.toFinite=za,fi.toInteger=Ua,fi.toLength=Ha,fi.toLower=function(t){return Va(t).toLowerCase()},fi.toNumber=Wa,fi.toSafeInteger=function(t){return t?Di(Ua(t),-D,D):0===t?t:0},fi.toString=Va,fi.toUpper=function(t){return Va(t).toUpperCase()},fi.trim=function(t,e,n){if((t=Va(t))&&(n||e===o))return t.replace(Dt,"");if(!t||!(e=Fr(e)))return t;var i=Pn(t),r=Pn(e);return Xr(i,bn(i,r),Cn(i,r)+1).join("")},fi.trimEnd=function(t,e,n){if((t=Va(t))&&(n||e===o))return t.replace(Ft,"");if(!t||!(e=Fr(e)))return t;var i=Pn(t);return Xr(i,0,Cn(i,Pn(e))+1).join("")},fi.trimStart=function(t,e,n){if((t=Va(t))&&(n||e===o))return t.replace(kt,"");if(!t||!(e=Fr(e)))return t;var i=Pn(t);return Xr(i,bn(i,Pn(e))).join("")},fi.truncate=function(t,e){var n=R,i=A;if(Ra(e)){var r="separator"in e?e.separator:r;n="length"in e?Ua(e.length):n,i="omission"in e?Fr(e.omission):i}var s=(t=Va(t)).length;if(Sn(t)){var a=Pn(t);s=a.length}if(n>=s)return t;var c=n-Mn(i);if(c<1)return i;var l=a?Xr(a,0,c).join(""):t.slice(0,c);if(r===o)return l+i;if(a&&(c+=l.length-c),Pa(r)){if(t.slice(c).search(r)){var u,h=l;for(r.global||(r=ne(r.source,Va(Wt.exec(r))+"g")),r.lastIndex=0;u=r.exec(h);)var d=u.index;l=l.slice(0,d===o?c:d)}}else if(t.indexOf(Fr(r),c)!=c){var f=l.lastIndexOf(r);f>-1&&(l=l.slice(0,f))}return l+i},fi.unescape=function(t){return(t=Va(t))&&Tt.test(t)?t.replace(wt,Ln):t},fi.uniqueId=function(t){var e=++he;return Va(t)+e},fi.upperCase=wc,fi.upperFirst=Ec,fi.each=Vs,fi.eachRight=Ys,fi.first=vs,Dc(fi,(Xc={},qi(fi,function(t,e){ue.call(fi.prototype,e)||(Xc[e]=t)}),Xc),{chain:!1}),fi.VERSION="4.17.15",qe(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){fi[t].placeholder=fi}),qe(["drop","take"],function(t,e){mi.prototype[t]=function(n){n=n===o?1:Vn(Ua(n),0);var i=this.__filtered__&&!e?new mi(this):this.clone();return i.__filtered__?i.__takeCount__=Yn(n,i.__takeCount__):i.__views__.push({size:Yn(n,N),type:t+(i.__dir__<0?"Right":"")}),i},mi.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}}),qe(["filter","map","takeWhile"],function(t,e){var n=e+1,i=n==M||3==n;mi.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:Fo(t,3),type:n}),e.__filtered__=e.__filtered__||i,e}}),qe(["head","last"],function(t,e){var n="take"+(e?"Right":"");mi.prototype[t]=function(){return this[n](1).value()[0]}}),qe(["initial","tail"],function(t,e){var n="drop"+(e?"":"Right");mi.prototype[t]=function(){return this.__filtered__?new mi(this):this[n](1)}}),mi.prototype.compact=function(){return this.filter(Ic)},mi.prototype.find=function(t){return this.filter(t).head()},mi.prototype.findLast=function(t){return this.reverse().find(t)},mi.prototype.invokeMap=Er(function(t,e){return"function"==typeof t?new mi(this):this.map(function(n){return ir(n,t,e)})}),mi.prototype.reject=function(t){return this.filter(ca(Fo(t)))},mi.prototype.slice=function(t,e){t=Ua(t);var n=this;return n.__filtered__&&(t>0||e<0)?new mi(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),e!==o&&(n=(e=Ua(e))<0?n.dropRight(-e):n.take(e-t)),n)},mi.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},mi.prototype.toArray=function(){return this.take(N)},qi(mi.prototype,function(t,e){var n=/^(?:filter|find|map|reject)|While$/.test(e),i=/^(?:head|last)$/.test(e),r=fi[i?"take"+("last"==e?"Right":""):e],s=i||/^find/.test(e);r&&(fi.prototype[e]=function(){var e=this.__wrapped__,a=i?[1]:arguments,c=e instanceof mi,l=a[0],u=c||ma(e),h=function(t){var e=r.apply(fi,tn([t],a));return i&&d?e[0]:e};u&&n&&"function"==typeof l&&1!=l.length&&(c=u=!1);var d=this.__chain__,f=!!this.__actions__.length,p=s&&!d,g=c&&!f;if(!s&&u){e=g?e:new mi(this);var _=t.apply(e,a);return _.__actions__.push({func:zs,args:[h],thisArg:o}),new _i(_,d)}return p&&g?t.apply(this,a):(_=this.thru(h),p?i?_.value()[0]:_.value():_)})}),qe(["pop","push","shift","sort","splice","unshift"],function(t){var e=oe[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",i=/^(?:pop|shift)$/.test(t);fi.prototype[t]=function(){var t=arguments;if(i&&!this.__chain__){var r=this.value();return e.apply(ma(r)?r:[],t)}return this[n](function(n){return e.apply(ma(n)?n:[],t)})}}),qi(mi.prototype,function(t,e){var n=fi[e];if(n){var i=n.name+"";ue.call(ri,i)||(ri[i]=[]),ri[i].push({name:e,func:n})}}),ri[po(o,y).name]=[{name:"wrapper",func:o}],mi.prototype.clone=function(){var t=new mi(this.__wrapped__);return t.__actions__=no(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=no(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=no(this.__views__),t},mi.prototype.reverse=function(){if(this.__filtered__){var t=new mi(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},mi.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=ma(t),i=e<0,r=n?t.length:0,o=function(t,e,n){var i=-1,r=n.length;for(;++i<r;){var o=n[i],s=o.size;switch(o.type){case"drop":t+=s;break;case"dropRight":e-=s;break;case"take":e=Yn(e,t+s);break;case"takeRight":t=Vn(t,e-s)}}return{start:t,end:e}}(0,r,this.__views__),s=o.start,a=o.end,c=a-s,l=i?a:s-1,u=this.__iteratees__,h=u.length,d=0,f=Yn(c,this.__takeCount__);if(!n||!i&&r==c&&f==c)return Ur(t,this.__actions__);var p=[];t:for(;c--&&d<f;){for(var g=-1,_=t[l+=e];++g<h;){var m=u[g],y=m.iteratee,v=m.type,b=y(_);if(v==P)_=b;else if(!b){if(v==M)continue t;break t}}p[d++]=_}return p},fi.prototype.at=Us,fi.prototype.chain=function(){return Bs(this)},fi.prototype.commit=function(){return new _i(this.value(),this.__chain__)},fi.prototype.next=function(){this.__values__===o&&(this.__values__=Ba(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?o:this.__values__[this.__index__++]}},fi.prototype.plant=function(t){for(var e,n=this;n instanceof gi;){var i=ds(n);i.__index__=0,i.__values__=o,e?r.__wrapped__=i:e=i;var r=i;n=n.__wrapped__}return r.__wrapped__=t,e},fi.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof mi){var e=t;return this.__actions__.length&&(e=new mi(this)),(e=e.reverse()).__actions__.push({func:zs,args:[Rs],thisArg:o}),new _i(e,this.__chain__)}return this.thru(Rs)},fi.prototype.toJSON=fi.prototype.valueOf=fi.prototype.value=function(){return Ur(this.__wrapped__,this.__actions__)},fi.prototype.first=fi.prototype.head,je&&(fi.prototype[je]=function(){return this}),fi}();Le._=Dn,(r=function(){return Dn}.call(e,n,e,i))===o||(i.exports=r)}).call(this)}).call(this,n(26),n(64)(t))},function(t,e,n){"use strict";
/*!
 * assign-symbols <https://github.com/jonschlinkert/assign-symbols>
 *
 * Copyright (c) 2015-present, Jon Schlinkert.
 * Licensed under the MIT License.
 */const i=Object.prototype.toString,r=Object.prototype.propertyIsEnumerable,o=Object.getOwnPropertySymbols;t.exports=(t,...e)=>{if(!function(t){return"function"==typeof t||"[object Object]"===i.call(t)||Array.isArray(t)}(t))throw new TypeError("expected the first argument to be an object");if(0===e.length||"function"!=typeof Symbol||"function"!=typeof o)return t;for(let n of e){let e=o(n);for(let i of e)r.call(n,i)&&(t[i]=n[i])}return t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(39),r=function(t){this.target=t,this.contentRect=i.ContentRect(t)};e.ResizeObserverEntry=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(39),r=function(){function t(t){this.target=t,this.$$broadcastWidth=this.$$broadcastHeight=0}return Object.defineProperty(t.prototype,"broadcastWidth",{get:function(){return this.$$broadcastWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"broadcastHeight",{get:function(){return this.$$broadcastHeight},enumerable:!0,configurable:!0}),t.prototype.isActive=function(){var t=i.ContentRect(this.target);return!!t&&(t.width!==this.broadcastWidth||t.height!==this.broadcastHeight)},t}();e.ResizeObservation=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.multiBindToService=function(t){return function(e){return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return n.forEach(function(n){return t.bind(n).toService(e)})}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(7),r=n(6),o=n(8);e.postConstruct=function(){return function(t,e,n){var s=new o.Metadata(r.POST_CONSTRUCT,e);if(Reflect.hasOwnMetadata(r.POST_CONSTRUCT,t.constructor))throw new Error(i.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(r.POST_CONSTRUCT,s,t.constructor)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(6),r=n(8),o=n(10);e.targetName=function(t){return function(e,n,s){var a=new r.Metadata(i.NAME_TAG,t);o.tagParameter(e,n,s,a)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(6),r=n(8),o=n(10);e.multiInject=function(t){return function(e,n,s){var a=new r.Metadata(i.MULTI_INJECT_TAG,t);"number"==typeof s?o.tagParameter(e,n,s,a):o.tagProperty(e,n,a)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(6),r=n(8),o=n(10);e.unmanaged=function(){return function(t,e,n){var s=new r.Metadata(i.UNMANAGED_TAG,!0);o.tagParameter(t,e,n,s)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(6),r=n(8),o=n(10);e.optional=function(){return function(t,e,n){var s=new r.Metadata(i.OPTIONAL_TAG,!0);"number"==typeof n?o.tagParameter(t,e,n,s):o.tagProperty(t,e,s)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(6),r=n(8),o=n(10);e.named=function(t){return function(e,n,s){var a=new r.Metadata(i.NAMED_TAG,t);"number"==typeof s?o.tagParameter(e,n,s,a):o.tagProperty(e,n,a)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(8),r=n(10);e.tagged=function(t,e){return function(n,o,s){var a=new i.Metadata(t,e);"number"==typeof s?r.tagParameter(n,o,s,a):r.tagProperty(n,o,a)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(7),r=n(6);e.injectable=function(){return function(t){if(Reflect.hasOwnMetadata(r.PARAM_TYPES,t))throw new Error(i.DUPLICATED_INJECTABLE_DECORATOR);var e=Reflect.getMetadata(r.DESIGN_PARAM_TYPES,t)||[];return Reflect.defineMetadata(r.PARAM_TYPES,e,t),t}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(11),r=function(t){this.id=i.id(),this.registry=t};e.ContainerModule=r;var o=function(t){this.id=i.id(),this.registry=t};e.AsyncContainerModule=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(7),r=function(){function t(){this._map=new Map}return t.prototype.getMap=function(){return this._map},t.prototype.add=function(t,e){if(null==t)throw new Error(i.NULL_ARGUMENT);if(null==e)throw new Error(i.NULL_ARGUMENT);var n=this._map.get(t);void 0!==n?(n.push(e),this._map.set(t,n)):this._map.set(t,[e])},t.prototype.get=function(t){if(null==t)throw new Error(i.NULL_ARGUMENT);var e=this._map.get(t);if(void 0!==e)return e;throw new Error(i.KEY_NOT_FOUND)},t.prototype.remove=function(t){if(null==t)throw new Error(i.NULL_ARGUMENT);if(!this._map.delete(t))throw new Error(i.KEY_NOT_FOUND)},t.prototype.removeByCondition=function(t){var e=this;this._map.forEach(function(n,i){var r=n.filter(function(e){return!t(e)});r.length>0?e._map.set(i,r):e._map.delete(i)})},t.prototype.hasKey=function(t){if(null==t)throw new Error(i.NULL_ARGUMENT);return this._map.has(t)},t.prototype.clone=function(){var e=new t;return this._map.forEach(function(t,n){t.forEach(function(t){return e.add(n,t.clone())})}),e},t.prototype.traverse=function(t){this._map.forEach(function(e,n){t(n,e)})},t}();e.Lookup=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){}return t.of=function(e,n){var i=new t;return i.bindings=e,i.middleware=n,i},t}();e.ContainerSnapshot=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(9),r=n(41),o=function(){function t(t){this._binding=t}return t.prototype.inRequestScope=function(){return this._binding.scope=i.BindingScopeEnum.Request,new r.BindingWhenOnSyntax(this._binding)},t.prototype.inSingletonScope=function(){return this._binding.scope=i.BindingScopeEnum.Singleton,new r.BindingWhenOnSyntax(this._binding)},t.prototype.inTransientScope=function(){return this._binding.scope=i.BindingScopeEnum.Transient,new r.BindingWhenOnSyntax(this._binding)},t}();e.BindingInSyntax=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(81),r=n(25),o=n(24),s=function(){function t(t){this._binding=t,this._bindingWhenSyntax=new o.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new r.BindingOnSyntax(this._binding),this._bindingInSyntax=new i.BindingInSyntax(t)}return t.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},t.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},t.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},t.prototype.when=function(t){return this._bindingWhenSyntax.when(t)},t.prototype.whenTargetNamed=function(t){return this._bindingWhenSyntax.whenTargetNamed(t)},t.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},t.prototype.whenTargetTagged=function(t,e){return this._bindingWhenSyntax.whenTargetTagged(t,e)},t.prototype.whenInjectedInto=function(t){return this._bindingWhenSyntax.whenInjectedInto(t)},t.prototype.whenParentNamed=function(t){return this._bindingWhenSyntax.whenParentNamed(t)},t.prototype.whenParentTagged=function(t,e){return this._bindingWhenSyntax.whenParentTagged(t,e)},t.prototype.whenAnyAncestorIs=function(t){return this._bindingWhenSyntax.whenAnyAncestorIs(t)},t.prototype.whenNoAncestorIs=function(t){return this._bindingWhenSyntax.whenNoAncestorIs(t)},t.prototype.whenAnyAncestorNamed=function(t){return this._bindingWhenSyntax.whenAnyAncestorNamed(t)},t.prototype.whenAnyAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenAnyAncestorTagged(t,e)},t.prototype.whenNoAncestorNamed=function(t){return this._bindingWhenSyntax.whenNoAncestorNamed(t)},t.prototype.whenNoAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenNoAncestorTagged(t,e)},t.prototype.whenAnyAncestorMatches=function(t){return this._bindingWhenSyntax.whenAnyAncestorMatches(t)},t.prototype.whenNoAncestorMatches=function(t){return this._bindingWhenSyntax.whenNoAncestorMatches(t)},t.prototype.onActivation=function(t){return this._bindingOnSyntax.onActivation(t)},t}();e.BindingInWhenOnSyntax=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(7),r=n(9),o=n(82),s=n(41),a=function(){function t(t){this._binding=t}return t.prototype.to=function(t){return this._binding.type=r.BindingTypeEnum.Instance,this._binding.implementationType=t,new o.BindingInWhenOnSyntax(this._binding)},t.prototype.toSelf=function(){if("function"!=typeof this._binding.serviceIdentifier)throw new Error(""+i.INVALID_TO_SELF_VALUE);var t=this._binding.serviceIdentifier;return this.to(t)},t.prototype.toConstantValue=function(t){return this._binding.type=r.BindingTypeEnum.ConstantValue,this._binding.cache=t,this._binding.dynamicValue=null,this._binding.implementationType=null,new s.BindingWhenOnSyntax(this._binding)},t.prototype.toDynamicValue=function(t){return this._binding.type=r.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=t,this._binding.implementationType=null,new o.BindingInWhenOnSyntax(this._binding)},t.prototype.toConstructor=function(t){return this._binding.type=r.BindingTypeEnum.Constructor,this._binding.implementationType=t,new s.BindingWhenOnSyntax(this._binding)},t.prototype.toFactory=function(t){return this._binding.type=r.BindingTypeEnum.Factory,this._binding.factory=t,new s.BindingWhenOnSyntax(this._binding)},t.prototype.toFunction=function(t){if("function"!=typeof t)throw new Error(i.INVALID_FUNCTION_BINDING);var e=this.toConstantValue(t);return this._binding.type=r.BindingTypeEnum.Function,e},t.prototype.toAutoFactory=function(t){return this._binding.type=r.BindingTypeEnum.Factory,this._binding.factory=function(e){return function(){return e.container.get(t)}},new s.BindingWhenOnSyntax(this._binding)},t.prototype.toProvider=function(t){return this._binding.type=r.BindingTypeEnum.Provider,this._binding.provider=t,new s.BindingWhenOnSyntax(this._binding)},t.prototype.toService=function(t){this.toDynamicValue(function(e){return e.container.get(t)})},t}();e.BindingToSyntax=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(7),r=n(9),o=n(6);e.resolveInstance=function(t,e,n){var s,a,c=null;if(e.length>0){var l=e.filter(function(t){return null!==t.target&&t.target.type===r.TargetTypeEnum.ConstructorArgument}).map(n);a=l,c=function(t,e,n){var i=e.filter(function(t){return null!==t.target&&t.target.type===r.TargetTypeEnum.ClassProperty}),o=i.map(n);return i.forEach(function(e,n){var i;i=e.target.name.value();var r=o[n];t[i]=r}),t}(c=new((s=t).bind.apply(s,[void 0].concat(a))),e,n)}else c=new t;return function(t,e){if(Reflect.hasMetadata(o.POST_CONSTRUCT,t)){var n=Reflect.getMetadata(o.POST_CONSTRUCT,t);try{e[n.value]()}catch(e){throw new Error(i.POST_CONSTRUCT_ERROR(t.name,e.message))}}}(t,c),c}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(7),r=n(9),o=n(44),s=n(14),a=n(84),c=function(t,e,n){try{return n()}catch(n){throw o.isStackOverflowExeption(n)?new Error(i.CIRCULAR_DEPENDENCY_IN_FACTORY(t,e.toString())):n}},l=function(t){return function(e){e.parentContext.setCurrentRequest(e);var n=e.bindings,o=e.childRequests,u=e.target&&e.target.isArray(),h=!(e.parentRequest&&e.parentRequest.target&&e.target&&e.parentRequest.target.matchesArray(e.target.serviceIdentifier));if(u&&h)return o.map(function(e){return l(t)(e)});var d=null;if(!e.target.isOptional()||0!==n.length){var f=n[0],p=f.scope===r.BindingScopeEnum.Singleton,g=f.scope===r.BindingScopeEnum.Request;if(p&&f.activated)return f.cache;if(g&&null!==t&&t.has(f.id))return t.get(f.id);if(f.type===r.BindingTypeEnum.ConstantValue)d=f.cache;else if(f.type===r.BindingTypeEnum.Function)d=f.cache;else if(f.type===r.BindingTypeEnum.Constructor)d=f.implementationType;else if(f.type===r.BindingTypeEnum.DynamicValue&&null!==f.dynamicValue)d=c("toDynamicValue",f.serviceIdentifier,function(){return f.dynamicValue(e.parentContext)});else if(f.type===r.BindingTypeEnum.Factory&&null!==f.factory)d=c("toFactory",f.serviceIdentifier,function(){return f.factory(e.parentContext)});else if(f.type===r.BindingTypeEnum.Provider&&null!==f.provider)d=c("toProvider",f.serviceIdentifier,function(){return f.provider(e.parentContext)});else{if(f.type!==r.BindingTypeEnum.Instance||null===f.implementationType){var _=s.getServiceIdentifierAsString(e.serviceIdentifier);throw new Error(i.INVALID_BINDING_TYPE+" "+_)}d=a.resolveInstance(f.implementationType,o,l(t))}return"function"==typeof f.onActivation&&(d=f.onActivation(e.parentContext,d)),p&&(f.cache=d,f.activated=!0),g&&null!==t&&!t.has(f.id)&&t.set(f.id,d),d}}};e.resolve=function(t){return l(t.plan.rootRequest.requestScope)(t.plan.rootRequest)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(11),r=function(){function t(t,e,n,r,o){this.id=i.id(),this.serviceIdentifier=t,this.parentContext=e,this.parentRequest=n,this.target=o,this.childRequests=[],this.bindings=Array.isArray(r)?r:[r],this.requestScope=null===n?new Map:null}return t.prototype.addChildRequest=function(e,n,i){var r=new t(e,this.parentContext,this,n,i);return this.childRequests.push(r),r},t}();e.Request=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this.str=t}return t.prototype.startsWith=function(t){return 0===this.str.indexOf(t)},t.prototype.endsWith=function(t){var e,n=t.split("").reverse().join("");return e=this.str.split("").reverse().join(""),this.startsWith.call({str:e},n)},t.prototype.contains=function(t){return-1!==this.str.indexOf(t)},t.prototype.equals=function(t){return this.str===t},t.prototype.value=function(){return this.str},t}();e.QueryableString=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(43),r=n(7),o=n(9),s=n(6),a=n(14);e.getFunctionName=a.getFunctionName;var c=n(42);function l(t,e,n,i){var s=t.getConstructorMetadata(n),a=s.compilerGeneratedMetadata;if(void 0===a){var l=r.MISSING_INJECTABLE_ANNOTATION+" "+e+".";throw new Error(l)}var d=s.userGeneratedMetadata,f=Object.keys(d),p=function(t,e,n,i,r){for(var o=[],s=0;s<r;s++){var a=u(s,t,e,n,i);null!==a&&o.push(a)}return o}(i,e,a,d,0===n.length&&f.length>0?f.length:n.length),g=function t(e,n){var i=e.getPropertiesMetadata(n);var r=[];var s=Object.keys(i);for(var a=0,l=s;a<l.length;a++){var u=l[a],d=i[u],f=h(i[u]),p=f.targetName||u,g=f.inject||f.multiInject,_=new c.Target(o.TargetTypeEnum.ClassProperty,p,g);_.metadata=d,r.push(_)}var m=Object.getPrototypeOf(n.prototype).constructor;if(m!==Object){var y=t(e,m);r=r.concat(y)}return r}(t,n);return p.concat(g)}function u(t,e,n,s,a){var l=a[t.toString()]||[],u=h(l),d=!0!==u.unmanaged,f=s[t],p=u.inject||u.multiInject;if((f=p||f)instanceof i.LazyServiceIdentifer&&(f=f.unwrap()),d){var g=f===Object,_=f===Function;if(!e&&(g||_||void 0===f)){var m=r.MISSING_INJECT_ANNOTATION+" argument "+t+" in class "+n+".";throw new Error(m)}var y=new c.Target(o.TargetTypeEnum.ConstructorArgument,u.targetName,f);return y.metadata=l,y}return null}function h(t){var e={};return t.forEach(function(t){e[t.key.toString()]=t.value}),{inject:e[s.INJECT_TAG],multiInject:e[s.MULTI_INJECT_TAG],targetName:e[s.NAME_TAG],unmanaged:e[s.UNMANAGED_TAG]}}e.getDependencies=function(t,e){return l(t,a.getFunctionName(e),e,!1)},e.getBaseClassDependencyCount=function t(e,n){var i=Object.getPrototypeOf(n.prototype).constructor;if(i!==Object){var r=l(e,a.getFunctionName(i),i,!0),o=r.map(function(t){return t.metadata.filter(function(t){return t.key===s.UNMANAGED_TAG})}),c=[].concat.apply([],o).length,u=r.length-c;return u>0?u:t(e,i)}return 0}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t,e){this.parentContext=t,this.rootRequest=e};e.Plan=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(11),r=function(){function t(t){this.id=i.id(),this.container=t}return t.prototype.addPlan=function(t){this.plan=t},t.prototype.setCurrentRequest=function(t){this.currentRequest=t},t}();e.Context=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.BindingCount={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(91),r=n(7),o=n(9),s=n(6),a=n(44),c=n(14),l=n(90),u=n(8),h=n(89),d=n(88),f=n(86),p=n(42);function g(t){return t._bindingDictionary}function _(t,e,n,o,s){var a=m(n.container,s.serviceIdentifier),l=[];return a.length===i.BindingCount.NoBindingsAvailable&&n.container.options.autoBindInjectable&&"function"==typeof s.serviceIdentifier&&t.getConstructorMetadata(s.serviceIdentifier).compilerGeneratedMetadata&&(n.container.bind(s.serviceIdentifier).toSelf(),a=m(n.container,s.serviceIdentifier)),l=e?a:a.filter(function(t){var e=new f.Request(t.serviceIdentifier,n,o,t,s);return t.constraint(e)}),function(t,e,n,o){switch(e.length){case i.BindingCount.NoBindingsAvailable:if(n.isOptional())return e;var s=c.getServiceIdentifierAsString(t),a=r.NOT_REGISTERED;throw a+=c.listMetadataForTarget(s,n),a+=c.listRegisteredBindingsForServiceIdentifier(o,s,m),new Error(a);case i.BindingCount.OnlyOneBindingAvailable:if(!n.isArray())return e;case i.BindingCount.MultipleBindingsAvailable:default:if(n.isArray())return e;s=c.getServiceIdentifierAsString(t),a=r.AMBIGUOUS_MATCH+" "+s;throw a+=c.listRegisteredBindingsForServiceIdentifier(o,s,m),new Error(a)}}(s.serviceIdentifier,l,s,n.container),l}function m(t,e){var n=[],i=g(t);return i.hasKey(e)?n=i.get(e):null!==t.parent&&(n=m(t.parent,e)),n}e.getBindingDictionary=g,e.plan=function(t,e,n,i,g,m,y,v){void 0===v&&(v=!1);var b=new l.Context(e),C=function(t,e,n,i,r,o){var a=t?s.MULTI_INJECT_TAG:s.INJECT_TAG,c=new u.Metadata(a,n),l=new p.Target(e,i,n,c);if(void 0!==r){var h=new u.Metadata(r,o);l.metadata.push(h)}return l}(n,i,g,"",m,y);try{return function t(e,n,i,s,a,c){var l,u;if(null===a){l=_(e,n,s,null,c),u=new f.Request(i,s,null,l,c);var p=new h.Plan(s,u);s.addPlan(p)}else l=_(e,n,s,a,c),u=a.addChildRequest(c.serviceIdentifier,l,c);l.forEach(function(n){var i=null;if(c.isArray())i=u.addChildRequest(n.serviceIdentifier,n,c);else{if(n.cache)return;i=u}if(n.type===o.BindingTypeEnum.Instance&&null!==n.implementationType){var a=d.getDependencies(e,n.implementationType);if(!s.container.options.skipBaseClassChecks){var l=d.getBaseClassDependencyCount(e,n.implementationType);if(a.length<l){var h=r.ARGUMENTS_LENGTH_MISMATCH(d.getFunctionName(n.implementationType));throw new Error(h)}}a.forEach(function(n){t(e,!1,n.serviceIdentifier,s,i,n)})}})}(t,v,g,b,null,C),b}catch(t){throw a.isStackOverflowExeption(t)&&b.plan&&c.circularDependencyToException(b.plan.rootRequest),t}},e.createMockRequest=function(t,e,n,i){var r=new p.Target(o.TargetTypeEnum.Variable,"",e,new u.Metadata(n,i)),s=new l.Context(t);return new f.Request(e,s,null,[],r)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(9),r=n(11),o=function(){function t(t,e){this.id=r.id(),this.activated=!1,this.serviceIdentifier=t,this.scope=e,this.type=i.BindingTypeEnum.Invalid,this.constraint=function(t){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return t.prototype.clone=function(){var e=new t(this.serviceIdentifier,this.scope);return e.activated=!1,e.implementationType=this.implementationType,e.dynamicValue=this.dynamicValue,e.scope=this.scope,e.type=this.type,e.factory=this.factory,e.provider=this.provider,e.constraint=this.constraint,e.onActivation=this.onActivation,e.cache=this.cache,e},t}();e.Binding=o},function(t,e,n){"use strict";var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))(function(r,o){function s(t){try{c(i.next(t))}catch(t){o(t)}}function a(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){t.done?r(t.value):new n(function(e){e(t.value)}).then(s,a)}c((i=i.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=i[2&o[0]?"return":o[0]?"throw":"next"])&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[0,r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(93),s=n(7),a=n(9),c=n(6),l=n(45),u=n(92),h=n(85),d=n(83),f=n(11),p=n(14),g=n(80),_=n(79),m=function(){function t(t){var e=t||{};if("object"!=typeof e)throw new Error(""+s.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(void 0===e.defaultScope)e.defaultScope=a.BindingScopeEnum.Transient;else if(e.defaultScope!==a.BindingScopeEnum.Singleton&&e.defaultScope!==a.BindingScopeEnum.Transient&&e.defaultScope!==a.BindingScopeEnum.Request)throw new Error(""+s.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(void 0===e.autoBindInjectable)e.autoBindInjectable=!1;else if("boolean"!=typeof e.autoBindInjectable)throw new Error(""+s.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(void 0===e.skipBaseClassChecks)e.skipBaseClassChecks=!1;else if("boolean"!=typeof e.skipBaseClassChecks)throw new Error(""+s.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:e.autoBindInjectable,defaultScope:e.defaultScope,skipBaseClassChecks:e.skipBaseClassChecks},this.id=f.id(),this._bindingDictionary=new _.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new l.MetadataReader}return t.merge=function(e,n){var i=new t,r=u.getBindingDictionary(i),o=u.getBindingDictionary(e),s=u.getBindingDictionary(n);function a(t,e){t.traverse(function(t,n){n.forEach(function(t){e.add(t.serviceIdentifier,t.clone())})})}return a(o,r),a(s,r),i},t.prototype.load=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=this._getContainerModuleHelpersFactory(),i=0,r=t;i<r.length;i++){var o=r[i],s=n(o.id);o.registry(s.bindFunction,s.unbindFunction,s.isboundFunction,s.rebindFunction)}},t.prototype.loadAsync=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return i(this,void 0,void 0,function(){var e,n,i,o,s;return r(this,function(r){switch(r.label){case 0:e=this._getContainerModuleHelpersFactory(),n=0,i=t,r.label=1;case 1:return n<i.length?(o=i[n],s=e(o.id),[4,o.registry(s.bindFunction,s.unbindFunction,s.isboundFunction,s.rebindFunction)]):[3,4];case 2:r.sent(),r.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},t.prototype.unload=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var i=function(t){return function(e){return e.moduleId===t}};e.forEach(function(e){var n=i(e.id);t._bindingDictionary.removeByCondition(n)})},t.prototype.bind=function(t){var e=this.options.defaultScope||a.BindingScopeEnum.Transient,n=new o.Binding(t,e);return this._bindingDictionary.add(t,n),new d.BindingToSyntax(n)},t.prototype.rebind=function(t){return this.unbind(t),this.bind(t)},t.prototype.unbind=function(t){try{this._bindingDictionary.remove(t)}catch(e){throw new Error(s.CANNOT_UNBIND+" "+p.getServiceIdentifierAsString(t))}},t.prototype.unbindAll=function(){this._bindingDictionary=new _.Lookup},t.prototype.isBound=function(t){var e=this._bindingDictionary.hasKey(t);return!e&&this.parent&&(e=this.parent.isBound(t)),e},t.prototype.isBoundNamed=function(t,e){return this.isBoundTagged(t,c.NAMED_TAG,e)},t.prototype.isBoundTagged=function(t,e,n){var i=!1;if(this._bindingDictionary.hasKey(t)){var r=this._bindingDictionary.get(t),o=u.createMockRequest(this,t,e,n);i=r.some(function(t){return t.constraint(o)})}return!i&&this.parent&&(i=this.parent.isBoundTagged(t,e,n)),i},t.prototype.snapshot=function(){this._snapshots.push(g.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},t.prototype.restore=function(){var t=this._snapshots.pop();if(void 0===t)throw new Error(s.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=t.bindings,this._middleware=t.middleware},t.prototype.createChild=function(e){var n=new t(e||this.options);return n.parent=this,n},t.prototype.applyMiddleware=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=t.reduce(function(t,e){return e(t)},n)},t.prototype.applyCustomMetadataReader=function(t){this._metadataReader=t},t.prototype.get=function(t){return this._get(!1,!1,a.TargetTypeEnum.Variable,t)},t.prototype.getTagged=function(t,e,n){return this._get(!1,!1,a.TargetTypeEnum.Variable,t,e,n)},t.prototype.getNamed=function(t,e){return this.getTagged(t,c.NAMED_TAG,e)},t.prototype.getAll=function(t){return this._get(!0,!0,a.TargetTypeEnum.Variable,t)},t.prototype.getAllTagged=function(t,e,n){return this._get(!1,!0,a.TargetTypeEnum.Variable,t,e,n)},t.prototype.getAllNamed=function(t,e){return this.getAllTagged(t,c.NAMED_TAG,e)},t.prototype.resolve=function(t){var e=this.createChild();return e.bind(t).toSelf(),e.get(t)},t.prototype._getContainerModuleHelpersFactory=function(){var t=this,e=function(t,e){t._binding.moduleId=e},n=function(n){return function(i){var r=t.rebind.bind(t)(i);return e(r,n),r}};return function(i){return{bindFunction:(r=i,function(n){var i=t.bind.bind(t)(n);return e(i,r),i}),isboundFunction:function(e){return t.isBound.bind(t)(e)},rebindFunction:n(i),unbindFunction:function(e){t.unbind.bind(t)(e)}};var r}},t.prototype._get=function(t,e,n,i,r,o){var a=null,c={avoidConstraints:t,contextInterceptor:function(t){return t},isMultiInject:e,key:r,serviceIdentifier:i,targetType:n,value:o};if(this._middleware){if(null==(a=this._middleware(c)))throw new Error(s.INVALID_MIDDLEWARE_RETURN)}else a=this._planAndResolve()(c);return a},t.prototype._planAndResolve=function(){var t=this;return function(e){var n=u.plan(t._metadataReader,t,e.isMultiInject,e.targetType,e.serviceIdentifier,e.key,e.value,e.avoidConstraints);return n=e.contextInterceptor(n),h.resolve(n)}},t}();e.Container=m},function(t,e,n){t.exports=function(){"use strict";function t(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function e(t,e){return t<e?-1:t>e?1:0}return function(n,i,r,o,s){!function e(n,i,r,o,s){for(;o>r;){if(o-r>600){var a=o-r+1,c=i-r+1,l=Math.log(a),u=.5*Math.exp(2*l/3),h=.5*Math.sqrt(l*u*(a-u)/a)*(c-a/2<0?-1:1),d=Math.max(r,Math.floor(i-c*u/a+h)),f=Math.min(o,Math.floor(i+(a-c)*u/a+h));e(n,i,d,f,s)}var p=n[i],g=r,_=o;for(t(n,r,i),s(n[o],p)>0&&t(n,r,o);g<_;){for(t(n,g,_),g++,_--;s(n[g],p)<0;)g++;for(;s(n[_],p)>0;)_--}0===s(n[r],p)?t(n,r,_):t(n,++_,o),_<=i&&(r=_+1),i<=_&&(o=_-1)}}(n,i,r||0,o||n.length-1,s||e)}}()},,function(t,e){},,function(t,e,n){},,function(t,e,n){},,function(t,e,n){},,function(t,e,n){},,function(t,e,n){},,function(t,e,n){},,function(t,e,n){},,function(t,e,n){},,function(t,e,n){},,function(t,e,n){},,function(t,e,n){},,function(t,e,n){},,function(t,e,n){},,function(t,e,n){},function(t,e){var n,i,r=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(t){i=s}}();var c,l=[],u=!1,h=-1;function d(){u&&c&&(u=!1,c.length?l=c.concat(l):h=-1,l.length&&f())}function f(){if(!u){var t=a(d);u=!0;for(var e=l.length;e;){for(c=l,l=[];++h<e;)c&&c[h].run();h=-1,e=l.length}c=null,u=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function g(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new p(t,e)),1!==l.length||u||a(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=g,r.addListener=g,r.once=g,r.off=g,r.removeListener=g,r.removeAllListeners=g,r.emit=g,r.prependListener=g,r.prependOnceListener=g,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(t,e,n){var i=n(54).default;i.initialize(),t.exports=i}]);